"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["1871"],{33803:function(t,e,a){a.d(e,{Z:()=>n});let n={elevatedTheme:"elevatedTheme-fBklGV"}},36786:function(t,e,a){a.d(e,{Z:()=>n});let n={avatar:"avatar-u8q6xB",ltr:"ltr-qDBmby",rtl:"rtl-zsi3Q8",overlap:"overlap-q75iOo",last:"last-JfNEJ_"}},74626:function(t,e,a){a.d(e,{_:()=>h});var n=a(7409),r=a(99282),l=a(98848),i=a(16584),o=a(94184),s=a.n(o),d=a(14293),c=a.n(d),u=a(56743),m=a(2564),p=a(32224),g=a(15771),b=a(66033);let h=t=>{var e;let{children:a,className:o,leadingIcon:d,native:h,renderAsLink:f=!1,size:v="lg",trailingIcon:y,variant:w="primary",justifyContent:_="center",href:k,target:C}=t,S=(0,l._)(t,["children","className","leadingIcon","native","renderAsLink","size","trailingIcon","variant","justifyContent","href","target"]),E=s()(o,b.Z.button,b.Z["button-size-".concat(v)],b.Z["button-variant-".concat(w)],b.Z["button-justify-content-".concat(_)],f&&b.Z.buttonAsLink,{[null!==(e=b.Z.buttonDisabled)&&void 0!==e?e:""]:S.disabled}),N="lg"===v?18:16,O=(0,i.BX)(i.HY,{children:["chevron-left"===d?(0,i.tZ)(u.Z,{size:N}):null,a,"chevron-right"===y?(0,i.tZ)(m.Z,{size:N}):null,"plus"===y?(0,i.tZ)(p.Z,{size:N}):null]});return(0,i.tZ)(i.HY,{children:f?(0,i.tZ)("a",{className:E,href:k,id:S.id,target:C,onClick:S.onClick,children:O}):(0,i.tZ)(g.kG,(0,r._)((0,n._)({},S,c()(h)?null:{localNavigation:!h}),{className:E,href:k,children:O}))})}},27625:function(t,e,a){a.d(e,{HU:()=>f,Sl:()=>b,cD:()=>h});var n=a(58865),r=a(16584),l=a(30396),i=a(23260),o=a(29032),s=a(95441),d=a(7271),c=a(15771),u=a(19081),m=a(58175),p=a(60308);function g(){let t=(0,n._)(["This "," was automatically hidden by your content settings."]);return g=function(){return t},t}function b(t){let e=(0,d.M)(),[a,n]=(0,l.eJ)(t&&!e);return{isHidden:a,onShow:()=>n(!1)}}function h(t){let{onShow:e,itemName:a,radius:n}=t,{iString:l,iTemplate:i}=(0,s.M1)(),d=i(g(),a||"item");return(0,r.tZ)(f,{onShow:e,radius:n,children:(0,r.BX)(o.C,{children:[(0,r.BX)(u.tu,{gap:4,alignItems:"center",justifyContent:"center",children:[(0,r.tZ)(m.xv.B4,{align:"center",color:"vibrance-primary",weight:"semibold",translated:!0,children:"May contain explicit content"}),(0,r.tZ)(m.xv.B4,{align:"center",color:"vibrance-secondary",children:d})]}),(0,r.BX)(u.gq,{gap:8,alignItems:"center",wrap:"wrap",justifyContent:"center",children:[(0,r.tZ)(c.zx,{priority:"primary-mono",children:l("Show anyway")}),(0,r.tZ)(c.zx,{priority:"secondary-outline",href:(0,p.v3t)({section:"privacy"}),newTab:!0,children:l("Adjust settings")})]})]})})}function f(t){let{onShow:e,children:a,radius:n}=t;return(0,r.BX)(u.tu,{justifyContent:"center",alignItems:"center",position:"absolute",inset:0,bg:"glass-inverted-thick",gap:16,padding:16,cursor:"pointer",onClick:t=>{t.preventDefault(),e()},radius:n,children:[(0,r.tZ)(i.Z,{size:24,stroke:"var(--color-utility-white)"}),a]})}},24547:function(t,e,a){a.d(e,{H:()=>u});var n=a(7409),r=a(16584),l=a(94184),i=a.n(l),o=a(94874),s=a(71068),d=a(84864),c=a(36786);function u(t){let{users:e,renderAvatar:a=t=>(0,r.tZ)(o.qE,(0,n._)({},t)),max:l=5,total:s,size:d=32,direction:u="ltr",className:b,renderCount:h,loading:f}=t,v=l?e.slice(0,l):e,y=s?s-v.length:l?e.length-l:0,w="rtl"===u?[...v].reverse():v,_=(0,r.tZ)(m,{size:d,remainingCount:y}),k=null==h?void 0:h(y),C=.25*d,S=Math.max(.125*d,3);return(0,r.BX)(p,{children:[(0,r.BX)(g,{className:i()(c.Z[u],b),style:{"--scale":"".concat(d,"px"),"--offset":"".concat(C,"px"),"--border-width":"".concat(S,"px")},children:[f?function(t){let{size:e,max:a}=t;return Array(a).fill(null).map((t,n)=>(0,r.tZ)(o.GX,{size:e,className:i()(c.Z.avatar,0!==n&&c.Z.overlap,n===a-1&&c.Z.last)},n))}({size:d,max:l}):w.map((t,e)=>a({user:t,size:d,className:i()(c.Z.avatar,0!==e&&c.Z.overlap,e===w.length-1&&c.Z.last)})),y>0&&!h&&_]}),y>0&&h&&k]})}function m(t){let{size:e,remainingCount:a}=t;return(0,r.tZ)(o.mw,{className:i()(c.Z.avatar,c.Z.overlap,c.Z.last),size:e,children:(0,r.tZ)(o.XH,{size:e,text:"+".concat((0,d.numberToRoughShortString)(Math.max(a,1),{plusSignifier:""}))})})}let p=(0,s.zo)({display:"flex",direction:"row",gap:8,alignItems:"center",justifyContent:"start"}),g=(0,s.zo)({display:"flex",direction:"row",alignItems:"center",justifyContent:"start"})},14518:function(t,e,a){a.d(e,{H:()=>g});var n=a(7409),r=a(99282),l=a(98848),i=a(16584),o=a(94184),s=a.n(o),d=a(98661),c=a(15771),u=a(19081),m=a(51776),p=a(68686);let g=(0,d.forwardRef)((t,e)=>{var{className:a,placement:o="end",priority:g="secondary-outline",button:b}=t,h=(0,l._)(t,["className","placement","priority","button"]);let f=d.default.isValidElement(b)&&null!=b&&b.type===c.zx?(0,d.cloneElement)(b,{priority:g,className:s()(b.props.className,p.Z.inputWithButtonButton,p.Z[o])}):null;return(0,i.BX)(u.hs,{direction:"start"===o?"row-reverse":"row",position:"relative",sizing:"border-box",className:s()(p.Z.inputWithButtonWrapper,p.Z[g]),children:[(0,i.tZ)(m.oi,(0,r._)((0,n._)({},h),{ref:e,flex:"grow",className:s()(a,p.Z.inputWithButtonInput,p.Z[g],f&&p.Z[o])})),f]})})},23398:function(t,e,a){a.d(e,{u:()=>r});var n=a(84864);function r(t){let e,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:24,r=!(arguments.length>2)||void 0===arguments[2]||arguments[2];t.match(/^([a-z]+:)?\/\//i)||(t="http://".concat(t));try{e=new URL(t)}catch(e){return console.error("Failed to parse URL",t,e),t}e.hostname=e.hostname.replace(/^www\./,""),e.pathname=e.pathname.replace(/\/+$/,""),e.hash="";let l=new Set;e.hostname.includes("youtube")&&l.add("v"),e.searchParams.forEach((t,a)=>{l.has(a)||e.searchParams.delete(a)});let i=e.toString().replace(/^\w+:\/\//,"").replace(/\/+$/,"");return i?r?(0,n.truncateText)(i,a):i:t}},5835:function(t,e,a){a.d(e,{$y:()=>d,hE:()=>m,ph:()=>b,uF:()=>p});var n=a(7409),r=a(80569),l=a.n(r),i=a(84864),o=a(15233),s=a(30548);let d={attrs:{url:{default:""},isEpisode:{default:!1},imageUrl:{default:""},title:{default:""},podcastTitle:{default:""},podcastByline:{default:""},duration:{default:""},numEpisodes:{default:""},targetUrl:{default:""},releaseDate:{default:""}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDom:[{tag:"iframe.apple-podcast",getAttrs:a(30837).Y}],toDOM:t=>{let{url:e,isEpisode:a}=t.attrs;return["div",{class:"apple-podcast-container","data-component-name":"ApplePodcastToDom"},["iframe",{class:"apple-podcast ".concat(a?"":"episode-list"),"data-attrs":JSON.stringify(t.attrs),src:e,frameborder:"0",allow:"autoplay *; encrypted-media *;",allowfullscreen:"true"}]]},toDOMStatic:t=>{let{imageUrl:e,isEpisode:a,podcastTitle:n,podcastByline:r,duration:l,numEpisodes:s,targetUrl:d}=t.attrs,c=t.attrs.title,u=n,m=(0,i.secondsToHHMMSS)(l/1e3);return a||(c=n,u=r,m=(0,i.pluralize)(s,"episode",{zero_fallback:"No episodes"})),(0,o.L)(e,c,u,m,{targetUrl:d})}},c=/[<iframe]?.*[src="]?(https?:\/\/(embed\.)?podcasts\.apple\.com\/([^/]+)?\/?podcast\/([^/]+)\/?(id\d+)\??(i=(\d+))?)[\S]*/,u=t=>{var e;let a=c.exec(t);return a?{match:a[0],embedLink:a[2],countryCode:a[3],slug:a[4],podcastId:null===(e=a[5])||void 0===e?void 0:e.substr(2),episodeId:a[7]}:{match:!1}},m=(0,s.S)({name:"applePodcast",nodeSpec:d,addCommands(){return{insertApplePodcast:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),p=function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e&&!e.nodes.applePodcast?null:u(t).match||null},g=async t=>{let e=u(t),{slug:a,podcastId:r,episodeId:i,countryCode:o}=e,s=(await l().get("/api/v1/apple_podcast").query({slug:a,podcastId:r,episodeId:i,country:o})).body;return(0,n._)({url:h(e),isEpisode:!!e.episodeId},s)},b=async function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(e?{schema:e}:await Promise.resolve().then(a.bind(a,37175))).schema.nodes.applePodcast.create(await g(t))},h=t=>{let{countryCode:e,slug:a,podcastId:n,episodeId:r}=t,l=encodeURIComponent(a||"");return"https://embed.podcasts.apple.com/".concat(e||"us","/podcast/").concat(l,"/id").concat(n).concat(r?"?i=".concat(r):"")}},26603:function(t,e,a){a.d(e,{$:()=>p,a:()=>g});var n=a(7409),r=a(6400),l=a(55679),i=a(52244),o=a(10656),s=a(84864),d=a(19520),c=a(30548),u=a(30837);let m="image-asset-error",p={attrs:{url:{default:""}},group:"block",defining:!0,parseDOM:[{tag:"div.".concat(m),getAttrs:u.Y}],toDOM:t=>{if("undefined"!=typeof window)try{t.attrs.isEditor=!0;let e=document.createElement("div");return e.className=m,e.setAttribute("data-attrs",JSON.stringify(t.attrs)),(0,o.G5)((0,r.h)(i.v,{node:(0,n._)({},t)}),e),e}catch(e){return console.error("Error rendering ImageAssetError",e),(0,d.s)({msg:null,node:t,err:e,group:"block"})}return["div",{"data-attrs":JSON.stringify((0,n._)({},t.attrs)),"data-component-name":"AssetErrorToDOM"},["picture",["img",{src:s.MISSING_IMAGE_URL,height:s.MISSING_IMAGE_HEIGHT,width:s.MISSING_IMAGE_WIDTH}]]]},toDOMStatic:t=>["div",{"data-attrs":JSON.stringify((0,n._)({},t.attrs)),"data-component-name":"AssetErrorToDOMStatic"}]},g=(0,c.S)({name:"assetError",nodeSpec:p,addNodeView:()=>(0,l.fW)(i.v)})},57937:function(t,e,a){a.d(e,{$y:()=>m,DW:()=>p});var n=a(7409),r=a(99282),l=a(6400),i=a(55679),o=a(84892),s=a(74204),d=a(10656),c=a(19520),u=a(30548);let m={attrs:{label:{default:null},mediaUploadId:{default:null},duration:{default:null},isEditorNode:{default:!1}},group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.native-audio-embed",getAttrs:a(30837).Y}],toDOM:t=>{if("undefined"!=typeof window&&t.attrs.isEditorNode)try{let e=document.createElement("div");return e.className="native-audio-embed",e.setAttribute("data-attrs",JSON.stringify(t.attrs)),(0,d.G5)((0,l.h)(o.cM,{label:t.attrs.label,src:"/api/v1/audio/upload/".concat(t.attrs.mediaUploadId,"/src"),duration:t.attrs.duration}),e),e}catch(e){return console.error("Error rendering AudioEmbedPlayer",e),(0,c.s)({msg:null,node:t,err:e,group:"block"})}return g(t)},toDOMStatic:t=>g(t)},p=(0,u.S)({name:"audio",nodeSpec:m,addNodeView:()=>(0,i.fW)(s.$),addCommands(){return{insertAudio:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:(0,r._)((0,n._)({},t),{isEditorNode:!0})})}}}}),g=t=>["div",{class:"native-audio-embed","data-component-name":"AudioPlaceholder","data-attrs":JSON.stringify(t.attrs)}]},55633:function(t,e,a){a.d(e,{$y:()=>r,E4:()=>l});var n=a(30548);let r={attrs:{label:{default:null},url:{default:null},duration:{default:null}},group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.native-audio-url-embed",getAttrs:a(30837).Y}],toDOM:t=>["div",{class:"native-audio-url-embed","data-attrs":JSON.stringify(t.attrs),"data-component-name":"AudioUrlPlaceholder"}]},l=(0,n.S)({name:"audioUrl",nodeSpec:r})},1451:function(t,e,a){a.d(e,{$:()=>l,h:()=>i});var n=a(84864),r=a(30548);let l={attrs:{request_id:{default:null},url:{default:null},src:{default:null},type:{default:null}},untrackedAttrs:["src"],inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"a.augmentation-placeholder",getAttrs:a(30837).Y}],toDOM:t=>["a",{class:"augmentation-placeholder image-link","data-attrs":JSON.stringify(t.attrs),href:"javascript:void(0)","data-component-name":"AugmentationPlaceholderToDOM"},["img",{src:t.attrs.src||n.TRANSPARENT_IMAGE_URL}]]},i=(0,r.S)({name:"augmentation_placeholder",nodeSpec:l,addCommands(){return{insertLoadingPlaceholder:(t,e)=>a=>{let{commands:n}=a;return e?n.insertContentAt(e,{type:this.name,attrs:t}):n.insertContent({type:this.name,attrs:t})}}}})},44262:function(t,e,a){a.d(e,{$y:()=>s,XC:()=>u,bo:()=>g,hV:()=>d});var n=a(7409),r=a(99282),l=a(69332),i=a(15233),o=a(30548);let s={attrs:{url:{default:""},title:{default:""},description:{default:""},thumbnail_url:{default:""},author:{default:""},embed_url:{default:""},is_album:{default:""}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.bandcamp-wrap",getAttrs:a(30837).Y}],toDOM:t=>["div",{class:"bandcamp-wrap".concat(t.attrs.is_album?" album":""),"data-attrs":JSON.stringify(t.attrs),"data-component-name":"BandcampToDOM"},["iframe",{src:t.attrs.embed_url,frameborder:"0",gesture:"media",scrolling:"no",allowfullscreen:"true"}]],toDOMStatic:t=>{let{thumbnail_url:e,author:a,title:n,description:r,url:l}=t.attrs;return(0,i.L)(e,n,(a||"").toString(),r,{targetUrl:l})}},d=(0,o.S)({name:"bandcamp",nodeSpec:s,addCommands(){return{insertBandcamp:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),c=/^.*(https?\:\/\/(\S+)?.bandcamp.com\/(...+)\/[^\/]+(\/[^\/]+)?(\?[\#]*)?(\#.*)?).*$/,u=t=>{var e;let a=c.exec(t);return null!==(e=a&&a[1])&&void 0!==e?e:null},m=t=>{let e=c.exec(t);return!!e&&"album"===e[3]},p=async t=>{let e=m(t),i=(await Promise.resolve().then(a.t.bind(a,80569,23))).default,o="dark"===(0,l.m)(t).theme?"dark":"light",s=(await i.get("/api/v1/bandcamp").query({url:t.trim(),is_album:e,theme:o})).body;return(0,r._)((0,n._)({},s),{is_album:e})},g=async function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(e?{schema:e}:await Promise.resolve().then(a.bind(a,37175))).schema.nodes.bandcamp.create(await p(t))}},41676:function(t,e,a){a.d(e,{$:()=>l,M:()=>i});var n=a(88897),r=a(19512);let l={content:"block+",group:"block",parseDOM:[{tag:"blockquote"},{tag:"p",priority:100,getAttrs:t=>!(!t.style.marginLeft||t.style.marginLeft.startsWith("0"))&&{}}],toDOM:()=>["blockquote",0]},i=r.ZP.extend({parseHTML:()=>l.parseDOM,addCommands(){return{setBlockquote:()=>t=>{let{state:e,commands:a}=t;return!(!(0,n.Ig)(e,"paragraph")||(0,n.Ig)(e,"pullquote")||(0,n.Ig)(e,"calloutBlock"))&&a.wrapIn(this.name)},toggleBlockquote:()=>t=>{let{state:e,commands:a}=t;return!(!(0,n.Ig)(e,"paragraph")||(0,n.Ig)(e,"pullquote")||(0,n.Ig)(e,"calloutBlock"))&&a.toggleWrap(this.name)},unsetBlockquote:()=>t=>{let{commands:e}=t;return e.lift(this.name)}}}})},82032:function(t,e,a){a.d(e,{$y:()=>c,IS:()=>b,X2:()=>u,q7:()=>p});var n=a(39693),r=a.n(n),l=a(48980),i=a(98012),o=a(30548),s=a(30837),d=a(35934);let c={attrs:{postId:{default:""},authorDid:{default:""},authorName:{default:""},authorHandle:{default:""},authorAvatarUrl:{default:""},text:{default:""},createdAt:{default:""},uri:{default:""},imageUrls:{default:[]}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDom:[{tag:"div.bluesky-wrap",getAttrs:s.Y}],toDOM:t=>(function(t){var e,a,n;let r=String(Math.random()).slice(2),l=(e=t.attrs.authorDid,a=t.attrs.postId,n=r,"https://embed.bsky.app/embed/".concat(e,"/app.bsky.feed.post/").concat(a,"?id=").concat(n)),i=document.createElement("div");i.className="bluesky-wrap outer",i.style.height="auto",i.style.display="flex",i.style.marginBottom="24px",i.dataset.attrs=JSON.stringify(t.attrs),i.setAttribute("data-component-name","BlueskyCreateBlueskyEmbed");let o=document.createElement("iframe");return o.id=h(t.attrs.postId),o.setAttribute("data-bluesky-id",r),o.src=l,o.width="100%",o.style.border="none",o.style.display="block",o.style.flexGrow="1",o.frameBorder="0",o.scrolling="no",i.appendChild(o),i})(t),toDOMStatic:t=>(function(t){var e,a,n;let r=t.attrs,l=document.createElement("div");l.className="bluesky-wrap static",l.setAttribute("data-component-name","BlueskyCreateStaticBlueskyEmbed");let o=document.createElement("div"),s=document.createElement("img");s.className="bluesky-avatar",r.authorAvatarUrl&&(s.src=r.authorAvatarUrl),o.appendChild(s);let d=document.createElement("span");d.className="bluesky-author-name",d.textContent="".concat(null!==(e=r.authorName)&&void 0!==e?e:r.authorHandle," "),o.appendChild(d);let c=document.createElement("span");c.className="bluesky-author-handle",c.textContent="@".concat(r.authorHandle),o.appendChild(c),l.appendChild(o);let u=document.createElement("div");if(u.textContent=r.text,l.appendChild(u),r.imageUrls.length>0&&r.imageUrls[0]){let t=document.createElement("img");t.src=r.imageUrls[0],l.append(t)}let m=document.createElement("div");m.className="bluesky-created-at",m.textContent=(0,i.Z)(r.createdAt).toString(),l.appendChild(m);let p=document.createElement("a");return p.href=(a=r.authorDid,n=r.postId,"https://bsky.app/profile/".concat(a,"/post/").concat(n,"?ref_src=embed")),p.text="View on Bluesky",l.appendChild(p),l})(t)},u=(0,o.S)({name:"bluesky",nodeSpec:c,addCommands(){return{insertBluesky:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),m=/^https:\/\/bsky.app\/profile\/([^\/]+)\/post\/([^\?]+)(\?.+)?$/;function p(t){let e=m.exec(t);return m.lastIndex=0,e&&e[0]}async function g(t){var e,a,n,o,s,d,c,u,p,g,b,h,f,v;let y=function(t){let e=m.exec(t);return e&&e[1]&&e[2]?{handle:e[1],postId:e[2]}:null}(t);if(!y)return null;let{handle:w,postId:_}=y,k=await (0,l.rd)((f=w,v=_,"https://public.api.bsky.app/xrpc/app.bsky.feed.getPostThread?uri=at://".concat(f,"/app.bsky.feed.post/").concat(v)));if("blocked"in k.thread||"notFound"in k.thread)return null;let C=null;return(null===(a=k.thread)||void 0===a?void 0:null===(e=a.post)||void 0===e?void 0:e.embed)&&((null===(n=k.thread.post.embed)||void 0===n?void 0:n.thumbnail)?C=null===(s=k.thread.post.embed)||void 0===s?void 0:s.thumbnail:(null!==(o=k.thread.post.embed.images)&&void 0!==o?o:[]).length>0&&(C=k.thread.post.embed.images[0].thumb)),{postId:_,authorDid:null!==(d=k.thread.post.author.did)&&void 0!==d?d:"",authorName:null!==(c=k.thread.post.author.displayName)&&void 0!==c?c:"",authorHandle:null!==(u=k.thread.post.author.handle)&&void 0!==u?u:"",authorAvatarUrl:null!==(p=k.thread.post.author.avatar)&&void 0!==p?p:"",text:null!==(g=k.thread.post.record.text)&&void 0!==g?g:"",createdAt:(0,i.Z)(null!==(b=k.thread.post.record.createdAt)&&void 0!==b?b:"").toISOString(),uri:null!==(h=k.thread.post.uri)&&void 0!==h?h:"",imageUrls:r()([C])}}async function b(t){var e;let{customSchema:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(n?{schema:n}:await Promise.resolve().then(a.bind(a,37175))).schema;if(!(null===(e=r.nodes.bluesky)||void 0===e?void 0:e.create))throw new d.gz("Bluesky node schema is missing");return r.nodes.bluesky.create(await g(t))}let h=t=>"bluesky-".concat(t)},95068:function(t,e,a){a.d(e,{$y:()=>C,H9:()=>S,ax:()=>E});var n=a(7409),r=a(99282),l=a(58865),i=a(60826),o=a(68833),s=a(98914),d=a(60308),c=a(63651),u=a(84864),m=a(47929),p=a(39947),g=a(30548);function b(){let t=(0,l._)(["Thanks for reading ","! Subscribe for free to receive new posts and support my work."]);return b=function(){return t},t}function h(){let t=(0,l._)([""," is a reader-supported publication. To receive new posts and support my work, consider becoming a free or paid subscriber."]);return h=function(){return t},t}function f(){let t=(0,l._)(["","! This post is public so feel free to share it."]);return f=function(){return t},t}function v(){let t=(0,l._)(["Share ",""]);return v=function(){return t},t}function y(){let t=(0,l._)(["Give a gift subscription"]);return y=function(){return t},t}function w(){let t=(0,l._)(["Get ","% off a group subscription"]);return w=function(){return t},t}function _(){let t=(0,l._)(["Get a group subscription"]);return _=function(){return t},t}function k(){let t=(0,l._)(["Start writing today. Use the button below to create a Substack of your own."]);return k=function(){return t},t}let C={attrs:{url:{default:null},text:{default:null},action:{default:null},class:{default:null}},inline:!1,atom:!0,group:"block",draggable:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"p.button-wrapper[data-attrs]",priority:100,getAttrs:a(30837).Y}],toDOM:t=>E(t)},S=(0,g.S)({name:"button",nodeSpec:C,addCommands(){var t=this;return{insertSubscribeButton:t=>e=>{let{commands:a}=e,n={url:i.W.CHECKOUT_URL,text:(0,u.getSubscribeText)(t,{now:!0})};return a.insertContent({type:this.name,attrs:n})},insertCustomButtonEditorV2:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})},insertSubscribeButtonWithPreamble:t=>e=>{let{commands:a,editor:n}=e,{iTemplate:r,iString:l}=I18N.i({pub:t}),o=t.author_name===t.name?l("enabled"!==t.payments_state?"Thanks for reading! Subscribe for free to receive new posts and support my work.":"This Substack is reader-supported. To receive new posts and support my work, consider becoming a free or paid subscriber."):r("enabled"!==t.payments_state?b():h(),t.name),s={url:i.W.CHECKOUT_URL,text:(0,u.getSubscribeText)(t),language:t.language};return a.insertContent({type:"subscribeWidget",attrs:s,content:[n.schema.nodes.ctaCaption.create(null,[n.schema.text(o)]).toJSON()]})},insertCaptionedShareButton:t=>e=>{let{commands:a,editor:n}=e,{iString:r,iTemplate:l}=I18N.i({pub:t}),o=l(f(),t.author_name===t.name?"Thanks for reading":"Thanks for reading ".concat(t.name)),s={url:i.W.SHARE_URL,text:r("Share")};return a.insertContent({type:"captionedShareButton",attrs:s,content:[n.state.schema.nodes.ctaCaption.create(null,[n.state.schema.text(o)]).toJSON()]})},insertSharePostButton:t=>e=>{let{commands:a}=e,{iString:n}=I18N.i({pub:t}),r={url:i.W.SHARE_URL,text:n("Share")};return a.insertContent({type:this.name,attrs:r})},insertSharePubButton:t=>e=>{let{commands:a}=e,{iTemplate:n}=I18N.i({pub:t}),r={url:i.W.SHARE_PUB_URL,text:n(v(),t.name)};return a.insertContent({type:this.name,attrs:r})},insertCommentsButton:t=>e=>{let{commands:a}=e,{iString:n}=I18N.i({pub:t}),r={url:i.W.HALF_MAGIC_COMMENTS_URL,text:n("Leave a comment")};return a.insertContent({type:this.name,attrs:r})},insertGiftButton:t=>e=>{let{commands:a}=e,{iTemplate:n}=I18N.i({pub:t}),r={url:"".concat(i.W.CHECKOUT_URL,"&gift=true"),text:(0,u.getSubscriptionSentenceWithCustomWords)(t,()=>n(y()),t=>"Give a gift ".concat(t.subscription))};return a.insertContent({type:this.name,attrs:r})},insertDonateButton:t=>e=>{let{commands:a}=e,{iString:n}=I18N.i({pub:t}),r={url:"".concat(i.W.CHECKOUT_URL,"&donate=true"),text:n("Donate Subscriptions")};return a.insertContent({type:this.name,attrs:r})},insertSurveyButton:(t,e,a)=>n=>{let{commands:r}=n;(0,o.j)(o.FP.READER_SURVEY_LINKED_IN_POST,{editorVersion:"2",surveyId:e.id});let l={url:"".concat((0,c.h8g)(t,e.id)),text:a};return r.insertContent({type:this.name,attrs:l})},insertGroupSubscriptionButton:t=>{let{publication:e}=t;return t=>{let{commands:a}=t,{iTemplate:n}=I18N.i({pub:e}),r=e.default_group_coupon,l={url:"".concat(i.W.CHECKOUT_URL,"group=true").concat(r?"&coupon=".concat(r):""),text:(0,u.getSubscriptionSentenceWithCustomWords)(e,()=>r&&e.default_group_coupon_percent_off?n(w(),e.default_group_coupon_percent_off.split(".")[0]):n(_()),t=>r&&e.default_group_coupon_percent_off?"Get ".concat(e.default_group_coupon_percent_off.split(".")[0],"% off a group ").concat(t.subscription):"Get a group ".concat(t.subscription))};return a.insertContent({type:this.name,attrs:l})}},insertCoupon:function(e,a){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i=>{let{commands:o}=i,c={url:(0,d.n1t)("".concat(e.base_url,"/subscribe"),(0,r._)((0,n._)({coupon:a.id},a.group_only&&{group:!0}),{utm_content:l.postId})),text:"Get ".concat((0,s.ig)(a))};return o.insertContent({type:t.name,attrs:c})}},insertReferralButton:t=>e=>{let{commands:a}=e,{iString:n}=I18N.i({pub:t}),r={url:"".concat(i.W.LEADERBOARD_URL,"&utm_source=").concat(m.b3.post),text:n("Refer a friend")};return a.insertContent({type:this.name,attrs:r})},insertCaptionedWriterReferralButtonV2:t=>{let{writerReferralCode:e,publication:a,postId:n}=t;return t=>{let{commands:r,state:l,dispatch:i}=t;if(!(0,p.o)(l,l.schema.nodes.button))return!1;let{iString:o,iTemplate:s}=I18N.i({pub:a}),c=s(k()),u={url:"".concat((0,d.Fnz)(e||""),"?utm_source=").concat(m.b3.substack,"&utm_context=").concat(m.gD.post,"&utm_content=").concat(n,"&utm_campaign=").concat(m.VX.writerReferralButton),text:o("Start a Substack")},g=l.schema.nodes.captionedWriterReferralButton.create(u,l.schema.nodes.ctaCaption.create(null,[l.schema.text(c)]));return!i||r.insertContent(g.toJSON())}}}}}),E=t=>{let e=document.createElement("span");e.textContent=t.attrs.text;let a=document.createElement("a");a.className="button primary",t.attrs.class&&(a.className+=" ".concat(t.attrs.class)),a.href=t.attrs.url,a.appendChild(e),a.addEventListener("click",t=>{/^.*%%.*%%/.test(a.href)&&(t.preventDefault(),(0,u.handleDocumentLinkClick)(a.href))});let n=document.createElement("p");return n.className="button-wrapper",n.setAttribute("data-attrs",JSON.stringify(t.attrs)),n.setAttribute("data-component-name","ButtonCreateButton"),n.appendChild(a),n}},12568:function(t,e,a){a.d(e,{$:()=>r,_:()=>l});var n=a(30548);let r={content:"text*",group:"block",selectable:!0,defining:!0,isolating:!0,parseDOM:[{tag:"figcaption"}],toDOM:()=>["figcaption",{class:"image-caption"},0]},l=(0,n.S)({name:"caption",nodeSpec:r})},65626:function(t,e,a){a.d(e,{$y:()=>s,R7:()=>c,zj:()=>u});var n=a(7409),r=a(60826),l=a(95068),i=a(30548),o=a(30837);let s=t=>({content:"ctaCaption",attrs:{url:{default:null},text:{default:null}},inline:!1,group:"block",draggable:!0,atom:!1,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.captioned-button-wrap",getAttrs:o.Y}],toDOM:e=>{let a=document.createElement("div");a.className="captioned-button-wrap",a.setAttribute("data-attrs",JSON.stringify(e.attrs)),a.setAttribute("data-component-name","CaptionedButtonToDOM");let r=document.createElement("div");r.className="preamble";let i=(0,l.ax)({attrs:(0,n._)({},e.attrs,t)});return a.appendChild(r),a.appendChild(i),{dom:a,contentDOM:r}}}),d=t=>{let{substitutionAttrs:e,name:a}=t;return(0,i.S)({name:a,nodeSpec:s(e)})},c=d({name:"captionedShareButton",substitutionAttrs:{url:r.W.SHARE_URL}}),u=d({name:"captionedWriterReferralButton",substitutionAttrs:{hasDynamicSubstitutions:!1}})},37622:function(t,e,a){a.d(e,{$:()=>r,Y:()=>l});var n=a(30548);let r={content:"block caption*",atom:!1,selectable:!0,isolating:!1,defining:!0,draggable:!0,group:"block",parseDOM:[{tag:"figure"}],toDOM:()=>["div",{class:"captioned-image-container"},["figure",0]],toDOMStatic:()=>["div",{class:"captioned-image-container-static"},["figure",0]]},l=(0,n.S)({name:"captionedImage",nodeSpec:r})},36621:function(t,e,a){a.d(e,{$:()=>c,l:()=>u});var n=a(7409),r=a(99282),l=a(6400),i=a(17117),o=a(10656),s=a(19520),d=a(30548);let c={attrs:{symbol:{default:""}},atom:!0,editable:!1,selectable:!0,isolating:!1,defining:!0,draggable:!1,inline:!0,group:"inline",parseDOM:[{tag:".cashtag-wrap",getAttrs:t=>{try{return JSON.parse(t.getElementsByTagName("a")[0].getAttribute("data-attrs"))}catch(t){return!1}}}],toDOM:t=>{if("undefined"!=typeof window)try{let e=document.createElement("span");return e.className="cashtag-wrap",(0,o.G5)((0,l.h)(i.Z,{symbol:t.attrs.symbol.trim()}),e),e}catch(e){return console.error("Error rendering Cashtag",e),(0,s.s)({msg:null,node:t,err:e,group:"inline"})}return["span",{class:"cashtag-wrap","data-attrs":JSON.stringify(t.attrs),"data-component-name":"CashtagToDOM"}]},toDOMStatic:t=>["span",{class:"cashtag-wrap","data-component-name":"CashtagToDOMStatic","data-attrs":JSON.stringify((0,r._)((0,n._)({},t.attrs),{prependSymbol:!0,isStatic:!0}))}]},u=(0,d.S)({name:"cashtag",nodeSpec:c})},31188:function(t,e,a){a.d(e,{Z:()=>o,s:()=>s});var n=a(80508),r=a(54809),l=a(30548);let i=new n.ZP({actionButtonAttr:"href",substackType:"comic",mimeTypesToSignature:r.ER,actionButtonText:"Read now"}),o=i,s=(0,l.S)({name:"comic",nodeSpec:i.nodeSpec})},71993:function(t,e,a){a.d(e,{$y:()=>m,Gq:()=>y,Xc:()=>p,a7:()=>f,aE:()=>b});var n=a(7409),r=a(6400),l=a(57796),i=a(10656),o=a(33884),s=a(63651),d=a(47929),c=a(19520),u=a(30548);let m={attrs:{url:{default:""},commentId:{default:null},comment:{default:null}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.comment",getAttrs:t=>{if(t instanceof HTMLElement)try{var e;return JSON.parse(null!==(e=t.getAttribute("data-attrs"))&&void 0!==e?e:"")}catch(t){}return!1}}],toDOM:t=>{if("undefined"!=typeof window)try{let e=document.createElement("div");return Object.assign(e,{className:"comment","data-attrs":JSON.stringify(t.attrs)}),(0,i.G5)((0,r.h)(l.d,{commentId:t.attrs.commentId}),e),e}catch(e){return console.error("Error rendering CommentEmbed",e),(0,c.s)({msg:null,node:t,err:e,group:"block"})}return g(t)},toDOMStatic:t=>g(t)},p=(0,u.S)({name:"comment",nodeSpec:m,addCommands(){return{insertComment:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}});function g(t){return["div",{class:"comment","data-attrs":JSON.stringify(t.attrs),"data-component-name":"CommentPlaceholder"}]}function b(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e&&!e.nodes.comment)return null;let a=(0,s.en2)(t);return a&&(0,o.Th)(a.pathname)?t:null}async function h(t){let e;let r=(await Promise.resolve().then(a.t.bind(a,80569,23))).default,l=(0,s.en2)(t),i=l&&(0,o.Th)(l.pathname);if(!i)return console.warn("pathname did not match"),null;try{let{body:{item:{comment:{id:t,date:a,edited_at:n,body:l,body_json:o,restacks:s,reaction_count:d,attachments:c,name:u,user_id:m,photo_url:p,user_bestseller_tier:g}}}}=await r.get("/api/v1/reader/comment/".concat(i.id));e={comment:{id:t,date:a,edited_at:n,body:l,body_json:o,restacks:s,reaction_count:d,attachments:c,name:u,user_id:m,photo_url:p,user_bestseller_tier:g}}}catch(t){return console.warn(t),null}let c=(0,s.BMD)(i,{urlParams:{utm_source:d.b3.commentEmbed}});return(0,n._)({url:c,commentId:i.id},e)}async function f(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(e?{schema:e}:await Promise.resolve().then(a.bind(a,37175))).schema,r=await h(t);return r?n.nodes.comment.create(r):null}async function v(){let t;let e=(await Promise.resolve().then(a.t.bind(a,80569,23))).default;try{t=(await e.get("/api/v1/reader/feed/last-note")).body;let a=(0,s.Sgq)(t);return h(a)}catch(t){return null}}async function y(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(e?{schema:e}:await Promise.resolve().then(a.bind(a,37175))).schema,r=await v();return r?n.nodes.comment.create(r):null}},88954:function(t,e,a){a.d(e,{$y:()=>c,Z9:()=>h,kr:()=>u,uL:()=>v});var n=a(6400),r=a(4373),l=a(10656),i=a(63651),o=a(47929),s=a(19520),d=a(30548);let c={attrs:{url:{default:""},subdomain:{default:null},pub:{default:null}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.community-chat",getAttrs:t=>{if(t instanceof HTMLElement)try{var e;return JSON.parse(null!==(e=t.getAttribute("data-attrs"))&&void 0!==e?e:"")}catch(t){}return!1}}],toDOM:t=>{if("undefined"!=typeof window)try{let e=document.createElement("div");if(Object.assign(e,{className:"community-chat","data-attrs":JSON.stringify(t.attrs)}),!t.attrs.pub||!t.attrs.subdomain){let t=document.createElement("div");return t.innerText="Could not load subscriber chat link",e.appendChild(t),e}return(0,l.G5)((0,n.h)(r.a,{pub:t.attrs.pub,subdomain:t.attrs.subdomain}),e),e}catch(e){return console.error("Error rendering CommunityChatEmbed",e),(0,s.s)({msg:null,node:t,err:e,group:"block"})}return m(t)},toDOMStatic:t=>m(t)},u=(0,d.S)({name:"communityChat",nodeSpec:c,addCommands(){return{insertCommunityChat:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})},insertCommunityChatEmbed:t=>e=>{var a,n;let{commands:r}=e,l={url:(0,i.ZVW)({pubKey:t.subdomain,utm_source:o.b3.chatEmbed}),subdomain:t.subdomain,pub:{id:t.id,name:t.name,author_name:null!==(a=t.primary_profile_name)&&void 0!==a?a:t.author_name,author_photo_url:null!==(n=t.primary_profile_photo_url)&&void 0!==n?n:t.author_photo_url}};return r.insertContent({type:this.name,attrs:l})},insertVisitThreadButton:t=>e=>{let{commands:a}=e;return a.insertCommunityChatEmbed(t)}}}});function m(t){return["div",{class:"community-chat","data-attrs":JSON.stringify(t.attrs),"data-component-name":"CommunityChatRenderPlaceholder"}]}let p=/^https?:\/\/open\.substack\.com(?:\.localhost:5000)?\/pub\/([^/]+)\/chat(\?.*)?$/,g=/^https?:\/\/([^.]+)\.substack\.com(?:\.localhost:5000)?\/chat(\?.*)?$/,b=/^https?:\/\/substack\.com(?:\.localhost:5000)?\/chat\/(\d+)/;function h(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e&&!e.nodes.communityChat)return null;let a=(0,i.en2)(t);return a&&a.pathname.match(/^(\/pub\/[^/]+)?\/chat($|\/)/)?t:null}async function f(t){var e,n;let r,l=(await Promise.resolve().then(a.t.bind(a,80569,23))).default,s=((r=(e=t).match(p))||(r=e.match(g)))&&null!==(n=r[1])&&void 0!==n?n:null,d=null;try{if(s){let{body:e}=await l.get("/api/v1/publication/chat-embed").query({subdomain:s,url:t});d=e}else{let e=function(t){var e;let a=t.match(b);return a&&null!==(e=a[1])&&void 0!==e?e:null}(t);if(e){let t=await l.get("/api/v1/publication/public/".concat(e));d=t.body.pub,s=t.body.pub.subdomain}}}catch(t){}return d?{url:(0,i.ZVW)({pubKey:d.subdomain,utm_source:o.b3.chatEmbed}),subdomain:s,pub:d}:null}async function v(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(e?{schema:e}:await Promise.resolve().then(a.bind(a,37175))).schema,r=await f(t);return r?n.nodes.communityChat.create(r):null}},13991:function(t,e,a){a.d(e,{$y:()=>g,H6:()=>v,dB:()=>b,yv:()=>w});var n=a(7409),r=a(99282),l=a(6400),i=a(55679),o=a(19925),s=a(45528),d=a(10656),c=a(63651),u=a(47929),m=a(19520),p=a(30548);let g={attrs:{url:{default:""},postId:{default:null},communityPost:{default:null},author:{default:null}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.community-post",getAttrs:t=>{if(t instanceof HTMLElement)try{var e;return JSON.parse(null!==(e=t.getAttribute("data-attrs"))&&void 0!==e?e:"")}catch(t){}return!1}}],toDOM:t=>{if("undefined"!=typeof window)try{let e=document.createElement("div");return Object.assign(e,{className:"community-post","data-attrs":JSON.stringify(t.attrs)}),(0,d.G5)((0,l.h)(s.V,{postId:t.attrs.postId}),e),e}catch(e){return console.error("Error rendering CommunityPostEmbed",e),(0,m.s)({msg:null,node:t,err:e,group:"block"})}return h(t)},toDOMStatic:t=>h(t)},b=(0,p.S)({name:"communityPost",nodeSpec:g,addCommands(){return{insertCommunityPost:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}},addNodeView:()=>(0,i.fW)(o.A)});function h(t){return["div",{class:"community-post","data-attrs":JSON.stringify(t.attrs),"data-component-name":"CommunityPostPlaceholder"}]}let f=/^\/chat(?:\/\d+)?\/posts?\/([-A-Fa-f0-9]+)$/;function v(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e&&!e.nodes.communityPost)return null;let a=(0,c.en2)(t);return a&&a.pathname.match(f)?t:null}async function y(t){var e,l;let i;let o=(await Promise.resolve().then(a.t.bind(a,80569,23))).default,s=(0,c.en2)(t),d=s&&(null===(e=s.pathname.match(f))||void 0===e?void 0:e[1]);if(!d)return null;try{i=(await o.get("/api/v1/community/posts/".concat(d))).body}catch(t){if(!(t instanceof Error))return null;{let e=t.response;if(402!==e.status||null===(l=e.body)||void 0===l||!l.status)return null;i=null==e?void 0:e.body}}let{user:m,communityPost:{id:p,publication_id:g,body:b,audience:h,type:v,media_assets:y,link_url:w,threadMediaUploads:_},status:k}=i,C={author:m},S=(null==_?void 0:_.length)&&_[0]?_[0].mediaUpload:null;"all_subscribers"!==h||k&&"FREE_SUBSCRIPTION_REQUIRED"!==k||(C=(0,r._)((0,n._)({},C),{communityPost:{id:p,publication_id:g,body:b,audience:h,type:v,media_assets:y,threadMediaUploads:S?[{mediaUpload:S}]:[],link_url:w?(0,c.n1t)(w,{utm_source:u.b3.postEmbed}):null}}));let E=(0,c._5K)({postId:d,utm_source:u.b3.threadEmbed});return(0,n._)({url:E,postId:d},C)}async function w(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(e?{schema:e}:await Promise.resolve().then(a.bind(a,37175))).schema,r=await y(t);return r?n.nodes.communityPost.create(r):null}},36122:function(t,e,a){a.d(e,{$:()=>r,B:()=>l});var n=a(30548);let r={content:"text*",group:"block",draggable:!1,selectable:!0,isolating:!0,defining:!0,atom:!1,parseDOM:[{tag:"p.cta-caption"}],toDOM:()=>["p",{class:"cta-caption"},0]},l=(0,n.S)({name:"ctaCaption",nodeSpec:r})},72270:function(t,e,a){a.d(e,{$y:()=>o,Bs:()=>s,HL:()=>p,s3:()=>h,vb:()=>u});var n=a(27412),r=a(60308),l=a(64314),i=a(30548);let o={attrs:{url:{default:""},thumbnail_url:{default:""},height:{default:""},title:{default:""},description:{default:""}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDom:[{tag:"div.datawrapper-wrap",getAttrs:a(30837).Y}],toDOM:t=>b(t),toDOMStatic:t=>g(t)},s=(0,i.S)({name:"datawrapper",nodeSpec:o,addCommands(){return{insertDatawrapper:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),d=/^.*https?:\/\/datawrapper\.dwcdn\.net\/.*$/,c=/^.*https?:\/\/(www\.)?datawrapper.de\/_\/.*$/,u=t=>{let e=d.exec(t);if(e)return e[0];let a=c.exec(t);return a&&a[0]},m=async t=>{let e=(await Promise.resolve().then(a.t.bind(a,80569,23))).default;return(await e.get("/api/v1/datawrapper-embed").query({url:t.trim()})).body},p=async function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(e?{schema:e}:await Promise.resolve().then(a.bind(a,37175))).schema.nodes.datawrapper.create(await m(t))},g=function(t){let{}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=document.createElement("div");e.className="datawrapper-wrap static",e.setAttribute("data-component-name","DatawrapperToDOMStatic");let a=document.createElement("a");if(a.href=t.attrs.url.replace(/embed\//,""),a.setAttribute("target","_blank"),t.attrs.title){let a=document.createElement("div");a.className="datawrapper-title",a.innerHTML=t.attrs.title,e.appendChild(a)}if(t.attrs.description){let a=document.createElement("div");a.className="datawrapper-description",a.innerHTML=t.attrs.description,e.appendChild(a)}let n=document.createElement("div"),l=document.createElement("img");return l.className="datawrapper-wrap thumbnail",l.src=(0,r.zF4)(t.attrs.thumbnail_url,640),l.style.backgroundImage="url(".concat(t.attrs.thumbnail_url,")"),t.attrs.belowTheFold&&l.setAttribute("loading","lazy"),a.append(l),n.append(a),e.appendChild(n),e},b=t=>{let e=document.createElement("div");e.id="datawrapper-iframe",e.className="datawrapper-wrap outer",e.dataset.attrs=JSON.stringify(t.attrs),e.setAttribute("data-component-name","DatawrapperToDOM");let a=document.createElement("iframe");a.id="iframe-datawrapper",a.className="datawrapper-iframe",a.src=t.attrs.url,a.width="730",a.height=t.attrs.height||"455",a.frameBorder="0",a.scrolling="no",t.attrs.belowTheFold&&a.setAttribute("loading","lazy"),e.appendChild(a);let n=document.createElement("script");return n.type="text/javascript",n.text=l.N,e.appendChild(n),e};class h{constructor(t){(0,n._)(this,"dom",void 0);let e=b(t),a=e.querySelector(".datawrapper-iframe"),r=document.createElement("div");r.className="datawrapper-screen",r.addEventListener("dblclick",()=>{r.classList.add("sunken"),a.focus()}),a.addEventListener("blur",()=>{r.classList.remove("sunken")}),e.appendChild(r),this.dom=e}}},82167:function(t,e,a){a.d(e,{$y:()=>_,Cr:()=>k,lQ:()=>S,wM:()=>E});var n=a(7409),r=a(99282),l=a(98848),i=a(6400),o=a(92007),s=a(55679),d=a(78718),c=a.n(d),u=a(80569),m=a.n(u),p=a(17218),g=a(89198),b=a(98914),h=a(10656),f=a(63651),v=a(19520),y=a(30548);let w="digest-post-embed",_={attrs:{nodeId:{default:null},caption:{default:null},cta:{default:null},showBylines:{default:!0},size:{default:null},isEditorNode:{default:!1},title:{default:null},publishedBylines:{default:null},post_date:{default:null},cover_image:{default:null},cover_image_alt:{default:null},canonical_url:{default:null},section_name:{default:null},video_upload_id:{default:null},id:{default:null},type:{default:null},reaction_count:{default:null},comment_count:{default:null},publication_name:{default:null},publication_logo_url:{default:null},belowTheFold:{default:!1}},group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,editable:!1,parseDOM:[{tag:".".concat(w),getAttrs:t=>{try{let e=JSON.parse(t.getAttribute("data-attrs"));return(0,r._)((0,n._)({},e),{nodeId:(0,b.EH)()})}catch(t){return!1}}}],toDOM:t=>{if("undefined"!=typeof window&&t.attrs.isEditorNode)try{let e=document.createElement("div");return e.className=w,e.setAttribute("data-attrs",JSON.stringify(t.attrs)),(0,h.G5)((0,i.h)(p.F,(0,r._)((0,n._)({},t.attrs),{caption:t.attrs.caption,cta:t.attrs.cta,showBylines:t.attrs.showBylines,size:t.attrs.size||void 0,isEditor:!0,pub:window._preloads.pub})),e),e}catch(e){return console.error("Error rendering DigestPostEmbedWeb",e),(0,v.s)({msg:null,node:t,err:e,group:"block"})}return C(t)},toDOMStatic:t=>["div",{class:w,"data-attrs":JSON.stringify((0,n._)({isEmail:!0},t.attrs))}]},k=(0,y.S)({name:"digestPostEmbed",nodeSpec:_,addNodeView:()=>(0,s.fW)(g.X),addCommands:()=>({convertDigestPostEmbedToLinkV2:t=>{let{pos:e,url:a}=t;return t=>{let{dispatch:n,state:r,chain:l}=t;if(n){let t=r.tr,n=e+a.length;return l().setNodeSelection(e).deleteSelection().command(t=>{let{tr:n}=t;return n.insertText(a,e),!0}).command(t=>{let{tr:l}=t;return l.addMark(e,n+1,r.schema.marks.link.create({text:a,href:a})),!0}).setTextSelection(o.Bs.create(t.doc,e,n+1)).scrollIntoView().focus(n+2).run()}return!0}},convertDigestPostEmbedToEmbeddedPostV2:t=>{let{pos:e,attrs:a}=t;return t=>{let{dispatch:n,chain:r}=t;if(n){let t={id:a.id,url:a.url,title:a.title,publication_name:a.publication_name,publication_logo_url:a.publication_logo_url,date:a.post_date,comment_count:a.comment_count,bylines:a.publishedBylines};return r().setNodeSelection(e).deleteCurrentNode().insertContent({type:"embeddedPost",attrs:t}).run()}return!0}}})}),C=t=>["div",{class:w,"data-attrs":JSON.stringify(t.attrs)}],S=function(t){var e,a,n,r;let{customSchema:l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(l&&!l.nodes.digestPostEmbed)return null;let i=(0,f.en2)(t);if(!i)return null;let o=(0,f.SjL)({url:t,currentSubdomain:null===(a=window._preloads)||void 0===a?void 0:null===(e=a.pub)||void 0===e?void 0:e.subdomain,currentCustomDomain:null===(r=window._preloads)||void 0===r?void 0:null===(n=r.pub)||void 0===n?void 0:n.custom_domain});return i&&(i.pathname.startsWith("/p/")||(0,f.RKj)(i))&&o?t:null},E=async t=>{let{pub:e,post:a}=(await m().get("/api/v1/posts/digest_embed").query({url:t.trim()})).body,{truncated_body_text:i}=a,o=(0,l._)(a,["truncated_body_text"]),{name:s,logo_url:d}=e,u=c()(o,["title","publishedBylines","post_date","cover_image","cover_image_alt","canonical_url","section_name","id","type","reaction_count","comment_count","video_upload_id"]);return(0,r._)((0,n._)({caption:null!=i?i:"",cta:"Read full story",size:"lg",isEditor:!0},u),{publishedBylines:u.publishedBylines.map(t=>c()(t,["id","name","bio","photo_url","is_guest","bestseller_tier","primaryPublicationSubscribeUrl","primaryPublicationUrl","primaryPublicationName","primaryPublicationId"])),publication_name:s,publication_logo_url:null!=d?d:""})}},47456:function(t,e,a){a.d(e,{$y:()=>b,RE:()=>f,e1:()=>h});var n=a(7409),r=a(99282),l=a(6400),i=a(88897),o=a(55679),s=a(33730),d=a(10656),c=a(57125),u=a(19520),m=a(68303),p=a(30548);let g="directMessage",b={name:g,group:"block",selectable:!0,inline:!1,draggable:!0,atom:!0,attrs:(0,c.Op)({attrs:{userId:{default:null,keepOnSplit:!1},userName:{default:null,keepOnSplit:!1},canDm:{default:null,keepOnSplit:!1},dmUpgradeOptions:{default:null,keepOnSplit:!1},isEditorNode:{default:!1,keepOnSplit:!1}}}),parseDOM:[{tag:"div.directMessage",getAttrs:t=>{try{if(t instanceof HTMLElement){let e=t.getAttribute("data-attrs");if(e)return JSON.parse(e)}}catch(t){}return!1}}],toDOM:t=>{if("undefined"!=typeof window&&t.attrs.isEditorNode)try{t.attrs.isEditor=!0;let e=document.createElement("div");return e.className=g,e.setAttribute("data-attrs",JSON.stringify(t.attrs)),(0,d.G5)((0,l.h)(s.V,{node:(0,n._)({},t)}),e),e}catch(e){return console.error("Error rendering DirectMessageEditor",e),(0,u.s)({msg:null,node:t,err:e,group:"block"})}return["div",{class:"".concat(g," button"),"data-attrs":JSON.stringify((0,n._)({},t.attrs)),"data-component-name":"DirectMessageToDOM"}]},toDOMStatic:t=>["div",{class:g,"data-attrs":JSON.stringify((0,r._)((0,n._)({},t.attrs),{isEmail:!0})),"data-component-name":"DirectMessageToDOMStatic"}]},h=i.hj.create({name:"directMessageExtension",addCommands:()=>({insertDirectMessage:t=>e=>{let{dispatch:a,state:n}=e,{user:r}=t,l={userName:r.name,userId:r.id,isEditorNode:!0};return a&&a((0,m.o4)(n,n.schema.nodes.directMessage.create(l))),!0}})}),f=(0,p.S)({name:"directMessage",nodeSpec:b,addCommands:h.addCommands,addNodeView:()=>(0,o.fW)(s.V)})},32978:function(t,e,a){a.d(e,{Z:()=>o,r:()=>s});var n=a(80508),r=a(54809),l=a(30548);let i=new n.ZP({actionButtonAttr:null,substackType:"ebook",mimeTypesToSignature:r.uM,actionButtonText:null}),o=i,s=(0,l.S)({name:"ebook",nodeSpec:i.nodeSpec})},40924:function(t,e,a){a.d(e,{$y:()=>c,Ez:()=>u,Ng:()=>m,O5:()=>g});var n=a(7409),r=a(99282),l=a(60308),i=a(63651),o=a(84864),s=a(47929),d=a(30548);let c={attrs:{id:{default:null},url:{default:null},publication_id:{default:null},publication_name:{default:null},publication_logo_url:{default:null},title:{default:null},truncated_body_text:{default:null},date:{default:null},like_count:{default:null},comment_count:{default:null},bylines:{default:null},utm_campaign:{default:null},belowTheFold:{default:!1},type:{default:null},language:{default:"en"}},untrackedAttrs:["truncated_body_text","bylines"],inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.embedded-post-wrap",getAttrs:a(30837).Y}],toDOM:t=>{let{publication_logo_url:e,publication_name:a,title:n,truncated_body_text:r,url:i,bylines:d,date:c,like_count:u,comment_count:m,utm_campaign:p,id:g,type:b,language:h}=t.attrs,{iString:f}=I18N.i(h),v=(0,l.n1t)(i,{utm_source:s.b3.substack,utm_campaign:p||s.VX.postEmbed,utm_medium:s.lP.web});""===v&&console.error("Invalid path (".concat(i,") for post: ").concat(g));let y=document.createElement("div");y.classList.add("embedded-post-title-icon"),y.innerHTML='<svg width="19" height="19" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path\n  d="M3 18V12C3 9.61305 3.94821 7.32387 5.63604 5.63604C7.32387 3.94821 9.61305 3 12 3C14.3869 3 16.6761 3.94821 18.364 5.63604C20.0518 7.32387 21 9.61305 21 12V18"\n  stroke-linecap="round"\n  stroke-linejoin="round"\n  />\n  <path\n  d="M21 19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H18C17.4696 21 16.9609 20.7893 16.5858 20.4142C16.2107 20.0391 16 19.5304 16 19V16C16 15.4696 16.2107 14.9609 16.5858 14.5858C16.9609 14.2107 17.4696 14 18 14H21V19ZM3 19C3 19.5304 3.21071 20.0391 3.58579 20.4142C3.96086 20.7893 4.46957 21 5 21H6C6.53043 21 7.03914 20.7893 7.41421 20.4142C7.78929 20.0391 8 19.5304 8 19V16C8 15.4696 7.78929 14.9609 7.41421 14.5858C7.03914 14.2107 6.53043 14 6 14H3V19Z"\n  stroke-linecap="round"\n  stroke-linejoin="round"\n  />\n</svg>';let w=document.createElement("div");return w.classList.add("embedded-post-cta-icon"),w.innerHTML='<svg width="32" height="32" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">\n  <path\n  className="inner-triangle"\n  d="M10 8L16 12L10 16V8Z"\n  stroke-width="1.5"\n  stroke-linecap="round"\n  stroke-linejoin="round"\n  />\n</svg>',["div",{class:"embedded-post-wrap","data-attrs":JSON.stringify(t.attrs),"data-component-name":"EmbeddedPostToDOM"},["a",{class:"embedded-post",native:!0,href:v},["div",{class:"embedded-post-header"},e?["img",{class:"embedded-post-publication-logo",src:(0,l.zF4)(e,56),loading:t.attrs.belowTheFold?"lazy":null}]:["span",{}],["span",{class:"embedded-post-publication-name"},a||f("Failed to embed post")]],["div",{class:"embedded-post-title-wrapper"},..."podcast"===b?[y]:[],["div",{class:"embedded-post-title"},n||f("Failed to embed post")]],...r?[["div",{class:"embedded-post-body"},(0,o.formatEllipsis)(r)]]:[],["div",{class:"embedded-post-cta-wrapper"},..."podcast"===b?[w]:[],["span",{class:"embedded-post-cta"},f("podcast"===b?"Listen now":"Read more")]],["div",{class:"embedded-post-meta"},(0,o.getPostEmbedMeta)({date:c,bylines:d,like_count:u,comment_count:m,language:h})]]]},toDOMStatic:t=>{let{publication_logo_url:e,publication_name:a,title:n,truncated_body_text:r,url:i,bylines:d,date:c,like_count:u,comment_count:m,utm_campaign:p,type:g,language:b}=t.attrs,{iString:h}=I18N.i(b),f=(0,l.n1t)(i,{utm_source:s.b3.substack,utm_campaign:p||s.VX.postEmbed,utm_medium:s.lP.email}),v=(0,l.zF4)("/img/podcast-headphones.svg",19,{format:"png"}),y=(0,l.zF4)("/img/audio-player-play.png",12);return["div",{class:"embedded-post-wrap","data-component-name":"EmbeddedPostToDOMStatic"},["div",{class:"embedded-post"},["div",{class:"embedded-post-header"},e?["img",{class:"embedded-post-publication-logo",src:(0,l.zF4)(e,56),width:28,height:28}]:["span",{}],["span",{class:"embedded-post-publication-name"},a||h("Failed to embed post")]],["div",{class:"embedded-post-title-wrapper"},..."podcast"===g?[["img",{class:"embedded-post-title-icon embedded-post-title-icon-static",src:v}]]:[],["a",{class:"embedded-post-title",href:f||"#"},n||h("Failed to embed post")]],...r?[["div",{class:"embedded-post-body"},(0,o.formatEllipsis)(r)]]:[["br"],["br"]],["div",{class:"embedded-post-cta-wrapper"},..."podcast"===g?[["img",{width:12,height:12,class:"embedded-post-cta-icon-static",src:y}]]:[],["a",{class:"embedded-post-cta",href:f||"#"},h("podcast"===g?"Listen now":"Read more")]],["div",{class:"embedded-post-meta"},(0,o.getPostEmbedMeta)({date:c,bylines:d,like_count:u,comment_count:m,language:b})]]]}},u=(0,d.S)({name:"embeddedPost",nodeSpec:c,addCommands(){return{insertEmbeddedPost:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),m=function(t){var e,a,n,r;let{customSchema:o,forceAllowOwnPub:s=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(o&&!o.nodes.embeddedPost)return null;let d=(0,l.en2)(t);if(!d)return null;let c=(0,i.SjL)({url:t,currentSubdomain:null===(a=window._preloads)||void 0===a?void 0:null===(e=a.pub)||void 0===e?void 0:e.subdomain,currentCustomDomain:null===(r=window._preloads)||void 0===r?void 0:null===(n=r.pub)||void 0===n?void 0:n.custom_domain});return d&&(d.pathname.startsWith("/p/")||(0,i.RKj)(d))&&!(c&&!s)?t:null},p=async t=>{let e=(await Promise.resolve().then(a.t.bind(a,80569,23))).default;try{return(await e.get("/api/v1/posts/embed").query({url:t.trim()})).body}catch(t){return null}},g=async function(t){let{customSchema:e,language:l="en"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=(e?{schema:e}:await Promise.resolve().then(a.bind(a,37175))).schema,o=await p(t);return o?i.nodes.embeddedPost.create((0,r._)((0,n._)({},o),{language:l})):null}},86725:function(t,e,a){a.d(e,{$y:()=>p,l6:()=>h,mt:()=>v,t3:()=>b,zJ:()=>g});var n=a(7409),r=a(99282),l=a(58865),i=a(60308),o=a(47929),s=a(30548),d=a(30837);function c(){let t=(0,l._)(["By ",""]);return c=function(){return t},t}function u(){let t=(0,l._)(["By ",""]);return u=function(){return t},t}let m=t=>t?{style:"background-color: ".concat(t)}:{},p={attrs:{id:{default:null},name:{default:""},logo_url:{default:null},base_url:{default:null},hero_text:{default:null},author_name:{default:null},show_subscribe:{default:!0},logo_bg_color:{default:null},language:{default:"en"}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.embedded-publication-wrap",getAttrs:d.Y}],toDOMWithSubscribe:t=>{let{name:e,logo_url:a,base_url:r,hero_text:l,author_name:s,logo_bg_color:d,language:u}=t.attrs,{iString:p,iTemplate:g}=I18N.i(u);return["div",{class:"embedded-publication-wrap","data-attrs":JSON.stringify(t.attrs),"data-component-name":"EmbeddedPublicationToDOMWithSubscribe"},["div",{class:"embedded-publication show-subscribe"},["a",{class:"embedded-publication-link-part",native:!0,href:(0,i.n1t)(r,{utm_source:o.b3.substack,utm_campaign:o.VX.publicationEmbed,utm_medium:o.lP.web})},...a?[["img",(0,n._)({class:"embedded-publication-logo",src:(0,i.zF4)(a),width:56,height:56},m(d))]]:[],["span",{class:"embedded-publication-name"},e||p("Failed to embed publication")],...l?[["div",{class:"embedded-publication-hero-text"},l]]:[],...s&&!e.includes(s)?[["div",{class:"embedded-publication-author-name"},g(c(),s)]]:[]],["form",{class:"embedded-publication-subscribe",method:"GET",action:(0,i.W1P)({base_url:r},{addBase:!0})},["input",{type:"hidden",name:"source",value:"publication-embed"}],["input",{type:"hidden",name:"autoSubmit",value:"true"}],["input",{type:"email",class:"email-input",name:"email",placeholder:p("Type your email...")}],["input",{type:"submit",class:"button primary",value:p("Subscribe")}]]]]},toDOMWithoutSubscribe:t=>{let{name:e,logo_url:a,base_url:r,hero_text:l,author_name:s,logo_bg_color:d,language:c}=t.attrs,{iString:p,iTemplate:g}=I18N.i(c);return["div",{class:"embedded-publication-wrap","data-attrs":JSON.stringify(t.attrs)},["a",{class:"embedded-publication embedded-publication-flex",native:!0,href:(0,i.n1t)(r,{utm_source:o.b3.substack,utm_campaign:o.VX.publicationEmbed,utm_medium:o.lP.web})},...a?[["div",{class:"embedded-publication-left"},["img",(0,n._)({class:"embedded-publication-logo",src:(0,i.zF4)(a),width:40,height:40},m(d))]]]:[],["div",{class:"embedded-publication-right"},["span",{class:"embedded-publication-name"},e||p("Failed to embed publication")],...l?[["div",{class:"embedded-publication-hero-text"},l]]:[],...s&&!e.includes(s)?[["div",{class:"embedded-publication-author-name"},g(u(),s)]]:[]]]]},toDOMStatic:t=>{let{name:e,logo_url:a,base_url:r,hero_text:l,author_name:s,logo_bg_color:d}=t.attrs,c=(0,i.n1t)(r,{utm_source:o.b3.substack,utm_campaign:o.VX.publicationEmbed,utm_medium:o.lP.email});return["div",{class:"embedded-publication-wrap","data-attrs":JSON.stringify(t.attrs),"data-component-name":"EmbeddedPublicationToDOMStatic"},["table",{class:"embedded-publication"},["tr",{},...a?[["td",{class:"embedded-publication-left",valign:"top",width:56},["img",(0,n._)({class:"embedded-publication-logo",src:(0,i.zF4)(a),width:40,height:40},m(d))]]]:[],["td",{class:"embedded-publication-right"},["span",{class:"embedded-publication-name"},["a",{href:c},e||"Failed to embed publication"]],...l?[["div",{class:"embedded-publication-hero-text"},["a",{href:c},l]]]:[],...s&&!e.includes(s)?[["div",{class:"embedded-publication-author-name"},["a",{href:c},"By ".concat(s)]]]:[]]]]]},toDOM:t=>t.attrs.show_subscribe?p.toDOMWithSubscribe(t):p.toDOMWithoutSubscribe(t)},g=(0,s.S)({name:"embeddedPublication",nodeSpec:p,addCommands(){return{insertEmbeddedPublication:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),b=function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e&&!e.nodes.embeddedPublication)return null;let a=(0,i.en2)(t);return a&&(!a.pathname||"/"===a.pathname)?t:null},h=async t=>{let e=(await Promise.resolve().then(a.t.bind(a,80569,23))).default;try{let a=await e.get("/api/v1/publication/embed").query({url:t.trim()});if(!a.body.id)return null;return a.body}catch(t){return null}},f=async t=>{let e=await h(t);return e?(0,r._)((0,n._)({},e),{show_subscribe:!0}):null},v=async function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(e?{schema:e}:await Promise.resolve().then(a.bind(a,37175))).schema,r=await f(t);return r?n.nodes.embeddedPublication.create(r):null}},1415:function(t,e,a){a.d(e,{n:()=>d});var n=a(59981),r=a(92007),l=a(80569),i=a.n(l);let o=async(t,e,a)=>{let{schema:n}=e;if(!n.nodes.cashtag)return console.error("Cashtag node not found in schema"),!0;let r=n.nodes.cashtag.create({symbol:t,prependSymbol:!1}),l=e.tr;return l.replaceSelectionWith(r),a&&a(l),!0},s=async()=>(await i().get("/api/v1/symbols/all")).body.symbols,d=n.pf.configure({HTMLAttributes:{class:"mention"},suggestion:{char:"$",allowSpaces:!1,startOfLine:!1,command:()=>{},items:()=>[],render:()=>({onStart:()=>{s()},onUpdate(){},onKeyDown:t=>"Escape"===t.event.key,async onExit(t){let e=t.text.trim();if(["$",""].includes(e))return;let a=await s();if(!/\$[a-z]+$/i.test(e)||e.length>6||!a.includes(e.toUpperCase().replace("$",""))||["BTC","ETH","SOL","XRP","BNB","LUNA"].includes(e.toUpperCase().replace("$","")))return;let n=t.editor.state.tr;n.setSelection(r.Bs.create(n.doc,t.range.from,t.range.to)).deleteSelection(),t.editor.view.dispatch(n),o(e.toUpperCase(),t.editor.view.state,t.editor.view.dispatch),t.editor.commands.insertContent(" "),t.editor.view.dispatch(t.editor.state.tr)}})}})},98738:function(t,e,a){a.d(e,{d:()=>l});var n=a(61767),r=a(19908);let l=n.r.extend({addKeyboardShortcuts(){return{"Mod-k":()=>this.editor.commands.addLink()}},addCommands:()=>({addLink:()=>t=>{let{state:e,dispatch:a,view:n}=t;return(0,r.M)(e.schema)(e,a,n)}})}).configure({autolink:!1,openOnClick:!1})},24653:function(t,e,a){a.d(e,{p:()=>tS});var n=a(7409),r=a(18490),l=a(32018),i=a(94886),o=a(99218),s=a(89290),d=a(2799),c=a(5835),u=a(26603),m=a(57937),p=a(55633),g=a(1451),b=a(44262),h=a(41676),f=a(82032),v=a(95068),y=a(12568),w=a(65626),_=a(37622),k=a(36621),C=a(31188),S=a(71993),E=a(88954),N=a(13991),O=a(36122),M=a(72270),T=a(82167),D=a(47456),A=a(32978),x=a(40924),P=a(86725),I=a(1415),L=a(98738),B=a(94413),R=a(80508),z=a(715),F=a(87113),J=a(71766),q=a(98450),$=a(87413);let H=a(67338).Z.extend({draggable:!0});var U=a(69323),W=a(61601),Z=a(57639),V=a(54793),Y=a(29511),G=a(49640),j=a(99975),K=a(41128),X=a(23431),Q=a(73078),tt=a(85197),te=a(53797),ta=a(8220),tn=a(18119),tr=a(44288),tl=a(13938),ti=a(54757),to=a(11006),ts=a(11470),td=a(66928),tc=a(19805),tu=a(46393),tm=a(2107),tp=a(99149),tg=a(79592),tb=a(39111),th=a(57950),tf=a(78483),tv=a(57881),ty=a(84766),tw=a(60802),t_=a(45913),tk=a(34612),tC=a(32751);let tS=t=>{let{isStatic:e,excludeDropCursor:a=!1}=t,tS={};return a&&(tS.dropcursor=!1),[d.Z.configure((0,n._)({history:!1,blockquote:!1,bulletList:!1,orderedList:!1,horizontalRule:!1},tS)),s.ZP,i.Z,o.Z,L.d,h.M,to.z.configure({isStatic:e}),r.ZP,l.ZP,W.hJ.configure({isStatic:e}),V.zk,m.DW.configure({isStatic:e}),c.hE.configure({isStatic:e}),tw.v.configure({isStatic:e}),tv.h.configure({isStatic:e}),ty.HU.configure({isStatic:e}),tk.O.configure({isStatic:e}),tC.II.configure({isStatic:e}),v.H9.configure({isStatic:e}),U.y.configure({isStatic:e}),Z.RK.configure({isStatic:e}),tb.K.configure({isStatic:e}),O.B.configure({isStatic:e}),T.Cr.configure({isStatic:e}),x.Ez.configure({isStatic:e}),P.zJ.configure({isStatic:e}),tp.H.configure({isStatic:e}),tg.JV.configure({isStatic:e}),ts.v.configure({isStatic:e}),k.l.configure({isStatic:e}),R.ag.configure({isStatic:e}),A.r.configure({isStatic:e}),C.s.configure({isStatic:e}),tt.H.configure({isStatic:e}),Y.o0.configure({isStatic:e}),tn.x.configure({isStatic:e}),tm.a.configure({isStatic:e}),G.F.configure({isStatic:e}),b.hV.configure({isStatic:e}),t_.qM.configure({isStatic:e}),tf.du.configure({isStatic:e}),f.X2.configure({isStatic:e}),te.q.configure({isStatic:e}),tu.uJ.configure({isStatic:e}),E.kr.configure({isStatic:e}),S.Xc.configure({isStatic:e}),N.dB.configure({isStatic:e}),$.Tu.configure({isStatic:e}),g.h.configure({isStatic:e}),tr.OR.configure({isStatic:e}),tr.kY.configure({isStatic:e}),j.j7.configure({isStatic:e}),M.Bs.configure({isStatic:e}),X.eK.configure({isStatic:e}),_.Y.configure({isStatic:e}),y._.configure({isStatic:e}),w.R7.configure({isStatic:e}),w.zj.configure({isStatic:e}),K.qs.configure({isStatic:e}),z.z.configure({isStatic:e}),F.V.configure({isStatic:e}),tl.T.configure({isStatic:e}),Q.U.configure({isStatic:e}),p.E4.configure({isStatic:e}),th.Z.configure({isStatic:e}),td.b.configure({isStatic:e}),tc.ym.configure({isStatic:e}),ti.t.configure({isStatic:e}),q.G.configure({isStatic:e}),u.a.configure({isStatic:e}),ta.$u.configure({isStatic:e}),H,B.T,I.n,D.RE.configure({isStatic:e}),J.t_.configure({isStatic:e})]}},94413:function(t,e,a){a.d(e,{T:()=>g});var n=a(58865),r=a(59981),l=a(92007),i=a(55679),o=a(42441),s=a.n(o),d=a(45088),c=a(70075),u=a(3258),m=a(98914);function p(){let t=(0,n._)(["No results for ",""]);return p=function(){return t},t}let g=r.pf.extend({name:"substack_mentions_extension"}).configure({HTMLAttributes:{class:"substack-mention"},suggestion:{char:"@",pluginKey:new l.H$("substack_mentions_extension"),decorationClass:"substack-mention",allowSpaces:!0,startOfLine:!1,command:t=>{var e;let{editor:a,range:n,props:r}=t;if(!r.item)return;let{name:i,id:o,type:s,url:d,photo_url:c}=r.item,u=a.view.state.selection.$to.nodeAfter;(null==u?void 0:null===(e=u.text)||void 0===e?void 0:e.startsWith(" "))&&(n.to+=1);let{schema:p}=a.state,g=a.state.tr;if(g.setSelection(l.Bs.create(g.doc,n.from,n.to)).deleteSelection(),a.view.dispatch(g),g=a.state.tr,!p.nodes.substack_mentions){console.error("substack_mentions node not found in schema");return}let b=p.nodes.substack_mentions.create({name:i,id:o,type:s,url:d,photo_url:c,uuid:(0,m.EH)()});g.insert(n.from,b),a.view.dispatch(g),a.commands.insertContent(" "),a.view.dispatch(a.state.tr),g.setSelection(l.Bs.near(g.doc.resolve(n.from+1)))},items:async t=>{let{query:e}=t;return e.length<1?[]:await (0,u.wg)(e)},render:()=>{let t,e;let a=s().prototype.stopCallback,n=function(t){var e,a,n;let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],l="undefined"!=typeof window&&null!==(n=null===(a=window._preloads)||void 0===a?void 0:null===(e=a.pub)||void 0===e?void 0:e.language)&&void 0!==n?n:"en",{iString:i,iTemplate:o}=I18N.i(l);return{items:t.items,query:t.query,isLoading:r,selectItem:e=>{e&&!e.disabledReason&&t.command({item:e})},placeholderText:i("Search for a person or publication"),noResultsText:o(p(),t.query),minQueryLength:2,language:l}};return{onStart:r=>{t=new i.M_(c.c,{props:n(r),editor:r.editor}),e=(0,d.ZP)("body",{getReferenceClientRect:r.clientRect,appendTo:()=>document.getElementsByClassName("editor-scroll")[0]||document.body,content:t.element,popperOptions:{strategy:"absolute",modifiers:[{options:{altAxis:!0}}]},showOnCreate:!0,interactive:!0,trigger:"manual",placement:"bottom-start"}),s().prototype.stopCallback=function(t,e,n){return"esc"===n||a(t,e,n)}},onBeforeUpdate(a){e&&e[0].show(),t&&t.updateProps(n(a,!0)),a.clientRect&&e&&e[0].setProps({getReferenceClientRect:a.clientRect})},onUpdate(a){t&&t.updateProps(n(a,!1)),e&&e[0].setProps({getReferenceClientRect:a.clientRect})},onKeyDown(n){var r;return"Escape"===n.event.key?(e&&e[0]&&e[0].destroy(),e=null,t&&t.destroy(),t=null,setTimeout(()=>{s().prototype.stopCallback=a},0),!0):null==t?void 0:null===(r=t.ref)||void 0===r?void 0:r.onKeyDown(n)},onExit(){s().prototype.stopCallback=a,e&&e[0]&&e[0].destroy(),e=null,t&&t.destroy(),t=null}}}}})},80508:function(t,e,a){a.d(e,{ZP:()=>m,ag:()=>g});var n=a(27412),r=a(80569),l=a.n(r),i=a(60826),o=a(60308),s=a(54809),d=a(30548);let c=t=>new Promise((e,a)=>{if(!window.FileReader){a(TypeError("File reader API not found"));return}let n=new FileReader;n.onerror=a,n.onload=()=>{e(n.result)},n.readAsDataURL(t)});class u{update(t){return t.type.name===this.fileEmbed.substackType}stopEvent(t){return"file-embed-menu-button"===t.target.className}constructor({fileEmbed:t,node:e,view:a,getPos:r}){(0,n._)(this,"dom",void 0),(0,n._)(this,"fileEmbed",void 0),this.fileEmbed=t,this.dom=t.buildNodeView(e,a,r)}}class m{getNodeView(t){let{editor:e,node:a,getPos:n}=t;return new u({fileEmbed:this,node:a,view:e.view,getPos:n})}get nodeSpec(){return{definition:this,attrs:{filename:{default:null},filetype:{default:null},filesize:{default:null},href:{default:null},title:{default:null},description:{default:null},thumbnail:{default:null},fileKey:{default:null},dirty:{default:!0},raw_href:{default:null},error:{default:null},empty:{default:!1}},substackType:this.substackType,inline:!1,atom:!0,group:"block",selectable:!1,draggable:!0,isolating:!0,defining:!0,parseDOM:(0,s.Xb)({mimeTypesToSignature:this.mimeTypesToSignature,substackType:this.substackType,actionButtonAttr:this.actionButtonAttr}),toDOM:t=>{let e=["div",{class:"file-embed-wrapper","data-component-name":"FileToDOM"},["div",{class:"file-embed-container-reader"},["div",{class:"file-embed-container-top"},["image",{class:"file-embed-thumbnail".concat(t.attrs.thumbnail?"":"-default"),src:t.attrs.thumbnail||(0,o.zF4)("/img/attachment_icon.svg")}],["div",{class:"file-embed-details"},["div",{class:"file-embed-details-h1"},t.attrs.title||t.attrs.filename||""],["div",{class:"file-embed-details-h2"},(0,s.Nf)({attrs:t.attrs})]],["a",{class:"file-embed-button wide",href:t.attrs[this.actionButtonAttr]},["span",{class:"file-embed-button-text"},this.actionButtonText]]]]];return t.attrs.description&&e[2].push(["div",{class:"file-embed-description"},t.attrs.description]),e[2].push(["a",{class:"file-embed-button narrow",href:t.attrs[this.actionButtonAttr]},["span",{class:"file-embed-button-text"},this.actionButtonText]]),e},toDOMStatic:t=>{var e;let a,n;let r=(null===(e=t.attrs)||void 0===e?void 0:e.title)||"";return t.attrs.thumbnail&&-1===t.attrs.thumbnail.indexOf("attachment_icon.svg")?(n=!1,a=(0,o.zF4)(t.attrs.thumbnail,100,{aspect:"1.5",crop:"fill",gravity:"auto",height:150})):(n=!0,a=(0,o.zF4)("/img/attachment_icon.svg",32,{aspect:"1",crop:"fill",gravity:"auto",height:32})),r&&r.length>40&&(r="".concat(r.substr(0,40),"...")),["table",{class:"static-file-embed-table",cellspacing:"16","data-component-name":"FileToDOMStatic"},["tr",{},["td",{class:"static-file-embed-thumbnail-container ".concat(n?"default":"")},["img",{class:"static-file-embed-thumbnail ".concat(n?"default":""),src:a}]],["td",{class:"static-file-embed-details ".concat(n?"default":"")},["div",{class:"static-file-embed-details-h1"},r],["div",{class:"static-file-embed-details-h2"},(0,s.Nf)({attrs:t.attrs})]]],...t.attrs.description?[["tr",{},["td",{class:"static-file-embed-description",colspan:"2"},["p",{style:"margin: 0;"},t.attrs.description||""]]]]:[],["tr",{},["td",{class:"static-file-embed-button-container",colspan:"2"},["table",{class:"static-file-embed-button",cellspacing:"0"},["tr",{},["td",{align:"center"},["a",{href:"".concat(t.attrs[this.actionButtonAttr],"?token=").concat(i.W.FILE_DOWNLOAD_TOKEN),class:"static-file-embed-anchor"},this.actionButtonText]]]]]]]}}}buildNodeView(t,e,a){var n,r,l,i;let s=document.createElement("div");s.className="file-embed-wrapper-editor";let d=document.createElement("div");d.className="file-embed-container",d.dataset.attrs=JSON.stringify(t.attrs),d.appendChild(this.generateContainerTop(t)),d.appendChild(this.generateDescription(t)),d.appendChild(this.generateButton("narrow"));let c=document.createElement("div");c.className="file-embed-aligner";let{button:u,menu:m}=this.generateDropdown(t,e,a);c.appendChild(d),c.appendChild(m),s.appendChild(c);let p=document.createElement("img");p.src=(0,o.zF4)("/img/file_drag_default.png");let g=document.createElement("img");g.src=(0,o.zF4)(null==t?void 0:null===(n=t.attrs)||void 0===n?void 0:n.thumbnail,100,{aspect:"1.5",crop:"fill",gravity:"auto",height:150}),s.addEventListener("dragstart",e=>{var a,n,r;(null==t?void 0:null===(a=t.attrs)||void 0===a?void 0:a.thumbnail)?null===(n=e.dataTransfer)||void 0===n||n.setDragImage(g,0,0):null===(r=e.dataTransfer)||void 0===r||r.setDragImage(p,0,0)}),(null===(l=e.state)||void 0===l?void 0:null===(r=l.doc)||void 0===r?void 0:r.nodeAt(e.state.doc.nodeSize-3))===t&&setTimeout(()=>{e.dispatch(e.state.tr.insertText("\r",e.state.doc.nodeSize-2))},0);let b=document.createElement("div");b.appendChild(this.generateSpinner());let h=this.generateErrorCover(e,t);return(null===(i=t.attrs)||void 0===i?void 0:i.error)&&(u.className="file-embed-menu-button hidden",d.className="file-embed-container covered error",d.appendChild(h)),t.startReplacing=()=>{b.className="file-embed-container cover",d.className="file-embed-container covered",u.className="file-embed-menu-button disabled",d.contains(h)&&d.removeChild(h),d.appendChild(b)},t.stopReplacing=t=>{t?(u.className="file-embed-menu-button hidden",d.className="file-embed-container covered error",d.appendChild(h)):(d.className="file-embed-container",u.className="file-embed-menu-button"),d.removeChild(b)},s}getFileAttrs(t){return{href:t.getAttribute("href"),filename:t.getAttribute("filename"),filetype:t.getAttribute("filetype"),filesize:t.getAttribute("filesize"),title:t.getAttribute("title"),dirty:t.getAttribute("dirty"),description:t.getAttribute("description"),error:t.getAttribute("error")}}generateThumbnail(t){let e=document.createElement("img");return e.className="file-embed-thumbnail".concat(t.attrs.thumbnail?"":"-default"),e.setAttribute("src",t.attrs.thumbnail||(0,o.zF4)("/img/attachment_icon.svg")),t.updateThumbnail=async function(a){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:400,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{aspect:"1.5",crop:"fill",gravity:"auto",width:400,height:600};if(t.attrs.dirty=!0,!a){t.attrs.thumbnail=null,e.onload=()=>{e.className="file-embed-thumbnail-default"},e.src=(0,o.zF4)("/img/attachment_icon.svg");return}let i=await c(a),s=await l().post("/api/v1/image").send({image:i}),d=(0,o.zF4)(s.body.url,n,r);return t.attrs.thumbnail=d,e.onload=()=>{e.className="file-embed-thumbnail"},e.src=d,d},e}generateDetails(t){let e=document.createElement("div");e.className="file-embed-details";let a=document.createElement("div");a.className="file-embed-details-h1",a.innerText=t.attrs.title||t.attrs.filename;let n=document.createElement("div");return n.className="file-embed-details-h2",n.innerText=(0,s.Nf)({attrs:t.attrs}),e.appendChild(a),e.appendChild(n),t.updateTitle=e=>{t.attrs.title=e,t.attrs.dirty=!0,a.innerText=e},e}generateButton(t){let e=document.createElement("button");e.className="file-embed-button primary mock ".concat(t);let a=document.createElement("span");return a.className="file-embed-button-text",a.innerText=this.actionButtonText,e.appendChild(a),e}generateDescription(t){let e=document.createElement("div");return e.className="file-embed-description ",e.innerText=t.attrs.description,t.updateDescription=a=>{t.attrs.dirty=!0,t.attrs.description=a?a.trim():null,e.innerText=a?a.trim():null},e}generateErrorCover(t,e){var a,n;let r=document.createElement("div");r.className="file-embed-container cover error";let l=document.createElement("div");l.className="file-embed-error-inner";let i=document.createElement("img");i.className="file-embed-error-icon",i.setAttribute("src",(0,o.aR6)("/img/alert-circle.svg"));let s=document.createElement("div");s.className="file-embed-error-message",s.innerText=null===(a=e.attrs.error)||void 0===a?void 0:a.message;let d=document.createElement("div");d.className="file-embed-error-button",d.onclick=this.makeReplaceButtonClickHandler(t,e);let c=document.createElement("span");return c.className="file-embed-error-button-text",c.innerText=(null===(n=e.attrs.error)||void 0===n?void 0:n.button)||"Try again",d.appendChild(c),l.appendChild(i),l.appendChild(s),l.appendChild(d),r.appendChild(l),r}generateSpinner(){let t=document.createElement("div");t.className="embed-loader-container";let e=document.createElement("div");e.className="embed-loader";let a=document.createElement("div");return a.innerText="Replacing...",a.className="embed-loader-text",t.appendChild(e),t.appendChild(a),t}makeReplaceButtonClickHandler(t,e){return()=>{let a=document.createElement("input");a.className="sidebar-item-hidden-file-input",a.type="file",a.oninput=a=>{var n,r;let l=null===(r=a.target)||void 0===r?void 0:null===(n=r.files)||void 0===n?void 0:n[0];t.dispatchEvent({type:"file_replace",node:e,file:l})},document.body.appendChild(a),a.click(),document.body.removeChild(a)}}generateDropdown(t,e,a){let n=document.createElement("div");n.className="post-editor-file-embed-dropdown-container dropdown-container";let r=document.createElement("div");r.className="dropdown-content";let l=document.createElement("div");l.className="dropdown-list",[{label:"Edit",icon:"edit",onclick:()=>{e.dispatchEvent(new CustomEvent("file_edit",{detail:{node:t}}))}},{label:"Replace",icon:"swap",onclick:this.makeReplaceButtonClickHandler(e,t)},{label:"Download",icon:"download",onclick:()=>{let e=document.createElement("a");e.href=t.attrs.raw_href,e.download=t.attrs.filename,document.body.appendChild(e);let a=window.onbeforeunload;window.onbeforeunload=null,e.click(),window.onbeforeunload=a,document.body.removeChild(e)}},{label:"Delete",icon:"trash",onclick:()=>{if("function"!=typeof a)return;let t=a();e.dispatch(e.state.tr.delete(t,t+1))}}].map(t=>{let e=document.createElement("div");e.className="dropdown-list-item",e.onclick=t.onclick;let a=document.createElement("div");a.className="dropdown-list-item-icon icon-".concat(t.icon);let n=document.createElement("span");return n.className="dropdown-list-item-text",n.innerText=t.label,e.appendChild(a),e.appendChild(n),e}).forEach(t=>{l.appendChild(t)}),r.appendChild(l);let i=document.createElement("div");i.className="file-embed-menu-button";let o=document.createElement("div");return o.className="dropdown-icon",o.appendChild(document.createElement("span")),o.appendChild(document.createElement("span")),o.appendChild(document.createElement("span")),o.appendChild(document.createElement("span")),i.appendChild(o),n.appendChild(i),n.appendChild(r),i.onclick=()=>{if("dropdown-content open"===r.className)return;r.className="dropdown-content open",o.className="dropdown-icon open",i.className="file-embed-menu-button open";let t=()=>{r.className="dropdown-content",o.className="dropdown-icon",i.className="file-embed-menu-button",document.removeEventListener("click",t)};setTimeout(()=>{document.addEventListener("click",t)},0)},{button:i,menu:n}}generateContainerTop(t){let e=document.createElement("div");return e.className="file-embed-container-top",e.appendChild(this.generateThumbnail(t)),e.appendChild(this.generateDetails(t)),e.appendChild(this.generateButton("wide")),e}constructor({substackType:t,actionButtonText:e,actionButtonAttr:a,mimeTypesToSignature:r}){(0,n._)(this,"substackType","file"),(0,n._)(this,"actionButtonText","Download"),(0,n._)(this,"actionButtonAttr","raw_href"),(0,n._)(this,"mimeTypesToSignature",void 0),t&&(this.substackType=t),e&&(this.actionButtonText=e),a&&(this.actionButtonAttr=a),this.mimeTypesToSignature=r}}let p=new m({actionButtonText:null,substackType:null,actionButtonAttr:null,mimeTypesToSignature:{}}),g=(0,d.S)({name:"file",nodeSpec:p.nodeSpec})},715:function(t,e,a){a.d(e,{$:()=>o,z:()=>s});var n=a(92007),r=a(94826),l=a(30548),i=a(80870);let o={attrs:{number:{default:1}},content:"block+",atom:!1,selectable:!1,isolating:!1,defining:!0,draggable:!1,group:"block",parseDOM:[{tag:".footnote"}],toDOM:t=>{let{number:e}=t.attrs;return["div",{class:"footnote","data-component-name":"FootnoteToDOM"},["a",{id:"footnote-".concat(e),href:"#footnote-anchor-".concat(e),class:"footnote-number",contenteditable:!1,target:"_self"},"".concat(e)],["div",{class:"footnote-content"},0]]},toDOMStatic:t=>{let{number:e}=t.attrs;return["div",{class:"footnote","data-component-name":"FootnoteToDOMStatic"},["span",{class:"footnote-number"},"".concat(e)],["div",{class:"footnote-content"},0]]}},s=(0,l.S)({name:"footnote",nodeSpec:o,addCommands:()=>({insertFootnote:()=>t=>{let{state:e,editor:a,dispatch:l}=t;if(!(0,r.P)(e))return!1;let{schema:o}=a,s=o.nodes.footnote.create({number:1},o.nodes.paragraph.create()),d=o.nodes.footnoteAnchor.create({number:1}),c=e.tr,u=(0,i.dG)(c,o);if(c.replaceWith(u,u,s),c.replaceSelectionWith(d),(0,i.A0)(c,o),l){try{c.setSelection(n.Bs.create(c.doc,u+2,u+2)).scrollIntoView()}catch(t){return console.error("could not set footnote text selection"),!1}l(c)}return!0}})})},87113:function(t,e,a){a.d(e,{$:()=>l,V:()=>i});var n=a(84864),r=a(30548);let l={attrs:{number:{default:1}},atom:!0,selectable:!0,isolating:!1,defining:!0,draggable:!0,inline:!0,group:"inline",parseDOM:[{tag:".footnote-anchor"}],toDOM:t=>{let{number:e}=t.attrs;return["a",{class:"footnote-anchor","data-component-name":"FootnoteAnchorToDOM",id:"footnote-anchor-".concat(e),href:"#footnote-".concat(e),target:"_self"},"".concat(e)]},toDOMStatic:t=>{let{number:e}=t.attrs;return["span",{class:"footnote-anchor-email","data-component-name":"FootnoteAnchorToDOMStatic"},"".concat((0,n.getSuperscriptNumberString)(e))]}},i=(0,r.S)({name:"footnoteAnchor",nodeSpec:l})},71766:function(t,e,a){a.d(e,{$y:()=>p,HK:()=>f,t_:()=>g});var n=a(7409),r=a(98848),l=a(55679),i=a(80569),o=a.n(i),s=a(87847),d=a(98914),c=a(30548),u=a(30837);let m="fp-recirc-block",p={attrs:{nodeId:{default:null},title:{default:"Featured Stories"},postIds:{default:[]},showCount:{default:4},posts:{default:null},isEditorNode:{default:!1},align:{default:null}},group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,editable:!1,parseDOM:[{tag:".".concat(m),getAttrs:u.Y}],toDOM:t=>b(t),toDOMStatic:t=>{let e=t.attrs,{align:a}=e,l=(0,r._)(e,["align"]);return["div",{class:m,"data-attrs":JSON.stringify((0,n._)({isEmail:!0},l))}]}},g=(0,c.S)({name:"fpRecircBlock",nodeSpec:p,addNodeView:()=>(0,l.fW)(s.p),addCommands:()=>({insertFpRecircBlock:t=>e=>{let{commands:a}=e,n={nodeId:(0,d.EH)(),title:t.title||"Featured Stories",postIds:t.postIds||[],showCount:t.showCount||4,posts:t.posts||void 0,isEditorNode:!0,align:t.align||null};return a.insertContent({type:"fpRecircBlock",attrs:n})},updateFpRecircBlock:t=>{let{pos:e,attrs:a}=t;return t=>{let{state:r,dispatch:l}=t;if(l){let t=r.doc.nodeAt(e);if(t&&"fpRecircBlock"===t.type.name){let i=r.tr;return i.setNodeMarkup(e,void 0,(0,n._)({},t.attrs,a)),l(i),!0}}return!1}}})}),b=t=>["div",{class:m,"data-attrs":JSON.stringify(t.attrs)}],h=t=>{var e,a,n;return{id:t.id,title:t.title,author_name:(null===(a=t.publishedBylines)||void 0===a?void 0:null===(e=a[0])||void 0===e?void 0:e.name)||t.author_name,author_names:null===(n=t.publishedBylines)||void 0===n?void 0:n.map(t=>t.name),cover_image:t.cover_image,canonical_url:t.canonical_url,post_date:t.post_date}},f=async(t,e)=>{try{if(t&&t.length>0)return((await o().get("/api/v1/posts/by_ids").query({ids:t.join(",")})).body.posts||[]).map(h);return((await o().get("/api/v1/archive").query({sort:"new",limit:4})).body||[]).map(h)}catch(t){return console.error("Error fetching fp recirc block posts:",t),[]}}},98450:function(t,e,a){a.d(e,{$:()=>r,G:()=>l});var n=a(30548);let r={content:"block+",group:"block",toDOM:()=>["div",{"data-component-name":"FragmentNodeToDOM"},0]},l=(0,n.S)({name:"fragmentNode",nodeSpec:r})},87413:function(t,e,a){a.d(e,{$y:()=>i,S:()=>d,Tu:()=>o,un:()=>m});var n=a(91036),r=a.n(n),l=a(30548);let i={attrs:{innerHTML:{default:""},stylesheet:{default:""}},untrackedAttrs:["innerHTML","stylesheet"],inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.github-gist",getAttrs:a(30837).Y}],toDOMStatic:t=>p(t,!0),toDOM:t=>p(t,!1)},o=(0,l.S)({name:"gitgist",nodeSpec:i,addCommands(){return{insertGithubGist:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),s=/(https?:\/\/gist.github.com\/([^\s]*\/[^\s\.#]*)([\.#][^\s]*)?)/,d=function(t){var e;let{customSchema:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(a&&!a.nodes.gitgist)return null;let n=s.exec(t);return null!==(e=n&&n[1])&&void 0!==e?e:null},c=t=>{let e=t.match(s);return e&&e[2]?e[2]:null},u=async t=>{let e=c(t),n=(await Promise.resolve().then(a.t.bind(a,80569,23))).default;return(await n.get("/api/v1/github/gist").query({id:e})).body},m=async function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(e?{schema:e}:await Promise.resolve().then(a.bind(a,37175))).schema.nodes.gitgist.create(await u(t))};function p(t,e){let a=document.createElement("div");a.classList.add("github-gist"),e?a.setAttribute("data-component-name","GitgistToDOMStatic"):(a.dataset.attrs=JSON.stringify(t.attrs),a.setAttribute("data-component-name","GitgistToDOM")),a.innerHTML=r()(t.attrs.innerHTML,{allowedTags:r().defaults.allowedTags,allowedAttributes:Object.assign({},r().defaults.allowedAttributes,{"*":["href","style","id","data-*","itemprop","class"]})});let n=document.createElement("link");if(n.rel="stylesheet",n.href=t.attrs.stylesheet,a.prepend(n),e){a.classList.add("static");let t=a.getElementsByTagName("td");for(let e=0;e<t.length;e++){let a=t[e];a&&(a.dataset.lineNumber?(a.innerHTML=a.dataset.lineNumber,a.align="right"):(a.align="left",a.innerHTML="<pre>".concat(a.innerHTML,"</pre>")),a.classList.add("content"),a.height="20px")}}return a}},69323:function(t,e,a){a.d(e,{$:()=>l,y:()=>i});var n=a(60308),r=a(30548);let l={attrs:{src:{default:""},height:{default:null},width:{default:null},alt:{default:null},title:{default:null}},inline:!0,group:"inline",draggable:!0,toDOM:t=>{let e=(0,n.zF4)(t.attrs.src,1100);return["img",{style:t.attrs.height&&t.attrs.width?"max-width:".concat(t.attrs.width,"px;max-height:").concat(t.attrs.height,"px"):"",src:e,alt:t.attrs.alt,title:t.attrs.title,"data-component-name":"ImageToDOM"}]},toDOMStatic:t=>{if(t.attrs.height&&t.attrs.width){let e=Math.min(t.attrs.width,550),a=(0,n.zF4)(t.attrs.src,e);return["table",{class:"image-wrapper",width:"100%",border:"0",cellSpacing:"0",cellPadding:"0","data-component-name":"ImageToDOMStatic"},["tr",{},["td"],["td",{class:"content",width:e}],["td"]],["tr",{},["td"],["td",{align:"left",class:"content",width:e},["img",{src:a,alt:t.attrs.alt,title:t.attrs.title}]],["td"]]]}return["img",{src:(0,n.zF4)(t.attrs.src,550),alt:t.attrs.alt,title:t.attrs.title}]}},i=(0,r.S)({name:"image",nodeSpec:l})},54793:function(t,e,a){a.d(e,{$y:()=>b,zk:()=>f});var n=a(7409),r=a(99282),l=a(88897),i=a(76405),o=a(55679),s=a(78718),d=a.n(s),c=a(78532),u=a(57639),m=a(57125);let p=()=>({src:{default:null,keepOnSplit:!1},alt:{default:null,keepOnSplit:!1},title:{default:null,keepOnSplit:!1},href:{default:null,keepOnSplit:!1},width:{default:"100%",keepOnSplit:!1},height:{default:"auto",keepOnSplit:!1},size:{default:"normal",keepOnSplit:!1},align:{default:"center",keepOnSplit:!1}}),g="image3",b={name:g,group:"block",atom:!1,selectable:!0,content:"inline*",draggable:!0,attrs:(0,m.Op)({attrs:p()}),parseDOM:[{tag:"image3",getAttrs:t=>{try{if(t instanceof HTMLElement){let e=t.getAttribute("data-attrs");if(e)return JSON.parse(e)}}catch(t){}return!1}}],toDOM:t=>{var e;let a=!!(null===(e=t.content)||void 0===e?void 0:e.size),r={class:"image3","data-attrs":JSON.stringify((0,n._)({},t.attrs))};return a?["div",["div",r,0]]:["div",r]},toDOMStatic:t=>{var e;let a=!!(null===(e=t.content)||void 0===e?void 0:e.size),l={class:"image3","data-attrs":JSON.stringify((0,r._)((0,n._)({},t.attrs),{isEmail:!0}))};return a?["div",["div",l,0]]:["div",l]}},h=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/,f=l.NB.create({name:g,inline:!1,group:"block",content:"inline*",draggable:!0,selectable:!0,isolating:!0,defining:!0,addOptions:()=>({HTMLAttributes:{}}),addAttributes:()=>p(),parseHTML:()=>[{tag:'img[src]:not([src^="data:"])',getAttrs:t=>({src:t.getAttribute("src")})},{tag:"image3"},{tag:"p",priority:100,getAttrs:t=>{var e;if(null==t?void 0:null===(e=t.textContent)||void 0===e?void 0:e.trim())return!1;let[a]=Array.from(t.getElementsByTagName("img"));return!!a&&d()((0,u.Nh)(a,null),["src","alt","height","width"])}}],renderHTML(t){let{HTMLAttributes:e}=t;return["image3",(0,l.P1)(this.options.HTMLAttributes,e),0]},addCommands(){return{setImage:t=>e=>{let{commands:a}=e,n=t.title?[{type:"text",text:t.title}]:[];try{return a.insertContent({type:this.name,attrs:t,content:n})}catch(t){return!1}},setUnsplashImage:t=>{let{url:e,width:a,height:n,description:r,userName:l,userHref:o}=t;return t=>{let{commands:s,editor:d}=t,c=d.schema.text("Photo by "),u=d.schema.text(l,[d.schema.marks.link.create({title:l,href:o})]),m=d.schema.text(" on "),p=d.schema.text("Unsplash",[d.schema.marks.link.create({title:"Unsplash",href:"https://unsplash.com"})]);return s.insertContent({type:this.name,attrs:{alt:r,src:e,height:n,width:a,type:"image/jpg"},content:i.HY.fromArray([c,u,m,p]).toJSON()})}}}},addNodeView:()=>(0,o.fW)(c._),addInputRules(){return[(0,l.x2)({find:h,type:this.type,getAttributes:t=>{let[,,e,a,n,r,l]=t;return{src:a,type:n,alt:e,title:r,href:l}}})]}})},61601:function(t,e,a){a.d(e,{$y:()=>m,hJ:()=>g});var n=a(7409),r=a(6400),l=a(88897),i=a(55679),o=a(81138),s=a(10656),d=a(19520),c=a(30837);let u="image-gallery-embed",m={attrs:{gallery:{default:{}},isEditorNode:{default:!1}},group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:u,getAttrs:c.Y}],toDOM:t=>{if("undefined"!=typeof window&&t.attrs.isEditorNode)try{t.attrs.isEditor=!0;let e=document.createElement("div");return e.className=u,e.setAttribute("data-attrs",JSON.stringify(t.attrs)),(0,s.G5)((0,r.h)(o.t,{node:(0,n._)({},t)}),e),e}catch(e){return console.error("Error rendering ImageGalleryComponent",e),(0,d.s)({msg:null,node:t,err:e,group:"block"})}return p(t)},toDOMStatic:t=>["div",{class:u,"data-attrs":JSON.stringify((0,n._)({isEmail:!0},t.attrs))}]},p=t=>["div",{class:u,"data-attrs":JSON.stringify(t.attrs)}],g=l.NB.create({name:"imageGallery",group:m.group,draggable:!0,addAttributes:()=>({gallery:{default:{}},isEditorNode:{default:!0}}),parseHTML:()=>[{tag:u}],renderHTML(t){let{HTMLAttributes:e,node:a}=t;return this.options.isStatic&&m.toDOMStatic?m.toDOMStatic(a):["div",(0,n._)({class:u},(0,l.P1)(e))]},addNodeView:()=>(0,i.fW)(o.t),addCommands(){return{insertImageGallery:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})},updateImageGallery:t=>e=>{let{commands:a}=e;return a.updateAttributes(this.name,t)}}}})},29511:function(t,e,a){a.d(e,{$p:()=>h,$y:()=>s,Dy:()=>c,o0:()=>d});var n=a(98012),r=a(63651),l=a(30548),i=a(30837);let o=/[@#][\w.]+|\n/g,s={attrs:{instagram_id:{default:""},title:{default:""},author_name:{default:""},thumbnail_url:{default:""},timestamp:{default:""},belowTheFold:{default:!1}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.instagram",getAttrs:i.Y}],toDOM:t=>{let e=document.createElement("div");e.className="instagram",e.setAttribute("data-attrs",JSON.stringify(t.attrs)),e.setAttribute("data-component-name","InstagramToDOM");let a=document.createElement("div");a.className="instagram-top-bar",e.appendChild(a);let l=document.createElement("a");l.className="instagram-author-name",l.href=p(t.attrs.author_name),l.target="_blank",l.textContent=t.attrs.author_name,a.appendChild(l);let i=document.createElement("a");i.className="instagram-image",i.href=m(t.attrs.instagram_id),i.target="_blank",e.appendChild(i);let s=document.createElement("img");s.src=(0,r.zF4)(t.attrs.thumbnail_url,640),t.attrs.belowTheFold&&s.setAttribute("loading","lazy"),i.appendChild(s);let d=document.createElement("div");d.className="instagram-bottom-bar",e.appendChild(d);let c=document.createElement("div");if(c.className="instagram-title",function(t,e){let a,n;if(!t)return;let r=0;for(;a=o.exec(t);)switch(r<a.index&&e.appendChild(document.createTextNode(t.substring(r,a.index))),r=a.index+a[0].length,a[0][0]){case"\n":e.appendChild(document.createElement("br"));break;case"@":(n=document.createElement("a")).href=p(a[0].substr(1)),n.target="_blank",n.textContent=a[0],e.appendChild(n);break;case"#":(n=document.createElement("a")).href=g(a[0]),n.target="_blank",n.textContent=a[0],e.appendChild(n);break;default:e.appendChild(document.createTextNode(a[0]))}r<t.length&&e.appendChild(document.createTextNode(t.substr(r)))}(t.attrs.title,c),d.appendChild(c),t.attrs.timestamp){let e=document.createElement("div");e.className="instagram-timestamp",e.textContent=(0,n.Z)(t.attrs.timestamp).format("MMMM D, YYYY"),d.appendChild(e)}return e}},d=(0,l.S)({name:"instagram",nodeSpec:s,addCommands(){return{insertInstagram:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),c=function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e&&!e.nodes.instagram?null:f(t)[1]},u=t=>f(t)[0],m=t=>"https://instagram.com/p/".concat(t),p=t=>"https://instagram.com/".concat(t),g=t=>"https://instagram.com/explore/tags/".concat(t.substr(1),"/"),b=async t=>{let e=(await Promise.resolve().then(a.t.bind(a,80569,23))).default;return(await e.get("/api/v1/instagram/post/".concat(u(t)))).body},h=async function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(e?{schema:e}:await Promise.resolve().then(a.bind(a,37175))).schema.nodes.instagram.create(await b(t))},f=t=>{let e=/(https?:\/\/(?:www\.)?(?:instagram\.com|instagr\.am)\/(?:p|reel|reels)\/([^\/\b\s\?\#]+)[^\s]*)/.exec(t);if(e){var a,n;return[null!==(a=e[2])&&void 0!==a?a:null,null!==(n=e[1])&&void 0!==n?n:null]}return[null,null]}},49640:function(t,e,a){a.d(e,{$:()=>m,F:()=>p});var n=a(58865),r=a(60308),l=a(47929),i=a(30548);function o(){let t=(0,n._)(["Get more from "," in the Substack app"]);return o=function(){return t},t}function s(){let t=(0,n._)(["Read "," in the Substack app"]);return s=function(){return t},t}function d(){let t=(0,n._)(["Get more from "," in the Substack app"]);return d=function(){return t},t}function c(){let t=(0,n._)(["Read "," in the Substack app"]);return c=function(){return t},t}let u=t=>(0,r.D4e)({utm_campaign:l.VX.appMarketing,utm_content:l.fZ.authorPostInsert,utm_source:t}),m={attrs:{logo_url:{default:null},publication_name:{default:null},publication_subdomain:{default:null},author_name:{default:null},language:{default:"en"}},inline:!1,atom:!0,group:"block",draggable:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.install-substack-app-embed"}],toDOM:t=>{let{logo_url:e,publication_name:a,publication_subdomain:n,author_name:l,language:i}=t.attrs,{iString:d,iTemplate:c}=I18N.i(i);return["div",{class:"install-substack-app-embed install-substack-app-embed-web","data-component-name":"InstallSubstackAppToDOM"},["img",{class:"install-substack-app-embed-img",src:(0,r.zF4)(e)}],["div",{class:"install-substack-app-embed-text"},["div",{class:"install-substack-app-header"},l?c(o(),l):c(s(),a)],["div",{class:"install-substack-app-text"},d("Available for iOS and Android")]],["a",{href:u(n),target:"_blank",class:"install-substack-app-embed-link"},["button",{class:"install-substack-app-embed-btn button primary"},d("Get the app")]]]},toDOMStatic:t=>{let{logo_url:e,publication_name:a,publication_subdomain:n,author_name:l,language:i}=t.attrs,{iString:o,iTemplate:s}=I18N.i(i);return["div",{class:"install-substack-app-embed","data-component-name":"InstallSubstackAppToDOMStatic"},["table",{class:"install-substack-embed-table"},["tr",{},["td",{rowspan:2},["img",{class:"install-substack-app-embed-img",src:(0,r.zF4)(e),width:64,height:64}]],["td",{class:"install-substack-app-header"},l?s(d(),l):s(c(),a)]],["tr",{},["td",{class:"install-substack-app-text"},o("Available for iOS and Android")]],["tr",{},["td",{colspan:2},["a",{href:u(n),target:"_blank",class:"install-substack-app-embed-link"},["button",{class:"install-substack-app-embed-btn button primary"},o("Get the app")]]]]]]}},p=(0,i.S)({name:"install_substack_app",nodeSpec:m,addCommands(){return{insertInstallSubstackAppEmbed:t=>e=>{let{commands:a}=e,n=(0,r.SVA)(t),l={logo_url:t.logo_url||"".concat(n,"/img/substack.png"),publication_name:t.name,language:t.language,author_name:t.author_name,publication_subdomain:t.subdomain};return a.insertContent({type:this.name,attrs:l})}}}})},99975:function(t,e,a){a.d(e,{$y:()=>s,aI:()=>m,j7:()=>d,lA:()=>c});var n=a(60308),r=a(30548),l=a(30837);let i=/https?:\/\/read\.amazon(?:\.co)?\.[a-z]+\/kp\/(?:embed|card)\?asin=([^&#\s\b'"]+)[^\b\s'"]*/i,o=[RegExp('<iframe[^>]+src="'.concat(i.source,'"[^>]*><\\/iframe>'),"i"),i],s={attrs:{kindleId:{default:""},imageUrl:{default:""}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDom:[{tag:"div.kindle-wrap",getAttrs:l.Y}],toDOM:t=>{let e=p(t.attrs.kindleId);return["div",{class:"kindle-wrap","data-attrs":JSON.stringify(t.attrs),"data-component-name":"KindleToDOM"},["iframe",{src:e,frameborder:"0",gesture:"media",allow:"autoplay; fullscreen",allowautoplay:"true",allowfullscreen:"true"}]]},toDOMStatic:t=>["table",{class:"kindle-wrapper",width:"100%",border:"0",cellSpacing:"0",cellPadding:"0","data-component-name":"KindleToDOMStatic"},["tr",{},["td"],["td",{align:"left",class:"content",width:200},["a",{class:"image-link",target:"_blank",href:g(t.attrs.kindleId)},["img",{"data-attrs":JSON.stringify(t.attrs),alt:"",width:"".concat(200),class:"wide-image",src:(0,n.zF4)(t.attrs.imageUrl,400)}]]],["td"]]]},d=(0,r.S)({name:"kindle",nodeSpec:s,addCommands(){return{insertKindle:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),c=t=>{for(let e of o){let a=e.exec(t);if(a)return a[0]}return null},u=async t=>{let e=(await Promise.resolve().then(a.t.bind(a,80569,23))).default;return(await e.get("/api/v1/kindle").query({embedText:t})).body},m=async function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(e?{schema:e}:await Promise.resolve().then(a.bind(a,37175))).schema.nodes.kindle.create(await u(t))},p=t=>(0,n.n1t)("https://read.amazon.com/kp/card",{asin:t,preview:"inline",linkCode:"kpe",hideShare:"true"}),g=t=>"https://www.amazon.com/gp/product/".concat(t,"/")},41128:function(t,e,a){a.d(e,{$y:()=>p,Jd:()=>h,Ox:()=>m,qs:()=>g});var n=a(27412),r=a(7409),l=a(99282),i=a(6400),o=a(55679),s=a(81924),d=a(19520),c=a(30548),u=a(30837);let m=()=>{let t="",e="ABCDEFGHIJKLMNOPQRSTUVWXYZ",a=e.length;for(let n=0;n<10;n++)t+=e.charAt(Math.floor(Math.random()*a));return t},p={content:"text*",group:"block",code:!0,defining:!0,isolating:!0,attrs:{persistentExpression:{default:""},id:{default:""}},parseDOM:[{tag:"pre.text",preserveWhitespace:"full",priority:60},{tag:"div.latexWrapper",getAttrs:u.Y}],toDOM:t=>["div",{class:"latex-rendered","data-attrs":JSON.stringify((0,r._)({},t.attrs)),"data-component-name":"LatexBlockToDOM"}],toDOMStatic:t=>["div",{class:"latex-rendered","data-attrs":JSON.stringify((0,l._)((0,r._)({},t.attrs),{isEmail:!0})),"data-component-name":"LatexBlockToDOMStatic"}]},g=(0,c.S)({name:"latex_block",nodeSpec:p,addCommands(){return{insertLatex:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}},addNodeView:()=>(0,o.fW)(s.w)}),b=t=>{try{let e=document.createElement("span");e.className="latex-rendered";let a=m(),n=null==t?void 0:t.attrs.persistentExpression;return(0,i.render)((0,i.h)(s.w,{persistentExpression:n,node:t,id:a}),e),e}catch(e){return console.error("Error rendering LatexComponent",e),(0,d.s)({msg:null,node:t,err:e,group:"block"})}};class h{constructor(t){(0,n._)(this,"dom",void 0),t.updateExpression=e=>{t.attrs=(0,l._)((0,r._)({},t.attrs),{persistentExpression:e}),t.attrs.dirty=!0},this.dom=b(t)}}},23431:function(t,e,a){a.d(e,{$1:()=>g,$y:()=>i,CA:()=>d,Ee:()=>u,eK:()=>o});var n=a(27412),r=a(60308),l=a(30548);let i={attrs:{url:{default:""},thumbnail_url:{default:""}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDom:[{tag:"div.lichess-wrap",getAttrs:a(30837).Y}],toDOM:t=>p(t),toDOMStatic:t=>m(t)},o=(0,l.S)({name:"lichess",nodeSpec:i,addCommands(){return{insertLichess:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),s=/^.*(https?\:\/\/(\S+)?(?:(.?lichess.org\/.*).*)).*$/,d=t=>{let e=s.exec(t);return e&&e[0]},c=async t=>{let e=(await Promise.resolve().then(a.t.bind(a,80569,23))).default;return(await e.get("/api/v1/lichess-embed").query({url:t.trim()})).body},u=async function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(e?{schema:e}:await Promise.resolve().then(a.bind(a,37175))).schema.nodes.lichess.create(await c(t))},m=function(t){let{}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=document.createElement("div");e.className="lichess-wrap static",e.setAttribute("data-component-name","LichessToDOMStatic");let a=document.createElement("a");a.href=t.attrs.url.replace(/embed\//,""),a.setAttribute("target","_blank");let n=document.createElement("img");return n.className="lichess-wrap thumbnail",n.src=(0,r.zF4)(t.attrs.thumbnail_url,640),n.style.backgroundImage="url(".concat(t.attrs.thumbnail_url,")"),t.attrs.belowTheFold&&n.setAttribute("loading","lazy"),a.append(n),e.appendChild(a),e},p=t=>{let e=document.createElement("div");e.id="lichess-iframe",e.className="lichess-wrap outer",e.dataset.attrs=JSON.stringify(t.attrs),e.setAttribute("data-component-name","LichessToDOM");let a=document.createElement("iframe");return a.id="iframe-lichess",a.className="lichess-iframe",a.src=t.attrs.url,a.width="560",a.height="405px",a.frameBorder="0",t.attrs.belowTheFold&&a.setAttribute("loading","lazy"),e.appendChild(a),e};class g{constructor(t){(0,n._)(this,"dom",void 0);let e=p(t),a=e.querySelector(".lichess-iframe"),r=document.createElement("div");r.className="lichess-screen",r.addEventListener("dblclick",()=>{r.classList.add("sunken"),a.focus()}),a.addEventListener("blur",()=>{r.classList.remove("sunken")}),e.appendChild(r),this.dom=e}}},73078:function(t,e,a){a.d(e,{$:()=>c,U:()=>u});var n=a(6400),r=a(10656),l=a(55706),i=a(60308),o=a(63651),s=a(19520),d=a(30548);let c={attrs:{name:{default:""},avatarUrl:{default:""},url:{default:""},isEditorNode:{default:!1}},group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.meeting-embed",getAttrs:a(30837).Y}],toDOM:t=>{if("undefined"!=typeof window&&t.attrs.isEditorNode)try{let e=document.createElement("div");return e.className="meeting-embed",e.setAttribute("data-attrs",JSON.stringify(t.attrs)),(0,r.G5)((0,n.h)(l.R,{name:t.attrs.name,avatarUrl:t.attrs.avatarUrl,url:t.attrs.url}),e),e}catch(e){return console.error("Error rendering MeetingEmbed",e),(0,s.s)({msg:null,node:t,err:e,group:"block"})}return m(t)},toDOMStatic:t=>m(t)},u=(0,d.S)({name:"meeting",nodeSpec:c,addCommands:()=>({insertMeeting:t=>e=>{let{commands:a,dispatch:n}=e,{publication:r,meetingsConfig:l,usePublicationName:s}=t,d=(0,i.SMH)({id:l.user_id,photo_url:l.user_profile_photo_url});return s&&r.logo_url&&(d=(0,o.zF4)(r.logo_url,112)),!n||a.insertContent({type:"meeting",attrs:{name:s?r.name:l.user_name,avatarUrl:d,url:(0,o.szv)(r,{addBase:!0,params:{source:"embed"}}),isEditorNode:!0}})}})}),m=t=>["div",{class:"meeting-embed","data-attrs":JSON.stringify(t.attrs),"data-component-name":"MeetingPlaceholder"}]},85197:function(t,e,a){a.d(e,{$:()=>c,H:()=>u});var n=a(7409),r=a(99282),l=a(6400),i=a(3258),o=a(10656),s=a(19520),d=a(30548);let c={attrs:{name:{default:""},id:{default:null},type:{default:null},url:{default:null},photo_url:{default:null},uuid:{default:null}},atom:!0,editable:!1,selectable:!0,isolating:!1,defining:!0,draggable:!1,inline:!0,group:"inline",parseDOM:[{tag:".mention-wrap",getAttrs:t=>{try{return JSON.parse(t.getElementsByTagName("a")[0].getAttribute("data-attrs"))}catch(t){return!1}}}],toDOM:t=>{if("undefined"!=typeof window)try{var e;let a=document.createElement("span");return a.className="mention-wrap",a.setAttribute("data-attrs",JSON.stringify(t.attrs)),(0,o.G5)((0,l.h)(i.ZP,{name:(null===(e=t.attrs.name)||void 0===e?void 0:e.trim())||"",id:t.attrs.id||null,type:t.attrs.type||null,url:t.attrs.url||null,photo_url:t.attrs.photo_url||null,uuid:t.attrs.uuid||null,isEditorContext:!0}),a),a}catch(e){return console.error("Error rendering Mention",e),(0,s.s)({msg:null,node:t,err:e,group:"inline"})}return["span",{class:"mention-wrap","data-attrs":JSON.stringify(t.attrs),"data-component-name":"MentionToDOM"}]},toDOMStatic:t=>["span",{class:"mention-wrap","data-attrs":JSON.stringify((0,r._)((0,n._)({},t.attrs),{isStatic:!0})),"data-component-name":"MentionToDOMStatic"}]},u=(0,d.S)({name:"substack_mentions",nodeSpec:c})},53797:function(t,e,a){a.d(e,{$y:()=>s,YT:()=>b,q:()=>d,vt:()=>p,zb:()=>h});var n=a(80569),r=a.n(n),l=a(60308),i=a(84864),o=a(30548);let s={attrs:{collection:{default:""},collection_slug:{default:""},creator:{default:""},description:{default:""},image_url:{default:""},name:{default:""},animation_url:{default:""},nft_logo_url:{default:""},permalink:{default:""},youtube_url:{default:null},belowTheFold:{default:!1}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.opensea",getAttrs:a(30837).Y}],toDOMStatic:function(t){let e=document.createElement("div");e.className="opensea static",e.setAttribute("data-component-name","OpenseaToDOMStatic");let a=document.createElement("table");a.className="opensea-header-table";let n=document.createElement("tr");n.className="opensea-header-row";let r=document.createElement("tr"),o=document.createElement("td"),s=document.createElement("a");s.className="opensea-title",t.attrs.permalink&&s.setAttribute("href",t.attrs.permalink),s.textContent=t.attrs.name,o.appendChild(s),r.appendChild(s);let d=document.createElement("tr"),c=document.createElement("td"),u=document.createElement("a");u.className="opensea-collection",t.attrs.collection_slug&&u.setAttribute("href","https://opensea.io/collection/".concat(t.attrs.collection_slug)),u.textContent=(0,i.truncateText)(t.attrs.collection,50),c.appendChild(u),d.appendChild(c);let m=document.createElement("td"),p=document.createElement("table");m.className="opensea-masthead",p.appendChild(r),p.appendChild(d),m.appendChild(p);let g=document.createElement("td");g.className="nft-logo";let b=document.createElement("a"),h=document.createElement("img");t.attrs.nft_logo_url&&h.setAttribute("src",(0,l.zF4)(t.attrs.nft_logo_url)),t.attrs.permalink&&b.setAttribute("href",t.attrs.permalink),t.attrs.belowTheFold&&b.setAttribute("loading","lazy"),b.appendChild(h),g.appendChild(b),n.appendChild(m),n.appendChild(g),a.appendChild(n);let f=document.createElement("a");t.attrs.permalink&&f.setAttribute("href",t.attrs.permalink);let v=document.createElement("img");v.className="opensea-image",t.attrs.image_url&&v.setAttribute("src",(0,l.zF4)(t.attrs.image_url,600,{crop:"fill"})),v.setAttribute("alt",t.attrs.name),v.setAttribute("width","500"),t.attrs.belowTheFold&&v.setAttribute("loading","lazy"),f.appendChild(v);let y=document.createElement("table");y.className="opensea-footer-table";let w=document.createElement("tr"),_=document.createElement("td");_.className="opensea-description",_.textContent=(0,i.truncateText)(t.attrs.description,200),w.appendChild(_);let k=document.createElement("tr"),C=document.createElement("td"),S=document.createElement("a");C.className="opensea-creator",t.attrs.creator&&S.setAttribute("href","https://opensea.io/".concat(t.attrs.creator,"?tab=created")),S.textContent="Created by ".concat((0,i.truncateText)(t.attrs.creator,50)),C.appendChild(S),k.appendChild(C);let E=document.createElement("tr"),N=document.createElement("td"),O=document.createElement("a"),M=document.createElement("table"),T=document.createElement("tr"),D=document.createElement("td");return O.className="opensea-cta-link",t.attrs.permalink&&O.setAttribute("href",t.attrs.permalink),M.setAttribute("cellspacing","16"),M.className="opensea-cta-table",D.className="opensea-cta",D.textContent="View on OpenSea",T.appendChild(D),M.appendChild(T),O.appendChild(M),N.appendChild(O),E.appendChild(N),t.attrs.description&&y.appendChild(w),y.appendChild(k),y.appendChild(E),e.appendChild(a),e.appendChild(f),e.appendChild(y),e.querySelectorAll&&Array.prototype.forEach.call(e.querySelectorAll("a"),t=>{t.target="_blank"}),e},toDOM:function(t){let e,a;let n=document.createElement("div");n.className="opensea",n.setAttribute("data-component-name","OpenseaToDOM");let r=document.createElement("a");r.className="opensea-title",t.attrs.permalink&&r.setAttribute("href",t.attrs.permalink),r.textContent=t.attrs.name;let o=document.createElement("a");o.className="opensea-collection",t.attrs.collection_slug&&o.setAttribute("href","https://opensea.io/collection/".concat(t.attrs.collection_slug)),o.textContent=(0,i.truncateText)(t.attrs.collection,50);let s=document.createElement("div");s.className="opensea-masthead",s.appendChild(r),s.appendChild(o);let d=document.createElement("a");t.attrs.permalink&&d.setAttribute("href",t.attrs.permalink);let c=document.createElement("img");t.attrs.nft_logo_url&&c.setAttribute("src",(0,l.zF4)(t.attrs.nft_logo_url)),t.attrs.belowTheFold&&c.setAttribute("loading","lazy"),d.appendChild(c);let u=document.createElement("div");u.className="opensea-header",u.appendChild(s),u.appendChild(d);let m=document.createElement("a");t.attrs.permalink&&m.setAttribute("href",t.attrs.permalink),m.className="opensea-media-link";let p=["mp3","wav","oga"].some(e=>{var a;return null===(a=t.attrs.animation_url)||void 0===a?void 0:a.endsWith(e)}),g=["gltf","glb","webm","mp4","m4v","ogv","ogg"].some(e=>{var a;return null===(a=t.attrs.animation_url)||void 0===a?void 0:a.endsWith(e)}),b=!t.attrs.animation_url,h=t.attrs.animation_url&&!p&&!g;(b||p||h||t.attrs.youtube_url)&&((a=document.createElement("img")).className="opensea-image",t.attrs.image_url&&a.setAttribute("src",(0,l.zF4)(t.attrs.image_url,600,{crop:"fill"})),t.attrs.belowTheFold&&a.setAttribute("loading","lazy"),a.setAttribute("alt",t.attrs.name),m.appendChild(a)),(p||g)&&((e=document.createElement(p?"audio":"video")).className="opensea-player",e.setAttribute("controls",!0),e.setAttribute("loop",!0),e.setAttribute("src",t.attrs.animation_url),e.setAttribute("alt","OpenSea NFT media"),t.attrs.belowTheFold&&e.setAttribute("loading","lazy")),a&&m.appendChild(a),e&&m.appendChild(e);let f=document.createElement("div");f.className="opensea-description",f.textContent=(0,i.truncateText)(t.attrs.description,200);let v=document.createElement("a");v.className="opensea-creator",t.attrs.creator&&v.setAttribute("href","https://opensea.io/".concat(t.attrs.creator,"?tab=created")),v.textContent="Created by ".concat((0,i.truncateText)(t.attrs.creator,50));let y=document.createElement("a");y.className="opensea-cta",t.attrs.permalink&&y.setAttribute("href",t.attrs.permalink),y.textContent="View on OpenSea";let w=document.createElement("div");return w.className="opensea-footer",t.attrs.description&&w.appendChild(f),w.appendChild(v),w.appendChild(y),n.appendChild(u),n.appendChild(m),n.appendChild(w),n.querySelectorAll&&Array.prototype.forEach.call(n.querySelectorAll("a"),t=>{t.target="_blank"}),n}},d=(0,o.S)({name:"opensea",nodeSpec:s,addCommands(){return{insertOpensea:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),c=t=>{var e,a,n;return null===(n=(0,l.en2)(t))||void 0===n?void 0:null===(a=n.pathname.match(/assets\/(ethereum\/)?(.+)/))||void 0===a?void 0:null===(e=a[2])||void 0===e?void 0:e.split("/")[0]},u=t=>{var e,a,n;return null===(n=(0,l.en2)(t))||void 0===n?void 0:null===(a=n.pathname.match(/assets\/(ethereum\/)?(.+)/))||void 0===a?void 0:null===(e=a[2])||void 0===e?void 0:e.split("/")[1]},m=async t=>(await r().get("/api/v1/opensea").query({contract:c(t),token_id:u(t)})).body,p=async(t,e)=>{let{customSchema:a}=e;return a.nodes.opensea.create(await m(t))},g=/^https:\/\/opensea.io\/assets\/.+/,b=t=>{let e=g.exec(t);return e&&e[0]},h=t=>null!==b(t)},8220:function(t,e,a){a.d(e,{$u:()=>m,$y:()=>u,Yi:()=>g,pR:()=>h});var n=a(6400),r=a(12277),l=a(10656),i=a(60308),o=a(19520),s=a(30548),d=a(30837);let c="pinterest-embed",u={attrs:{url:{default:""},thumbnail_url:{default:""},title:{default:""},author_name:{default:""},author_url:{default:""},belowTheFold:{default:!1}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDom:[{tag:"div.pinterest-embed-wrap",getAttrs:d.Y}],toDOM:t=>v(t),toDOMStatic:t=>f(t)},m=(0,s.S)({name:"pinterest",nodeSpec:u,addCommands(){return{insertPinterest:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),p=/^https?:\/\/(?:(?:www\.)?pinterest\.com\/(?:pin\/[^/]+|[^/]+\/[^/]+)|pin\.it\/[^/]+)\/?.*$/,g=t=>{let e=p.exec(t);return e&&e[0]},b=async t=>{let e=(await Promise.resolve().then(a.t.bind(a,80569,23))).default;return(await e.get("/api/v1/pinterest-embed").query({url:t.trim()})).body},h=async function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(e?{schema:e}:await Promise.resolve().then(a.bind(a,37175))).schema;if(!n.nodes.pinterest)throw Error("Pinterest node type not found in schema");return n.nodes.pinterest.create(await b(t))},f=t=>{let e=t.attrs.url||"",a=350,n=350,r=350,l=350;return t.attrs.thumbnail_url?t.attrs.width&&t.attrs.height?(a=t.attrs.width,l=Math.round((n=t.attrs.height)*(r=Math.min(a,i.bxL))/a),["table",{className:"image-wrapper",width:"100%",border:"0",cellSpacing:"0",cellPadding:"0","data-component-name":"PinterestToDOMStatic"},["tr",{},["td",{}],["td",{align:"left",className:"content",width:String(r)},["a",{className:"image-link",target:"_blank",href:e},["img",{"data-attrs":JSON.stringify(t.attrs),alt:t.attrs.title||"Pinterest Pin",title:t.attrs.title||"Pinterest Pin",width:String(r),height:String(l),className:a>i.bxL?"wide-image":"",src:(0,i.zF4)(t.attrs.thumbnail_url,2*Math.min(a,i.bxL)),loading:t.attrs.belowTheFold?"lazy":null}]]],["td",{}]],["tr",{},["td",{}],["td",{align:"center"},["figcaption",{className:"image-caption",style:"box-sizing: content-box;color: #777777;font-size: 14px;line-height: 20px;font-weight: 400;letter-spacing: -.15px;margin-top: 8px;width: 70%;padding-left: 15%;padding-right: 15%;text-align: center;"},["a",{href:t.attrs.url||"#",target:"_blank",style:"color: inherit; text-decoration: none;"},t.attrs.title||"View on Pinterest"]]],["td",{}]]]):["table",{className:"image-wrapper",width:"100%",border:"0",cellSpacing:"0",cellPadding:"0","data-component-name":"PinterestToDOMStatic"},["tr",{},["td",{}],["td",{align:"left",className:"content",width:String(350)},["a",{className:"image-link",target:"_blank",href:e},["img",{"data-attrs":JSON.stringify(t.attrs),alt:t.attrs.title||"Pinterest Pin",title:t.attrs.title||"Pinterest Pin",src:(0,i.zF4)(t.attrs.thumbnail_url,2*i.bxL),loading:t.attrs.belowTheFold?"lazy":null}]]],["td",{}]],["tr",{},["td",{}],["td",{align:"center"},["figcaption",{class:"image-caption",style:"box-sizing: content-box;color: #777777;font-size: 14px;line-height: 20px;font-weight: 400;letter-spacing: -.15px;margin-top: 8px;width: 70%;padding-left: 15%;padding-right: 15%;text-align: center;"},["a",{href:t.attrs.url||"#",target:"_blank",style:"color: inherit; text-decoration: none;"},t.attrs.title||"View on Pinterest"]]],["td",{}]]]:["table",{className:"image-wrapper pinterest-text-wrapper",width:"100%",border:"0",cellSpacing:"0",cellPadding:"0","data-component-name":"PinterestToDOMStatic"},["tr",{},["td",{}],["td",{align:"left",className:"content",width:String(350)},["a",{className:"image-link pinterest-text-link",target:"_blank",href:e},["div",{className:"pinterest-fallback-text",style:"padding: 10px; border: 1px solid #e8e8e8; border-radius: 4px; text-align: center;"},["div",{className:"pinterest-identifier",style:"font-weight: bold; margin-bottom: 5px;"},"Pinterest"],["span",{style:"display: block;"},["a",{href:t.attrs.url||"#",target:"_blank",style:"color: inherit; text-decoration: none;"},t.attrs.title||"View on Pinterest"]],t.attrs.author_name?["span",{className:"pinterest-author",style:"display: block; margin-top: 8px; font-size: 0.9em; color: #666;"},"By ".concat(t.attrs.author_name)]:null]]],["td",{}]]]},v=t=>{if("undefined"!=typeof window)try{let e=document.createElement("div");return e.setAttribute("data-attrs",JSON.stringify(t.attrs)),e.className=c,e.setAttribute("data-component-name","PinterestNodeWrapper"),(0,l.G5)((0,n.h)(r.M,{attrs:t.attrs}),e),e}catch(e){return console.error("Error rendering PinterestNode:",e),(0,o.s)({msg:"Error rendering Pinterest embed",node:t,err:e,group:"block"})}let e=document.createElement("div");e.className="".concat(c," pinterest-ssr-fallback"),e.setAttribute("data-attrs",JSON.stringify(t.attrs)),e.setAttribute("data-component-name","PinterestToDOMPreact");let a=document.createElement("p");return a.textContent="Loading Pinterest Pin...",e.appendChild(a),e}},18119:function(t,e,a){a.d(e,{$:()=>u,x:()=>m});var n=a(7409),r=a(6400),l=a(78435),i=a(10656),o=a(19520),s=a(30548),d=a(30837);let c="poll-embed",u={attrs:{id:{default:null}},group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:c,getAttrs:d.Y}],toDOM:t=>{if("undefined"!=typeof window)try{let e=document.createElement("div");return e.setAttribute("data-attrs",JSON.stringify(t.attrs)),e.className=c,(0,i.G5)((0,r.h)(l.n_,{id:t.attrs.id,isEditor:!0}),e),e}catch(e){return console.error("Error rendering Poll",e),(0,o.s)({msg:null,node:t,err:e,group:"block"})}return["div",{class:c,"data-attrs":JSON.stringify(t.attrs),"data-component-name":"PollToDOM"}]},toDOMStatic:t=>["div",{class:c,"data-attrs":JSON.stringify((0,n._)({isEmail:!0},t.attrs)),"data-component-name":"PollToDOMStatic"}]},m=(0,s.S)({name:"poll",nodeSpec:u,addCommands(){return{insertPoll:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}})},44288:function(t,e,a){a.d(e,{$y:()=>i,Gd:()=>c,OR:()=>s,eC:()=>b,kY:()=>o,sv:()=>m});var n=a(27412),r=a(60308),l=a(30548);let i={attrs:{url:{default:""},thumbnail_url:{default:""}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDom:[{tag:"div.prediction-market-wrap",getAttrs:a(30837).Y}],toDOM:t=>g(t),toDOMStatic:t=>p(t)},o=(0,l.S)({name:"prediction_market",nodeSpec:i,addCommands(){return{insertPredictionMarket:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),s=(0,l.S)({name:"manifold",nodeSpec:i}),d=/^.*(https?:\/\/(\S+)?(?:(.?manifold\.markets|metaculus\.com\/questions\/.*\/|polymarket\.com\/event\/[^\/]+(\/[^\/]+)?))).*$/,c=t=>{let e=d.exec(t);return e&&e[0]},u=async t=>{let e=(await Promise.resolve().then(a.t.bind(a,80569,23))).default;return(await e.get("/api/v1/prediction-embed").query({url:t.trim()})).body},m=async function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(e?{schema:e}:await Promise.resolve().then(a.bind(a,37175))).schema.nodes.prediction_market.create(await u(t))},p=function(t){let{}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=document.createElement("div");e.className="prediction-market-wrap static",e.setAttribute("data-component-name","PredictionMarketToDOMStatic");let a=document.createElement("a");a.href=t.attrs.url.replace(/embed\//,""),a.setAttribute("target","_blank");let n=document.createElement("img");return n.className="prediction-market thumbnail",n.src=(0,r.zF4)(t.attrs.thumbnail_url,640),n.style.backgroundImage="url(".concat(t.attrs.thumbnail_url,")"),t.attrs.belowTheFold&&n.setAttribute("loading","lazy"),a.append(n),e.appendChild(a),e},g=t=>{let e=document.createElement("div"),a=t.attrs.url.includes("polymarket");e.id="prediction-market-iframe",e.className="prediction-market-wrap outer",e.dataset.attrs=JSON.stringify(t.attrs),e.setAttribute("data-component-name","PredictionMarketToDOM");let n=document.createElement("iframe");return n.id="iframe-prediction-market",n.className="prediction-market-iframe",n.src=t.attrs.url,n.width=a?"400px":"560px",n.height=a?"180px":"405px",n.frameBorder="0",t.attrs.belowTheFold&&n.setAttribute("loading","lazy"),e.appendChild(n),e};class b{constructor(t){(0,n._)(this,"dom",void 0);let e=g(t),a=e.querySelector(".prediction-market-iframe"),r=document.createElement("div");r.className="prediction-market-screen",r.addEventListener("dblclick",()=>{r.classList.add("sunken"),a.focus()}),a.addEventListener("blur",()=>{r.classList.remove("sunken")}),e.appendChild(r),this.dom=e}}},13938:function(t,e,a){a.d(e,{$:()=>r,T:()=>l});var n=a(30548);let r={content:"text*",group:"block",code:!0,defining:!0,isolating:!0,attrs:{params:{default:""},language:{default:"en"}},parseDOM:[{tag:"pre.text",preserveWhitespace:"full",priority:60}],toDOM:()=>{var t,e,a;let{iString:n}=I18N.i("undefined"!=typeof window&&null!==(a=null===(e=window._preloads)||void 0===e?void 0:null===(t=e.pub)||void 0===t?void 0:t.language)&&void 0!==a?a:"en");return["div",{class:"preformatted-block","data-component-name":"PreformattedTextBlockToDOM"},["label",{class:"hide-text",contenteditable:!1},n("Text within this block will maintain its original spacing when published")],["pre",{class:"text"},0]]},toDOMStatic:()=>["pre",{class:"text","data-component-name":"PreformattedTextBlockToDOMStatic"},0]},l=(0,n.S)({name:"preformatted_text_block",nodeSpec:r})},54757:function(t,e,a){a.d(e,{$:()=>l,t:()=>i});var n=a(60308),r=a(30548);let l={attrs:{pub:{default:null},uuid:{default:null}},inline:!1,atom:!0,group:"block",draggable:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.install-substack-app-embed.preview-inapp"}],toDOM:t=>{let{pub:e,uuid:a}=t.attrs,{iString:r}=I18N.i({pub:e}),l="object"==typeof e?(0,n.SVA)(e):(0,n.SVA)({id:e}),i=e.logo_url||"".concat(l,"/img/substack.png");return["div",{class:"install-substack-app-embed preview-inapp","data-component-name":"PreviewInSubstackAppToDOM"},["img",{class:"install-substack-app-embed-img",src:(0,n.zF4)(i)}],["div",{class:"install-substack-app-embed-text"},["div",{class:"install-substack-app-header"},r("Test in the Substack app")],["div",{class:"install-substack-app-text"},r("This section is only visible to you")]],["a",{href:(0,n.uyd)(e,a),target:"_blank",class:"install-substack-app-embed-link"},["button",{class:"install-substack-app-embed-btn button primary"},r("Open in app")]]]},toDOMStatic:t=>{let{pub:e,uuid:a}=t.attrs,{iString:r}=I18N.i({pub:e}),l="object"==typeof e?(0,n.SVA)(e):(0,n.SVA)({id:e}),i=e.logo_url||"".concat(l,"/img/substack.png");return["div",{class:"install-substack-app-embed preview-inapp","data-component-name":"PreviewInSubstackAppToDOMStatic"},["table",{class:"install-substack-embed-table"},["tr",{},["td",{rowspan:2},["img",{class:"install-substack-app-embed-img",src:(0,n.zF4)(i),width:64,height:64}]],["td",{class:"install-substack-app-header"},r("Test in the Substack app")]],["tr",{},["td",{class:"install-substack-app-text"},r("This section is only visible to you")]],["tr",{},["td",{colspan:2},["a",{href:(0,n.uyd)(e,a),target:"_blank",class:"install-substack-app-embed-link"},["button",{class:"install-substack-app-embed-btn button primary"},r("Open in app")]]]]]]}},i=(0,r.S)({name:"preview_in_substack_app",nodeSpec:l})},11006:function(t,e,a){a.d(e,{$:()=>o,z:()=>s});var n=a(7409),r=a(99282),l=a(88897),i=a(55679);let o={attrs:{align:{default:null},color:{default:null}},content:"block+",group:"block",defining:!0,parseDOM:[{tag:"q"},{tag:"div.pullquote"}],toDOM:t=>{let e=["pullquote"];return"wide"===t.attrs.align&&e.push("pullquote-align-wide"),"left"===t.attrs.align&&e.push("pullquote-align-left"),"right"===t.attrs.align&&e.push("pullquote-align-right"),"center"===t.attrs.align&&e.push("pullquote-align-center"),t.attrs.color&&e.push("pullquote-color-".concat(t.attrs.color)),["div",{class:e.join(" ")},0]},toDOMStatic:t=>["div",{class:"pullquote"},0]},s=l.NB.create({name:"pullquote",defining:!0,content:o.content,group:o.group,addAttributes:()=>({align:{default:null},color:{default:null}}),renderHTML:t=>o.toDOM(t.node),parseHTML:()=>o.parseDOM,addNodeView(){let{PullquoteEditor:t}=a(53568);return(0,i.fW)(t)},addCommands(){let t=(t,e)=>a=>{let{state:l,dispatch:i}=a,{from:o,to:s}=l.selection,{pullquote:d}=l.schema.nodes,c=null,u=null;if(l.doc.nodesBetween(o,s,(t,e)=>{if(t.type===d)return c=t,u=e,!1}),!c||null===u)return!1;if(i){let a=l.tr,o=c.attrs;a.setNodeMarkup(u,void 0,(0,r._)((0,n._)({},o),{[t]:e})),i(a)}return!0};return{setPullquote:()=>t=>{let{state:e,commands:a}=t;return!(!(0,l.Ig)(e,"paragraph")||(0,l.Ig)(e,"blockquote")||(0,l.Ig)(e,"calloutBlock"))&&a.wrapIn(this.name)},togglePullquote:()=>t=>{let{state:e,commands:a}=t;return!(!(0,l.Ig)(e,"paragraph")||(0,l.Ig)(e,"blockquote")||(0,l.Ig)(e,"calloutBlock"))&&a.toggleWrap(this.name)},unsetPullquote:()=>t=>{let{commands:e}=t;return e.lift(this.name)},setPullquoteAlign:e=>t("align",e),setPullquoteColor:e=>t("color",e)}}})},11470:function(t,e,a){a.d(e,{$:()=>g,v:()=>b});var n=a(7409),r=a(6400),l=a(88897),i=a(55679),o=a(42224),s=a(10656),d=a(8072),c=a(19520),u=a(30548),m=a(30837);let p="recipe-embed",g={attrs:{id:{default:null}},group:"block",draggable:!1,atom:!1,selectable:!1,isolating:!1,defining:!1,parseDOM:[{tag:p,getAttrs:m.Y}],toDOM:t=>{if("undefined"!=typeof window)try{let e=document.createElement("div");return e.setAttribute("data-attrs",JSON.stringify(t.attrs)),e.setAttribute("data-component-name","RecipeToDOM"),e.className=p,(0,s.G5)((0,r.h)(o.k,{node:{attrs:{id:t.attrs.id}}}),e),e}catch(e){return console.error("Error rendering RecipeNode",e),(0,c.s)({msg:null,node:t,err:e,group:"block"})}return["div",{class:p,"data-attrs":JSON.stringify(t.attrs),"data-component-name":"RecipeToDOM"}]},toDOMStatic:t=>["div",{class:p,"data-attrs":JSON.stringify((0,n._)({isEmail:!0},t.attrs)),"data-component-name":"RecipeToDomStatic"}],renderHTML(t){let{HTMLAttributes:e}=t;return["recipe",(0,l.P1)(this.options.HTMLAttributes,e)]},parseHTML:()=>[{tag:"recipe"}],addNodeView:()=>(0,i.fW)(d.C)},b=(0,u.S)({name:"recipe",nodeSpec:g,addCommands(){return{insertRecipe:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}})},66928:function(t,e,a){a.d(e,{$:()=>l,b:()=>i});var n=a(60826),r=a(30548);let l={attrs:{name:{default:null},subdomain:{default:""}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.referral-link",getAttrs:a(30837).Y}],toDOM:t=>{let e=t.attrs.name||"".concat(t.attrs.subdomain,".substack.com"),a=document.createElement("div");a.className="referral-link",a.setAttribute("data-attrs",JSON.stringify(t.attrs)),a.setAttribute("data-component-name","ReferralLinkToDOM");let r=document.createElement("h4");a.appendChild(r);let l=document.createElement("a");l.textContent=n.W.PRINTED_REFERRAL_URL,l.href="http://".concat(n.W.REFERRAL_URL),r.appendChild(l),l.addEventListener("click",t=>{if(l.href.endsWith("%%")){t.preventDefault();let e=window.open("/?referral_code=test&showWelcome=true","_blank");e&&e.focus&&e.focus()}});let i=document.createElement("a");return i.className="button primary",i.textContent="Share your referral link",i.href="mailto:?subject=".concat(encodeURIComponent("Check out ".concat(e)),"&body=").concat(encodeURIComponent("Subscribe using my link: "),"http://").concat(n.W.REFERRAL_URL),a.appendChild(i),a}},i=(0,r.S)({name:"referral_link",nodeSpec:l})},19805:function(t,e,a){a.d(e,{$y:()=>d,ym:()=>c});var n=a(7409),r=a(6400),l=a(84881),i=a(10656),o=a(19520),s=a(30548);let d={attrs:{isEditorNode:{default:!1},numReferralsRequired:{default:null},rewardDescription:{default:null},pub:{default:{}},tierNumber:{default:null}},atom:!0,content:"",isolating:!1,defining:!1,group:"block",parseDOM:[{getAttrs:a(30837).Y,tag:".referrals-tier-card"}],toDOM:t=>{if("undefined"!=typeof window)try{let e=document.createElement("div");return e.className="referrals-tier-card",e.setAttribute("data-attrs",JSON.stringify(t.attrs)),(0,i.G5)((0,r.h)(l.y,{numReferralsRequired:t.attrs.numReferralsRequired,rewardDescription:t.attrs.rewardDescription,pub:m(t.attrs.pub),tierNumber:t.attrs.tierNumber}),e),e}catch(e){return console.error("Error rendering ReferralsTierCardComponent",e),(0,o.s)({msg:null,node:t,err:e,group:"block"})}return u(t)},toDOMStatic:t=>u(t)},c=(0,s.S)({name:"referralTier",nodeSpec:d}),u=t=>["div",{class:"referrals-tier-card","data-attrs":JSON.stringify(t.attrs),"data-component-name":"ReferralsTierCardPlaceholder"}],m=t=>{let e=(0,n._)({},t);return delete e.email_render_elements,e}},46393:function(t,e,a){a.d(e,{$y:()=>o,SH:()=>d,kb:()=>u,uJ:()=>s});var n=a(7409),r=a(60308),l=a(15233),i=a(30548);let o={attrs:{url:{default:""},title:{default:""},description:{default:""},thumbnail_url:{default:""},author_name:{default:""},author_url:{default:""},targetUrl:{default:""}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.soundcloud-wrap",getAttrs:a(30837).Y}],toDOM:t=>["div",{class:"soundcloud-wrap","data-attrs":JSON.stringify(t.attrs),"data-component-name":"SoundcloudToDOM"},["iframe",{src:(0,r.rhs)("https://w.soundcloud.com/player/?auto_play=false&buying=false&liking=false&download=false&sharing=false&show_artwork=true&show_comments=false&show_playcount=false&show_user=true&hide_related=true&visual=false&start_track=0",{url:t.attrs.url}),frameborder:"0",gesture:"media",scrolling:"no",allowfullscreen:"true"}]],toDOMStatic:t=>{let{thumbnail_url:e,author_name:a,title:n,targetUrl:r}=t.attrs;return(0,l.L)(e,n,a,null,{targetUrl:r})}},s=(0,i.S)({name:"soundcloud",nodeSpec:o,addCommands(){return{insertSoundcloud:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),d=function(t){var e;let{customSchema:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(a&&!a.nodes.soundcloud)return null;let n=/^.*(https?\:\/\/(www\.)?soundcloud.com\/[^\/]+\/[^\/]+(\/[^\/]+)?(\?[\#]*)?(\#.*)?).*$/.exec(t);return null!==(e=n&&n[1])&&void 0!==e?e:null},c=async t=>{let e=(await Promise.resolve().then(a.t.bind(a,80569,23))).default,r=(await e.get("/api/v1/soundcloud").query({url:t.trim()})).body;return(0,n._)({targetUrl:t.trim()},r)},u=async function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(e?{schema:e}:await Promise.resolve().then(a.bind(a,37175))).schema.nodes.soundcloud.create(await c(t))}},2107:function(t,e,a){a.d(e,{$:()=>u,a:()=>m});var n=a(7409),r=a(6400),l=a(13693),i=a(10656),o=a(19520),s=a(30548),d=a(30837);let c="sponsorship-campaign-embed",u={attrs:{id:{default:null},pub:{default:null}},group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:c,getAttrs:d.Y}],toDOM:t=>{if("undefined"!=typeof window){var e;let a=null===(e=window._preloads)||void 0===e?void 0:e.pub,n=null==a?void 0:a.sponsorshipCampaigns;if(!n)return["div",{class:c,"data-attrs":JSON.stringify(t.attrs),"data-component-name":"SponsorshipCampaignToDOM",text:"Sponsorship campaign not found"}];let s=n[t.attrs.id];if(!s)return["div",{class:c,"data-attrs":JSON.stringify(t.attrs),"data-component-name":"SponsorshipCampaignToDOM",text:"Sponsorship campaign not found"}];try{let e=document.createElement("div");return e.setAttribute("data-attrs",JSON.stringify(t.attrs)),e.className=c,(0,i.G5)((0,r.h)(l.VR,{campaign:s,isEditor:!0,pub:a}),e),e}catch(e){return console.error("Error rendering SponsorshipCampaign",e),(0,o.s)({msg:null,node:t,err:e,group:"block"})}}return["div",{class:c,"data-attrs":JSON.stringify(t.attrs),"data-component-name":"SponsorshipCampaignToDOM"}]},toDOMStatic:t=>["div",{class:c,"data-attrs":JSON.stringify((0,n._)({isEmail:!0},t.attrs)),"data-component-name":"SponsorshipCampaignToDOMStatic"}]},m=(0,s.S)({name:"sponsorshipCampaign",nodeSpec:u,addCommands(){return{insertSponsorshipCampaign:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}})},99149:function(t,e,a){a.d(e,{$:()=>l,H:()=>i});var n=a(60308),r=a(30548);let l={attrs:{image:{default:""},title:{default:""},subtitle:{default:""},description:{default:""},url:{default:""}},inline:!0,group:"inline",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,toDOM:t=>["iframe",{class:"spotify-wrap","data-attrs":JSON.stringify(t.attrs),src:"https://open.spotify.com/embed?uri=".concat(encodeURIComponent(t.attrs.url),"&view=coverart&theme=white"),frameborder:"0",gesture:"media",allowfullscreen:"true","data-component-name":"SpotifyToDOM"}],toDOMStatic:t=>["a",{class:"spotify-wrap",href:t.attrs.url,"data-component-name":"SpotifyToDOMStatic"},["img",{class:"cover",src:(0,n.zF4)("/img/spotify_play.png?v=1",156),style:"background-image:url(".concat(t.attrs.image,")")}],["span",{class:"content"},["img",{class:"logo",src:(0,n.zF4)("/img/spotify_logo.png",40)}],["span",{class:"title"},t.attrs.title],["span",{class:"subtitle"},t.attrs.subtitle],["span",{class:"description"},t.attrs.description]]]},i=(0,r.S)({name:"spotify",nodeSpec:l})},79592:function(t,e,a){a.d(e,{$y:()=>l,JV:()=>i,W7:()=>d,qZ:()=>o});var n=a(15233),r=a(30548);let l={attrs:{image:{default:""},title:{default:""},subtitle:{default:""},description:{default:""},url:{default:""},belowTheFold:{default:!1},noScroll:{default:!1}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"iframe.spotify-wrap",getAttrs:a(30837).Y}],toDOM:t=>{let e="spotify-wrap",a=c(t.attrs.url).params;return(null==a?void 0:a.show)||(null==a?void 0:a.episode)?e+=" podcast":(null==a?void 0:a.playlist)?e+=" playlist":(null==a?void 0:a.album)?e+=" album":(null==a?void 0:a.artist)&&(e+=" artist"),["iframe",{class:e,"data-attrs":JSON.stringify(t.attrs),src:u(t.attrs.url),frameborder:"0",gesture:"media",allowfullscreen:"true",allow:"encrypted-media",loading:t.attrs.belowTheFold?"lazy":null,"data-component-name":"Spotify2ToDOM",scrolling:t.attrs.noScroll?"no":null}]},toDOMStatic:t=>{let{image:e,title:a,subtitle:r,description:l,url:i}=t.attrs;return(0,n.L)(e,a,r,l,{targetUrl:i})}},i=(0,r.S)({name:"spotify2",nodeSpec:l,addCommands(){return{insertSpotify:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),o=function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e&&!e.nodes.spotify2?null:c(t).url},s=async t=>{let e=(await Promise.resolve().then(a.t.bind(a,80569,23))).default;return(await e.get("/api/v1/spotify").query({url:t})).body},d=async(t,e)=>{let{customSchema:a}=e;return a.nodes.spotify2.create(await s(t))},c=t=>{var e,a,n,r;if(null==t?void 0:t.includes("anchor.fm")){let n=/((?:https?:\/\/(?:www\.)?anchor\.fm\/(?:embed\/)?|anchor:)([^"'\s\b?#()]*))/.exec(t);if(n)return{params:{show:"podcast"},url:null!==(e=n[1])&&void 0!==e?e:null,base:null!==(a=n[2])&&void 0!==a?a:null,platform:"anchor"}}let l=/((?:https?:\/\/(open|podcasters)\.spotify\.com\/(?:embed\/)?|spotify:)([^"'\s\b?#()]*)(?:[?#][\S]*)?)/.exec(t);if(!l)return{params:null,url:null,base:null,platform:null};let i=l[3].split(/[/:]/),o={};for(let t=1;t<i.length;t+=2)o[i[t-1]]=i[t];return{params:o,url:null!==(n=l[1])&&void 0!==n?n:null,base:null!==(r=l[2])&&void 0!==r?r:null,platform:"spotify"}},u=t=>{let{params:e,base:a,platform:n}=c(t),r=[];if(e){if("anchor"===n)return"https://anchor.fm/".concat(a);if("open"===a)e.user&&e.playlist?r.push("user",e.user,"playlist",e.playlist):e.playlist?r.push("playlist",e.playlist):e.album?r.push("album",e.album):e.track?r.push("track",e.track):e.artist?r.push("artist",e.artist):e.show?r.push("show",e.show):e.pod?r.push("pod",e.pod):(e.episode||e.episodes)&&r.push("episode",e.episode||e.episodes);else for(let[t,a]of Object.entries(e))a&&(r.push(t),r.push(a));return"https://".concat(a,".spotify.com/").concat("open"===a?"embed":"","/").concat(r.join("/"))}}},39111:function(t,e,a){a.d(e,{$:()=>l,K:()=>i});var n=a(95068),r=a(30548);let l={content:"ctaCaption",attrs:{url:{default:null},text:{default:null},language:{default:"en"}},inline:!1,group:"block",draggable:!0,atom:!1,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.subscription-widget-wrap",getAttrs:a(30837).Y}],toDOM:t=>{let{text:e,language:a}=t.attrs,{iString:n}=I18N.i(a);return["div",{class:"subscription-widget-wrap-editor","data-attrs":JSON.stringify(t.attrs),"data-component-name":"SubscribeWidgetToDOM"},["div",{class:"subscription-widget show-subscribe"},["div",{class:"preamble"},0],["form",{class:"subscription-widget-subscribe"},["input",{type:"email",class:"email-input",name:"email",placeholder:n("Type your email…"),tabindex:-1}],["input",{type:"submit",class:"button primary",value:e}],["div",{class:"fake-input-wrapper"},["div",{class:"fake-input"}],["div",{class:"fake-button"}]]]]]},toDOMStatic:t=>["div",{class:"subscription-widget-wrap","data-component-name":"SubscribeWidgetToDOMStatic"},["div",{class:"subscription-widget show-subscribe"},["div",{class:"preamble"},0],(0,n.ax)(t)]]},i=(0,r.S)({name:"subscribeWidget",nodeSpec:l,addCommands(){return{insertSubscribeWidget:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}})},57950:function(t,e,a){a.d(e,{$:()=>r,Z:()=>l});var n=a(30548);let r={content:"block+",group:"block",defining:!1,isolating:!1,attrs:{params:{default:""}},parseDOM:[{tag:"pre.template-comment"}],toDOM:()=>["pre",{class:"template-comment","data-component-name":"TemplateCommentToDOM"},["code",0]]},l=(0,n.S)({name:"templateComment",nodeSpec:r})},78483:function(t,e,a){a.d(e,{$y:()=>o,Ml:()=>m,QZ:()=>h,du:()=>s,od:()=>c});var n=a(27412),r=a(60826),l=a(60308),i=a(30548);let o={attrs:{url:{default:""},title:{default:""},thumbnail_url:{default:""},author:{default:""},embed_url:{default:""},author_url:{default:""},belowTheFold:{default:!1}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDom:[{tag:"div.tiktok-wrap",getAttrs:a(30837).Y}],toDOM:t=>b(t),toDOMStatic:t=>g(t)},s=(0,i.S)({name:"tiktok",nodeSpec:o,addCommands(){return{insertTiktok:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),d=/^.*(https?\:\/\/(\S+)?(?:vt.tiktok.com\/|(.?tiktok.com\/.*\/video\/).*)).*$/,c=t=>{let e=d.exec(t);return e&&e[0]},u=async t=>{let e=(await Promise.resolve().then(a.t.bind(a,80569,23))).default;return(await e.get("/api/v1/tiktok").query({url:t.trim()})).body},m=async function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(e?{schema:e}:await Promise.resolve().then(a.bind(a,37175))).schema.nodes.tiktok.create(await u(t))},p=t=>"tiktok-".concat(null==t?void 0:t.split("/").slice(-1)[0]),g=function(t){var e,a,n,i;let{useTikTokUrl:o=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=document.createElement("div");s.className="tiktok-wrap static",s.setAttribute("data-component-name","TikTokCreateStaticTikTokEmbed");let d="".concat(o?t.attrs.url:"".concat(r.W.POST_URL,"/#tiktok-").concat(null===(e=t.attrs.embed_url)||void 0===e?void 0:e.split("/").slice(-1)[0])),c=document.createElement("a");c.href=d,c.setAttribute("target","_blank");let u=document.createElement("img");u.className="tiktok thumbnail",u.src=(0,l.zF4)(t.attrs.thumbnail_url,640),u.style.backgroundImage="url(".concat((0,l.zF4)(t.attrs.thumbnail_url),")"),t.attrs.belowTheFold&&u.setAttribute("loading","lazy"),c.append(u);let m=document.createElement("div");m.classList.add("content");let p=document.createElement("a");p.classList.add("author"),p.href=t.attrs.author_url,p.setAttribute("target","_blank"),p.appendChild(document.createTextNode((null===(i=t.attrs.author_url)||void 0===i?void 0:null===(n=i.split)||void 0===n?void 0:null===(a=n.call(i,"/").slice(-1))||void 0===a?void 0:a[0])||t.attrs.author));let g=document.createElement("a");return g.classList.add("title"),g.href=d,g.setAttribute("target","_blank"),g.appendChild(document.createTextNode(t.attrs.title)),m.appendChild(p),m.appendChild(g),s.appendChild(c),s.appendChild(m),s},b=t=>{var e;let a=t.attrs.embed_url,n=document.createElement("div");n.id=p(a),n.className="tiktok-wrap outer",n.dataset.attrs=JSON.stringify(t.attrs),n.setAttribute("data-component-name","TikTokCreateTikTokEmbed");let r=document.createElement("iframe");r.id="iframe-".concat(p(a)),r.className="tiktok-iframe",r.src=a,r.frameBorder="0",null===(e=r.setAttribute)||void 0===e||e.call(r,"allow","autoplay; fullscreen; encrypted-media"),r.allowFullscreen="true",r.allowautoplay="true",r.allowfullscreen="true",r.scrolling="no",t.attrs.belowTheFold&&r.setAttribute("loading","lazy"),n.appendChild(r);let i=document.createElement("iframe");i.src="https://team-hosted-public.s3.amazonaws.com/set-then-check-cookie.html",i.id="third-party-iframe-".concat(p(a)),i.className="third-party-cookie-check-iframe",i.style.display="none",t.attrs.belowTheFold&&i.setAttribute("loading","lazy"),n.append(i);let o=g(t,{useTikTokUrl:!0});n.appendChild(o);let s=document.createElement("div");s.classList.add("fallback-failure"),s.id="fallback-failure-".concat(p(a));let d=document.createElement("div");d.classList.add("error-content");let c=document.createElement("img");return c.classList.add("error-icon"),c.src=(0,l.aR6)("/img/alert-circle.svg"),t.attrs.belowTheFold&&c.setAttribute("loading","lazy"),d.appendChild(c),d.appendChild(document.createTextNode("Tiktok failed to load.")),d.appendChild(document.createElement("br")),d.appendChild(document.createElement("br")),d.appendChild(document.createTextNode("Enable 3rd party cookies or use another browser")),s.appendChild(d),n.appendChild(s),n};class h{constructor(t){(0,n._)(this,"dom",void 0);let e=b(t),a=e.querySelector(".tiktok-iframe"),r=document.createElement("div");r.className="tiktok-screen";let l=document.createElement("h1");l.className="instructions",l.innerText="Double click to interact",r.appendChild(l),r.addEventListener("dblclick",()=>{r.classList.add("sunken"),a.focus()}),a.addEventListener("blur",()=>{r.classList.remove("sunken")}),e.appendChild(r),this.dom=e}}},57881:function(t,e,a){a.d(e,{$:()=>s,h:()=>d});var n=a(91036),r=a.n(n),l=a(90406),i=a(63651),o=a(30548);let s={attrs:{url:{default:""},html:{default:""},author:{default:""},author_name:{default:""},date:{default:""}},untrackedAttrs:["html"],inline:!0,group:"inline",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.tweet",getAttrs:function(t){try{let e=JSON.parse(t.getAttribute("data-attrs"));if("url"in e&&"html"in e&&"author"in e&&"author_name"in e&&"date"in e)return e;return!1}catch(t){return!1}}}],toDOM:t=>{let e=document.createElement("div");e.className="tweet",e.setAttribute("data-component-name","TwitterToDOM"),e.setAttribute("data-attrs",JSON.stringify(t.attrs)),e.innerHTML=r()(t.attrs.html,{allowedTags:r().defaults.allowedTags.concat(["img"]),allowedAttributes:Object.assign({},r().defaults.allowedAttributes,{"*":["href","style","id","data-*","itemprop","class","align","alt","center","bgcolor"]})});let a=document.createElement("a");a.className="tweet-header",a.href="https://twitter.com/".concat(t.attrs.author),e.insertBefore(a,e.childNodes[0]);let n=document.createElement("img");n.src="".concat(i.L4R,"/image/twitter_name/w_").concat(l.yK,"/").concat(t.attrs.author,".jpg"),a.appendChild(n);let o=document.createElement("span");o.className="tweet-author-name",o.textContent=t.attrs.author_name,a.appendChild(o);let s=document.createElement("span");s.className="tweet-author",s.textContent="@".concat(t.attrs.author),a.appendChild(s);let d=document.createElement("a");return d.className="tweet-date",d.textContent=t.attrs.date,d.href=t.attrs.url,e.appendChild(d),e.querySelectorAll&&Array.prototype.forEach.call(e.querySelectorAll("a"),t=>{t.target="_blank"}),e}},d=(0,o.S)({name:"twitter",nodeSpec:s})},84766:function(t,e,a){a.d(e,{$y:()=>c,HU:()=>u,Pz:()=>m,qK:()=>g});var n=a(91036),r=a.n(n),l=a(90406),i=a(98012),o=a(63651),s=a(84864),d=a(30548);let c={attrs:{url:{default:""},full_text:{default:""},username:{default:""},name:{default:""},date:{default:""},photos:{default:[]},quoted_tweet:{default:{}},retweet_count:{default:0},like_count:{default:0},expanded_url:{default:null},video_url:{default:null},belowTheFold:{default:!1}},untrackedAttrs:["full_text","photos","quoted_tweet","expanded_url"],inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.tweet",getAttrs:a(30837).Y}],toDOMStatic:t=>f(t,!0),toDOM:t=>f(t,!1)},u=(0,d.S)({name:"twitter2",nodeSpec:c,addCommands(){return{insertTwitter:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),m=function(t){var e;let{customSchema:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(a&&!a.nodes.twitter2)return null;let n=/(https?:\/\/(mobile\.twitter\.com|twitter\.com|t\.co)\/.*\/status\/[^\/\s]*)/.exec(t);return null!==(e=n&&n[1])&&void 0!==e?e:null},p=async t=>{let e=(await Promise.resolve().then(a.t.bind(a,80569,23))).default;return(await e.get("/api/v1/tweet").query({url:t})).body},g=async function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(e?{schema:e}:await Promise.resolve().then(a.bind(a,37175))).schema.nodes.twitter2.create(await p(t))};function b(t,e){let{additionalClasses:a=[],belowTheFold:n=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=document.createElement("div");r.className="tweet-photo-wrapper ".concat(a.join(" "));let l=document.createElement("img");if(l.className="tweet-photo",l.setAttribute("src",(0,o.zF4)(t.img_url,600)),l.setAttribute("alt",t.alt_text||"Image"),n&&l.setAttribute("loading","lazy"),e)r.appendChild(l);else{let e=document.createElement("picture"),a=document.createElement("source");a.setAttribute("type","image/webp"),a.setAttribute("srcset",(0,o.zF4)(t.img_url,600,{format:"webp"})),e.appendChild(a),e.appendChild(l),r.appendChild(e)}return r}let h=function(t,e){let{belowTheFold:a=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=document.createElement("div");if(n.className="tweet-photos-container",1===t.length)n.appendChild(b(t[0],e,{belowTheFold:a})),n.className+=" one";else if(2===t.length)for(let r of(n.className+=" two",t)){let t=document.createElement("div");t.className="tweet-photos-column",t.appendChild(b(r,e,{belowTheFold:a})),n.appendChild(t)}else{let r=[document.createElement("div"),document.createElement("div")];if(r.forEach(t=>{n.appendChild(t),t.className="tweet-photos-column"}),3===t.length)for(let l of(n.className+=" three",r[0].appendChild(b(t[0],e,{belowTheFold:a})),t.slice(1)))r[1].appendChild(b(l,e,{additionalClasses:["half-height-container"],belowTheFold:a}));else n.className+=" four",t.slice(0,4).forEach((t,n)=>{r[n%2].appendChild(b(t,e,{additionalClasses:["half-height-container"],belowTheFold:a}))})}return n};function f(t,e){var a;let n=document.createElement("div"),d=e?"Twitter2ToDOMStatic":"Twitter2ToDOM";n.setAttribute("data-component-name",d),n.className="".concat(e?"tweet static":"tweet"),e||n.setAttribute("data-attrs",JSON.stringify(t.attrs));let c=document.createElement("a"),u=document.createElement("a");c.className="tweet-link-top",u.className="tweet-link-bottom",c.setAttribute("href",t.attrs.url),u.setAttribute("href",t.attrs.url);let m=document.createElement("div");if(m.className="tweet-text",c.setAttribute("target","_blank"),u.setAttribute("target","_blank"),m.innerHTML=r()(t.attrs.full_text,{allowedTags:r().defaults.allowedTags.concat(["img"]),allowedAttributes:Object.assign({},r().defaults.allowedAttributes,{"*":["href","style","id","data-*","itemprop","class","align","alt","center","bgcolor"]})}),n.appendChild(c),c.appendChild(m),t.attrs.video_url&&!e){let e=document.createElement("div");e.className="tweet-video-wrapper",n.appendChild(e);let a=document.createElement("video");a.className="tweet-video",a.setAttribute("controls","true"),a.setAttribute("src",(0,o.zF4)(t.attrs.video_url,600)),a.setAttribute("alt","Video"),t.attrs.belowTheFold&&a.setAttribute("loading","lazy"),e.appendChild(a)}else if((null==t?void 0:null===(a=t.attrs)||void 0===a?void 0:a.photos)&&t.attrs.photos.length>0){let a=h(t.attrs.photos,e,{belowTheFold:t.attrs.belowTheFold});c.appendChild(a)}if(t.attrs.quoted_tweet&&t.attrs.quoted_tweet.full_text){let e=document.createElement("div");e.className="quote-tweet",e.innerHTML=r()(t.attrs.quoted_tweet.full_text,{allowedTags:[]});let a=document.createElement("div");a.className="quote-tweet-header";let n=document.createElement("img");n.className="quote-tweet-header-avatar",n.src="".concat(o.L4R,"/image/twitter_name/w_40/").concat(t.attrs.quoted_tweet.username,".jpg"),n.setAttribute("alt","Twitter avatar".concat(t.attrs.quoted_tweet.username?" for @".concat(t.attrs.quoted_tweet.username):"")),t.attrs.belowTheFold&&n.setAttribute("loading","lazy"),a.appendChild(n);let l=document.createElement("div");l.className="quote-tweet-header-text";let i=document.createElement("span");i.className="quote-tweet-name",i.textContent="".concat(t.attrs.quoted_tweet.name||""," "),l.appendChild(i);let s=document.createElement("span");s.className="quote-tweet-username",s.textContent="@".concat(t.attrs.quoted_tweet.username),l.appendChild(s),a.appendChild(l),e.insertBefore(a,e.childNodes[0]),c.appendChild(e)}if(t.attrs.expanded_url&&t.attrs.expanded_url.title){let a=document.createElement("a");if(a.className="expanded-link",a.setAttribute("href",t.attrs.expanded_url.url),t.attrs.expanded_url.image){let e=t.attrs.expanded_url.image.url||t.attrs.expanded_url.image,n=document.createElement("img");n.setAttribute("src",(0,o.zF4)(e,600,{height:314,crop:"fill"})),n.className="expanded-link-img",t.attrs.belowTheFold&&n.setAttribute("loading","lazy"),a.appendChild(n)}let n=document.createElement("div");n.className="expanded-link-bottom";let r=document.createElement("span");r.className="expanded-link-domain",r.textContent=t.attrs.expanded_url.domain,n.appendChild(r);let l=document.createElement("span");l.className="expanded-link-title",l.textContent=(0,s.truncateText)(t.attrs.expanded_url.title,140),n.appendChild(l);let i=document.createElement("span");i.className="expanded-link-description",i.textContent=t.attrs.expanded_url.description?e?t.attrs.expanded_url.description.slice(0,135).concat("..."):t.attrs.expanded_url.description:"",n.appendChild(i),a.appendChild(n),c.appendChild(a)}let p=document.createElement("div");p.className="tweet-header",c.insertBefore(p,c.childNodes[0]);let g=document.createElement("img");g.className="tweet-header-avatar",g.src="".concat(o.L4R,"/image/twitter_name/w_").concat(2*l.yK,"/").concat(t.attrs.username,".jpg"),g.setAttribute("alt","Twitter avatar".concat(t.attrs.username?" for @".concat(t.attrs.username):"")),t.attrs.belowTheFold&&g.setAttribute("loading","lazy"),p.appendChild(g);let b=document.createElement("div");b.className="tweet-header-text",p.appendChild(b);let f=document.createElement("span");f.className="tweet-author-name",f.textContent="".concat(t.attrs.name||""," "),b.appendChild(f);let v=document.createElement("span");v.className="tweet-author-handle",v.textContent="@".concat(t.attrs.username),b.appendChild(v);let y=document.createElement("div");y.className="tweet-footer";let w=document.createElement("span");if(w.className="tweet-date",w.textContent=(0,i.Z)(t.attrs.date).format("h:mm A ∙ MMM D, YYYY"),y.appendChild(w),0!==t.attrs.retweet_count&&0!==t.attrs.like_count){let t=document.createElement("hr");y.appendChild(t)}if(0!==t.attrs.retweet_count&&0!==t.attrs.like_count){let e=document.createElement("div");if(e.className="tweet-ufi",t.attrs.like_count>0){let a=document.createElement("span"),n=document.createElement("span");a.setAttribute("href","".concat(t.attrs.url,"/likes")),a.className="likes",n.className="like-count",n.textContent=t.attrs.like_count.toLocaleString(),a.appendChild(n),a.append(t.attrs.like_count>1?"Likes":"Like"),e.appendChild(a)}if(t.attrs.retweet_count>0){let a=document.createElement("span"),n=document.createElement("span");a.setAttribute("href","".concat(t.attrs.url,"/retweets")),a.className="retweets",n.className="rt-count",n.textContent=t.attrs.retweet_count.toLocaleString(),a.appendChild(n),a.append(t.attrs.retweet_count>1?"Retweets":"Retweet"),e.appendChild(a)}y.appendChild(e)}return u.appendChild(y),n.appendChild(u),c.querySelectorAll&&Array.prototype.forEach.call(c.querySelectorAll("a"),t=>{t.target="_blank"}),u.querySelectorAll&&Array.prototype.forEach.call(u.querySelectorAll("a"),t=>{t.target="_blank"}),n}},60802:function(t,e,a){a.d(e,{$:()=>c,v:()=>u});var n=a(6400),r=a(55679),l=a(84711),i=a(92314),o=a(10656),s=a(19520),d=a(30548);let c={attrs:{mediaUploadId:{default:null},duration:{default:null}},group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,toDOM:t=>{if("undefined"!=typeof window)try{let e=document.createElement("div");e.className="native-video-embed",e.setAttribute("data-attrs",JSON.stringify(t.attrs));let a={mediaUploadId:t.attrs.mediaUploadId,pub:null,post:null,isEditor:!0};return(0,o.G5)((0,n.h)(i.c,a),e),e}catch(e){return console.error("Error rendering VideoEmbedPlayer",e),(0,s.s)({msg:null,node:t,err:e,group:"block"})}return m(t)},toDOMStatic:t=>m(t)},u=(0,d.S)({name:"video",nodeSpec:c,addNodeView:()=>(0,r.fW)(l.d),addCommands(){return{insertVideo:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),m=t=>["div",{class:"native-video-embed","data-component-name":"VideoPlaceholder","data-attrs":JSON.stringify(t.attrs)}]},45913:function(t,e,a){a.d(e,{$y:()=>l,Jn:()=>u,Oy:()=>c,qM:()=>i,vR:()=>s});var n=a(63651),r=a(30548);let l={attrs:{videoId:{default:""},videoKey:{default:""},belowTheFold:{default:!1}},untrackedAttrs:["videoKey"],inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.vimeo-wrap",getAttrs:a(30837).Y}],toDOM:t=>{var e;let a=o(t.attrs.videoId,t.attrs.videoKey);return["div",{id:(e=t.attrs.videoId,"vimeo-".concat(e)),class:"vimeo-wrap","data-attrs":JSON.stringify(t.attrs),"data-component-name":"VimeoToDOM"},["div",{class:"vimeo-inner"},["iframe",{src:a,frameborder:"0",gesture:"media",allow:"autoplay; fullscreen",allowautoplay:"true",allowfullscreen:"true",loading:t.attrs.belowTheFold?"lazy":null}]]]},toDOMStatic:t=>["a",{href:m(t.attrs.videoId,t.attrs.videoKey),target:"_blank",class:"vimeo-wrap","data-component-name":"VimeoToDOMStatic"},["img",{src:u(t.attrs.videoId,{maxWidth:550})}]]},i=(0,r.S)({name:"vimeo",nodeSpec:l,addCommands(){return{insertVimeo:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),o=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return"https://player.vimeo.com/video/".concat(t,"?autoplay=0").concat(e?"&h=".concat(e):"")},s=function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e&&!e.nodes.vimeo?null:p(t)[2]},d=t=>{let[e,a]=p(t);return e?{videoId:e,videoKey:a}:null},c=async(t,e)=>{let{customSchema:a}=e,n=d(t);return n?a.nodes.vimeo.create(n):null},u=function(t){let{maxWidth:e=728,playButton:a=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"".concat(n.L4R,"/image/vimeo/w_").concat(e,",c_limit,d_video_placeholder.png").concat(a?"/l_youtube_play_qyqt8q,w_170":"","/").concat(t)},m=(t,e)=>"https://vimeo.com/".concat(t).concat(e?"/".concat(e):"");function p(t){let e=/(https?:\/\/[^\s]*vimeo.com\/(?:channels\/[^/]+\/|video\/)?(\d+)(\/([0-9a-f]+))?[^\s\"\'"]*)/.exec(t);return e?[e[2],e[4],e[1]]:[null,null,null]}},34612:function(t,e,a){a.d(e,{$:()=>l,O:()=>i});var n=a(30548),r=a(32751);let l={attrs:{videoId:{default:""}},inline:!0,group:"inline",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,toDOM:t=>{let e="https://www.youtube.com/embed/".concat(t.attrs.videoId);return["div",{class:"youtube-wrap","data-component-name":"YoutubeToDOM","data-attrs":JSON.stringify(t.attrs)},["iframe",{src:e,frameborder:"0",gesture:"media",allowfullscreen:"true"}]]},toDOMStatic:t=>["a",{href:"https://www.youtube.com/watch?v=".concat(t.attrs.videoId),target:"_blank",class:"youtube-wrap","data-component-name":"YoutubeToDOMStatic"},["img",{src:(0,r.Jn)(t.attrs.videoId,{maxWidth:550})}]]},i=(0,n.S)({name:"youtube",nodeSpec:l})},32751:function(t,e,a){a.d(e,{$y:()=>o,II:()=>s,Jn:()=>m,dQ:()=>f,gp:()=>d,o1:()=>c});var n=a(27412),r=a(69332),l=a(63651),i=a(30548);let o={attrs:{videoId:{default:""},startTime:{default:null},endTime:{default:null}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.youtube-wrap",getAttrs:a(30837).Y},{tag:"iframe",getAttrs:t=>{try{let e=t.src&&b(t.src)[0];if(e)return{videoId:e};return!1}catch(t){return!1}}},{tag:"object",getAttrs:t=>{try{let e=t.data&&b(t.data)[0];if(e)return{videoId:e};for(let e of t.querySelectorAll("param")){let t=e.value&&b(e.value)[0];if(t)return{videoId:t}}for(let e of t.querySelectorAll("embed")){let t=e.src&&b(e.src)[0];if(t)return{videoId:t}}return!1}catch(t){return!1}}}],toDOM:t=>{let e=g(t.attrs.videoId,{start:t.attrs.startTime,end:t.attrs.endTime});return["div",{id:h(t.attrs.videoId),class:"youtube-wrap","data-attrs":JSON.stringify(t.attrs),"data-component-name":"Youtube2ToDOM"},["div",{class:"youtube-inner"},["iframe",{src:e,frameborder:"0",loading:"lazy",gesture:"media",allow:"autoplay; fullscreen",allowautoplay:"true",allowfullscreen:"true",width:"728",height:"409"}]]]},toDOMStatic:t=>["a",{href:p(t.attrs),target:"_blank",class:"youtube-wrap","data-component-name":"Youtube2ToDOMStatic"},["img",{src:m(t.attrs.videoId,{maxWidth:728})}]]},s=(0,i.S)({name:"youtube2",nodeSpec:o,addCommands(){return{insertYoutube:t=>e=>{let{commands:a}=e;return a.insertContent({type:this.name,attrs:t})}}}}),d=function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e&&!e.nodes.youtube2?null:b(t)[1]},c=async function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(e?{schema:e}:await Promise.resolve().then(a.bind(a,37175))).schema,r=u(t);return r?n.nodes.youtube2?n.nodes.youtube2.create(r):(console.error("Schema does not have a youtube2 node"),null):null},u=t=>{let e=b(t)[0];if(!e)return null;let a=function(t){let e=(0,r.m)(t);return{start:e.start||e.t,end:e.end}}(t);return{videoId:e,startTime:a.start,endTime:a.end}},m=function(t){let{maxWidth:e=728,playButton:a=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"".concat(l.L4R,"/image/youtube/w_").concat(e,",c_limit").concat(a?"/l_youtube_play_qyqt8q,w_120":"","/").concat(t)},p=t=>"https://www.youtube.com/watch?".concat((0,l.Y$Q)({v:t.videoId,start:t.startTime,end:t.endTime})),g=function(t){let{start:e,end:a,enableJsApi:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"https://www.youtube-nocookie.com/embed/".concat(t,"?").concat((0,l.Y$Q)({start:e,end:a,rel:0,autoplay:0,showinfo:0,enablejsapi:+!!n}))},b=t=>{var e,a,n;let l=/(https?\:\/\/(www\.|m\.)?youtube\.com\/(v\/)?watch\?[^\s]+)/.exec(t);if(l){let t=(0,r.m)(l[1]).v||null;if(t)return[t,null!==(e=l[1])&&void 0!==e?e:null]}let i=/(https?:\/\/(?:youtu\.be|www\.youtube\.com\/embed|www\.youtube-nocookie\.com\/embed|www\.youtube\.com\/v|www\.youtube\.com\/shorts|www\.youtube\.com\/live)\/([A-z0-9\-_]+)[^\s]*)/.exec(t);return i?[null!==(a=i[2])&&void 0!==a?a:null,null!==(n=i[1])&&void 0!==n?n:null]:[null,null]};function h(t){return"youtube2-".concat(t)}class f{constructor(t){(0,n._)(this,"dom",void 0);let e=g(t.attrs.videoId,{start:t.attrs.startTime,end:t.attrs.endTime,enableJsApi:!0}),a=document.createElement("div");a.id=h(t.attrs.videoId),a.className="youtube-wrap",a.dataset.attrs=JSON.stringify(t.attrs);let r=document.createElement("div");r.className="youtube-inner",a.appendChild(r);let l=document.createElement("iframe");l.src=e,l.frameBorder="0",l.gesture="media",l.allow="autoplay; fullscreen",l.allowautoplay="true",l.allowFullscreen=!0,l.style.backgroundImage="url(".concat(m(t.attrs.videoId,{maxWidth:728}),")"),r.appendChild(l);let i=document.createElement("div");i.className="youtube-overlay";let o=document.createElement("div");o.className="youtube-instructions",o.innerText="Double click to interact with video",i.appendChild(o),i.addEventListener("dblclick",()=>{i.classList.add("disabled"),l.classList.remove("disabled"),l.focus()}),l.addEventListener("blur",()=>{var t;i.classList.remove("hidden"),i.classList.remove("disabled"),l.classList.add("disabled"),null===(t=l.contentWindow)||void 0===t||t.postMessage(JSON.stringify({event:"command",func:"pauseVideo",args:""}),"*")}),r.appendChild(i),this.dom=a}}}}]);