<!DOCTYPE html>
<!-- saved from url=(0063)https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up -->
<html lang="en" style="background: rgb(255, 255, 255); overflow: hidden; padding-right: 10px;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        
        <meta name="norton-safeweb-site-verification" content="24usqpep0ejc5w6hod3dulxwciwp0djs6c6ufp96av3t4whuxovj72wfkdjxu82yacb7430qjm8adbd5ezlt4592dq4zrvadcn9j9n-0btgdzpiojfzno16-fnsnu7xd">
        
        <link rel="preconnect" href="https://substackcdn.com/">
        

        

        

        <style>
          @layer legacy, tailwind, pencraft;
        </style>

        
        <link rel="preload" as="style" href="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/main.652fdc07fcff20447973.css">
        
        <link rel="preload" as="style" href="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/color_links.c9908948e2f4e05476e6.css">
        
        
        
        <link rel="preload" as="font" href="https://fonts.gstatic.com/s/spectral/v13/rnCr-xNNww_2s0amA9M5knjsS_ul.woff2" crossorigin="">
        

        
            
                <link rel="stylesheet" type="text/css" href="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/994.c495c108.css">
            
                <link rel="stylesheet" type="text/css" href="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/9889.2afca7dd.css">
            
                <link rel="stylesheet" type="text/css" href="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/main.89bb9053.css">
            
                <link rel="stylesheet" type="text/css" href="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/4462.b640f236.css">
            
                <link rel="stylesheet" type="text/css" href="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/1844.a0401b64.css">
            
                <link rel="stylesheet" type="text/css" href="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/2312.4fbe0277.css">
            
                <link rel="stylesheet" type="text/css" href="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/1498.75666004.css">
            
                <link rel="stylesheet" type="text/css" href="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/4327.38ce7d4a.css">
            
                <link rel="stylesheet" type="text/css" href="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/4219.d7899285.css">
            
                <link rel="stylesheet" type="text/css" href="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/9899.3e1ce1c8.css">
            
        

        
        
        
        
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0, viewport-fit=cover">
        <meta name="author" content="Cameron R. Wolfe, Ph.D.">
        <meta property="og:url" content="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up">
        <title>LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D.</title>
        
        <link rel="canonical" href="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up">
        

        

        

        
            
                <link rel="shortcut icon" href="https://substackcdn.com/image/fetch/$s_!gYoe!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F0c6a61df-ab60-4f61-9305-73702e5bd5bd%2Ffavicon.ico">
            
        
            
                <link rel="icon" type="image/png" sizes="16x16" href="https://substackcdn.com/image/fetch/$s_!OZE3!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F0c6a61df-ab60-4f61-9305-73702e5bd5bd%2Ffavicon-16x16.png">
            
        
            
                <link rel="icon" type="image/png" sizes="32x32" href="https://substackcdn.com/image/fetch/$s_!7cb0!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F0c6a61df-ab60-4f61-9305-73702e5bd5bd%2Ffavicon-32x32.png">
            
        
            
                <link rel="icon" type="image/png" sizes="48x48" href="https://substackcdn.com/image/fetch/$s_!_pAz!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F0c6a61df-ab60-4f61-9305-73702e5bd5bd%2Ffavicon-48x48.png">
            
        
            
                <link rel="apple-touch-icon" sizes="57x57" href="https://substackcdn.com/image/fetch/$s_!1S-2!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F0c6a61df-ab60-4f61-9305-73702e5bd5bd%2Fapple-touch-icon-57x57.png">
            
        
            
                <link rel="apple-touch-icon" sizes="60x60" href="https://substackcdn.com/image/fetch/$s_!BBCL!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F0c6a61df-ab60-4f61-9305-73702e5bd5bd%2Fapple-touch-icon-60x60.png">
            
        
            
                <link rel="apple-touch-icon" sizes="72x72" href="https://substackcdn.com/image/fetch/$s_!DTpR!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F0c6a61df-ab60-4f61-9305-73702e5bd5bd%2Fapple-touch-icon-72x72.png">
            
        
            
                <link rel="apple-touch-icon" sizes="76x76" href="https://substackcdn.com/image/fetch/$s_!Qlm9!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F0c6a61df-ab60-4f61-9305-73702e5bd5bd%2Fapple-touch-icon-76x76.png">
            
        
            
                <link rel="apple-touch-icon" sizes="114x114" href="https://substackcdn.com/image/fetch/$s_!Mkzu!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F0c6a61df-ab60-4f61-9305-73702e5bd5bd%2Fapple-touch-icon-114x114.png">
            
        
            
                <link rel="apple-touch-icon" sizes="120x120" href="https://substackcdn.com/image/fetch/$s_!ipbb!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F0c6a61df-ab60-4f61-9305-73702e5bd5bd%2Fapple-touch-icon-120x120.png">
            
        
            
                <link rel="apple-touch-icon" sizes="144x144" href="https://substackcdn.com/image/fetch/$s_!twIw!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F0c6a61df-ab60-4f61-9305-73702e5bd5bd%2Fapple-touch-icon-144x144.png">
            
        
            
                <link rel="apple-touch-icon" sizes="152x152" href="https://substackcdn.com/image/fetch/$s_!_brj!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F0c6a61df-ab60-4f61-9305-73702e5bd5bd%2Fapple-touch-icon-152x152.png">
            
        
            
                <link rel="apple-touch-icon" sizes="167x167" href="https://substackcdn.com/image/fetch/$s_!_hi8!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F0c6a61df-ab60-4f61-9305-73702e5bd5bd%2Fapple-touch-icon-167x167.png">
            
        
            
                <link rel="apple-touch-icon" sizes="180x180" href="https://substackcdn.com/image/fetch/$s_!b2J0!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F0c6a61df-ab60-4f61-9305-73702e5bd5bd%2Fapple-touch-icon-180x180.png">
            
        
            
                <link rel="apple-touch-icon" sizes="1024x1024" href="https://substackcdn.com/image/fetch/$s_!pPZy!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F0c6a61df-ab60-4f61-9305-73702e5bd5bd%2Fapple-touch-icon-1024x1024.png">
            
        
            
        
            
        
            
        

        

        
            <link rel="alternate" type="application/rss+xml" href="https://cameronrwolfe.substack.com/feed" title="Deep (Learning) Focus">
        

        
        
          <style>
            @font-face{font-family:'Spectral';font-style:italic;font-weight:400;font-display:fallback;src:url(https://fonts.gstatic.com/s/spectral/v13/rnCt-xNNww_2s0amA9M8on7mTNmnUHowCw.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Spectral';font-style:italic;font-weight:400;font-display:fallback;src:url(https://fonts.gstatic.com/s/spectral/v13/rnCt-xNNww_2s0amA9M8onXmTNmnUHowCw.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Spectral';font-style:italic;font-weight:400;font-display:fallback;src:url(https://fonts.gstatic.com/s/spectral/v13/rnCt-xNNww_2s0amA9M8onTmTNmnUHowCw.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Spectral';font-style:italic;font-weight:400;font-display:fallback;src:url(https://fonts.gstatic.com/s/spectral/v13/rnCt-xNNww_2s0amA9M8onrmTNmnUHo.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Spectral';font-style:normal;font-weight:400;font-display:fallback;src:url(https://fonts.gstatic.com/s/spectral/v13/rnCr-xNNww_2s0amA9M9knjsS_ulYHs.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Spectral';font-style:normal;font-weight:400;font-display:fallback;src:url(https://fonts.gstatic.com/s/spectral/v13/rnCr-xNNww_2s0amA9M2knjsS_ulYHs.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Spectral';font-style:normal;font-weight:400;font-display:fallback;src:url(https://fonts.gstatic.com/s/spectral/v13/rnCr-xNNww_2s0amA9M3knjsS_ulYHs.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Spectral';font-style:normal;font-weight:400;font-display:fallback;src:url(https://fonts.gstatic.com/s/spectral/v13/rnCr-xNNww_2s0amA9M5knjsS_ul.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Spectral';font-style:normal;font-weight:600;font-display:fallback;src:url(https://fonts.gstatic.com/s/spectral/v13/rnCs-xNNww_2s0amA9vmtm3FafaPWnIIMrY.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Spectral';font-style:normal;font-weight:600;font-display:fallback;src:url(https://fonts.gstatic.com/s/spectral/v13/rnCs-xNNww_2s0amA9vmtm3OafaPWnIIMrY.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Spectral';font-style:normal;font-weight:600;font-display:fallback;src:url(https://fonts.gstatic.com/s/spectral/v13/rnCs-xNNww_2s0amA9vmtm3PafaPWnIIMrY.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Spectral';font-style:normal;font-weight:600;font-display:fallback;src:url(https://fonts.gstatic.com/s/spectral/v13/rnCs-xNNww_2s0amA9vmtm3BafaPWnII.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}
            @font-face{font-family:'Lora';font-style:italic;font-weight:400;font-display:fallback;src:url(https://fonts.gstatic.com/s/lora/v32/0QI8MX1D_JOuMw_hLdO6T2wV9KnW-MoFoqJ2nPWc3ZyhTjcV.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Lora';font-style:italic;font-weight:400;font-display:fallback;src:url(https://fonts.gstatic.com/s/lora/v32/0QI8MX1D_JOuMw_hLdO6T2wV9KnW-MoFoqt2nPWc3ZyhTjcV.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Lora';font-style:italic;font-weight:400;font-display:fallback;src:url(https://fonts.gstatic.com/s/lora/v32/0QI8MX1D_JOuMw_hLdO6T2wV9KnW-MoFoqB2nPWc3ZyhTjcV.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Lora';font-style:italic;font-weight:400;font-display:fallback;src:url(https://fonts.gstatic.com/s/lora/v32/0QI8MX1D_JOuMw_hLdO6T2wV9KnW-MoFoqF2nPWc3ZyhTjcV.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Lora';font-style:italic;font-weight:400;font-display:fallback;src:url(https://fonts.gstatic.com/s/lora/v32/0QI8MX1D_JOuMw_hLdO6T2wV9KnW-MoFoq92nPWc3ZyhTg.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Lora';font-style:normal;font-weight:400;font-display:fallback;src:url(https://fonts.gstatic.com/s/lora/v32/0QIvMX1D_JOuMwf7I_FMl_GW8g.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Lora';font-style:normal;font-weight:400;font-display:fallback;src:url(https://fonts.gstatic.com/s/lora/v32/0QIvMX1D_JOuMw77I_FMl_GW8g.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Lora';font-style:normal;font-weight:400;font-display:fallback;src:url(https://fonts.gstatic.com/s/lora/v32/0QIvMX1D_JOuMwX7I_FMl_GW8g.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Lora';font-style:normal;font-weight:400;font-display:fallback;src:url(https://fonts.gstatic.com/s/lora/v32/0QIvMX1D_JOuMwT7I_FMl_GW8g.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Lora';font-style:normal;font-weight:400;font-display:fallback;src:url(https://fonts.gstatic.com/s/lora/v32/0QIvMX1D_JOuMwr7I_FMl_E.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Lora';font-style:normal;font-weight:600;font-display:fallback;src:url(https://fonts.gstatic.com/s/lora/v32/0QIvMX1D_JOuMwf7I_FMl_GW8g.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Lora';font-style:normal;font-weight:600;font-display:fallback;src:url(https://fonts.gstatic.com/s/lora/v32/0QIvMX1D_JOuMw77I_FMl_GW8g.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Lora';font-style:normal;font-weight:600;font-display:fallback;src:url(https://fonts.gstatic.com/s/lora/v32/0QIvMX1D_JOuMwX7I_FMl_GW8g.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Lora';font-style:normal;font-weight:600;font-display:fallback;src:url(https://fonts.gstatic.com/s/lora/v32/0QIvMX1D_JOuMwT7I_FMl_GW8g.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Lora';font-style:normal;font-weight:600;font-display:fallback;src:url(https://fonts.gstatic.com/s/lora/v32/0QIvMX1D_JOuMwr7I_FMl_E.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}
          </style>
        
        

        <style>:root{--color_theme_bg_pop:#538cfa;--background_pop:#538cfa;--cover_bg_color:#FFFFFF;--background_pop_darken:#3a7bf9;--print_on_pop:#ffffff;--color_theme_bg_pop_darken:#3a7bf9;--color_theme_print_on_pop:#ffffff;--color_theme_bg_pop_20:rgba(83, 140, 250, 0.2);--color_theme_bg_pop_30:rgba(83, 140, 250, 0.3);--border_subtle:rgba(204, 204, 204, 0.5);--background_subtle:rgba(229, 238, 254, 0.4);--print_pop:#538cfa;--color_theme_accent:#538cfa;--cover_print_primary:#363737;--cover_print_secondary:#757575;--cover_print_tertiary:#b6b6b6;--cover_border_color:#538cfa;--font_family_headings_preset:Lora,sans-serif;--font_weight_headings_preset:600;--font_family_body_preset:Spectral,sans-serif;--font_weight_body_preset:400;--font_size_body_offset:1px;--font_preset_heading:fancy_serif;--font_preset_body:classic_serif;--home_hero:feature-media;--home_posts:list;--home_show_top_posts:true;--web_bg_color:#ffffff;--background_contrast_1:#f0f0f0;--color_theme_bg_contrast_1:#f0f0f0;--background_contrast_2:#dddddd;--color_theme_bg_contrast_2:#dddddd;--background_contrast_3:#b7b7b7;--color_theme_bg_contrast_3:#b7b7b7;--background_contrast_4:#929292;--color_theme_bg_contrast_4:#929292;--background_contrast_5:#515151;--color_theme_bg_contrast_5:#515151;--color_theme_bg_elevated:#ffffff;--color_theme_bg_elevated_secondary:#f0f0f0;--color_theme_detail:#e6e6e6;--background_contrast_pop:rgba(83, 140, 250, 0.4);--color_theme_bg_contrast_pop:rgba(83, 140, 250, 0.4);--input_background:#ffffff;--cover_input_background:#ffffff;--tooltip_background:#191919;--web_bg_color_h:0;--web_bg_color_s:0%;--web_bg_color_l:100%;--print_on_web_bg_color:#363737;--print_secondary_on_web_bg_color:#868787;--selected_comment_background_color:#fdf9f3;--background_pop_rgb:83, 140, 250;--background_pop_rgb_pc:83 140 250;--color_theme_bg_pop_rgb:83, 140, 250;--color_theme_bg_pop_rgb_pc:83 140 250;--color_theme_accent_rgb:83, 140, 250;--color_theme_accent_rgb_pc:83 140 250;}</style>

        
            <link rel="stylesheet" href="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/main.652fdc07fcff20447973.css">
        
            <link rel="stylesheet" href="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/color_links.c9908948e2f4e05476e6.css">
        

        <style></style>

        

        

        

        
    <link type="text/css" rel="stylesheet" id="dark-mode-custom-link"><link type="text/css" rel="stylesheet" id="dark-mode-general-link"><style lang="en" type="text/css" id="dark-mode-custom-style"></style><style lang="en" type="text/css" id="dark-mode-native-style"></style><style lang="en" type="text/css" id="dark-mode-native-sheet"></style><style type="text/css">/*
  code is extracted from Calendly's embed stylesheet: https://assets.calendly.com/assets/external/widget.css
*/

.calendly-inline-widget,
.calendly-inline-widget *,
.calendly-badge-widget,
.calendly-badge-widget *,
.calendly-overlay,
.calendly-overlay * {
    font-size:16px;
    line-height:1.2em
}

.calendly-inline-widget iframe,
.calendly-badge-widget iframe,
.calendly-overlay iframe {
    display:inline;
    width:100%;
    height:100%
}

.calendly-popup-content {
    position:relative
}

.calendly-popup-content.calendly-mobile {
    -webkit-overflow-scrolling:touch;
    overflow-y:auto
}

.calendly-overlay {
    position:fixed;
    top:0;
    left:0;
    right:0;
    bottom:0;
    overflow:hidden;
    z-index:9999;
    background-color:#a5a5a5;
    background-color:rgba(31,31,31,0.4)
}

.calendly-overlay .calendly-close-overlay {
    position:absolute;
    top:0;
    left:0;
    right:0;
    bottom:0
}

.calendly-overlay .calendly-popup {
    box-sizing:border-box;
    position:absolute;
    top:50%;
    left:50%;
    -webkit-transform:translateY(-50%) translateX(-50%);
    transform:translateY(-50%) translateX(-50%);
    width:80%;
    min-width:900px;
    max-width:1000px;
    height:90%;
    max-height:680px
}

@media (max-width: 975px) {
    .calendly-overlay .calendly-popup {
        position:fixed;
        top:50px;
        left:0;
        right:0;
        bottom:0;
        -webkit-transform:none;
        transform:none;
        width:100%;
        height:auto;
        min-width:0;
        max-height:none
    }
}

.calendly-overlay .calendly-popup .calendly-popup-content {
    height:100%;
}

.calendly-overlay .calendly-popup-close {
    position:absolute;
    top:25px;
    right:25px;
    color:#fff;
    width:19px;
    height:19px;
    cursor:pointer;
    background:url(https://assets.calendly.com/assets/external/close-icon.svg) no-repeat;
    background-size:contain
}

@media (max-width: 975px) {
    .calendly-overlay .calendly-popup-close {
        top:15px;
        right:15px
    }
}

.calendly-badge-widget {
    position:fixed;
    right:20px;
    bottom:15px;
    z-index:9998
}

.calendly-badge-widget .calendly-badge-content {
    display:table-cell;
    width:auto;
    height:45px;
    padding:0 30px;
    border-radius:25px;
    box-shadow:rgba(0,0,0,0.25) 0 2px 5px;
    font-family:sans-serif;
    text-align:center;
    vertical-align:middle;
    font-weight:bold;
    font-size:14px;
    color:#fff;
    cursor:pointer
}

.calendly-badge-widget .calendly-badge-content.calendly-white {
    color:#666a73
}

.calendly-badge-widget .calendly-badge-content span {
    display:block;
    font-size:12px
}

.calendly-spinner {
    position:absolute;
    top:50%;
    left:0;
    right:0;
    -webkit-transform:translateY(-50%);
    transform:translateY(-50%);
    text-align:center;
    z-index:-1
}

.calendly-spinner>div {
    display:inline-block;
    width:18px;
    height:18px;
    background-color:#e1e1e1;
    border-radius:50%;
    vertical-align:middle;
    -webkit-animation:calendly-bouncedelay 1.4s infinite ease-in-out;
    animation:calendly-bouncedelay 1.4s infinite ease-in-out;
    -webkit-animation-fill-mode:both;
    animation-fill-mode:both
}

.calendly-spinner .calendly-bounce1 {
    -webkit-animation-delay:-0.32s;
    animation-delay:-0.32s
}

.calendly-spinner .calendly-bounce2 {
    -webkit-animation-delay:-0.16s;
    animation-delay:-0.16s
}

@-webkit-keyframes calendly-bouncedelay {
    0%,80%,100% {
        -webkit-transform:scale(0);
        transform:scale(0)
    } 
    
    40%{
        -webkit-transform:scale(1);
        transform:scale(1)
    }
}

@keyframes calendly-bouncedelay{ 
    0%,80%,100% {
        -webkit-transform:scale(0);
        transform:scale(0)
    }
    
    40% {
        -webkit-transform:scale(1);
        transform:scale(1)
    }
}</style><meta property="og:type" content="article" data-preact-helmet="true"><meta name="theme-color" content="#ffffff" data-preact-helmet="true"><meta name="twitter:card" content="summary_large_image" data-preact-helmet="true"><meta property="og:title" content="LLaMA-2 from the Ground Up" data-preact-helmet="true"><meta name="twitter:title" content="LLaMA-2 from the Ground Up" data-preact-helmet="true"><meta name="description" content="Everything you need to know about the best open-source LLM on the market..." data-preact-helmet="true"><meta property="og:description" content="Everything you need to know about the best open-source LLM on the market..." data-preact-helmet="true"><meta name="twitter:description" content="Everything you need to know about the best open-source LLM on the market..." data-preact-helmet="true"><meta property="og:image" content="https://substackcdn.com/image/fetch/$s_!D1xF!,w_1200,h_600,c_fill,f_jpg,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png" data-preact-helmet="true"><meta name="twitter:image" content="https://substackcdn.com/image/fetch/$s_!IuXX!,f_auto,q_auto:best,fl_progressive:steep/https%3A%2F%2Fcameronrwolfe.substack.com%2Fapi%2Fv1%2Fpost_preview%2F135824233%2Ftwitter.jpg%3Fversion%3D4" data-preact-helmet="true"><link rel="stylesheet" type="text/css" href="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/2947.47d0d7d2.css"><link rel="stylesheet" type="text/css" href="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/9543.28251e41.css"><link rel="stylesheet" type="text/css" href="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/3894.216e944d.css"><link rel="stylesheet" type="text/css" href="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/3280.8db3c09e.css"></head>

    <body class=" ">
        

        

        

        

        

        

        <div id="entry" aria-hidden="true" inert=""><div id="main" class="main typography use-theme-bg"><div class="pencraft pc-display-contents pc-reset pubTheme-yiXxQA"><div data-testid="navbar" class="main-menu"><div class="mainMenuContent-DME8DR" style="position: fixed; top: -72px;"><div style="position: relative; height: 72px;" class="pencraft pc-display-flex pc-gap-12 pc-paddingLeft-20 pc-paddingRight-20 pc-justifyContent-space-between pc-alignItems-center pc-reset border-bottom-detail-themed-Ua9186 topBar-pIF0J1"><div style="flex-basis: 0px; flex-grow: 1;" class="logoContainer-p12gJb"><a href="https://cameronrwolfe.substack.com/" native="true" class="pencraft pc-display-contents pc-reset"><div draggable="false" class="pencraft pc-display-flex pc-position-relative pc-reset"><div style="width: 40px; height: 40px;" class="pencraft pc-display-flex pc-reset bg-white-ZBV5av pc-borderRadius-sm overflow-hidden-WdpwT6 sizing-border-box-DggLA4"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!87xa!,w_80,h_80,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fab9b43fb-52d5-40da-995d-5b7cd3f91064_896x896.png"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/ab9b43fb-52d5-40da-995d-5b7cd3f91064_896x896.jpg" sizes="100vw" alt="Deep (Learning) Focus" width="80" height="80" style="width: 40px; height: 40px;" draggable="false" class="img-OACg1c object-fit-cover-u4ReeV pencraft pc-reset"></picture></div></div></a></div><div style="flex-grow: 0;" class="titleContainer-DJYq5v"><h1 class="pencraft pc-reset font-pub-headings-FE5byy reset-IxiVJZ title-oOnUGd"><a href="https://cameronrwolfe.substack.com/" class="pencraft pc-display-contents pc-reset">Deep (Learning) Focus</a></h1></div><div style="flex-basis: 0px; flex-grow: 1;" class="pencraft pc-display-flex pc-justifyContent-flex-end pc-alignItems-center pc-reset"><div class="buttonsContainer-SJBuep"><div class="pencraft pc-display-flex pc-gap-8 pc-justifyContent-flex-end pc-alignItems-center pc-reset navbar-buttons"><div class="pencraft pc-display-contents pc-reset pubTheme-yiXxQA"><div class="pencraft pc-display-flex pc-gap-4 pc-reset"><span><button type="button" aria-label="Search" class="pencraft pc-reset pencraft iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_md-gCDS3o priority_tertiary-rlke8z" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-search"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.3-4.3"></path></svg></button></span><button type="button" aria-label="View more" id="trigger1" aria-expanded="false" aria-haspopup="dialog" aria-controls="dialog2" class="pencraft pc-reset pencraft iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_md-gCDS3o priority_tertiary-rlke8z" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-share"><path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"></path><polyline points="16 6 12 2 8 6"></polyline><line x1="12" x2="12" y1="2" y2="15"></line></svg></button></div><button type="button" data-testid="noncontributor-cta-button" class="pencraft pc-reset pencraft buttonBase-GK1x3M buttonText-X0uSmG buttonStyle-r7yGCK priority_primary-RfbeYt size_md-gCDS3o" tabindex="0">Subscribe</button><button type="button" native="true" data-href="https://substack.com/sign-in?redirect=%2Fp%2Fllama-2-from-the-ground-up&amp;for_pub=cameronrwolfe" class="pencraft pc-reset pencraft buttonBase-GK1x3M buttonText-X0uSmG buttonStyle-r7yGCK priority_tertiary-rlke8z size_md-gCDS3o" tabindex="0">Sign in</button></div></div></div></div></div></div><div style="height: 72px;"></div></div></div><div><script async="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/js"></script><script src="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up" type="application/ld+json">{"@context":"https://schema.org","@type":"NewsArticle","url":"https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up","mainEntityOfPage":"https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up","headline":"LLaMA-2 from the Ground Up","description":"Everything you need to know about the best open-source LLM on the market...","image":[{"@type":"ImageObject","url":"https://substack-post-media.s3.amazonaws.com/public/images/ed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png"}],"datePublished":"2023-08-14T14:42:59+05:30","dateModified":"2023-08-14T14:42:59+05:30","isAccessibleForFree":true,"author":[{"@type":"Person","name":"Cameron R. Wolfe, Ph.D.","url":"https://substack.com/@cwolferesearch","description":"Research @ Netflix \u2022 Rice University PhD \u2022 I make AI understandable","identifier":"user:29736521","sameAs":["https://twitter.com/cwolferesearch"],"image":{"@type":"ImageObject","contentUrl":"https://substackcdn.com/image/fetch/$s_!VC2M!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F69aba7df-b571-4609-aa47-fc2d031c11b8_1242x1595.jpeg","thumbnailUrl":"https://substackcdn.com/image/fetch/$s_!VC2M!,w_128,h_128,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F69aba7df-b571-4609-aa47-fc2d031c11b8_1242x1595.jpeg"}}],"publisher":{"@type":"Organization","name":"Deep (Learning) Focus","url":"https://cameronrwolfe.substack.com","description":"I contextualize and explain important topics in AI research.","interactionStatistic":{"@type":"InteractionCounter","name":"Subscribers","interactionType":"https://schema.org/SubscribeAction","userInteractionCount":10000},"identifier":"pub:1092659","logo":{"@type":"ImageObject","url":"https://substackcdn.com/image/fetch/$s_!87xa!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fab9b43fb-52d5-40da-995d-5b7cd3f91064_896x896.png","contentUrl":"https://substackcdn.com/image/fetch/$s_!87xa!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fab9b43fb-52d5-40da-995d-5b7cd3f91064_896x896.png","thumbnailUrl":"https://substackcdn.com/image/fetch/$s_!87xa!,w_128,h_128,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fab9b43fb-52d5-40da-995d-5b7cd3f91064_896x896.png"},"image":{"@type":"ImageObject","url":"https://substackcdn.com/image/fetch/$s_!87xa!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fab9b43fb-52d5-40da-995d-5b7cd3f91064_896x896.png","contentUrl":"https://substackcdn.com/image/fetch/$s_!87xa!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fab9b43fb-52d5-40da-995d-5b7cd3f91064_896x896.png","thumbnailUrl":"https://substackcdn.com/image/fetch/$s_!87xa!,w_128,h_128,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fab9b43fb-52d5-40da-995d-5b7cd3f91064_896x896.png"},"sameAs":["https://twitter.com/cwolferesearch"]}}</script><div aria-label="Post" role="main" class="single-post-container"><div class="container"><div class="single-post"><div class="pencraft pc-display-contents pc-reset pubTheme-yiXxQA"><article class="typography newsletter-post post"><div inert="" role="dialog" class="modal typography out gone share-dialog popup"><div class="modal-table"><div class="modal-row"><div class="modal-cell modal-content no-fullscreen"><div class="container"><button type="button" aria-label="X" data-testid="close-modal" class="pencraft pc-reset pencraft modal-btn modal-exit-btn no-margin iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_md-gCDS3o priority_tertiary-rlke8z" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="secondary" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg></button><div class="pencraft pc-display-contents pc-reset pubTheme-yiXxQA"><div class="pencraft pc-display-contents pc-reset elevatedTheme-fBklGV"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-24 pc-padding-24 pc-reset bg-primary-zk6FDl border-detail-EGrm7T pc-borderRadius-md container-xiJVit"><h4 class="pencraft pc-reset flex-grow-rzmknG align-center-y7ZD4w line-height-24-jnGwiv font-display-nhmvtD size-20-P_cSRT weight-bold-DmI9lw reset-IxiVJZ">Share this post</h4><a href="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up#" class="pencraft pc-display-contents pc-reset"><div class="pencraft pc-display-contents pc-reset elevatedTheme-fBklGV"><div style="background: linear-gradient(180deg, rgba(80,80,80,0.75), rgba(80,80,80,0.75)), var(--color-dark-bg-secondary);" draggable="false" class="pencraft pc-display-flex pc-flexDirection-column pc-minWidth-0 pc-position-relative pc-reset bg-primary-zk6FDl pc-borderRadius-md showFocus-sk_vEm postAttachment-eYV3fM" tabindex="0"><div class="pencraft pc-display-flex pc-flexDirection-column pc-reset border-bottom-detail-k1F6C4 vibrantHeader-We3FVb"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!D1xF!,w_424,h_222,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 424w, https://substackcdn.com/image/fetch/$s_!D1xF!,w_520,h_272,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 520w, https://substackcdn.com/image/fetch/$s_!D1xF!,w_848,h_444,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 848w, https://substackcdn.com/image/fetch/$s_!D1xF!,w_1040,h_545,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 1040w, https://substackcdn.com/image/fetch/$s_!D1xF!,w_1272,h_666,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 1272w, https://substackcdn.com/image/fetch/$s_!D1xF!,w_1456,h_762,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 1456w, https://substackcdn.com/image/fetch/$s_!D1xF!,w_1560,h_817,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 1560w" sizes="520px"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/ed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.jpg" sizes="520px" alt="" srcset="https://substackcdn.com/image/fetch/$s_!D1xF!,w_424,h_222,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 424w, https://substackcdn.com/image/fetch/$s_!D1xF!,w_520,h_272,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 520w, https://substackcdn.com/image/fetch/$s_!D1xF!,w_848,h_444,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 848w, https://substackcdn.com/image/fetch/$s_!D1xF!,w_1040,h_545,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 1040w, https://substackcdn.com/image/fetch/$s_!D1xF!,w_1272,h_666,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 1272w, https://substackcdn.com/image/fetch/$s_!D1xF!,w_1456,h_762,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 1456w, https://substackcdn.com/image/fetch/$s_!D1xF!,w_1560,h_817,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 1560w" width="520" draggable="false" class="img-OACg1c postImage-L4FlO9 vibrantPostImage-TTXyOq pencraft pc-reset"></picture></div><div class="pencraft pc-display-flex pc-gap-12 pc-padding-12 pc-alignItems-center pc-reset"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-2 pc-minWidth-0 pc-reset flex-grow-rzmknG"><div class="pencraft pc-display-flex pc-gap-8 pc-paddingBottom-4 pc-alignItems-center pc-reset"><div draggable="false" class="pencraft pc-display-flex pc-position-relative pc-reset"><div style="width: 18px; height: 18px;" class="pencraft pc-display-flex pc-reset bg-white-ZBV5av pc-borderRadius-xs overflow-hidden-WdpwT6 sizing-border-box-DggLA4"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!87xa!,w_36,h_36,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fab9b43fb-52d5-40da-995d-5b7cd3f91064_896x896.png"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/ab9b43fb-52d5-40da-995d-5b7cd3f91064_896x896(1).jpg" sizes="100vw" alt="Deep (Learning) Focus" width="36" height="36" style="width: 18px; height: 18px;" draggable="false" class="img-OACg1c object-fit-cover-u4ReeV pencraft pc-reset"></picture></div></div><div class="pencraft pc-reset flex-grow-rzmknG ellipsis-Jb8om8 color-vibrance-secondary-k5eqjt line-height-20-t4M0El font-text-qe4AeH size-13-hZTUKr weight-regular-mUq6Gb nowrap-QngyoB reset-IxiVJZ">Deep (Learning) Focus</div></div><div class="pencraft pc-reset color-vibrance-primary-KHCdqV line-height-20-t4M0El font-text-qe4AeH size-15-Psle70 weight-medium-fw81nC clamp-y7pNm8 clamp-2-kM02pu reset-IxiVJZ">LLaMA-2 from the Ground Up</div></div></div></div></div></a><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-16 pc-reset"><div class="pencraft pc-display-flex pc-justifyContent-space-between pc-reset"><button type="button" class="pencraft pc-reset pc-borderRadius-sm pencraft buttonBase-GK1x3M" tabindex="0"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-width-64 pc-alignItems-center pc-reset container-iTCOuF"><div class="pencraft pc-display-flex pc-flexDirection-column pc-width-64 pc-height-64 pc-justifyContent-center pc-alignItems-center pc-reset bg-secondary-UUD3_J animate-XFJxE4 pc-borderRadius-lg button-zkMi7O"><svg role="img" style="height: 20px; width: 20px;" width="20" height="20" viewBox="0 0 20 20" fill="none" stroke-width="2" stroke="var(--color-fg-primary)" xmlns="http://www.w3.org/2000/svg"><g><title></title><path d="M7.50008 14.1666H5.83341C4.72835 14.1666 3.66854 13.7276 2.88714 12.9462C2.10573 12.1648 1.66675 11.105 1.66675 9.99992C1.66675 8.89485 2.10573 7.83504 2.88714 7.05364C3.66854 6.27224 4.72835 5.83325 5.83341 5.83325H7.50008M12.5001 5.83325H14.1667C15.2718 5.83325 16.3316 6.27224 17.113 7.05364C17.8944 7.83504 18.3334 8.89485 18.3334 9.99992C18.3334 11.105 17.8944 12.1648 17.113 12.9462C16.3316 13.7276 15.2718 14.1666 14.1667 14.1666H12.5001M6.66675 9.99992H13.3334"></path></g></svg></div><div class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-11-NuY2Zx weight-semibold-uqA4FV reset-IxiVJZ">Copy link</div></div></button><button type="button" class="pencraft pc-reset pc-borderRadius-sm pencraft buttonBase-GK1x3M" tabindex="0"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-width-64 pc-alignItems-center pc-reset container-iTCOuF"><div class="pencraft pc-display-flex pc-flexDirection-column pc-width-64 pc-height-64 pc-justifyContent-center pc-alignItems-center pc-reset bg-secondary-UUD3_J animate-XFJxE4 pc-borderRadius-lg button-zkMi7O"><svg role="img" style="height: 20px; width: 20px;" width="20" height="20" viewBox="0 0 20 20" fill="var(--color-fg-primary)" stroke-width="1.8" stroke="none" xmlns="http://www.w3.org/2000/svg"><g><title></title><path stroke="none" d="M20 10C20 4.47715 15.5229 0 10 0C4.47715 0 0 4.47715 0 10C0 14.9912 3.65684 19.1283 8.4375 19.8785V12.8906H5.89844V10H8.4375V7.79688C8.4375 5.29063 9.93047 3.90625 12.2146 3.90625C13.3084 3.90625 14.4531 4.10156 14.4531 4.10156V6.5625H13.1922C11.95 6.5625 11.5625 7.3334 11.5625 8.125V10H14.3359L13.8926 12.8906H11.5625V19.8785C16.3432 19.1283 20 14.9912 20 10Z"></path></g></svg></div><div class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-11-NuY2Zx weight-semibold-uqA4FV reset-IxiVJZ">Facebook</div></div></button><button type="button" class="pencraft pc-reset pc-borderRadius-sm pencraft buttonBase-GK1x3M" tabindex="0"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-width-64 pc-alignItems-center pc-reset container-iTCOuF"><div class="pencraft pc-display-flex pc-flexDirection-column pc-width-64 pc-height-64 pc-justifyContent-center pc-alignItems-center pc-reset bg-secondary-UUD3_J animate-XFJxE4 pc-borderRadius-lg button-zkMi7O"><svg role="img" style="height: 20px; width: 20px;" width="20" height="20" viewBox="0 0 20 20" fill="var(--color-fg-primary)" stroke-width="1.8" stroke="var(--color-fg-primary)" xmlns="http://www.w3.org/2000/svg"><g><title></title><path stroke="none" d="M9.9958 11.0646C10.2693 11.0646 10.5346 10.9569 10.7915 10.7248L19.0717 3.431C18.6241 3.13262 18.1102 3 17.3974 3H2.60257C1.88976 3 1.37587 3.13262 0.920011 3.431L9.20011 10.7248C9.46534 10.9569 9.73057 11.0646 9.9958 11.0646ZM0.215499 15.9465L6.34893 9.82137L0.198922 4.40075C0.107749 4.5748 0 4.99751 0 5.56941V14.7199C0 15.2503 0.0828842 15.6316 0.215499 15.9465ZM2.35391 17.2892H17.646C18.2511 17.2892 18.7235 17.14 19.0385 16.9245L12.731 10.6171L11.5209 11.6945C11.0402 12.1173 10.518 12.3328 9.9958 12.3328C9.48197 12.3328 8.95975 12.1173 8.47905 11.6945L7.26894 10.6171L0.961455 16.9245C1.27642 17.14 1.74057 17.2892 2.35391 17.2892ZM19.7844 15.9465C19.9088 15.6316 20 15.2503 20 14.7199V5.56941C20 4.99751 19.8922 4.5748 19.8011 4.40075L13.651 9.82137L19.7844 15.9465Z"></path></g></svg></div><div class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-11-NuY2Zx weight-semibold-uqA4FV reset-IxiVJZ">Email</div></div></button><button type="button" class="pencraft pc-reset pc-borderRadius-sm pencraft buttonBase-GK1x3M" tabindex="0"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-width-64 pc-alignItems-center pc-reset container-iTCOuF"><div class="pencraft pc-display-flex pc-flexDirection-column pc-width-64 pc-height-64 pc-justifyContent-center pc-alignItems-center pc-reset bg-secondary-UUD3_J animate-XFJxE4 pc-borderRadius-lg button-zkMi7O"><svg role="img" style="height: 20px; width: 20px;" width="20" height="20" viewBox="0 0 20 20" fill="var(--color-fg-primary)" stroke-width="1.8" stroke="none" xmlns="http://www.w3.org/2000/svg"><g><title></title><path d="M1.96484 0.624512H18.0354V2.70052H1.96484V0.624512Z" stroke="none"></path><path d="M1.96484 4.77655H18.0354V6.85254H1.96484V4.77655Z" stroke="none"></path><path d="M1.96484 8.92857V19.9505L10.0001 14.6347L18.0354 19.9505V8.92857H1.96484Z" stroke="none"></path></g></svg></div><div class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-11-NuY2Zx weight-semibold-uqA4FV reset-IxiVJZ">Notes</div></div></button><button type="button" class="pencraft pc-reset pc-borderRadius-sm pencraft buttonBase-GK1x3M" tabindex="0"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-width-64 pc-alignItems-center pc-reset container-iTCOuF"><div class="pencraft pc-display-flex pc-flexDirection-column pc-width-64 pc-height-64 pc-justifyContent-center pc-alignItems-center pc-reset bg-secondary-UUD3_J animate-XFJxE4 pc-borderRadius-lg button-zkMi7O"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--color-fg-primary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-ellipsis"><circle cx="12" cy="12" r="1"></circle><circle cx="19" cy="12" r="1"></circle><circle cx="5" cy="12" r="1"></circle></svg></div><div class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-11-NuY2Zx weight-semibold-uqA4FV reset-IxiVJZ">More</div></div></button></div></div></div></div></div></div></div></div></div></div><div role="region" aria-label="Post header" class="post-header"><h1 class="post-title published">LLaMA-2 from the Ground Up</h1><h3 class="subtitle">Everything you need to know about the best open-source LLM on the market...</h3><div aria-label="Post UFI" role="region" class="pencraft pc-display-flex pc-flexDirection-column pc-paddingBottom-16 pc-reset"><div class="pencraft pc-display-flex pc-flexDirection-column pc-paddingTop-16 pc-paddingBottom-16 pc-reset"><div class="pencraft pc-display-flex pc-gap-12 pc-alignItems-center pc-reset byline-wrapper"><div class="pencraft pc-display-flex pc-reset"><div class="pencraft pc-display-flex pc-flexDirection-row pc-gap-8 pc-alignItems-center pc-justifyContent-flex-start pc-reset"><div style="--scale: 36px; --offset: 9px; --border-width: 4.5px;" class="pencraft pc-display-flex pc-flexDirection-row pc-alignItems-center pc-justifyContent-flex-start pc-reset ltr-qDBmby"><div class="profile-hover-card-target profileHoverCardTarget-PBxvGm"><a href="https://substack.com/@cwolferesearch" aria-label="View Cameron R. Wolfe, Ph.D.&#39;s profile" class="pencraft pc-display-contents pc-reset"><div tabindex="0" class="pencraft pc-display-flex pc-width-36 pc-height-36 pc-justifyContent-center pc-alignItems-center pc-position-relative pc-reset bg-secondary-UUD3_J flex-auto-j3S2WA animate-XFJxE4 outline-detail-vcQLyr pc-borderRadius-full overflow-hidden-WdpwT6 sizing-border-box-DggLA4 pressable-sm-YIJFKJ showFocus-sk_vEm container-TAtrWj interactive-UkK0V6 avatar-u8q6xB last-JfNEJ_" style="--scale: 36px;"><div title="Cameron R. Wolfe, Ph.D." class="pencraft pc-display-flex pc-width-36 pc-height-36 pc-justifyContent-center pc-alignItems-center pc-position-relative pc-reset bg-secondary-UUD3_J flex-auto-j3S2WA outline-detail-vcQLyr pc-borderRadius-full overflow-hidden-WdpwT6 sizing-border-box-DggLA4 container-TAtrWj" style="--scale: 36px;"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!VC2M!,w_36,h_36,c_fill,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F69aba7df-b571-4609-aa47-fc2d031c11b8_1242x1595.jpeg 36w, https://substackcdn.com/image/fetch/$s_!VC2M!,w_72,h_72,c_fill,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F69aba7df-b571-4609-aa47-fc2d031c11b8_1242x1595.jpeg 72w, https://substackcdn.com/image/fetch/$s_!VC2M!,w_108,h_108,c_fill,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F69aba7df-b571-4609-aa47-fc2d031c11b8_1242x1595.jpeg 108w" sizes="36px"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/69aba7df-b571-4609-aa47-fc2d031c11b8_1242x1595.jpg" sizes="36px" alt="Cameron R. Wolfe, Ph.D.&#39;s avatar" srcset="https://substackcdn.com/image/fetch/$s_!VC2M!,w_36,h_36,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F69aba7df-b571-4609-aa47-fc2d031c11b8_1242x1595.jpeg 36w, https://substackcdn.com/image/fetch/$s_!VC2M!,w_72,h_72,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F69aba7df-b571-4609-aa47-fc2d031c11b8_1242x1595.jpeg 72w, https://substackcdn.com/image/fetch/$s_!VC2M!,w_108,h_108,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F69aba7df-b571-4609-aa47-fc2d031c11b8_1242x1595.jpeg 108w" width="36" height="36" draggable="false" class="img-OACg1c object-fit-cover-u4ReeV pencraft pc-reset"></picture></div></div></a></div></div></div></div><div class="pencraft pc-display-flex pc-flexDirection-column pc-reset"><div class="pencraft pc-reset color-pub-primary-text-NyXPlw line-height-20-t4M0El font-meta-MWBumP size-11-NuY2Zx weight-medium-fw81nC transform-uppercase-yKDgcq reset-IxiVJZ meta-EgzBVA"><div class="profile-hover-card-target profileHoverCardTarget-PBxvGm"><a href="https://substack.com/@cwolferesearch" class="pencraft pc-reset decoration-hover-underline-ClDVRM reset-IxiVJZ">Cameron R. Wolfe, Ph.D.</a></div></div><div class="pencraft pc-display-flex pc-gap-4 pc-reset"><div class="pencraft pc-reset color-pub-secondary-text-hGQ02T line-height-20-t4M0El font-meta-MWBumP size-11-NuY2Zx weight-medium-fw81nC transform-uppercase-yKDgcq reset-IxiVJZ meta-EgzBVA">Aug 14, 2023</div></div></div></div></div><div class="pencraft pc-display-flex pc-gap-16 pc-paddingTop-16 pc-paddingBottom-16 pc-justifyContent-space-between pc-alignItems-center pc-reset flex-grow-rzmknG border-top-detail-themed-k9TZAY border-bottom-detail-themed-Ua9186 post-ufi"><div class="pencraft pc-display-flex pc-gap-8 pc-reset"><div class="like-button-container post-ufi-button style-button"><a role="button" aria-label="Like (44)" aria-pressed="false" class="post-ufi-button style-button has-label with-border"><svg role="img" style="height: 20px; width: 20px;" width="20" height="20" viewBox="0 0 24 24" fill="#000000" stroke-width="2" stroke="#000" xmlns="http://www.w3.org/2000/svg" class="icon"><g><title></title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-heart"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"></path></svg></g></svg><div class="label">44</div></a><div inert="" role="dialog" class="modal typography out gone reader-onboarding-modal wide popup"><div class="modal-table"><div class="modal-row"><div class="modal-cell modal-content"><div class="container"><button tabindex="0" type="button" aria-label="X" data-testid="close-modal" class="pencraft pc-reset pencraft modal-btn modal-exit-btn no-margin iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_md-gCDS3o priority_tertiary-rlke8z"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="secondary" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg></button><div class="reader-onboarding-modal-container"></div></div></div></div></div></div><div inert="" role="dialog" class="modal typography out gone share-dialog popup"><div class="modal-table"><div class="modal-row"><div class="modal-cell modal-content no-fullscreen"><div class="container"><button type="button" aria-label="X" data-testid="close-modal" class="pencraft pc-reset pencraft modal-btn modal-exit-btn no-margin iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_md-gCDS3o priority_tertiary-rlke8z" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="secondary" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg></button><div class="pencraft pc-display-contents pc-reset pubTheme-yiXxQA"><div class="pencraft pc-display-contents pc-reset elevatedTheme-fBklGV"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-24 pc-padding-24 pc-reset bg-primary-zk6FDl border-detail-EGrm7T pc-borderRadius-md container-xiJVit"><h4 class="pencraft pc-reset flex-grow-rzmknG align-center-y7ZD4w line-height-24-jnGwiv font-display-nhmvtD size-20-P_cSRT weight-bold-DmI9lw reset-IxiVJZ">Share this post</h4><a href="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up#" class="pencraft pc-display-contents pc-reset"><div class="pencraft pc-display-contents pc-reset elevatedTheme-fBklGV"><div style="background: linear-gradient(180deg, rgba(80,80,80,0.75), rgba(80,80,80,0.75)), var(--color-dark-bg-secondary);" draggable="false" class="pencraft pc-display-flex pc-flexDirection-column pc-minWidth-0 pc-position-relative pc-reset bg-primary-zk6FDl pc-borderRadius-md showFocus-sk_vEm postAttachment-eYV3fM" tabindex="0"><div class="pencraft pc-display-flex pc-flexDirection-column pc-reset border-bottom-detail-k1F6C4 vibrantHeader-We3FVb"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!D1xF!,w_424,h_222,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 424w, https://substackcdn.com/image/fetch/$s_!D1xF!,w_520,h_272,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 520w, https://substackcdn.com/image/fetch/$s_!D1xF!,w_848,h_444,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 848w, https://substackcdn.com/image/fetch/$s_!D1xF!,w_1040,h_545,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 1040w, https://substackcdn.com/image/fetch/$s_!D1xF!,w_1272,h_666,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 1272w, https://substackcdn.com/image/fetch/$s_!D1xF!,w_1456,h_762,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 1456w, https://substackcdn.com/image/fetch/$s_!D1xF!,w_1560,h_817,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 1560w" sizes="520px"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/ed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.jpg" sizes="520px" alt="" srcset="https://substackcdn.com/image/fetch/$s_!D1xF!,w_424,h_222,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 424w, https://substackcdn.com/image/fetch/$s_!D1xF!,w_520,h_272,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 520w, https://substackcdn.com/image/fetch/$s_!D1xF!,w_848,h_444,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 848w, https://substackcdn.com/image/fetch/$s_!D1xF!,w_1040,h_545,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 1040w, https://substackcdn.com/image/fetch/$s_!D1xF!,w_1272,h_666,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 1272w, https://substackcdn.com/image/fetch/$s_!D1xF!,w_1456,h_762,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 1456w, https://substackcdn.com/image/fetch/$s_!D1xF!,w_1560,h_817,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 1560w" width="520" draggable="false" class="img-OACg1c postImage-L4FlO9 vibrantPostImage-TTXyOq pencraft pc-reset"></picture></div><div class="pencraft pc-display-flex pc-gap-12 pc-padding-12 pc-alignItems-center pc-reset"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-2 pc-minWidth-0 pc-reset flex-grow-rzmknG"><div class="pencraft pc-display-flex pc-gap-8 pc-paddingBottom-4 pc-alignItems-center pc-reset"><div draggable="false" class="pencraft pc-display-flex pc-position-relative pc-reset"><div style="width: 18px; height: 18px;" class="pencraft pc-display-flex pc-reset bg-white-ZBV5av pc-borderRadius-xs overflow-hidden-WdpwT6 sizing-border-box-DggLA4"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!87xa!,w_36,h_36,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fab9b43fb-52d5-40da-995d-5b7cd3f91064_896x896.png"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/ab9b43fb-52d5-40da-995d-5b7cd3f91064_896x896(1).jpg" sizes="100vw" alt="Deep (Learning) Focus" width="36" height="36" style="width: 18px; height: 18px;" draggable="false" class="img-OACg1c object-fit-cover-u4ReeV pencraft pc-reset"></picture></div></div><div class="pencraft pc-reset flex-grow-rzmknG ellipsis-Jb8om8 color-vibrance-secondary-k5eqjt line-height-20-t4M0El font-text-qe4AeH size-13-hZTUKr weight-regular-mUq6Gb nowrap-QngyoB reset-IxiVJZ">Deep (Learning) Focus</div></div><div class="pencraft pc-reset color-vibrance-primary-KHCdqV line-height-20-t4M0El font-text-qe4AeH size-15-Psle70 weight-medium-fw81nC clamp-y7pNm8 clamp-2-kM02pu reset-IxiVJZ">LLaMA-2 from the Ground Up</div></div></div></div></div></a><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-16 pc-reset"><div class="pencraft pc-display-flex pc-justifyContent-space-between pc-reset"><button type="button" class="pencraft pc-reset pc-borderRadius-sm pencraft buttonBase-GK1x3M" tabindex="0"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-width-64 pc-alignItems-center pc-reset container-iTCOuF"><div class="pencraft pc-display-flex pc-flexDirection-column pc-width-64 pc-height-64 pc-justifyContent-center pc-alignItems-center pc-reset bg-secondary-UUD3_J animate-XFJxE4 pc-borderRadius-lg button-zkMi7O"><svg role="img" style="height: 20px; width: 20px;" width="20" height="20" viewBox="0 0 20 20" fill="none" stroke-width="2" stroke="var(--color-fg-primary)" xmlns="http://www.w3.org/2000/svg"><g><title></title><path d="M7.50008 14.1666H5.83341C4.72835 14.1666 3.66854 13.7276 2.88714 12.9462C2.10573 12.1648 1.66675 11.105 1.66675 9.99992C1.66675 8.89485 2.10573 7.83504 2.88714 7.05364C3.66854 6.27224 4.72835 5.83325 5.83341 5.83325H7.50008M12.5001 5.83325H14.1667C15.2718 5.83325 16.3316 6.27224 17.113 7.05364C17.8944 7.83504 18.3334 8.89485 18.3334 9.99992C18.3334 11.105 17.8944 12.1648 17.113 12.9462C16.3316 13.7276 15.2718 14.1666 14.1667 14.1666H12.5001M6.66675 9.99992H13.3334"></path></g></svg></div><div class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-11-NuY2Zx weight-semibold-uqA4FV reset-IxiVJZ">Copy link</div></div></button><button type="button" class="pencraft pc-reset pc-borderRadius-sm pencraft buttonBase-GK1x3M" tabindex="0"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-width-64 pc-alignItems-center pc-reset container-iTCOuF"><div class="pencraft pc-display-flex pc-flexDirection-column pc-width-64 pc-height-64 pc-justifyContent-center pc-alignItems-center pc-reset bg-secondary-UUD3_J animate-XFJxE4 pc-borderRadius-lg button-zkMi7O"><svg role="img" style="height: 20px; width: 20px;" width="20" height="20" viewBox="0 0 20 20" fill="var(--color-fg-primary)" stroke-width="1.8" stroke="none" xmlns="http://www.w3.org/2000/svg"><g><title></title><path stroke="none" d="M20 10C20 4.47715 15.5229 0 10 0C4.47715 0 0 4.47715 0 10C0 14.9912 3.65684 19.1283 8.4375 19.8785V12.8906H5.89844V10H8.4375V7.79688C8.4375 5.29063 9.93047 3.90625 12.2146 3.90625C13.3084 3.90625 14.4531 4.10156 14.4531 4.10156V6.5625H13.1922C11.95 6.5625 11.5625 7.3334 11.5625 8.125V10H14.3359L13.8926 12.8906H11.5625V19.8785C16.3432 19.1283 20 14.9912 20 10Z"></path></g></svg></div><div class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-11-NuY2Zx weight-semibold-uqA4FV reset-IxiVJZ">Facebook</div></div></button><button type="button" class="pencraft pc-reset pc-borderRadius-sm pencraft buttonBase-GK1x3M" tabindex="0"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-width-64 pc-alignItems-center pc-reset container-iTCOuF"><div class="pencraft pc-display-flex pc-flexDirection-column pc-width-64 pc-height-64 pc-justifyContent-center pc-alignItems-center pc-reset bg-secondary-UUD3_J animate-XFJxE4 pc-borderRadius-lg button-zkMi7O"><svg role="img" style="height: 20px; width: 20px;" width="20" height="20" viewBox="0 0 20 20" fill="var(--color-fg-primary)" stroke-width="1.8" stroke="var(--color-fg-primary)" xmlns="http://www.w3.org/2000/svg"><g><title></title><path stroke="none" d="M9.9958 11.0646C10.2693 11.0646 10.5346 10.9569 10.7915 10.7248L19.0717 3.431C18.6241 3.13262 18.1102 3 17.3974 3H2.60257C1.88976 3 1.37587 3.13262 0.920011 3.431L9.20011 10.7248C9.46534 10.9569 9.73057 11.0646 9.9958 11.0646ZM0.215499 15.9465L6.34893 9.82137L0.198922 4.40075C0.107749 4.5748 0 4.99751 0 5.56941V14.7199C0 15.2503 0.0828842 15.6316 0.215499 15.9465ZM2.35391 17.2892H17.646C18.2511 17.2892 18.7235 17.14 19.0385 16.9245L12.731 10.6171L11.5209 11.6945C11.0402 12.1173 10.518 12.3328 9.9958 12.3328C9.48197 12.3328 8.95975 12.1173 8.47905 11.6945L7.26894 10.6171L0.961455 16.9245C1.27642 17.14 1.74057 17.2892 2.35391 17.2892ZM19.7844 15.9465C19.9088 15.6316 20 15.2503 20 14.7199V5.56941C20 4.99751 19.8922 4.5748 19.8011 4.40075L13.651 9.82137L19.7844 15.9465Z"></path></g></svg></div><div class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-11-NuY2Zx weight-semibold-uqA4FV reset-IxiVJZ">Email</div></div></button><button type="button" class="pencraft pc-reset pc-borderRadius-sm pencraft buttonBase-GK1x3M" tabindex="0"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-width-64 pc-alignItems-center pc-reset container-iTCOuF"><div class="pencraft pc-display-flex pc-flexDirection-column pc-width-64 pc-height-64 pc-justifyContent-center pc-alignItems-center pc-reset bg-secondary-UUD3_J animate-XFJxE4 pc-borderRadius-lg button-zkMi7O"><svg role="img" style="height: 20px; width: 20px;" width="20" height="20" viewBox="0 0 20 20" fill="var(--color-fg-primary)" stroke-width="1.8" stroke="none" xmlns="http://www.w3.org/2000/svg"><g><title></title><path d="M1.96484 0.624512H18.0354V2.70052H1.96484V0.624512Z" stroke="none"></path><path d="M1.96484 4.77655H18.0354V6.85254H1.96484V4.77655Z" stroke="none"></path><path d="M1.96484 8.92857V19.9505L10.0001 14.6347L18.0354 19.9505V8.92857H1.96484Z" stroke="none"></path></g></svg></div><div class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-11-NuY2Zx weight-semibold-uqA4FV reset-IxiVJZ">Notes</div></div></button><button type="button" class="pencraft pc-reset pc-borderRadius-sm pencraft buttonBase-GK1x3M" tabindex="0"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-width-64 pc-alignItems-center pc-reset container-iTCOuF"><div class="pencraft pc-display-flex pc-flexDirection-column pc-width-64 pc-height-64 pc-justifyContent-center pc-alignItems-center pc-reset bg-secondary-UUD3_J animate-XFJxE4 pc-borderRadius-lg button-zkMi7O"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--color-fg-primary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-ellipsis"><circle cx="12" cy="12" r="1"></circle><circle cx="19" cy="12" r="1"></circle><circle cx="5" cy="12" r="1"></circle></svg></div><div class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-11-NuY2Zx weight-semibold-uqA4FV reset-IxiVJZ">More</div></div></button></div></div></div></div></div></div></div></div></div></div></div><a role="button" href="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up/comments" aria-label="View comments (6)" class="post-ufi-button style-button post-ufi-comment-button has-label with-border"><svg role="img" style="height: 20px; width: 20px;" width="20" height="20" viewBox="0 0 24 24" fill="#000000" stroke-width="2" stroke="#000" xmlns="http://www.w3.org/2000/svg" class="icon"><g><title></title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-message-circle"><path d="M7.9 20A9 9 0 1 0 4 16.1L2 22Z"></path></svg></g></svg><div class="label">6</div></a><a role="button" class="post-ufi-button style-button has-label with-border"><svg role="img" style="height: 20px; width: 20px;" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke="#000" xmlns="http://www.w3.org/2000/svg" class="icon"><g><title></title><path d="M21 3V8M21 8H16M21 8L18 5.29962C16.7056 4.14183 15.1038 3.38328 13.3879 3.11547C11.6719 2.84766 9.9152 3.08203 8.32951 3.79031C6.74382 4.49858 5.39691 5.65051 4.45125 7.10715C3.5056 8.5638 3.00158 10.2629 3 11.9996M3 21V16M3 16H8M3 16L6 18.7C7.29445 19.8578 8.89623 20.6163 10.6121 20.8841C12.3281 21.152 14.0848 20.9176 15.6705 20.2093C17.2562 19.501 18.6031 18.3491 19.5487 16.8925C20.4944 15.4358 20.9984 13.7367 21 12" stroke-linecap="round" stroke-linejoin="round"></path></g></svg><div class="label">6</div></a><div inert="" role="dialog" class="modal typography out gone reader-onboarding-modal wide popup"><div class="modal-table"><div class="modal-row"><div class="modal-cell modal-content"><div class="container"><button tabindex="0" type="button" aria-label="X" data-testid="close-modal" class="pencraft pc-reset pencraft modal-btn modal-exit-btn no-margin iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_md-gCDS3o priority_tertiary-rlke8z"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="secondary" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg></button><div class="reader-onboarding-modal-container"></div></div></div></div></div></div></div><div class="pencraft pc-display-flex pc-gap-8 pc-reset"><a role="button" href="javascript:void(0)" aria-label="View share options" class="post-ufi-button style-button no-icon has-label with-border"><div class="label">Share</div></a></div></div></div></div><div class="visibility-check"></div><div><button tabindex="0" type="button" aria-label="Table of Contents" class="pencraft pc-position-fixed pc-reset pencraft trigger-V8d1vI fixed-n4RrZu"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-12 pc-paddingLeft-8 pc-paddingRight-8 pc-paddingTop-12 pc-paddingBottom-12 pc-alignItems-flex-end pc-reset"><div class="line-DsYVXw"></div><div class="line-DsYVXw indent-2-yiZ6hb active-Yh0Zwm"></div><div class="line-DsYVXw indent-2-yiZ6hb"></div><div class="line-DsYVXw"></div><div class="line-DsYVXw indent-2-yiZ6hb"></div><div class="line-DsYVXw indent-2-yiZ6hb"></div><div class="line-DsYVXw indent-2-yiZ6hb"></div><div class="line-DsYVXw"></div><div class="line-DsYVXw indent-2-yiZ6hb"></div><div class="line-DsYVXw indent-2-yiZ6hb"></div><div class="line-DsYVXw"></div><div class="line-DsYVXw indent-2-yiZ6hb"></div><div class="line-DsYVXw indent-2-yiZ6hb"></div></div></button><div class="available-content"><div dir="auto" class="body markup"><div class="captioned-image-container"><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!jFdK!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff3464668-f880-4091-a4f0-0c26bfe9f4c9_2134x1182.png" data-component-name="Image2ToDOM" rel="" class="image-link image2 is-viewable-img"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!jFdK!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff3464668-f880-4091-a4f0-0c26bfe9f4c9_2134x1182.png 424w, https://substackcdn.com/image/fetch/$s_!jFdK!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff3464668-f880-4091-a4f0-0c26bfe9f4c9_2134x1182.png 848w, https://substackcdn.com/image/fetch/$s_!jFdK!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff3464668-f880-4091-a4f0-0c26bfe9f4c9_2134x1182.png 1272w, https://substackcdn.com/image/fetch/$s_!jFdK!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff3464668-f880-4091-a4f0-0c26bfe9f4c9_2134x1182.png 1456w" sizes="100vw"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/f3464668-f880-4091-a4f0-0c26bfe9f4c9_2134x1182.jpg" width="1456" height="806" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/f3464668-f880-4091-a4f0-0c26bfe9f4c9_2134x1182.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:806,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:878634,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:false,&quot;topImage&quot;:true,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!jFdK!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff3464668-f880-4091-a4f0-0c26bfe9f4c9_2134x1182.png 424w, https://substackcdn.com/image/fetch/$s_!jFdK!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff3464668-f880-4091-a4f0-0c26bfe9f4c9_2134x1182.png 848w, https://substackcdn.com/image/fetch/$s_!jFdK!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff3464668-f880-4091-a4f0-0c26bfe9f4c9_2134x1182.png 1272w, https://substackcdn.com/image/fetch/$s_!jFdK!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff3464668-f880-4091-a4f0-0c26bfe9f4c9_2134x1182.png 1456w" sizes="100vw" fetchpriority="high" class="sizing-normal"></picture><div class="image-link-expand"><div class="pencraft pc-display-flex pc-gap-8 pc-reset"><div class="pencraft pc-reset icon-container restack-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M8 16H3v5"></path></svg></div><div class="pencraft pc-reset icon-container view-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-maximize2"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" x2="14" y1="3" y2="10"></line><line x1="3" x2="10" y1="21" y2="14"></line></svg></div></div></div></div></a><figcaption class="image-caption">(from [1])</figcaption></figure></div><p><span>The opeurce AI research community has heavily explored the creation of open-source, commercially-usable large language models (LLMs). Although a variety of such models perform well, none stand out quite like LLaMA-2 [1], a suite of recently-proposed open-source language models with sizes ranging from 7 to 70 billion parameters. Compared to their predecessors (i.e., </span><a href="https://cameronrwolfe.substack.com/p/llama-llms-for-everyone" rel="">LLaMA-1</a><span> [2]), LLaMA-2 models differentiate themselves by pre-training over more data, using a longer </span><a href="https://cameronrwolfe.substack.com/i/117151147/the-context-window" rel="">context length</a><span>, and adopting an architecture that is optimized for faster inference. Additionally, LLaMA-2 goes beyond prior research in open-source LLMs by investing heavily into the models’ alignment process, which is used to create LLaMA-2-Chat models that are optimized for dialogue applications and nearly match the quality of top proprietary LLMs (e.g., ChatGPT and GPT-4) in certain areas. Within this overview, we will explore the details of LLaMA-2 and build an in-depth understanding of these models starting from basic concepts.</span></p><blockquote><p><em>“There have been public releases of pre-trained LLMs (such as BLOOM) that match the performance of closed pre-trained competitors like GPT-3 and Chinchilla, but none of these models are suitable substitutes for closed product LLMs, such as ChatGPT, BARD, and Claude.” </em><span>- from [14]</span></p></blockquote><p><strong>Language model fundamentals. </strong><span>Throughout this overview, we will try to build an understanding of relevant concepts from the ground up (sometimes providing links for further reading for the purpose of brevity). However, we will not cover fundamentals with respect to how language models work in general. For these details, I highly recommend reading the resources below:</span></p><ul><li><p><span>The transformer architecture [</span><a href="http://jalammar.github.io/illustrated-transformer/" rel="">link</a><span>]</span></p></li><li><p><span>Decoder-only transformer architecture [</span><a href="https://twitter.com/cwolferesearch/status/1640446111348555776?s=20" rel="">link</a><span>]</span></p></li><li><p><span>Language modeling (next-token prediction) objective [</span><a href="https://cameronrwolfe.substack.com/i/135273362/the-language-modeling-objective" rel="">link</a><span>]</span></p></li><li><p><span>Prompting language models [</span><a href="https://cameronrwolfe.substack.com/p/practical-prompt-engineering-part" rel="">link</a><span>]</span></p></li><li><p><span>Specialized language models [</span><a href="https://cameronrwolfe.substack.com/p/specialized-llms-chatgpt-lamda-galactica" rel="">link</a><span>]</span></p></li><li><p><span>Decoding (or inference) with a language model [</span><a href="https://twitter.com/cwolferesearch/status/1659608476455256078?s=20" rel="">link</a><span>]</span></p></li></ul><p>Gaining an in-depth understanding of fundamental concepts related to language models is important for understanding this overview. Leveraging this knowledge, we will now build upon these basic concepts to better understand how LLaMA-2 approaches and improves the pre-training and alignment process for LLMs.</p><h2 class="header-anchor-post">Model Architecture and Pre-Training<div class="pencraft pc-display-flex pc-alignItems-center pc-position-absolute pc-reset header-anchor-parent"><div class="pencraft pc-display-contents pc-reset pubTheme-yiXxQA"><div id="§model-architecture-and-pre-training" class="pencraft pc-reset header-anchor offset-top"></div><button type="button" aria-label="Link" data-href="https://cameronrwolfe.substack.com/i/135824233/model-architecture-and-pre-training" class="pencraft pc-reset pencraft iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_sm-G3LciD priority_secondary-S63h9o" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></button></div></div></h2><div class="captioned-image-container"><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!k3Ps!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fdd8bc0b7-e7b7-4a96-9e00-627ad2ecda20_2232x1362.png" data-component-name="Image2ToDOM" rel="" class="image-link image2 is-viewable-img"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!k3Ps!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fdd8bc0b7-e7b7-4a96-9e00-627ad2ecda20_2232x1362.png 424w, https://substackcdn.com/image/fetch/$s_!k3Ps!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fdd8bc0b7-e7b7-4a96-9e00-627ad2ecda20_2232x1362.png 848w, https://substackcdn.com/image/fetch/$s_!k3Ps!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fdd8bc0b7-e7b7-4a96-9e00-627ad2ecda20_2232x1362.png 1272w, https://substackcdn.com/image/fetch/$s_!k3Ps!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fdd8bc0b7-e7b7-4a96-9e00-627ad2ecda20_2232x1362.png 1456w" sizes="100vw"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/dd8bc0b7-e7b7-4a96-9e00-627ad2ecda20_2232x1362.jpg" width="1456" height="888" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/dd8bc0b7-e7b7-4a96-9e00-627ad2ecda20_2232x1362.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:888,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:386034,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:false,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!k3Ps!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fdd8bc0b7-e7b7-4a96-9e00-627ad2ecda20_2232x1362.png 424w, https://substackcdn.com/image/fetch/$s_!k3Ps!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fdd8bc0b7-e7b7-4a96-9e00-627ad2ecda20_2232x1362.png 848w, https://substackcdn.com/image/fetch/$s_!k3Ps!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fdd8bc0b7-e7b7-4a96-9e00-627ad2ecda20_2232x1362.png 1272w, https://substackcdn.com/image/fetch/$s_!k3Ps!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fdd8bc0b7-e7b7-4a96-9e00-627ad2ecda20_2232x1362.png 1456w" sizes="100vw" class="sizing-normal"></picture><div class="image-link-expand"><div class="pencraft pc-display-flex pc-gap-8 pc-reset"><div class="pencraft pc-reset icon-container restack-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M8 16H3v5"></path></svg></div><div class="pencraft pc-reset icon-container view-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-maximize2"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" x2="14" y1="3" y2="10"></line><line x1="3" x2="10" y1="21" y2="14"></line></svg></div></div></div></div></a><figcaption class="image-caption">(from [3])</figcaption></figure></div><p>There are many factors that contribute to the utility of LLaMA-2. To begin with, however, the models use a modified (and improved) model architecture and pre-training procedure. Compared to its predecessor, LLaMA-2 has an architecture that is optimized for faster inference and is pre-trained over more data, allowing a broader knowledge base to be formed; see above.</p><h4 class="header-anchor-post">Optimized Architecture with Faster Inference<div class="pencraft pc-display-flex pc-alignItems-center pc-position-absolute pc-reset header-anchor-parent"><div class="pencraft pc-display-contents pc-reset pubTheme-yiXxQA"><div id="§optimized-architecture-with-faster-inference" class="pencraft pc-reset header-anchor offset-top"></div><button type="button" aria-label="Link" data-href="https://cameronrwolfe.substack.com/i/135824233/optimized-architecture-with-faster-inference" class="pencraft pc-reset pencraft iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_sm-G3LciD priority_secondary-S63h9o" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></button></div></div></h4><p><span>LLaMa-2 adopts the model architecture of LLaMA-1 with a few modifications. To understand LLaMA-2’s architecture, we need a working understanding of the transformer architecture in general; see </span><a href="https://cameronrwolfe.substack.com/i/85568430/decoder-only-transformers" rel="">here</a><span> for more details on this topic. More specifically, nearly all causal language models adopt the </span><a href="https://twitter.com/cwolferesearch/status/1640446111348555776?s=20" rel="">decoder-only variant</a><span> of the transformer architecture. Now, we will study some of the modifications to this architecture that are made by both </span><a href="https://cameronrwolfe.substack.com/p/llama-llms-for-everyone" rel="">LLaMA</a><span> [2] and LLaMA-2 [1]. All of these changes apply to both LLaMA and LLaMA-2 unless otherwise specified.</span></p><div class="captioned-image-container"><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!9tyU!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3b6fab4d-7825-47ec-a59e-979d9dfa0384_1256x938.png" data-component-name="Image2ToDOM" rel="" class="image-link image2 is-viewable-img"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!9tyU!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3b6fab4d-7825-47ec-a59e-979d9dfa0384_1256x938.png 424w, https://substackcdn.com/image/fetch/$s_!9tyU!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3b6fab4d-7825-47ec-a59e-979d9dfa0384_1256x938.png 848w, https://substackcdn.com/image/fetch/$s_!9tyU!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3b6fab4d-7825-47ec-a59e-979d9dfa0384_1256x938.png 1272w, https://substackcdn.com/image/fetch/$s_!9tyU!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3b6fab4d-7825-47ec-a59e-979d9dfa0384_1256x938.png 1456w" sizes="100vw"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/3b6fab4d-7825-47ec-a59e-979d9dfa0384_1256x938.png" width="447" height="333.82643312101914" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/3b6fab4d-7825-47ec-a59e-979d9dfa0384_1256x938.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:938,&quot;width&quot;:1256,&quot;resizeWidth&quot;:447,&quot;bytes&quot;:98417,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!9tyU!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3b6fab4d-7825-47ec-a59e-979d9dfa0384_1256x938.png 424w, https://substackcdn.com/image/fetch/$s_!9tyU!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3b6fab4d-7825-47ec-a59e-979d9dfa0384_1256x938.png 848w, https://substackcdn.com/image/fetch/$s_!9tyU!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3b6fab4d-7825-47ec-a59e-979d9dfa0384_1256x938.png 1272w, https://substackcdn.com/image/fetch/$s_!9tyU!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3b6fab4d-7825-47ec-a59e-979d9dfa0384_1256x938.png 1456w" sizes="100vw" loading="lazy" class="sizing-normal"></picture><div class="image-link-expand"><div class="pencraft pc-display-flex pc-gap-8 pc-reset"><div class="pencraft pc-reset icon-container restack-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M8 16H3v5"></path></svg></div><div class="pencraft pc-reset icon-container view-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-maximize2"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" x2="14" y1="3" y2="10"></line><line x1="3" x2="10" y1="21" y2="14"></line></svg></div></div></div></div></a><figcaption class="image-caption">LLaMA-2 uses a pre-normalization variant of the normal transformer block</figcaption></figure></div><p><strong>Normalization. </strong><span>Most transformer architectures adopt </span><a href="https://pytorch.org/docs/stable/generated/torch.nn.LayerNorm.html" rel="">layer normalization</a><span>, which is applied after each layer within the transformer block; see above. LLaMA, however, replaces this with a variant called Root Mean Square Layer Normalization (or </span><a href="https://github.com/bzhangGo/rmsnorm" rel="">RMSNorm</a><span> for short!), which is a simplified version of layer normalization that has been shown to improve training stability and generalization</span><span class="footnote-hovercard-target"><a data-component-name="FootnoteAnchorToDOM" id="footnote-anchor-1-135824233" href="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up#footnote-1-135824233" target="_self" rel="" class="footnote-anchor">1</a></span><span> [4]. RMSNorm is formulated as shown below.</span></p><div class="captioned-image-container"><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!S8-H!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbaeeee5e-8cba-426f-9fa4-8666a7e76155_1080x138.png" data-component-name="Image2ToDOM" rel="" class="image-link image2"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!S8-H!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbaeeee5e-8cba-426f-9fa4-8666a7e76155_1080x138.png 424w, https://substackcdn.com/image/fetch/$s_!S8-H!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbaeeee5e-8cba-426f-9fa4-8666a7e76155_1080x138.png 848w, https://substackcdn.com/image/fetch/$s_!S8-H!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbaeeee5e-8cba-426f-9fa4-8666a7e76155_1080x138.png 1272w, https://substackcdn.com/image/fetch/$s_!S8-H!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbaeeee5e-8cba-426f-9fa4-8666a7e76155_1080x138.png 1456w" sizes="100vw"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/baeeee5e-8cba-426f-9fa4-8666a7e76155_1080x138.jpg" width="463" height="59.16111111111111" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/baeeee5e-8cba-426f-9fa4-8666a7e76155_1080x138.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:138,&quot;width&quot;:1080,&quot;resizeWidth&quot;:463,&quot;bytes&quot;:35449,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!S8-H!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbaeeee5e-8cba-426f-9fa4-8666a7e76155_1080x138.png 424w, https://substackcdn.com/image/fetch/$s_!S8-H!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbaeeee5e-8cba-426f-9fa4-8666a7e76155_1080x138.png 848w, https://substackcdn.com/image/fetch/$s_!S8-H!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbaeeee5e-8cba-426f-9fa4-8666a7e76155_1080x138.png 1272w, https://substackcdn.com/image/fetch/$s_!S8-H!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbaeeee5e-8cba-426f-9fa4-8666a7e76155_1080x138.png 1456w" sizes="100vw" loading="lazy" class="sizing-normal"></picture><div></div></div></a></figure></div><p>For LLaMA, a pre-normalization variant of RMSNorm is adopted, meaning that normalization is applied prior to the major layers in a transformer block, rather than after, as shown in the figure above. RMSNorm achieves comparable levels of performance compared to layer norm with a 10-50% improvement in efficiency.</p><p><strong>Activation functions.</strong><span> LLaMA models adopt the SwiGLU activation function—as opposed to the standard </span><a href="https://pytorch.org/docs/stable/generated/torch.nn.ReLU.html" rel="">ReLU</a><span> function adopted by most neural networks—within their feed-forward layers. The SwiGLU activation function can be formulated as follows.</span></p><div class="captioned-image-container"><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!iFse!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9aec7e3e-45bc-42f1-9e0c-0248bee25263_982x244.png" data-component-name="Image2ToDOM" rel="" class="image-link image2"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!iFse!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9aec7e3e-45bc-42f1-9e0c-0248bee25263_982x244.png 424w, https://substackcdn.com/image/fetch/$s_!iFse!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9aec7e3e-45bc-42f1-9e0c-0248bee25263_982x244.png 848w, https://substackcdn.com/image/fetch/$s_!iFse!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9aec7e3e-45bc-42f1-9e0c-0248bee25263_982x244.png 1272w, https://substackcdn.com/image/fetch/$s_!iFse!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9aec7e3e-45bc-42f1-9e0c-0248bee25263_982x244.png 1456w" sizes="100vw"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/9aec7e3e-45bc-42f1-9e0c-0248bee25263_982x244.jpg" width="321" height="79.75967413441956" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/9aec7e3e-45bc-42f1-9e0c-0248bee25263_982x244.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:244,&quot;width&quot;:982,&quot;resizeWidth&quot;:321,&quot;bytes&quot;:60320,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!iFse!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9aec7e3e-45bc-42f1-9e0c-0248bee25263_982x244.png 424w, https://substackcdn.com/image/fetch/$s_!iFse!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9aec7e3e-45bc-42f1-9e0c-0248bee25263_982x244.png 848w, https://substackcdn.com/image/fetch/$s_!iFse!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9aec7e3e-45bc-42f1-9e0c-0248bee25263_982x244.png 1272w, https://substackcdn.com/image/fetch/$s_!iFse!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9aec7e3e-45bc-42f1-9e0c-0248bee25263_982x244.png 1456w" sizes="100vw" loading="lazy" class="sizing-normal"></picture><div></div></div></a></figure></div><p><span>SwiGLU is an element-wise product of two </span><a href="https://mathworld.wolfram.com/LinearTransformation.html" rel="">linear transformations</a><span> of the input </span><code>x</code><span>, one of which has had a Swish activation applied to it. This activation function requires three matrix multiplications (i.e., it is more computationally expensive than a normal activation function such as ReLU), but it has been found to yield improvements in performance relative to other activation functions, </span><em>even when the amount of compute being used is held constant</em><span>. A more in-depth analysis of potential activation functions for LLMs can be found in [5].</span></p><p><strong>RoPE.</strong><span> Instead of using </span><a href="https://cameronrwolfe.substack.com/p/language-understanding-with-bert#%C2%A7berts-architecture" rel="">absolute</a><span> or </span><a href="https://jaketae.github.io/study/relative-positional-encoding/" rel="">relative</a><span> positional embeddings, LLaMA models adopt a RoPE [6] scheme, which finds a balance between the absolute and relative position of each token in a sequence. This position embedding approach encodes absolute position with a </span><a href="https://en.wikipedia.org/wiki/Rotation_matrix" rel="">rotation matrix</a><span> and adds relative position information directly into the </span><a href="https://twitter.com/cwolferesearch/status/1641932082283700226?s=20" rel="">self-attention operation</a><span>. The benefit of RoPE embeddings on tasks with longer sequence lengths has led this approach to be adopted by a variety of LLMs (e.g., </span><a href="https://cameronrwolfe.substack.com/p/palm-efficiently-training-massive" rel="">PaLM</a><span> [7] and </span><a href="https://cameronrwolfe.substack.com/p/falcon-the-pinnacle-of-open-source" rel="">Falcon</a><span> [8]); read more below.</span></p><p data-attrs="{&quot;url&quot;:&quot;https://blog.eleuther.ai/rotary-embeddings/&quot;,&quot;text&quot;:&quot;Learn about RoPE&quot;,&quot;action&quot;:null,&quot;class&quot;:null}" data-component-name="ButtonCreateButton" class="button-wrapper"><a href="https://blog.eleuther.ai/rotary-embeddings/" rel="" class="button primary"><span>Learn about RoPE</span></a></p><div class="captioned-image-container"><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!KCGS!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa9b56d4a-69cc-446d-83e1-5359b87ebf8e_2212x816.png" data-component-name="Image2ToDOM" rel="" class="image-link image2 is-viewable-img"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!KCGS!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa9b56d4a-69cc-446d-83e1-5359b87ebf8e_2212x816.png 424w, https://substackcdn.com/image/fetch/$s_!KCGS!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa9b56d4a-69cc-446d-83e1-5359b87ebf8e_2212x816.png 848w, https://substackcdn.com/image/fetch/$s_!KCGS!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa9b56d4a-69cc-446d-83e1-5359b87ebf8e_2212x816.png 1272w, https://substackcdn.com/image/fetch/$s_!KCGS!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa9b56d4a-69cc-446d-83e1-5359b87ebf8e_2212x816.png 1456w" sizes="100vw"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/a9b56d4a-69cc-446d-83e1-5359b87ebf8e_2212x816.jpg" width="1456" height="537" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/a9b56d4a-69cc-446d-83e1-5359b87ebf8e_2212x816.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:537,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:237783,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!KCGS!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa9b56d4a-69cc-446d-83e1-5359b87ebf8e_2212x816.png 424w, https://substackcdn.com/image/fetch/$s_!KCGS!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa9b56d4a-69cc-446d-83e1-5359b87ebf8e_2212x816.png 848w, https://substackcdn.com/image/fetch/$s_!KCGS!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa9b56d4a-69cc-446d-83e1-5359b87ebf8e_2212x816.png 1272w, https://substackcdn.com/image/fetch/$s_!KCGS!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa9b56d4a-69cc-446d-83e1-5359b87ebf8e_2212x816.png 1456w" sizes="100vw" loading="lazy" class="sizing-normal"></picture><div class="image-link-expand"><div class="pencraft pc-display-flex pc-gap-8 pc-reset"><div class="pencraft pc-reset icon-container restack-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M8 16H3v5"></path></svg></div><div class="pencraft pc-reset icon-container view-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-maximize2"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" x2="14" y1="3" y2="10"></line><line x1="3" x2="10" y1="21" y2="14"></line></svg></div></div></div></div></a><figcaption class="image-caption">(from [1])</figcaption></figure></div><p><strong>What is different?</strong><span> So far, all of the modifications to the normal decoder-only transformer that we have discussed are adopted by both LLaMA and LLaMA-2. However, LLaMA-2 does have a few notable architectural changes compared to its predecessor. First, LLaMA-2 is trained with a longer </span><a href="https://cameronrwolfe.substack.com/i/117151147/the-context-window" rel="">context length</a><span> of 4K tokens (i.e., LLaMA was trained with a 2K context length). Additionally, LLaMA-2 adopts grouped query attention (GQA) [9] within each of its layers; see below. This modification is made to speed up the inference process of LLaMA-2 models. </span></p><div class="captioned-image-container"><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!QELC!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8a7dc1e2-e66c-4a30-a0a7-518ae7e3a566_1536x596.png" data-component-name="Image2ToDOM" rel="" class="image-link image2 is-viewable-img"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!QELC!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8a7dc1e2-e66c-4a30-a0a7-518ae7e3a566_1536x596.png 424w, https://substackcdn.com/image/fetch/$s_!QELC!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8a7dc1e2-e66c-4a30-a0a7-518ae7e3a566_1536x596.png 848w, https://substackcdn.com/image/fetch/$s_!QELC!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8a7dc1e2-e66c-4a30-a0a7-518ae7e3a566_1536x596.png 1272w, https://substackcdn.com/image/fetch/$s_!QELC!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8a7dc1e2-e66c-4a30-a0a7-518ae7e3a566_1536x596.png 1456w" sizes="100vw"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/8a7dc1e2-e66c-4a30-a0a7-518ae7e3a566_1536x596.jpg" width="1456" height="565" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/8a7dc1e2-e66c-4a30-a0a7-518ae7e3a566_1536x596.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:565,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:null,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:null,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!QELC!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8a7dc1e2-e66c-4a30-a0a7-518ae7e3a566_1536x596.png 424w, https://substackcdn.com/image/fetch/$s_!QELC!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8a7dc1e2-e66c-4a30-a0a7-518ae7e3a566_1536x596.png 848w, https://substackcdn.com/image/fetch/$s_!QELC!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8a7dc1e2-e66c-4a30-a0a7-518ae7e3a566_1536x596.png 1272w, https://substackcdn.com/image/fetch/$s_!QELC!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8a7dc1e2-e66c-4a30-a0a7-518ae7e3a566_1536x596.png 1456w" sizes="100vw" loading="lazy" class="sizing-normal"></picture><div class="image-link-expand"><div class="pencraft pc-display-flex pc-gap-8 pc-reset"><div class="pencraft pc-reset icon-container restack-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M8 16H3v5"></path></svg></div><div class="pencraft pc-reset icon-container view-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-maximize2"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" x2="14" y1="3" y2="10"></line><line x1="3" x2="10" y1="21" y2="14"></line></svg></div></div></div></div></a><figcaption class="image-caption">(from [9])</figcaption></figure></div><p><span>GQA is a modified version of the standard multi-head </span><a href="https://twitter.com/cwolferesearch/status/1644773244786941952?s=20" rel="">causal self-attention</a><span>. In GQA, we divide the </span><code>N</code><span> total self-attention heads into groups, where key and value heads are shared within each group; see above. Such an approach is an interpolation between vanilla multi-headed self-attention and </span><a href="https://cameronrwolfe.substack.com/i/104244919/architectural-modifications" rel="">multi-query attention</a><span>, which uses a shared key and value projection across all </span><code>N</code><span> heads. Interestingly, </span><em>GQA maintains the performance of vanilla multi-headed causal self-attention and achieves comparable efficiency compared to multi-query attention</em><span>. </span></p><h4 class="header-anchor-post">More Data = Better Model<div class="pencraft pc-display-flex pc-alignItems-center pc-position-absolute pc-reset header-anchor-parent"><div class="pencraft pc-display-contents pc-reset pubTheme-yiXxQA"><div id="§more-data-better-model" class="pencraft pc-reset header-anchor offset-top"></div><button type="button" aria-label="Link" data-href="https://cameronrwolfe.substack.com/i/135824233/more-data-better-model" class="pencraft pc-reset pencraft iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_sm-G3LciD priority_secondary-S63h9o" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></button></div></div></h4><p><span>All LLMs</span><span class="footnote-hovercard-target"><a data-component-name="FootnoteAnchorToDOM" id="footnote-anchor-2-135824233" href="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up#footnote-2-135824233" target="_self" rel="" class="footnote-anchor">2</a></span><span> follow a (relatively) standard and simple pre-training process, based upon an unlabeled textual corpus and the </span><a href="https://cameronrwolfe.substack.com/i/85568430/language-modeling" rel="">next token prediction</a><span> objective. Given that the pre-training methodology for LLMs is standardized, model performance is largely correlated with the quality and amount of data used for pre-training. For pre-trained base models, using </span><a href="https://twitter.com/cwolferesearch/status/1688662318522007552?s=20" rel="">more and better data</a><span> for pre-training the LLM will generally improve the resulting model’s performance! </span></p><blockquote><p><em>“The capabilities of LLMs are remarkable considering the seemingly straightforward nature of the training methodology.”</em><span> - from [1]</span></p></blockquote><p><strong>The LLaMA approach.</strong><span> Both LLaMA and LLaMA-2 use solely public sources of data for pre-training. Such a choice is made deliberately to ensure that the pre-training process can be openly replicated by anyone with sufficient compute resources. Compared to LLaMA, however, LLaMA-2 adopts a new mixture of pre-training data (i.e., sources that are known to be high-quality and factual are sampled more heavily) and increases the size of the pre-training dataset by 40%. Such a change allows the model to learn from more data during pre-training and, as a result, improves the knowledge base possessed by LLAMA-2.  </span></p><div class="captioned-image-container"><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!J1zP!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd0e47f39-c9ce-4fbe-89d3-96f9baa2cd5f_1270x1362.png" data-component-name="Image2ToDOM" rel="" class="image-link image2 is-viewable-img"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!J1zP!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd0e47f39-c9ce-4fbe-89d3-96f9baa2cd5f_1270x1362.png 424w, https://substackcdn.com/image/fetch/$s_!J1zP!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd0e47f39-c9ce-4fbe-89d3-96f9baa2cd5f_1270x1362.png 848w, https://substackcdn.com/image/fetch/$s_!J1zP!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd0e47f39-c9ce-4fbe-89d3-96f9baa2cd5f_1270x1362.png 1272w, https://substackcdn.com/image/fetch/$s_!J1zP!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd0e47f39-c9ce-4fbe-89d3-96f9baa2cd5f_1270x1362.png 1456w" sizes="100vw"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/d0e47f39-c9ce-4fbe-89d3-96f9baa2cd5f_1270x1362.png" width="553" height="593.059842519685" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/d0e47f39-c9ce-4fbe-89d3-96f9baa2cd5f_1270x1362.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:1362,&quot;width&quot;:1270,&quot;resizeWidth&quot;:553,&quot;bytes&quot;:334047,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!J1zP!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd0e47f39-c9ce-4fbe-89d3-96f9baa2cd5f_1270x1362.png 424w, https://substackcdn.com/image/fetch/$s_!J1zP!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd0e47f39-c9ce-4fbe-89d3-96f9baa2cd5f_1270x1362.png 848w, https://substackcdn.com/image/fetch/$s_!J1zP!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd0e47f39-c9ce-4fbe-89d3-96f9baa2cd5f_1270x1362.png 1272w, https://substackcdn.com/image/fetch/$s_!J1zP!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd0e47f39-c9ce-4fbe-89d3-96f9baa2cd5f_1270x1362.png 1456w" sizes="100vw" loading="lazy" class="sizing-normal"></picture><div class="image-link-expand"><div class="pencraft pc-display-flex pc-gap-8 pc-reset"><div class="pencraft pc-reset icon-container restack-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M8 16H3v5"></path></svg></div><div class="pencraft pc-reset icon-container view-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-maximize2"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" x2="14" y1="3" y2="10"></line><line x1="3" x2="10" y1="21" y2="14"></line></svg></div></div></div></div></a><figcaption class="image-caption">(from [1])</figcaption></figure></div><p><strong>Pre-training on the right data.</strong><span> As we will see, LLaMA-2 places an emphasis on key properties like helpfulness and safety that should be encouraged within the resulting model. Interestingly, LLaMA-2’s focus upon safety metrics and data quality begins as early as the pre-training process. Data from sources that are known to contain high levels of personal information are excluded from the pre-training set, while data coming from factual or respected sources is emphasized more heavily during pre-training. Additionally, authors measure various factors, such as representation of different demographic groups and levels of toxicity, to minimize the amount of bias within LLaMA-2; see above. Put simply, great care is placed into the contents and composition of LLAMA-2’s pre-training dataset. </span></p><h2 class="header-anchor-post">Fine-Tuning Process and LLaMA-2-Chat<div class="pencraft pc-display-flex pc-alignItems-center pc-position-absolute pc-reset header-anchor-parent"><div class="pencraft pc-display-contents pc-reset pubTheme-yiXxQA"><div id="§fine-tuning-process-and-llama-chat" class="pencraft pc-reset header-anchor offset-top"></div><button type="button" aria-label="Link" data-href="https://cameronrwolfe.substack.com/i/135824233/fine-tuning-process-and-llama-chat" class="pencraft pc-reset pencraft iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_sm-G3LciD priority_secondary-S63h9o" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></button></div></div></h2><div class="captioned-image-container"><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!rRss!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8e5666f4-b294-40ad-8fa6-72f5c68e2f53_2210x1328.png" data-component-name="Image2ToDOM" rel="" class="image-link image2 is-viewable-img"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!rRss!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8e5666f4-b294-40ad-8fa6-72f5c68e2f53_2210x1328.png 424w, https://substackcdn.com/image/fetch/$s_!rRss!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8e5666f4-b294-40ad-8fa6-72f5c68e2f53_2210x1328.png 848w, https://substackcdn.com/image/fetch/$s_!rRss!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8e5666f4-b294-40ad-8fa6-72f5c68e2f53_2210x1328.png 1272w, https://substackcdn.com/image/fetch/$s_!rRss!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8e5666f4-b294-40ad-8fa6-72f5c68e2f53_2210x1328.png 1456w" sizes="100vw"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/8e5666f4-b294-40ad-8fa6-72f5c68e2f53_2210x1328.jpg" width="1456" height="875" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/8e5666f4-b294-40ad-8fa6-72f5c68e2f53_2210x1328.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:875,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:465511,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!rRss!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8e5666f4-b294-40ad-8fa6-72f5c68e2f53_2210x1328.png 424w, https://substackcdn.com/image/fetch/$s_!rRss!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8e5666f4-b294-40ad-8fa6-72f5c68e2f53_2210x1328.png 848w, https://substackcdn.com/image/fetch/$s_!rRss!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8e5666f4-b294-40ad-8fa6-72f5c68e2f53_2210x1328.png 1272w, https://substackcdn.com/image/fetch/$s_!rRss!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8e5666f4-b294-40ad-8fa6-72f5c68e2f53_2210x1328.png 1456w" sizes="100vw" loading="lazy" class="sizing-normal"></picture><div class="image-link-expand"><div class="pencraft pc-display-flex pc-gap-8 pc-reset"><div class="pencraft pc-reset icon-container restack-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M8 16H3v5"></path></svg></div><div class="pencraft pc-reset icon-container view-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-maximize2"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" x2="14" y1="3" y2="10"></line><line x1="3" x2="10" y1="21" y2="14"></line></svg></div></div></div></div></a><figcaption class="image-caption">(from [1])</figcaption></figure></div><p>Prior to LLaMA-2, most open-source models were aligned exclusively by performing supervised fine-tuning (SFT) over publicly-available datasets. However, proprietary models (e.g., ChatGPT or GPT-4) tend to follow a more thorough approach that fine-tunes the LLM over extensive amounts of dialogue and human feedback. Attempting to close this gap, LLaMA-2 is fine-tuned using a large dataset in a similar manner to proprietary models, producing the LLaMA-2-Chat model that is optimized for dialogue-based applications; see above. For most closed-source models, the alignment process is highly proprietary, but LLaMA-2 attempts to improve transparency and make high-quality alignment more understandable for open-source research efforts.</p><blockquote><p><em>“Closed product LLMs are heavily fine-tuned to align with human preferences, which greatly enhances their usability and safety. This step can require significant costs in compute and human annotation, and is often not transparent or easily reproducible, limiting progress within the community to advance AI alignment research.”</em><span> - from [1]</span></p></blockquote><p><strong>What is alignment? </strong><span>Alignment refers to the idea of teaching an LLM to produce an output that </span><em>aligns</em><span> with human desires. While the pre-training process focuses upon accurately performing next token prediction, alignment fine-tunes—typically using </span><a href="https://cameronrwolfe.substack.com/i/93578656/refining-llm-behavior" rel="">supervised fine-tuning (SFT) and/or reinforcement learning from human feedback (RLHF)</a><span>—the model to accomplish a variety of different goals; see below. Notably, LLMs gain </span><a href="https://cameronrwolfe.substack.com/i/134561977/lima-less-is-more-for-alignment" rel="">most of their knowledge base</a><span> during pre-training, while alignment serves to teach them the correct output style or format.</span></p><div class="captioned-image-container"><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!SXav!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9295576d-46db-45db-b156-ccaae2ebaa99_2428x588.png" data-component-name="Image2ToDOM" rel="" class="image-link image2"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!SXav!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9295576d-46db-45db-b156-ccaae2ebaa99_2428x588.png 424w, https://substackcdn.com/image/fetch/$s_!SXav!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9295576d-46db-45db-b156-ccaae2ebaa99_2428x588.png 848w, https://substackcdn.com/image/fetch/$s_!SXav!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9295576d-46db-45db-b156-ccaae2ebaa99_2428x588.png 1272w, https://substackcdn.com/image/fetch/$s_!SXav!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9295576d-46db-45db-b156-ccaae2ebaa99_2428x588.png 1456w" sizes="100vw"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/9295576d-46db-45db-b156-ccaae2ebaa99_2428x588.jpg" width="1456" height="353" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/9295576d-46db-45db-b156-ccaae2ebaa99_2428x588.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:353,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:342358,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!SXav!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9295576d-46db-45db-b156-ccaae2ebaa99_2428x588.png 424w, https://substackcdn.com/image/fetch/$s_!SXav!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9295576d-46db-45db-b156-ccaae2ebaa99_2428x588.png 848w, https://substackcdn.com/image/fetch/$s_!SXav!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9295576d-46db-45db-b156-ccaae2ebaa99_2428x588.png 1272w, https://substackcdn.com/image/fetch/$s_!SXav!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9295576d-46db-45db-b156-ccaae2ebaa99_2428x588.png 1456w" sizes="100vw" loading="lazy" class="sizing-normal"></picture><div></div></div></a><figcaption class="image-caption">(from [10, 11])</figcaption></figure></div><p><span>For example, alignment can be performed with a goal of reducing hallucinations, avoiding unsafe questions</span><span class="footnote-hovercard-target"><a data-component-name="FootnoteAnchorToDOM" id="footnote-anchor-3-135824233" href="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up#footnote-3-135824233" target="_self" rel="" class="footnote-anchor">3</a></span><span>, following detailed instructions, and more. Multiple goals can be aligned for at once.  In the case of LLaMA-2, authors focus upon improving the following criteria during alignment:</span></p><ul><li><p><em>Helpfulness</em><span>: the model fulfills users’ requests and provides requested information.</span></p></li><li><p><em>Safety</em><span>: the model avoids responses that are “unsafe”</span></p></li></ul><p>Performing alignment in pursuit of these goals produces the LLaMA-2-Chat model that is specialized for dialogue-based use cases. Given that LLaMA-2-Chat is fine-tuned/aligned using both SFT and RLHF, we will now consider and explore each of these phases of fine-tuning individually. </p><h4 class="header-anchor-post">Supervised Fine-Tuning (SFT)<div class="pencraft pc-display-flex pc-alignItems-center pc-position-absolute pc-reset header-anchor-parent"><div class="pencraft pc-display-contents pc-reset pubTheme-yiXxQA"><div id="§supervised-fine-tuning-sft" class="pencraft pc-reset header-anchor offset-top"></div><button type="button" aria-label="Link" data-href="https://cameronrwolfe.substack.com/i/135824233/supervised-fine-tuning-sft" class="pencraft pc-reset pencraft iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_sm-G3LciD priority_secondary-S63h9o" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></button></div></div></h4><div class="captioned-image-container"><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!qMvq!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff1368769-40db-440b-b13f-5299b62dd53a_632x1070.png" data-component-name="Image2ToDOM" rel="" class="image-link image2 is-viewable-img"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!qMvq!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff1368769-40db-440b-b13f-5299b62dd53a_632x1070.png 424w, https://substackcdn.com/image/fetch/$s_!qMvq!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff1368769-40db-440b-b13f-5299b62dd53a_632x1070.png 848w, https://substackcdn.com/image/fetch/$s_!qMvq!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff1368769-40db-440b-b13f-5299b62dd53a_632x1070.png 1272w, https://substackcdn.com/image/fetch/$s_!qMvq!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff1368769-40db-440b-b13f-5299b62dd53a_632x1070.png 1456w" sizes="100vw"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/f1368769-40db-440b-b13f-5299b62dd53a_632x1070.jpg" width="226" height="382.626582278481" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/f1368769-40db-440b-b13f-5299b62dd53a_632x1070.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:1070,&quot;width&quot;:632,&quot;resizeWidth&quot;:226,&quot;bytes&quot;:124874,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!qMvq!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff1368769-40db-440b-b13f-5299b62dd53a_632x1070.png 424w, https://substackcdn.com/image/fetch/$s_!qMvq!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff1368769-40db-440b-b13f-5299b62dd53a_632x1070.png 848w, https://substackcdn.com/image/fetch/$s_!qMvq!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff1368769-40db-440b-b13f-5299b62dd53a_632x1070.png 1272w, https://substackcdn.com/image/fetch/$s_!qMvq!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff1368769-40db-440b-b13f-5299b62dd53a_632x1070.png 1456w" sizes="100vw" loading="lazy" class="sizing-normal"></picture><div class="image-link-expand"><div class="pencraft pc-display-flex pc-gap-8 pc-reset"><div class="pencraft pc-reset icon-container restack-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M8 16H3v5"></path></svg></div><div class="pencraft pc-reset icon-container view-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-maximize2"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" x2="14" y1="3" y2="10"></line><line x1="3" x2="10" y1="21" y2="14"></line></svg></div></div></div></div></a><figcaption class="image-caption">(from [10])</figcaption></figure></div><p><span>The first step in the fine-tuning process for LLaMA-2 is SFT. This technique is simple to understand, as it relies upon a (supervised) next-token prediction objective that is nearly identical to pre-training; see above. Put simply, we just collect a dataset of dialogue examples (i.e., prompt and response pairs; see below)</span><span class="footnote-hovercard-target"><a data-component-name="FootnoteAnchorToDOM" id="footnote-anchor-4-135824233" href="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up#footnote-4-135824233" target="_self" rel="" class="footnote-anchor">4</a></span><span> and train the model using a </span><a href="https://cameronrwolfe.substack.com/i/135273362/the-language-modeling-objective" rel="">next-token prediction objective</a><span> applied to the responses within each of these examples. By fine-tuning the model in this way, the LLM learns to replicate behavior emulated within the responses of the fine-tuning dataset. Thus, any desirable properties—or alignment objectives—present within this data, in turn, become present within the model itself.</span></p><div class="captioned-image-container"><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!RMwG!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8c6d0e01-1cb0-4acf-937a-52b05d96591a_1272x672.png" data-component-name="Image2ToDOM" rel="" class="image-link image2 is-viewable-img"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!RMwG!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8c6d0e01-1cb0-4acf-937a-52b05d96591a_1272x672.png 424w, https://substackcdn.com/image/fetch/$s_!RMwG!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8c6d0e01-1cb0-4acf-937a-52b05d96591a_1272x672.png 848w, https://substackcdn.com/image/fetch/$s_!RMwG!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8c6d0e01-1cb0-4acf-937a-52b05d96591a_1272x672.png 1272w, https://substackcdn.com/image/fetch/$s_!RMwG!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8c6d0e01-1cb0-4acf-937a-52b05d96591a_1272x672.png 1456w" sizes="100vw"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/8c6d0e01-1cb0-4acf-937a-52b05d96591a_1272x672.jpg" width="1272" height="672" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/8c6d0e01-1cb0-4acf-937a-52b05d96591a_1272x672.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:672,&quot;width&quot;:1272,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:209713,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!RMwG!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8c6d0e01-1cb0-4acf-937a-52b05d96591a_1272x672.png 424w, https://substackcdn.com/image/fetch/$s_!RMwG!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8c6d0e01-1cb0-4acf-937a-52b05d96591a_1272x672.png 848w, https://substackcdn.com/image/fetch/$s_!RMwG!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8c6d0e01-1cb0-4acf-937a-52b05d96591a_1272x672.png 1272w, https://substackcdn.com/image/fetch/$s_!RMwG!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8c6d0e01-1cb0-4acf-937a-52b05d96591a_1272x672.png 1456w" sizes="100vw" loading="lazy" class="sizing-normal"></picture><div class="image-link-expand"><div class="pencraft pc-display-flex pc-gap-8 pc-reset"><div class="pencraft pc-reset icon-container restack-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M8 16H3v5"></path></svg></div><div class="pencraft pc-reset icon-container view-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-maximize2"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" x2="14" y1="3" y2="10"></line><line x1="3" x2="10" y1="21" y2="14"></line></svg></div></div></div></div></a><figcaption class="image-caption">(from [1])</figcaption></figure></div><p>Notably, LLaMA-2-Chat performs two separate phases of SFT. The first phrase trains over a larger amount of public data, while the second phase trains over a smaller curated dataset with much higher quality. In total, roughly 100K dialogue examples are observed by LLaMA-2-Chat while performing SFT. </p><p><strong>The data.</strong><span> Many datasets for dialogue-based fine-tuning are available via sites like HuggingFace. LLaMA-2 begins its alignment process by fine-tuning over a </span><a href="https://huggingface.co/datasets/lucasmccabe-lmi/FLAN_CoT_alpaca_style" rel="">publicly available dataset for SFT</a><span>. However, such public data lacks in quality and diversity, which—as revealed by LIMA [12]—is problematic. Authors in [1] collect extra data via a combination of 3rd party vendors and filtering efforts on public data. The resulting dataset, although of moderate size (i.e., 27,540 examples in total), is manually scrutinized and validated to ensure quality criteria are met. </span></p><blockquote><p><em>“We found that the outputs sampled from the resulting SFT model were often competitive with SFT data handwritten by human annotators, suggesting that we could reprioritize and devote more annotation effort to preference-based annotation for RLHF.”</em><span> - from [1]</span></p></blockquote><p><span>The limited set of clean instructions used for the second phase of SFT in [1] are quite effective. Interestingly, authors mention that collecting more data for SFT had diminishing returns because </span><em>i)</em><span> the fine-tuned model is capable of generating its own data for SFT and </span><em>ii)</em><span> investing more annotation into RLHF yields a clear benefit. Overall, we see in [1] that an effective strategy for SFT is to curate a small dataset with higher quality standards, which aligns with findings from [12].&nbsp;</span></p><h4 class="header-anchor-post">Reinforcement Learning from Human Feedback (RLHF)<div class="pencraft pc-display-flex pc-alignItems-center pc-position-absolute pc-reset header-anchor-parent"><div class="pencraft pc-display-contents pc-reset pubTheme-yiXxQA"><div id="§reinforcement-learning-from-human-feedback-rlhf" class="pencraft pc-reset header-anchor offset-top"></div><button type="button" aria-label="Link" data-href="https://cameronrwolfe.substack.com/i/135824233/reinforcement-learning-from-human-feedback-rlhf" class="pencraft pc-reset pencraft iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_sm-G3LciD priority_secondary-S63h9o" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></button></div></div></h4><div class="captioned-image-container"><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!Fou6!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fefbc95a9-a0cc-4ef6-908a-7154a2e6517d_1356x1218.png" data-component-name="Image2ToDOM" rel="" class="image-link image2 is-viewable-img"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!Fou6!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fefbc95a9-a0cc-4ef6-908a-7154a2e6517d_1356x1218.png 424w, https://substackcdn.com/image/fetch/$s_!Fou6!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fefbc95a9-a0cc-4ef6-908a-7154a2e6517d_1356x1218.png 848w, https://substackcdn.com/image/fetch/$s_!Fou6!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fefbc95a9-a0cc-4ef6-908a-7154a2e6517d_1356x1218.png 1272w, https://substackcdn.com/image/fetch/$s_!Fou6!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fefbc95a9-a0cc-4ef6-908a-7154a2e6517d_1356x1218.png 1456w" sizes="100vw"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/efbc95a9-a0cc-4ef6-908a-7154a2e6517d_1356x1218.jpg" width="423" height="379.9513274336283" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/efbc95a9-a0cc-4ef6-908a-7154a2e6517d_1356x1218.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:1218,&quot;width&quot;:1356,&quot;resizeWidth&quot;:423,&quot;bytes&quot;:280362,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!Fou6!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fefbc95a9-a0cc-4ef6-908a-7154a2e6517d_1356x1218.png 424w, https://substackcdn.com/image/fetch/$s_!Fou6!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fefbc95a9-a0cc-4ef6-908a-7154a2e6517d_1356x1218.png 848w, https://substackcdn.com/image/fetch/$s_!Fou6!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fefbc95a9-a0cc-4ef6-908a-7154a2e6517d_1356x1218.png 1272w, https://substackcdn.com/image/fetch/$s_!Fou6!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fefbc95a9-a0cc-4ef6-908a-7154a2e6517d_1356x1218.png 1456w" sizes="100vw" loading="lazy" class="sizing-normal"></picture><div class="image-link-expand"><div class="pencraft pc-display-flex pc-gap-8 pc-reset"><div class="pencraft pc-reset icon-container restack-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M8 16H3v5"></path></svg></div><div class="pencraft pc-reset icon-container view-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-maximize2"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" x2="14" y1="3" y2="10"></line><line x1="3" x2="10" y1="21" y2="14"></line></svg></div></div></div></div></a><figcaption class="image-caption">(from [10])</figcaption></figure></div><p><span>Although SFT is quite effective, it can be difficult to curate and manage a dataset that accurately captures the goals of alignment. </span><em>How do we know that the data present within our SFT dataset is consistently helpful and safe?</em><span> On the other hand, RLHF (shown above) takes the more direct approach of fine-tuning the LLM directly from human feedback on the model’s output. First, human annotators are asked to write prompts for the LLMs, which can be selected based on the alignment criteria (e.g., helpfulness and safety). From here, the LLM is used to generate multiple (i.e., at least two) responses for each prompt, and the human annotators rank these responses based on their quality. Here, “quality” is typically judged according to how well the response matches the alignment criteria. Then, RLHF can be used to optimize the LLM based on these human preference scores.</span></p><p><strong>The data.</strong><span> LLAMA-2 follows a binary protocol for collecting human preference data. For each prompt written by an annotator, two model responses are generated, and the annotator chooses the desired response based on helpfulness and safety criteria. Notably, each instance of human preference collection focuses upon a single alignment criteria</span><span class="footnote-hovercard-target"><a data-component-name="FootnoteAnchorToDOM" id="footnote-anchor-5-135824233" href="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up#footnote-5-135824233" target="_self" rel="" class="footnote-anchor">5</a></span><span>. For example, an annotator could write an adversarial prompt that tries to get the LLM to generate something unsafe, then rate the responses specifically based upon whether safety criteria are satisfied. Similarly, one could prompt the LLM with a detailed instruction and evaluate whether either of the model’s responses are more helpful. </span></p><div class="captioned-image-container"><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!GsBa!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc0cbcce0-923b-4a73-bd93-8ef0a7f00434_1266x646.png" data-component-name="Image2ToDOM" rel="" class="image-link image2 is-viewable-img"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!GsBa!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc0cbcce0-923b-4a73-bd93-8ef0a7f00434_1266x646.png 424w, https://substackcdn.com/image/fetch/$s_!GsBa!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc0cbcce0-923b-4a73-bd93-8ef0a7f00434_1266x646.png 848w, https://substackcdn.com/image/fetch/$s_!GsBa!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc0cbcce0-923b-4a73-bd93-8ef0a7f00434_1266x646.png 1272w, https://substackcdn.com/image/fetch/$s_!GsBa!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc0cbcce0-923b-4a73-bd93-8ef0a7f00434_1266x646.png 1456w" sizes="100vw"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/c0cbcce0-923b-4a73-bd93-8ef0a7f00434_1266x646.jpg" width="1266" height="646" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/c0cbcce0-923b-4a73-bd93-8ef0a7f00434_1266x646.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:646,&quot;width&quot;:1266,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:198692,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!GsBa!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc0cbcce0-923b-4a73-bd93-8ef0a7f00434_1266x646.png 424w, https://substackcdn.com/image/fetch/$s_!GsBa!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc0cbcce0-923b-4a73-bd93-8ef0a7f00434_1266x646.png 848w, https://substackcdn.com/image/fetch/$s_!GsBa!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc0cbcce0-923b-4a73-bd93-8ef0a7f00434_1266x646.png 1272w, https://substackcdn.com/image/fetch/$s_!GsBa!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc0cbcce0-923b-4a73-bd93-8ef0a7f00434_1266x646.png 1456w" sizes="100vw" loading="lazy" class="sizing-normal"></picture><div class="image-link-expand"><div class="pencraft pc-display-flex pc-gap-8 pc-reset"><div class="pencraft pc-reset icon-container restack-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M8 16H3v5"></path></svg></div><div class="pencraft pc-reset icon-container view-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-maximize2"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" x2="14" y1="3" y2="10"></line><line x1="3" x2="10" y1="21" y2="14"></line></svg></div></div></div></div></a><figcaption class="image-caption">(from [1])</figcaption></figure></div><p><span>Going a bit further, annotators are also asked to label the degree to which one response is better than the other (i.e., </span><em>significantly better</em><span>, </span><em>better</em><span>, </span><em>slightly better</em><span>, or </span><em>negligibly better</em><span>), as well as explicitly label whether either of the LLM’s responses are considered unsafe. We see in [1] that new batches of human preference data are collected each week, allowing multiple phases of RLHF to be performed iteratively. Statistics of the full human preference dataset that is collected compared to public human preference datasets are provided in the table above.</span></p><blockquote><p><em>“Human feedback is … used to train a reward model, which learns patterns in the preferences of the human annotators and can then automate preference decisions.”</em><span> - from [1]</span></p></blockquote><p>Data for RLHF is collected in several batches. A new batch of data is collected each week, and authors of [1] iteratively fine-tune the LLaMA-2-Chat model (using RLHF) as each of these batches become available. As such, multiple successive “rounds” of RLHF are performed throughout the alignment process.</p><p><strong>Safety-based data collection. </strong><span>To collect fine-tuning data for improved safety during RLHF, authors in [1] design instructions using two techniques: </span></p><ol><li><p><em>Risk Categories</em><span>: a topic about which the LLM could potentially product unsafe content.</span></p></li><li><p><em>Attack Vectors</em><span>: question styles that cover a broad variety of prompts that could elicit negative behavior.</span></p></li></ol><p>Three different risk categories are considered, including illicit and criminal activities, hateful and harmful activities, and unqualified advice. Additionally, several different attack vectors are defined, such as psychological manipulation (authority manipulation), logic manipulation (false premises), syntactic manipulation (misspelling), semantic manipulation (metaphor), and perspective manipulation (role playing). Using combinations of these different techniques, human annotators craft prompts that are more likely to elicit unsafe behavior, allowing such behavior to be discouraged during the fine-tuning process.</p><p><strong>Training the reward model. </strong><span>After collecting human feedback, a reward model is trained on this data. The reward model takes a prompt—</span><em>with the full chat history</em><span>—and response as input and predicts a preference score. The reward model usually shares the same architecture and weights as the LLM, but its classification head (for next token prediction) is replaced with a regression head (for preference estimation) and the model is fine-tuned on preference data; see below. </span></p><div class="captioned-image-container"><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!dJ0v!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fe0961ffa-b040-419a-ab10-1a16a2a84f87_2212x1244.png" data-component-name="Image2ToDOM" rel="" class="image-link image2 is-viewable-img"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!dJ0v!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fe0961ffa-b040-419a-ab10-1a16a2a84f87_2212x1244.png 424w, https://substackcdn.com/image/fetch/$s_!dJ0v!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fe0961ffa-b040-419a-ab10-1a16a2a84f87_2212x1244.png 848w, https://substackcdn.com/image/fetch/$s_!dJ0v!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fe0961ffa-b040-419a-ab10-1a16a2a84f87_2212x1244.png 1272w, https://substackcdn.com/image/fetch/$s_!dJ0v!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fe0961ffa-b040-419a-ab10-1a16a2a84f87_2212x1244.png 1456w" sizes="100vw"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/e0961ffa-b040-419a-ab10-1a16a2a84f87_2212x1244.jpg" width="1456" height="819" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/e0961ffa-b040-419a-ab10-1a16a2a84f87_2212x1244.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:819,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:352243,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!dJ0v!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fe0961ffa-b040-419a-ab10-1a16a2a84f87_2212x1244.png 424w, https://substackcdn.com/image/fetch/$s_!dJ0v!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fe0961ffa-b040-419a-ab10-1a16a2a84f87_2212x1244.png 848w, https://substackcdn.com/image/fetch/$s_!dJ0v!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fe0961ffa-b040-419a-ab10-1a16a2a84f87_2212x1244.png 1272w, https://substackcdn.com/image/fetch/$s_!dJ0v!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fe0961ffa-b040-419a-ab10-1a16a2a84f87_2212x1244.png 1456w" sizes="100vw" loading="lazy" class="sizing-normal"></picture><div class="image-link-expand"><div class="pencraft pc-display-flex pc-gap-8 pc-reset"><div class="pencraft pc-reset icon-container restack-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M8 16H3v5"></path></svg></div><div class="pencraft pc-reset icon-container view-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-maximize2"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" x2="14" y1="3" y2="10"></line><line x1="3" x2="10" y1="21" y2="14"></line></svg></div></div></div></div></a><figcaption class="image-caption">Normal LLM structure for next-token prediction compared to the structure of an LLM-based reward model</figcaption></figure></div><p><span>The reward model automates obtaining an accurate preference score for prompt-response pairs, which allows the LLM to be fine-tuned using </span><a href="https://www.geeksforgeeks.org/what-is-reinforcement-learning/" rel="">reinforcement learning (RL)</a><span> to maximize (automatically generated) human preference scores across a large dataset. To train the reward model, we take binary preference data and form a training objective that forces the preferred example to have a higher score than its counterpart</span><span class="footnote-hovercard-target"><a data-component-name="FootnoteAnchorToDOM" id="footnote-anchor-6-135824233" href="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up#footnote-6-135824233" target="_self" rel="" class="footnote-anchor">6</a></span><span>! An example of such an objective is shown below.</span></p><div class="captioned-image-container"><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!85r1!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3f29a20d-c865-4a01-9fec-61590e4e7d79_1394x498.png" data-component-name="Image2ToDOM" rel="" class="image-link image2"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!85r1!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3f29a20d-c865-4a01-9fec-61590e4e7d79_1394x498.png 424w, https://substackcdn.com/image/fetch/$s_!85r1!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3f29a20d-c865-4a01-9fec-61590e4e7d79_1394x498.png 848w, https://substackcdn.com/image/fetch/$s_!85r1!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3f29a20d-c865-4a01-9fec-61590e4e7d79_1394x498.png 1272w, https://substackcdn.com/image/fetch/$s_!85r1!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3f29a20d-c865-4a01-9fec-61590e4e7d79_1394x498.png 1456w" sizes="100vw"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/3f29a20d-c865-4a01-9fec-61590e4e7d79_1394x498.png" width="517" height="184.69583931133428" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/3f29a20d-c865-4a01-9fec-61590e4e7d79_1394x498.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:498,&quot;width&quot;:1394,&quot;resizeWidth&quot;:517,&quot;bytes&quot;:86917,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!85r1!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3f29a20d-c865-4a01-9fec-61590e4e7d79_1394x498.png 424w, https://substackcdn.com/image/fetch/$s_!85r1!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3f29a20d-c865-4a01-9fec-61590e4e7d79_1394x498.png 848w, https://substackcdn.com/image/fetch/$s_!85r1!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3f29a20d-c865-4a01-9fec-61590e4e7d79_1394x498.png 1272w, https://substackcdn.com/image/fetch/$s_!85r1!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3f29a20d-c865-4a01-9fec-61590e4e7d79_1394x498.png 1456w" sizes="100vw" loading="lazy" class="sizing-normal"></picture><div></div></div></a><figcaption class="image-caption">(from [1])</figcaption></figure></div><p><span>However, we should recall that the preference data collected in [1] is not just binary. We have more granular information that identifies responses that are significantly or moderately better than others. To capture this more detailed information, we can simply add a margin—</span><em>or a fixed value assigned to each of the significantly better, better, slightly better, or negligibly better categories</em><span>—to the loss shown above. Such a margin pushes the reward model to assign larger gaps in score between responses with big differences in preference; see below.</span></p><div class="captioned-image-container"><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!H2D3!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb7ac7d1c-cfd3-4e65-9db3-1163349c2717_1376x282.png" data-component-name="Image2ToDOM" rel="" class="image-link image2"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!H2D3!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb7ac7d1c-cfd3-4e65-9db3-1163349c2717_1376x282.png 424w, https://substackcdn.com/image/fetch/$s_!H2D3!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb7ac7d1c-cfd3-4e65-9db3-1163349c2717_1376x282.png 848w, https://substackcdn.com/image/fetch/$s_!H2D3!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb7ac7d1c-cfd3-4e65-9db3-1163349c2717_1376x282.png 1272w, https://substackcdn.com/image/fetch/$s_!H2D3!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb7ac7d1c-cfd3-4e65-9db3-1163349c2717_1376x282.png 1456w" sizes="100vw"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/b7ac7d1c-cfd3-4e65-9db3-1163349c2717_1376x282.jpg" width="487" height="99.80668604651163" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/b7ac7d1c-cfd3-4e65-9db3-1163349c2717_1376x282.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:282,&quot;width&quot;:1376,&quot;resizeWidth&quot;:487,&quot;bytes&quot;:49948,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!H2D3!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb7ac7d1c-cfd3-4e65-9db3-1163349c2717_1376x282.png 424w, https://substackcdn.com/image/fetch/$s_!H2D3!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb7ac7d1c-cfd3-4e65-9db3-1163349c2717_1376x282.png 848w, https://substackcdn.com/image/fetch/$s_!H2D3!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb7ac7d1c-cfd3-4e65-9db3-1163349c2717_1376x282.png 1272w, https://substackcdn.com/image/fetch/$s_!H2D3!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb7ac7d1c-cfd3-4e65-9db3-1163349c2717_1376x282.png 1456w" sizes="100vw" loading="lazy" class="sizing-normal"></picture><div></div></div></a><figcaption class="image-caption">(from [1])</figcaption></figure></div><p>Interestingly, we see in [1] that authors combine their custom-curated human preference data with other public sources of data when training reward models. To explain this decision, authors claim that injecting such extra sources of data does not seem to have a negative impact on reward model performance. Plus, this data aids the reward models’ generalization and can protect against issues like reward hacking, in which RLHF takes advantage of weaknesses in the reward function to arbitrarily inflate preference scores without improving the model. </p><blockquote><p><em>“We do not observe negative transfer from the open-source preference datasets. Thus, we have decided to keep them in our data mixture, as they could enable better generalization for the reward model and prevent reward hacking, i.e. Llama 2-Chat taking advantage of some weaknesses of our reward, and so artificially inflating the score despite performing less well.”</em><span> - from [1]</span></p></blockquote><p><strong>Alignment is oftentimes a tradeoff!</strong><span> Interestingly, we see in [1] that separate reward models are trained for each of the alignment criteria. More specifically, we have a helpfulness reward model and a separately safety reward model. This might seem unnecessary at first, but we should realize that properties such as helpfulness and safety—</span><em>or any alignment criteria in general</em><span>—are oftentimes a tradeoff. Making an LLM more safe might make it less helpful; e.g., the model could refuse to answer a question that is unsafe, which is (arguably) not helpful. Given this tradeoff, authors in [2] observe that predicting helpfulness and safety preference scores with separate reward models is the best way to accurately model the nuances in human preference according to different alignment criteria.</span></p><blockquote><p><em>“In order for a single model to perform well on both dimensions, it needs to not only learn to select the better response given a prompt but also to distinguish adversarial prompts from safe ones. As a result, optimizing two separate models eases the reward modeling task.”</em><span> - from [1]</span></p></blockquote><p><strong>Optimization via RL.</strong><span>  Even after multiple rounds of SFT are performed, five successive versions of RLHF models are created in [1]—</span><em>one for each batch of human preference data</em><span>. Although the </span><a href="https://openai.com/research/openai-baselines-ppo" rel="">PPO algorithm</a><span> has typically been a standard for performing RLHF, we see in [1] that two separate algorithms are considered:</span></p><ul><li><p><em>PPO</em><span>: standard algorithm used for RLHF.</span></p></li><li><p><em>Rejection Sampling</em><span>: samples </span><code>K</code><span> responses from the LLM for each prompt, scores each response using the reward model, selects the best response, and fine-tunes on this example. </span></p></li></ul><p>While PPO only takes one sample from the model per iteration, rejection sampling takes numerous samples.  Within rejection sampling, the highest-reward sample that is generated is considered the new “gold standard”. As shown in the figure below, generating multiple samples in this manner can drastically increase the maximum reward of samples observed during fine-tuning.</p><div class="captioned-image-container"><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!QtIR!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2b3e108b-443b-481c-8b76-3c0a12d4a165_1594x604.png" data-component-name="Image2ToDOM" rel="" class="image-link image2 is-viewable-img"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!QtIR!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2b3e108b-443b-481c-8b76-3c0a12d4a165_1594x604.png 424w, https://substackcdn.com/image/fetch/$s_!QtIR!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2b3e108b-443b-481c-8b76-3c0a12d4a165_1594x604.png 848w, https://substackcdn.com/image/fetch/$s_!QtIR!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2b3e108b-443b-481c-8b76-3c0a12d4a165_1594x604.png 1272w, https://substackcdn.com/image/fetch/$s_!QtIR!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2b3e108b-443b-481c-8b76-3c0a12d4a165_1594x604.png 1456w" sizes="100vw"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/2b3e108b-443b-481c-8b76-3c0a12d4a165_1594x604.jpg" width="1456" height="552" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/2b3e108b-443b-481c-8b76-3c0a12d4a165_1594x604.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:552,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:110350,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!QtIR!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2b3e108b-443b-481c-8b76-3c0a12d4a165_1594x604.png 424w, https://substackcdn.com/image/fetch/$s_!QtIR!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2b3e108b-443b-481c-8b76-3c0a12d4a165_1594x604.png 848w, https://substackcdn.com/image/fetch/$s_!QtIR!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2b3e108b-443b-481c-8b76-3c0a12d4a165_1594x604.png 1272w, https://substackcdn.com/image/fetch/$s_!QtIR!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2b3e108b-443b-481c-8b76-3c0a12d4a165_1594x604.png 1456w" sizes="100vw" loading="lazy" class="sizing-normal"></picture><div class="image-link-expand"><div class="pencraft pc-display-flex pc-gap-8 pc-reset"><div class="pencraft pc-reset icon-container restack-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M8 16H3v5"></path></svg></div><div class="pencraft pc-reset icon-container view-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-maximize2"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" x2="14" y1="3" y2="10"></line><line x1="3" x2="10" y1="21" y2="14"></line></svg></div></div></div></div></a><figcaption class="image-caption">(from [1])</figcaption></figure></div><p><span>In [1], rejection sampling is performed with the largest model (i.e., LLaMA-70B-Chat) and used to train all other (smaller) models</span><span class="footnote-hovercard-target"><a data-component-name="FootnoteAnchorToDOM" id="footnote-anchor-7-135824233" href="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up#footnote-7-135824233" target="_self" rel="" class="footnote-anchor">7</a></span><span>. While PPO performs iterative updates after each sample, rejection sampling fine-tuning uses the same model (i.e., at the beginning of the RLHF round) to generate an entire dataset of high-reward samples that are used for fine-tuning in a similar manner to SFT.  </span></p><blockquote><p><em>“We illustrate the benefit of Rejection Sampling in Figure 7. The delta between the maximum and median curves can be interpreted as the potential gain of fine-tuning on the best output.”</em><span> - from [1]</span></p></blockquote><p><span>To ensure the best possible performance, authors include best samples from all RLHF iterations—</span><em>not just the current iteration</em><span>—when performing rejection sampling fine-tuning. Without including samples from prior iterations, we see that regressions in performance may occur when using rejection sampling fine-tuning. In [1], a rejection sampling approach is adopted for the first four rounds of RLHF, then the final round combines both rejection sampling fine-tuning and PPO sequentially (i.e., PPO is applied after rejection sampling fine-tuning). </span></p><div class="captioned-image-container"><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!IjRU!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F4b0ef016-bb81-4a02-9a41-4f685609aea1_1584x568.png" data-component-name="Image2ToDOM" rel="" class="image-link image2 is-viewable-img"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!IjRU!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F4b0ef016-bb81-4a02-9a41-4f685609aea1_1584x568.png 424w, https://substackcdn.com/image/fetch/$s_!IjRU!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F4b0ef016-bb81-4a02-9a41-4f685609aea1_1584x568.png 848w, https://substackcdn.com/image/fetch/$s_!IjRU!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F4b0ef016-bb81-4a02-9a41-4f685609aea1_1584x568.png 1272w, https://substackcdn.com/image/fetch/$s_!IjRU!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F4b0ef016-bb81-4a02-9a41-4f685609aea1_1584x568.png 1456w" sizes="100vw"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/4b0ef016-bb81-4a02-9a41-4f685609aea1_1584x568.jpg" width="1456" height="522" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/4b0ef016-bb81-4a02-9a41-4f685609aea1_1584x568.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:522,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:214524,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!IjRU!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F4b0ef016-bb81-4a02-9a41-4f685609aea1_1584x568.png 424w, https://substackcdn.com/image/fetch/$s_!IjRU!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F4b0ef016-bb81-4a02-9a41-4f685609aea1_1584x568.png 848w, https://substackcdn.com/image/fetch/$s_!IjRU!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F4b0ef016-bb81-4a02-9a41-4f685609aea1_1584x568.png 1272w, https://substackcdn.com/image/fetch/$s_!IjRU!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F4b0ef016-bb81-4a02-9a41-4f685609aea1_1584x568.png 1456w" sizes="100vw" loading="lazy" class="sizing-normal"></picture><div class="image-link-expand"><div class="pencraft pc-display-flex pc-gap-8 pc-reset"><div class="pencraft pc-reset icon-container restack-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M8 16H3v5"></path></svg></div><div class="pencraft pc-reset icon-container view-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-maximize2"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" x2="14" y1="3" y2="10"></line><line x1="3" x2="10" y1="21" y2="14"></line></svg></div></div></div></div></a><figcaption class="image-caption">(from [1])</figcaption></figure></div><p><strong>Tweaking the temperature. </strong><span>Interestingly, we also observe in [1] that the optimal </span><a href="https://twitter.com/cwolferesearch/status/1671628210180698112?s=20" rel="">temperature</a><span> to use when generating samples for RLHF changes with iterative updates to the model; see above. As such, the temperature must be readjusted after each round of RLHF to achieve the best results. Furthermore, authors in [1] mention that the optimal temperature seems to be dependent upon context. For example, different shifts in the optimal temperature are observed for certain types of prompts, such as creative prompts or those that are considered more factual. </span></p><h4 class="header-anchor-post">Improving Multi-Turn Dialogue with Ghost Attention<div class="pencraft pc-display-flex pc-alignItems-center pc-position-absolute pc-reset header-anchor-parent"><div class="pencraft pc-display-contents pc-reset pubTheme-yiXxQA"><div id="§improving-multi-turn-dialogue-with-ghost-attention" class="pencraft pc-reset header-anchor offset-top"></div><button type="button" aria-label="Link" data-href="https://cameronrwolfe.substack.com/i/135824233/improving-multi-turn-dialogue-with-ghost-attention" class="pencraft pc-reset pencraft iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_sm-G3LciD priority_secondary-S63h9o" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></button></div></div></h4><p>In many cases, dialogue agents, such as LLaMA-2-Chat, conduct conversations with users over multiple turns. Sometimes, a system message or instruction is provided to the model at the beginning of this back-and-forth conversation that should be obeyed throughout. However, we see in [1] that the LLM may quickly forget about this instruction, leading it to only apply to initial turns; see below. </p><div class="captioned-image-container"><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!B0FK!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F85cc8dd2-4fbc-4aba-8767-ecf72474ff5e_1928x1106.png" data-component-name="Image2ToDOM" rel="" class="image-link image2 is-viewable-img"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!B0FK!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F85cc8dd2-4fbc-4aba-8767-ecf72474ff5e_1928x1106.png 424w, https://substackcdn.com/image/fetch/$s_!B0FK!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F85cc8dd2-4fbc-4aba-8767-ecf72474ff5e_1928x1106.png 848w, https://substackcdn.com/image/fetch/$s_!B0FK!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F85cc8dd2-4fbc-4aba-8767-ecf72474ff5e_1928x1106.png 1272w, https://substackcdn.com/image/fetch/$s_!B0FK!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F85cc8dd2-4fbc-4aba-8767-ecf72474ff5e_1928x1106.png 1456w" sizes="100vw"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/85cc8dd2-4fbc-4aba-8767-ecf72474ff5e_1928x1106.jpg" width="599" height="343.5199175824176" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/85cc8dd2-4fbc-4aba-8767-ecf72474ff5e_1928x1106.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:835,&quot;width&quot;:1456,&quot;resizeWidth&quot;:599,&quot;bytes&quot;:439450,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!B0FK!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F85cc8dd2-4fbc-4aba-8767-ecf72474ff5e_1928x1106.png 424w, https://substackcdn.com/image/fetch/$s_!B0FK!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F85cc8dd2-4fbc-4aba-8767-ecf72474ff5e_1928x1106.png 848w, https://substackcdn.com/image/fetch/$s_!B0FK!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F85cc8dd2-4fbc-4aba-8767-ecf72474ff5e_1928x1106.png 1272w, https://substackcdn.com/image/fetch/$s_!B0FK!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F85cc8dd2-4fbc-4aba-8767-ecf72474ff5e_1928x1106.png 1456w" sizes="100vw" loading="lazy" class="sizing-normal"></picture><div class="image-link-expand"><div class="pencraft pc-display-flex pc-gap-8 pc-reset"><div class="pencraft pc-reset icon-container restack-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M8 16H3v5"></path></svg></div><div class="pencraft pc-reset icon-container view-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-maximize2"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" x2="14" y1="3" y2="10"></line><line x1="3" x2="10" y1="21" y2="14"></line></svg></div></div></div></div></a><figcaption class="image-caption">(from [1])</figcaption></figure></div><p><span>To solve this issue, authors in [1] explore a fine-tuning approach with synthetic data, called Ghost Attention (GAtt). Given a dialogue session, GAtt</span><em> i)</em><span> samples an instruction that should be followed in a conversation, </span><em>ii)</em><span> concatenates this instruction to every user message within the conversation, and </span><em>iii)</em><span> samples responses to each message using the model from the latest round of RLHF. After removing the concatenated instruction from all but the first user message, such an approach can generate synthetic multi-turn dialogue data that consistently abides by an instruction. Then, we can just fine-tune over this data using SFT, which—</span><em>as shown above</em><span>—improves instruction following over long dialogues!</span></p><h2 class="header-anchor-post">Evaluations and Key Findings<div class="pencraft pc-display-flex pc-alignItems-center pc-position-absolute pc-reset header-anchor-parent"><div class="pencraft pc-display-contents pc-reset pubTheme-yiXxQA"><div id="§evaluations-and-key-findings" class="pencraft pc-reset header-anchor offset-top"></div><button type="button" aria-label="Link" data-href="https://cameronrwolfe.substack.com/i/135824233/evaluations-and-key-findings" class="pencraft pc-reset pencraft iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_sm-G3LciD priority_secondary-S63h9o" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></button></div></div></h2><p><span>LLaMA-2 and LLaMA-2-Chat are evaluated extensively in comparison to both other open-source LLMs and proprietary models. The base and fine-tuned models set a new state-of-the-art among open-source LLMs. As we will see, these models also have a variety of different emergent capabilities</span><span class="footnote-hovercard-target"><a data-component-name="FootnoteAnchorToDOM" id="footnote-anchor-8-135824233" href="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up#footnote-8-135824233" target="_self" rel="" class="footnote-anchor">8</a></span><span> and interesting properties that are analyzed extensively within [1] to provide useful insights.</span></p><h4 class="header-anchor-post">LLaMA-2 (Base Model) Performance<div class="pencraft pc-display-flex pc-alignItems-center pc-position-absolute pc-reset header-anchor-parent"><div class="pencraft pc-display-contents pc-reset pubTheme-yiXxQA"><div id="§llama-base-model-performance" class="pencraft pc-reset header-anchor offset-top"></div><button type="button" aria-label="Link" data-href="https://cameronrwolfe.substack.com/i/135824233/llama-base-model-performance" class="pencraft pc-reset pencraft iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_sm-G3LciD priority_secondary-S63h9o" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></button></div></div></h4><div class="captioned-image-container"><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!qmpo!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F02a42b8e-34ba-48f4-b9c5-1f36ba909f64_1260x490.png" data-component-name="Image2ToDOM" rel="" class="image-link image2 is-viewable-img"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!qmpo!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F02a42b8e-34ba-48f4-b9c5-1f36ba909f64_1260x490.png 424w, https://substackcdn.com/image/fetch/$s_!qmpo!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F02a42b8e-34ba-48f4-b9c5-1f36ba909f64_1260x490.png 848w, https://substackcdn.com/image/fetch/$s_!qmpo!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F02a42b8e-34ba-48f4-b9c5-1f36ba909f64_1260x490.png 1272w, https://substackcdn.com/image/fetch/$s_!qmpo!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F02a42b8e-34ba-48f4-b9c5-1f36ba909f64_1260x490.png 1456w" sizes="100vw"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/02a42b8e-34ba-48f4-b9c5-1f36ba909f64_1260x490.jpg" width="1260" height="490" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/02a42b8e-34ba-48f4-b9c5-1f36ba909f64_1260x490.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:490,&quot;width&quot;:1260,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:null,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:null,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!qmpo!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F02a42b8e-34ba-48f4-b9c5-1f36ba909f64_1260x490.png 424w, https://substackcdn.com/image/fetch/$s_!qmpo!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F02a42b8e-34ba-48f4-b9c5-1f36ba909f64_1260x490.png 848w, https://substackcdn.com/image/fetch/$s_!qmpo!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F02a42b8e-34ba-48f4-b9c5-1f36ba909f64_1260x490.png 1272w, https://substackcdn.com/image/fetch/$s_!qmpo!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F02a42b8e-34ba-48f4-b9c5-1f36ba909f64_1260x490.png 1456w" sizes="100vw" loading="lazy" class="sizing-normal"></picture><div class="image-link-expand"><div class="pencraft pc-display-flex pc-gap-8 pc-reset"><div class="pencraft pc-reset icon-container restack-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M8 16H3v5"></path></svg></div><div class="pencraft pc-reset icon-container view-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-maximize2"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" x2="14" y1="3" y2="10"></line><line x1="3" x2="10" y1="21" y2="14"></line></svg></div></div></div></div></a><figcaption class="image-caption">(from [1])</figcaption></figure></div><p><span>Compared to popular open-source base LLMs (e.g., </span><a href="https://cameronrwolfe.substack.com/p/democratizing-ai-mosaicmls-impact" rel="">MPT</a><span>, </span><a href="https://cameronrwolfe.substack.com/p/falcon-the-pinnacle-of-open-source" rel="">Falcon</a><span>, and </span><a href="https://cameronrwolfe.substack.com/p/llama-llms-for-everyone" rel="">LLaMA-1</a><span>), LLaMA-2 models set a new state-of-the-art on all tasks considered; see above. Notably, however, LLaMA-2 was somewhat </span><a href="https://twitter.com/amasad/status/1681383736032493580?s=20" rel="">criticized</a><span> for its (relatively) poor performance on coding-based tasks (e.g., </span><a href="https://arxiv.org/abs/2107.03374" rel="">HumanEval</a><span>). Some have speculated that this may be due to a lack of sufficient code within LLaMA-2’s pre-training corpus, though the exact explanation is not completely clear as of now. </span></p><div class="captioned-image-container"><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!Wvzh!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7984d418-3031-480a-8438-a7e992c82023_1262x356.png" data-component-name="Image2ToDOM" rel="" class="image-link image2 is-viewable-img"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!Wvzh!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7984d418-3031-480a-8438-a7e992c82023_1262x356.png 424w, https://substackcdn.com/image/fetch/$s_!Wvzh!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7984d418-3031-480a-8438-a7e992c82023_1262x356.png 848w, https://substackcdn.com/image/fetch/$s_!Wvzh!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7984d418-3031-480a-8438-a7e992c82023_1262x356.png 1272w, https://substackcdn.com/image/fetch/$s_!Wvzh!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7984d418-3031-480a-8438-a7e992c82023_1262x356.png 1456w" sizes="100vw"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/7984d418-3031-480a-8438-a7e992c82023_1262x356.jpg" width="1262" height="356" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/7984d418-3031-480a-8438-a7e992c82023_1262x356.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:356,&quot;width&quot;:1262,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:null,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:null,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!Wvzh!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7984d418-3031-480a-8438-a7e992c82023_1262x356.png 424w, https://substackcdn.com/image/fetch/$s_!Wvzh!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7984d418-3031-480a-8438-a7e992c82023_1262x356.png 848w, https://substackcdn.com/image/fetch/$s_!Wvzh!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7984d418-3031-480a-8438-a7e992c82023_1262x356.png 1272w, https://substackcdn.com/image/fetch/$s_!Wvzh!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7984d418-3031-480a-8438-a7e992c82023_1262x356.png 1456w" sizes="100vw" loading="lazy" class="sizing-normal"></picture><div class="image-link-expand"><div class="pencraft pc-display-flex pc-gap-8 pc-reset"><div class="pencraft pc-reset icon-container restack-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M8 16H3v5"></path></svg></div><div class="pencraft pc-reset icon-container view-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-maximize2"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" x2="14" y1="3" y2="10"></line><line x1="3" x2="10" y1="21" y2="14"></line></svg></div></div></div></div></a><figcaption class="image-caption">(from [1])</figcaption></figure></div><p><span>When compared to proprietary models, LLaMA-2 base models perform worse; see above. However, we should keep in mind that this comparison is made between a base LLM and aligned models like GPT-3.5 and GPT-4. When compared to proprietary base LLMs (e.g., </span><a href="https://cameronrwolfe.substack.com/p/palm-efficiently-training-massive" rel="">PaLM</a><span> [4]), LLaMA-2 performs favorably!</span></p><div class="captioned-image-container"><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!KocF!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F13124aad-2af1-43ed-8ac1-291c1cd49072_1590x732.png" data-component-name="Image2ToDOM" rel="" class="image-link image2 is-viewable-img"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!KocF!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F13124aad-2af1-43ed-8ac1-291c1cd49072_1590x732.png 424w, https://substackcdn.com/image/fetch/$s_!KocF!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F13124aad-2af1-43ed-8ac1-291c1cd49072_1590x732.png 848w, https://substackcdn.com/image/fetch/$s_!KocF!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F13124aad-2af1-43ed-8ac1-291c1cd49072_1590x732.png 1272w, https://substackcdn.com/image/fetch/$s_!KocF!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F13124aad-2af1-43ed-8ac1-291c1cd49072_1590x732.png 1456w" sizes="100vw"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/13124aad-2af1-43ed-8ac1-291c1cd49072_1590x732.jpg" width="1456" height="670" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/13124aad-2af1-43ed-8ac1-291c1cd49072_1590x732.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:670,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:158497,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!KocF!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F13124aad-2af1-43ed-8ac1-291c1cd49072_1590x732.png 424w, https://substackcdn.com/image/fetch/$s_!KocF!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F13124aad-2af1-43ed-8ac1-291c1cd49072_1590x732.png 848w, https://substackcdn.com/image/fetch/$s_!KocF!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F13124aad-2af1-43ed-8ac1-291c1cd49072_1590x732.png 1272w, https://substackcdn.com/image/fetch/$s_!KocF!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F13124aad-2af1-43ed-8ac1-291c1cd49072_1590x732.png 1456w" sizes="100vw" loading="lazy" class="sizing-normal"></picture><div class="image-link-expand"><div class="pencraft pc-display-flex pc-gap-8 pc-reset"><div class="pencraft pc-reset icon-container restack-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M8 16H3v5"></path></svg></div><div class="pencraft pc-reset icon-container view-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-maximize2"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" x2="14" y1="3" y2="10"></line><line x1="3" x2="10" y1="21" y2="14"></line></svg></div></div></div></div></a><figcaption class="image-caption">(from [1])</figcaption></figure></div><p><strong>Safety results.</strong><span> As we have mentioned previously, the authors of LLaMA-2 place an emphasis upon safety when crafting the model’s pre-training dataset, leading them to measure and even exclude data according to a variety of different factors. Despite these efforts to minimize bias in the pre-training dataset, results on automatic safety benchmarks are mixed as shown above. While LLaMA-2-7B is less toxic and more truthful and informative compared to prior models, larger models (e.g., LLaMA-2-34B and LLaMA-2-70B) seem to have an increase in toxicity, which the authors claim may come from their use of a larger pre-training and lack of aggressive filtering of toxic information from this dataset.</span></p><h4 class="header-anchor-post">Fine-Tuning Analysis for LLaMA-2-Chat<div class="pencraft pc-display-flex pc-alignItems-center pc-position-absolute pc-reset header-anchor-parent"><div class="pencraft pc-display-contents pc-reset pubTheme-yiXxQA"><div id="§fine-tuning-analysis-for-llama-chat" class="pencraft pc-reset header-anchor offset-top"></div><button type="button" aria-label="Link" data-href="https://cameronrwolfe.substack.com/i/135824233/fine-tuning-analysis-for-llama-chat" class="pencraft pc-reset pencraft iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_sm-G3LciD priority_secondary-S63h9o" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></button></div></div></h4><blockquote><p><em>“Evaluating LLMs is a challenging open-research problem. Human evaluation, while a gold standard, can be complicated by various HCI considerations, and is not always scalable.”</em><span> - from [1]</span></p></blockquote><p>LLaMA-2-Chat is evaluated according to its levels of helpfulness and safety using a variety of different techniques. First, evaluation of model quality is automated by using reward model output as a proxy for performance. The results of these evaluations—and alternative evaluations that use GPT-4 as a judge—are shown below, where we see that LLaMA-2-Chat slowly becomes more helpful and safe throughout each round of the fine-tuning process with both SFT and RLHF.  </p><div class="captioned-image-container"><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!9A3z!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F97eb6108-8b95-47a1-965e-85e8390d70b4_1892x672.png" data-component-name="Image2ToDOM" rel="" class="image-link image2 is-viewable-img"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!9A3z!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F97eb6108-8b95-47a1-965e-85e8390d70b4_1892x672.png 424w, https://substackcdn.com/image/fetch/$s_!9A3z!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F97eb6108-8b95-47a1-965e-85e8390d70b4_1892x672.png 848w, https://substackcdn.com/image/fetch/$s_!9A3z!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F97eb6108-8b95-47a1-965e-85e8390d70b4_1892x672.png 1272w, https://substackcdn.com/image/fetch/$s_!9A3z!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F97eb6108-8b95-47a1-965e-85e8390d70b4_1892x672.png 1456w" sizes="100vw"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/97eb6108-8b95-47a1-965e-85e8390d70b4_1892x672.jpg" width="1456" height="517" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/97eb6108-8b95-47a1-965e-85e8390d70b4_1892x672.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:517,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:673527,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!9A3z!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F97eb6108-8b95-47a1-965e-85e8390d70b4_1892x672.png 424w, https://substackcdn.com/image/fetch/$s_!9A3z!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F97eb6108-8b95-47a1-965e-85e8390d70b4_1892x672.png 848w, https://substackcdn.com/image/fetch/$s_!9A3z!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F97eb6108-8b95-47a1-965e-85e8390d70b4_1892x672.png 1272w, https://substackcdn.com/image/fetch/$s_!9A3z!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F97eb6108-8b95-47a1-965e-85e8390d70b4_1892x672.png 1456w" sizes="100vw" loading="lazy" class="sizing-normal"></picture><div class="image-link-expand"><div class="pencraft pc-display-flex pc-gap-8 pc-reset"><div class="pencraft pc-reset icon-container restack-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M8 16H3v5"></path></svg></div><div class="pencraft pc-reset icon-container view-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-maximize2"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" x2="14" y1="3" y2="10"></line><line x1="3" x2="10" y1="21" y2="14"></line></svg></div></div></div></div></a><figcaption class="image-caption">(from [1])</figcaption></figure></div><p>Although such automated metrics are informative, they can be biased or incorrect. As such, LLaMA-2-Chat is subjected to extensive human evaluations. In the figure below, we see that humans find LLaMA-2-Chat to be more helpful than a variety of powerful open-source and proprietary language models. Similarly, LLaMA-2-Chat exceeds the same models in human safety evaluations. As such, the LLaMA-2-Chat model is generally found to be more helpful and safe than a variety of other powerful LLMs based on extensive human evaluation. </p><div class="captioned-image-container"><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!u5d8!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F065228d3-36b5-4837-9901-84fd88d02ec4_2040x792.png" data-component-name="Image2ToDOM" rel="" class="image-link image2 is-viewable-img"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!u5d8!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F065228d3-36b5-4837-9901-84fd88d02ec4_2040x792.png 424w, https://substackcdn.com/image/fetch/$s_!u5d8!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F065228d3-36b5-4837-9901-84fd88d02ec4_2040x792.png 848w, https://substackcdn.com/image/fetch/$s_!u5d8!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F065228d3-36b5-4837-9901-84fd88d02ec4_2040x792.png 1272w, https://substackcdn.com/image/fetch/$s_!u5d8!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F065228d3-36b5-4837-9901-84fd88d02ec4_2040x792.png 1456w" sizes="100vw"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/065228d3-36b5-4837-9901-84fd88d02ec4_2040x792.jpg" width="1456" height="565" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/065228d3-36b5-4837-9901-84fd88d02ec4_2040x792.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:565,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:623109,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!u5d8!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F065228d3-36b5-4837-9901-84fd88d02ec4_2040x792.png 424w, https://substackcdn.com/image/fetch/$s_!u5d8!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F065228d3-36b5-4837-9901-84fd88d02ec4_2040x792.png 848w, https://substackcdn.com/image/fetch/$s_!u5d8!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F065228d3-36b5-4837-9901-84fd88d02ec4_2040x792.png 1272w, https://substackcdn.com/image/fetch/$s_!u5d8!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F065228d3-36b5-4837-9901-84fd88d02ec4_2040x792.png 1456w" sizes="100vw" loading="lazy" class="sizing-normal"></picture><div class="image-link-expand"><div class="pencraft pc-display-flex pc-gap-8 pc-reset"><div class="pencraft pc-reset icon-container restack-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M8 16H3v5"></path></svg></div><div class="pencraft pc-reset icon-container view-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-maximize2"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" x2="14" y1="3" y2="10"></line><line x1="3" x2="10" y1="21" y2="14"></line></svg></div></div></div></div></a><figcaption class="image-caption">(from [1])</figcaption></figure></div><p><span>Despite these results, we should recall that human evaluations can be limited and are only conducted over a (relatively) small set of prompts</span><span class="footnote-hovercard-target"><a data-component-name="FootnoteAnchorToDOM" id="footnote-anchor-9-135824233" href="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up#footnote-9-135824233" target="_self" rel="" class="footnote-anchor">9</a></span><span>.  In general, human evaluation can be subjective and noise is present in the evaluation process, which we should keep in mind when studying and interpreting these results.</span></p><div class="captioned-image-container"><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!D8gh!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F1bc94cc6-4876-4a05-beb9-12ec1727926c_1274x806.png" data-component-name="Image2ToDOM" rel="" class="image-link image2 is-viewable-img"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!D8gh!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F1bc94cc6-4876-4a05-beb9-12ec1727926c_1274x806.png 424w, https://substackcdn.com/image/fetch/$s_!D8gh!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F1bc94cc6-4876-4a05-beb9-12ec1727926c_1274x806.png 848w, https://substackcdn.com/image/fetch/$s_!D8gh!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F1bc94cc6-4876-4a05-beb9-12ec1727926c_1274x806.png 1272w, https://substackcdn.com/image/fetch/$s_!D8gh!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F1bc94cc6-4876-4a05-beb9-12ec1727926c_1274x806.png 1456w" sizes="100vw"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/1bc94cc6-4876-4a05-beb9-12ec1727926c_1274x806.jpg" width="1274" height="806" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/1bc94cc6-4876-4a05-beb9-12ec1727926c_1274x806.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:806,&quot;width&quot;:1274,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:209798,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!D8gh!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F1bc94cc6-4876-4a05-beb9-12ec1727926c_1274x806.png 424w, https://substackcdn.com/image/fetch/$s_!D8gh!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F1bc94cc6-4876-4a05-beb9-12ec1727926c_1274x806.png 848w, https://substackcdn.com/image/fetch/$s_!D8gh!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F1bc94cc6-4876-4a05-beb9-12ec1727926c_1274x806.png 1272w, https://substackcdn.com/image/fetch/$s_!D8gh!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F1bc94cc6-4876-4a05-beb9-12ec1727926c_1274x806.png 1456w" sizes="100vw" loading="lazy" class="sizing-normal"></picture><div class="image-link-expand"><div class="pencraft pc-display-flex pc-gap-8 pc-reset"><div class="pencraft pc-reset icon-container restack-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M8 16H3v5"></path></svg></div><div class="pencraft pc-reset icon-container view-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-maximize2"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" x2="14" y1="3" y2="10"></line><line x1="3" x2="10" y1="21" y2="14"></line></svg></div></div></div></div></a><figcaption class="image-caption">(from [1])</figcaption></figure></div><p><strong>Reward model scaling. </strong><span>To assess the quality of helpfulness and safety reward models created in [1], authors compare and evaluate these models against a variety of other reward models; see above. As expected, the reward models used to fine-tune LLaMA-2-Chat seem to perform the best. Additionally, we see that larger reward models perform better when trained over the same amount of data and that the performance of reward models has yet to reach a plateau; see below. </span></p><div class="captioned-image-container"><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!-CvU!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F92dac79e-851f-4bd1-ab42-07f0c48b237f_1266x528.png" data-component-name="Image2ToDOM" rel="" class="image-link image2 is-viewable-img"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!-CvU!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F92dac79e-851f-4bd1-ab42-07f0c48b237f_1266x528.png 424w, https://substackcdn.com/image/fetch/$s_!-CvU!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F92dac79e-851f-4bd1-ab42-07f0c48b237f_1266x528.png 848w, https://substackcdn.com/image/fetch/$s_!-CvU!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F92dac79e-851f-4bd1-ab42-07f0c48b237f_1266x528.png 1272w, https://substackcdn.com/image/fetch/$s_!-CvU!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F92dac79e-851f-4bd1-ab42-07f0c48b237f_1266x528.png 1456w" sizes="100vw"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/92dac79e-851f-4bd1-ab42-07f0c48b237f_1266x528.png" width="1266" height="528" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/92dac79e-851f-4bd1-ab42-07f0c48b237f_1266x528.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:528,&quot;width&quot;:1266,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:171197,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!-CvU!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F92dac79e-851f-4bd1-ab42-07f0c48b237f_1266x528.png 424w, https://substackcdn.com/image/fetch/$s_!-CvU!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F92dac79e-851f-4bd1-ab42-07f0c48b237f_1266x528.png 848w, https://substackcdn.com/image/fetch/$s_!-CvU!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F92dac79e-851f-4bd1-ab42-07f0c48b237f_1266x528.png 1272w, https://substackcdn.com/image/fetch/$s_!-CvU!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F92dac79e-851f-4bd1-ab42-07f0c48b237f_1266x528.png 1456w" sizes="100vw" loading="lazy" class="sizing-normal"></picture><div class="image-link-expand"><div class="pencraft pc-display-flex pc-gap-8 pc-reset"><div class="pencraft pc-reset icon-container restack-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M8 16H3v5"></path></svg></div><div class="pencraft pc-reset icon-container view-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-maximize2"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" x2="14" y1="3" y2="10"></line><line x1="3" x2="10" y1="21" y2="14"></line></svg></div></div></div></div></a><figcaption class="image-caption">(from [1])</figcaption></figure></div><p><em>Why does this matter?</em><span> As authors note in [1], the performance of the reward model, given that it is used to automate preference feedback during RLHF, is directly related to the performance of the fine-tuned chat model. In other words, an improvement in the quality of the reward model tends to produce a relative improvement in the quality of the fine-tuned LLM. The results above seem to indicate that using larger reward models trained over more data is helpful.</span></p><p><strong>Other findings. </strong><span>In addition to the helpfulness and safety analysis performed in [1], a variety of interesting observations are made about the behavior of LLaMA-2-Chat. Most LLMs struggle with temporal reasoning (i.e., reasoning about when in time certain events occurred), but LLaMA-2 is fine-tuned to better process temporal information by performing SFT over time-focused prompt-response examples. As such, the model is surprisingly capable of organizing knowledge in a temporal manner; see above. Going further, LLaMA-2-Chat is not specifically trained to </span><a href="https://cameronrwolfe.substack.com/p/teaching-language-models-to-use-tools" rel="">leverage tools</a><span>, but the model seems to be able to generalize to tool usage in a </span><a href="https://cameronrwolfe.substack.com/i/117151147/zero-shot-learning" rel="">zero-shot</a><span> manner as shown in the figure below. </span></p><div class="captioned-image-container"><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!GE4V!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1625468-04e3-4875-a760-f25c6da9187a_1578x614.png" data-component-name="Image2ToDOM" rel="" class="image-link image2 is-viewable-img"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!GE4V!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1625468-04e3-4875-a760-f25c6da9187a_1578x614.png 424w, https://substackcdn.com/image/fetch/$s_!GE4V!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1625468-04e3-4875-a760-f25c6da9187a_1578x614.png 848w, https://substackcdn.com/image/fetch/$s_!GE4V!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1625468-04e3-4875-a760-f25c6da9187a_1578x614.png 1272w, https://substackcdn.com/image/fetch/$s_!GE4V!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1625468-04e3-4875-a760-f25c6da9187a_1578x614.png 1456w" sizes="100vw"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/a1625468-04e3-4875-a760-f25c6da9187a_1578x614.jpg" width="1456" height="567" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/a1625468-04e3-4875-a760-f25c6da9187a_1578x614.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:567,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:270416,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!GE4V!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1625468-04e3-4875-a760-f25c6da9187a_1578x614.png 424w, https://substackcdn.com/image/fetch/$s_!GE4V!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1625468-04e3-4875-a760-f25c6da9187a_1578x614.png 848w, https://substackcdn.com/image/fetch/$s_!GE4V!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1625468-04e3-4875-a760-f25c6da9187a_1578x614.png 1272w, https://substackcdn.com/image/fetch/$s_!GE4V!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1625468-04e3-4875-a760-f25c6da9187a_1578x614.png 1456w" sizes="100vw" loading="lazy" class="sizing-normal"></picture><div class="image-link-expand"><div class="pencraft pc-display-flex pc-gap-8 pc-reset"><div class="pencraft pc-reset icon-container restack-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M8 16H3v5"></path></svg></div><div class="pencraft pc-reset icon-container view-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-maximize2"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" x2="14" y1="3" y2="10"></line><line x1="3" x2="10" y1="21" y2="14"></line></svg></div></div></div></div></a><figcaption class="image-caption">(from [1])</figcaption></figure></div><h2 class="header-anchor-post">Closing Thoughts<div class="pencraft pc-display-flex pc-alignItems-center pc-position-absolute pc-reset header-anchor-parent"><div class="pencraft pc-display-contents pc-reset pubTheme-yiXxQA"><div id="§closing-thoughts" class="pencraft pc-reset header-anchor offset-top"></div><button type="button" aria-label="Link" data-href="https://cameronrwolfe.substack.com/i/135824233/closing-thoughts" class="pencraft pc-reset pencraft iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_sm-G3LciD priority_secondary-S63h9o" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></button></div></div></h2><p>The LLaMA-2 (and LLaMA-2-Chat) suite of LLMs mark the beginning of a new era for open-source LLMs, as their performance is now closer than ever to that of top proprietary models like ChatGPT and GPT-4. When we examine the key insights from [1] that make these models so impressive, we will notice that simple changes can have a big impact on model performance. However, a variety of in-depth technical insights are provided by LLaMA-2 as well. Some of the major takeaways from LLaMA-2 are itemized and elaborated below. </p><p><strong>Garbage in = garbage out. </strong><span>As we have </span><a href="https://cameronrwolfe.substack.com/p/data-is-the-foundation-of-language" rel="">discussed previously</a><span>, the amount and quality of data used to train an LLM—both during pre-training and fine-tuning—is incredibly important. We see in [1] that part of what makes LLaMA-2 so great is an emphasis upon data. During pre-training, the model observes 40% more data than its predecessor and adopts a modified mixture that emphasizes factual sources. Additionally, LLaMA-2 adopts an approach similar to </span><a href="https://cameronrwolfe.substack.com/i/134561977/lima-less-is-more-for-alignment" rel="">LIMA</a><span> during fine-tuning by curating a smaller, high-quality corpus of dialogues for SFT.</span></p><p><strong>Alignment is important.</strong><span> One of the largest differences between LLaMA-2 and prior work on open-source LLMs is the emphasis upon high-quality alignment. Rather than simply performing SFT with public data, authors in [1] truly try to replicate the complex alignment process that is used for proprietary models by performing multiple rounds of both SFT and RLHF. Although the resulting LLaMA-2-Chat model isn’t the current leader on the </span><a href="https://huggingface.co/spaces/HuggingFaceH4/open_llm_leaderboard" rel="">Open LLM Leaderboard</a><span class="footnote-hovercard-target"><a data-component-name="FootnoteAnchorToDOM" id="footnote-anchor-10-135824233" href="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up#footnote-10-135824233" target="_self" rel="" class="footnote-anchor">10</a></span><span>, such an emphasis upon extensive alignment provides invaluable technical insight that drastically improves the transparency of research in this area. </span></p><div class="captioned-image-container"><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!PvSs!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F5e903beb-ebf5-44b2-9731-55afc4c02584_1584x432.png" data-component-name="Image2ToDOM" rel="" class="image-link image2 is-viewable-img"><div class="image2-inset"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!PvSs!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F5e903beb-ebf5-44b2-9731-55afc4c02584_1584x432.png 424w, https://substackcdn.com/image/fetch/$s_!PvSs!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F5e903beb-ebf5-44b2-9731-55afc4c02584_1584x432.png 848w, https://substackcdn.com/image/fetch/$s_!PvSs!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F5e903beb-ebf5-44b2-9731-55afc4c02584_1584x432.png 1272w, https://substackcdn.com/image/fetch/$s_!PvSs!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F5e903beb-ebf5-44b2-9731-55afc4c02584_1584x432.png 1456w" sizes="100vw"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/5e903beb-ebf5-44b2-9731-55afc4c02584_1584x432.jpg" width="1456" height="397" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/5e903beb-ebf5-44b2-9731-55afc4c02584_1584x432.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:397,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:87793,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!PvSs!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F5e903beb-ebf5-44b2-9731-55afc4c02584_1584x432.png 424w, https://substackcdn.com/image/fetch/$s_!PvSs!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F5e903beb-ebf5-44b2-9731-55afc4c02584_1584x432.png 848w, https://substackcdn.com/image/fetch/$s_!PvSs!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F5e903beb-ebf5-44b2-9731-55afc4c02584_1584x432.png 1272w, https://substackcdn.com/image/fetch/$s_!PvSs!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F5e903beb-ebf5-44b2-9731-55afc4c02584_1584x432.png 1456w" sizes="100vw" loading="lazy" class="sizing-normal"></picture><div class="image-link-expand"><div class="pencraft pc-display-flex pc-gap-8 pc-reset"><div class="pencraft pc-reset icon-container restack-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M8 16H3v5"></path></svg></div><div class="pencraft pc-reset icon-container view-image"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-maximize2"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" x2="14" y1="3" y2="10"></line><line x1="3" x2="10" y1="21" y2="14"></line></svg></div></div></div></div></a><figcaption class="image-caption">(from [1])</figcaption></figure></div><p><strong>RLHF is powerful.</strong><span> Interestingly, authors in [1] mentioned an aversion to using reinforcement learning-based alignment approaches at the outset of this project. However, we see in [1] that reinforcement learning is incredibly effective! RLHF seems to be a natural approach for alignment, as it fosters a synergy between human and LLM via iterative feedback and fine-tuning. Although SFT is useful, human writing quality has high variance, and the model must learn (at least in part) from the tail end of this variance (i.e., bad examples) when using SFT. In contrast, the annotation process for RLHF only requires humans to select the better response, which is less noisy and allows poor responses to be eliminated over time; see above. Additionally, we can observe during RLHF responses that even go beyond human writing comprehension. Despite not being able to write such responses, humans can easily rate them as preferable.</span></p><blockquote><p><em>“Many among us expressed a preference for supervised annotation, attracted by its denser signal… However, reinforcement learning proved highly effective, particularly given its cost and time effectiveness. Our findings underscore that the crucial determinant of RLHF’s success lies in the synergy it fosters between humans and LLMs throughout the annotation process.”</em><span> - from [1]</span></p></blockquote><h4 class="header-anchor-post">New to the newsletter?<div class="pencraft pc-display-flex pc-alignItems-center pc-position-absolute pc-reset header-anchor-parent"><div class="pencraft pc-display-contents pc-reset pubTheme-yiXxQA"><div id="§new-to-the-newsletter" class="pencraft pc-reset header-anchor offset-top"></div><button type="button" aria-label="Link" data-href="https://cameronrwolfe.substack.com/i/135824233/new-to-the-newsletter" class="pencraft pc-reset pencraft iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_sm-G3LciD priority_secondary-S63h9o" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></button></div></div></h4><p><span>Hi! I’m </span><a href="https://cameronrwolfe.me/" rel="">Cameron R. Wolfe</a><span>, deep learning Ph.D. and Director of AI at </span><a href="https://www.rebuyengine.com/" rel="">Rebuy</a><span>. This is the Deep (Learning) Focus newsletter, where I help readers understand AI research via overviews that explain relevant topics from the ground up. If you like the newsletter, please subscribe, share it, or follow me on </span><a href="https://twitter.com/cwolferesearch" rel="">twitter</a><span> or </span><a href="https://www.linkedin.com/in/cameron-r-wolfe-ph-d-04744a238/" rel="">LinkedIn</a><span>!</span></p><p data-attrs="{&quot;url&quot;:&quot;https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up?utm_source=substack&amp;utm_medium=email&amp;utm_content=share&amp;action=share&quot;,&quot;text&quot;:&quot;Share&quot;,&quot;action&quot;:null,&quot;class&quot;:null}" data-component-name="ButtonCreateButton" class="button-wrapper"><a href="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up?utm_source=substack&amp;utm_medium=email&amp;utm_content=share&amp;action=share" rel="" class="button primary"><span>Share</span></a></p><h4 class="header-anchor-post">Bibliography<div class="pencraft pc-display-flex pc-alignItems-center pc-position-absolute pc-reset header-anchor-parent"><div class="pencraft pc-display-contents pc-reset pubTheme-yiXxQA"><div id="§bibliography" class="pencraft pc-reset header-anchor offset-top"></div><button type="button" aria-label="Link" data-href="https://cameronrwolfe.substack.com/i/135824233/bibliography" class="pencraft pc-reset pencraft iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_sm-G3LciD priority_secondary-S63h9o" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></button></div></div></h4><p><span>[1] Touvron, Hugo, et al. "Llama 2: Open Foundation and Fine-Tuned Chat Models."&nbsp;</span><em>arXiv preprint arXiv:2307.09288</em><span>&nbsp;(2023).&nbsp;</span></p><p><span>[2] Touvron, Hugo, et al. "Llama: Open and efficient foundation language models."&nbsp;</span><em>arXiv preprint arXiv:2302.13971</em><span>&nbsp;(2023).</span></p><p><span>[3] “Introducing Llama2: The next generation of our open source large language model”, </span><em>Meta</em><span>, https://ai.meta.com/llama/.</span></p><p><span>[4] Zhang, Biao, and Rico Sennrich. "Root mean square layer normalization."&nbsp;</span><em>Advances in Neural Information Processing Systems</em><span>&nbsp;32 (2019).</span></p><p><span>[5] Shazeer, Noam. "Glu variants improve transformer."&nbsp;</span><em>arXiv preprint arXiv:2002.05202</em><span>&nbsp;(2020).</span></p><p><span>[6] Su, Jianlin, et al. "Roformer: Enhanced transformer with rotary position embedding."&nbsp;</span><em>arXiv preprint arXiv:2104.09864</em><span>&nbsp;(2021).</span></p><p><span>[7] Chowdhery, Aakanksha, et al. "Palm: Scaling language modeling with pathways."&nbsp;</span><em>arXiv preprint arXiv:2204.02311</em><span>&nbsp;(2022).</span></p><p><span>[8] “Introducing Falcon LLM”,&nbsp;</span><em>Technology Innovation Institute</em><span>, 7 June 2023, https://falconllm.tii.ae/.</span></p><p><span>[9] Ainslie, Joshua, et al. "GQA: Training Generalized Multi-Query Transformer Models from Multi-Head Checkpoints."&nbsp;</span><em>arXiv preprint arXiv:2305.13245</em><span>&nbsp;(2023).</span></p><p><span>[10] Ouyang, Long, et al. "Training language models to follow instructions with human feedback."&nbsp;</span><em>Advances in Neural Information Processing Systems</em><span>&nbsp;35 (2022): 27730-27744.</span></p><p><span>[11] Glaese, Amelia, et al. "Improving alignment of dialogue agents via targeted human judgements."&nbsp;</span><em>arXiv preprint arXiv:2209.14375</em><span>&nbsp;(2022).</span></p><p><span>[12] Zhou, Chunting, et al. "Lima: Less is more for alignment."&nbsp;</span><em>arXiv preprint arXiv:2305.11206</em><span>&nbsp;(2023).</span></p><div data-component-name="FootnoteToDOM" class="footnote"><a id="footnote-1-135824233" href="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up#footnote-anchor-1-135824233" contenteditable="false" target="_self" rel="" class="footnote-number">1</a><div class="footnote-content"><p><span>“Generalization” is a term in deep/machine learning that refers to a model’s ability to </span><em>generalize</em><span> beyond training data and also perform well on data it has not seen during training, either in the wild or as part of a hold-out test set. </span></p></div></div><div data-component-name="FootnoteToDOM" class="footnote"><a id="footnote-2-135824233" href="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up#footnote-anchor-2-135824233" contenteditable="false" target="_self" rel="" class="footnote-number">2</a><div class="footnote-content"><p>Many people have disagreements over the definition of an LLM. Here, I am referring to causal language models (i.e., trained with a language modeling objective) that are based upon a decoder-only transformer architecture. </p></div></div><div data-component-name="FootnoteToDOM" class="footnote"><a id="footnote-3-135824233" href="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up#footnote-anchor-3-135824233" contenteditable="false" target="_self" rel="" class="footnote-number">3</a><div class="footnote-content"><p>Notably, many researchers/practitioners have heavily criticized popular LLMs—especially recently—for their refusal to answer questions that are “unsafe”. In some cases, alignment efforts can even be perceived by some as reducing the quality of the underlying LLM for this exact reason. </p></div></div><div data-component-name="FootnoteToDOM" class="footnote"><a id="footnote-4-135824233" href="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up#footnote-anchor-4-135824233" contenteditable="false" target="_self" rel="" class="footnote-number">4</a><div class="footnote-content"><p>LLaMA-2 uses dialogue examples for fine-tuning because it is explicitly optimized for dialogue or chat-based conversations during alignment. </p></div></div><div data-component-name="FootnoteToDOM" class="footnote"><a id="footnote-5-135824233" href="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up#footnote-anchor-5-135824233" contenteditable="false" target="_self" rel="" class="footnote-number">5</a><div class="footnote-content"><p>Maximizing the quality of human annotation is largely related to minimizing cognitive load. So, focusing upon a single alignment criteria at a time likely leads to higher quality, detailed annotations that more accurately reflect alignment criteria. </p></div></div><div data-component-name="FootnoteToDOM" class="footnote"><a id="footnote-6-135824233" href="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up#footnote-anchor-6-135824233" contenteditable="false" target="_self" rel="" class="footnote-number">6</a><div class="footnote-content"><p>This style of loss function is called a “ranking” loss. We don’t directly optimize the model to output a certain score for any input. Rather, we just have pairs of inputs where we know that one input should have a higher score within this pair. So, we train the model to push these scores apart, where the preferred input has a higher score. </p></div></div><div data-component-name="FootnoteToDOM" class="footnote"><a id="footnote-7-135824233" href="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up#footnote-anchor-7-135824233" contenteditable="false" target="_self" rel="" class="footnote-number">7</a><div class="footnote-content"><p><span>Interestingly, this is a form of </span><a href="https://cameronrwolfe.substack.com/i/114077195/knowledge-distillation" rel="">knowledge distillation</a><span>, as the best samples from the larger model are used to fine-tune all smaller LLaMa-2-Chat models via a fine-tuning approach that is similar to SFT. </span></p></div></div><div data-component-name="FootnoteToDOM" class="footnote"><a id="footnote-8-135824233" href="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up#footnote-anchor-8-135824233" contenteditable="false" target="_self" rel="" class="footnote-number">8</a><div class="footnote-content"><p>An emergent capability simply refers to a capability or skill possessed by a model that is not explicitly encouraged during training. For example, the ability of pre-trained LLMs to perform in-context learning can be considered “emergent” given that we never directly train the model to develop this skill via next-token prediction. </p></div></div><div data-component-name="FootnoteToDOM" class="footnote"><a id="footnote-9-135824233" href="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up#footnote-anchor-9-135824233" contenteditable="false" target="_self" rel="" class="footnote-number">9</a><div class="footnote-content"><p>Most evaluations are performed over a set of ~4,000 prompts, which is quite large by academic research standards. </p></div></div><div data-component-name="FootnoteToDOM" class="footnote"><a id="footnote-10-135824233" href="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up#footnote-anchor-10-135824233" contenteditable="false" target="_self" rel="" class="footnote-number">10</a><div class="footnote-content"><p>We should keep in mind here that whether one LLM is better than another is subjective and highly dependent upon how we define “better”. LLaMA-2-Chat is specifically aligned based on helpfulness and safety, and the model seems to excel in these categories as shown by extensive evaluation in [1]. </p></div></div></div><div hidden="" style="position: fixed; top: 1px; left: 1px; width: 1px; height: 0px; padding: 0px; margin: -1px; overflow: hidden; clip: rect(0px, 0px, 0px, 0px); white-space: nowrap; border-width: 0px; display: none;"></div></div><div class="visibility-check"></div><div class="pencraft pc-display-flex pc-paddingTop-16 pc-reset divider-Ti4OTa"><hr></div><div class="visibility-check"></div><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-16 pc-paddingTop-32 pc-paddingBottom-32 pc-reset"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-paddingBottom-8 pc-reset"><h4 class="pencraft pc-reset flex-grow-rzmknG align-center-y7ZD4w line-height-24-jnGwiv font-display-nhmvtD size-20-P_cSRT weight-bold-DmI9lw reset-IxiVJZ">Subscribe to Deep (Learning) Focus</h4><div class="pencraft pc-reset flex-grow-rzmknG color-secondary-ls1g8s align-center-y7ZD4w line-height-20-t4M0El font-text-qe4AeH size-15-Psle70 weight-regular-mUq6Gb reset-IxiVJZ">By Cameron R. Wolfe · Launched 3 years ago</div><div class="pencraft pc-reset flex-grow-rzmknG color-primary-zABazT align-center-y7ZD4w line-height-20-t4M0El font-text-qe4AeH size-15-Psle70 weight-regular-mUq6Gb reset-IxiVJZ">I contextualize and explain important topics in AI research.</div></div><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-16 pc-alignItems-center pc-reset"><div data-component-name="SubscribeWidget" class="subscribe-widget subscribeWidget-sIP7pQ"><div class="pencraft pc-display-flex pc-justifyContent-center pc-reset"><div class="container-IpPqBD"><form action="https://cameronrwolfe.substack.com/api/v1/free?nojs=true" method="post" novalidate="" class="form form-M5sC90"><input type="hidden" name="first_url" value="https://cameronrwolfe.substack.com/p/decoder-only-transformers-the-workhorse"><input type="hidden" name="first_referrer" value="https://www.google.com/"><input type="hidden" name="current_url" value="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up"><input type="hidden" name="current_referrer"><input type="hidden" name="first_session_url" value="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up"><input type="hidden" name="first_session_referrer"><input type="hidden" name="referral_code"><input type="hidden" name="source" value="post-end-cta"><input type="hidden" name="referring_pub_id"><input type="hidden" name="additional_referring_pub_ids"><div class="sideBySideWrap-vGXrwP"><div class="emailInputWrapper-QlA86j"><div class="pencraft pc-display-flex pc-minWidth-0 pc-position-relative pc-reset flex-auto-j3S2WA"><input name="email" placeholder="Type your email..." type="email" class="pencraft emailInput-OkIMeB input-y4v6N4 inputText-pV_yWb"></div></div><button tabindex="0" type="submit" class="pencraft pc-reset pencraft rightButton primary subscribe-btn button-VFSdkv buttonBase-GK1x3M"><span class="button-text ">Subscribe</span></button></div><div id="error-container"></div></form><div class="animationWrapper-QRL6aQ"></div></div></div></div><div class="pencraft pc-display-flex pc-flexDirection-column pc-maxWidth-400 pc-reset"><div class="visibility-check"></div><label class="pencraft pc-display-flex pc-gap-8 pc-justifyContent-center pc-alignItems-center pc-reset tosCheckbox-XbLWCT"><div class="pencraft pc-reset color-secondary-ls1g8s align-center-y7ZD4w line-height-20-t4M0El font-text-qe4AeH size-13-hZTUKr weight-regular-mUq6Gb reset-IxiVJZ">By subscribing,  I agree to Substack's <a href="https://substack.com/tos" target="_blank" class="pencraft pc-reset reset-IxiVJZ" style="text-decoration: underline;">Terms of Use</a>, and acknowledge its <a href="https://substack.com/ccpa#personal-data-collected" target="_blank" class="pencraft pc-reset reset-IxiVJZ" style="text-decoration: underline;">Information Collection Notice</a> and <a href="https://substack.com/privacy" target="_blank" class="pencraft pc-reset reset-IxiVJZ" style="text-decoration: underline;">Privacy Policy</a>.</div></label></div></div></div><div class="pencraft pc-display-flex pc-paddingTop-16 pc-paddingBottom-16 pc-reset border-top-detail-themed-k9TZAY"><div class="pencraft pc-display-flex pc-gap-16 pc-alignItems-center pc-reset color-secondary-ls1g8s"><div class="pencraft pc-display-flex pc-flexDirection-row pc-gap-8 pc-alignItems-center pc-justifyContent-flex-start pc-reset"><div class="pencraft pc-display-flex pc-flexDirection-row pc-alignItems-center pc-justifyContent-flex-start pc-reset rtl-zsi3Q8" style="--scale: 32px; --offset: 8px; --border-width: 4px;"><div class="profile-hover-card-target profileHoverCardTarget-PBxvGm"><a href="https://substack.com/profile/106254331-eswar-divi" aria-label="View Eswar Divi&#39;s profile" class="pencraft pc-display-contents pc-reset"><div tabindex="0" class="pencraft pc-display-flex pc-width-32 pc-height-32 pc-justifyContent-center pc-alignItems-center pc-position-relative pc-reset bg-secondary-UUD3_J flex-auto-j3S2WA animate-XFJxE4 outline-detail-vcQLyr pc-borderRadius-full overflow-hidden-WdpwT6 sizing-border-box-DggLA4 pressable-sm-YIJFKJ showFocus-sk_vEm container-TAtrWj interactive-UkK0V6 avatar-u8q6xB" style="--scale: 32px;"><div title="Eswar Divi" class="pencraft pc-display-flex pc-width-32 pc-height-32 pc-justifyContent-center pc-alignItems-center pc-position-relative pc-reset bg-secondary-UUD3_J flex-auto-j3S2WA outline-detail-vcQLyr pc-borderRadius-full overflow-hidden-WdpwT6 sizing-border-box-DggLA4 container-TAtrWj" style="--scale: 32px;"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!Mrad!,w_32,h_32,c_fill,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fbd8cbd5e-7e5a-41b0-99bd-96903aabd88a_144x144.png 32w, https://substackcdn.com/image/fetch/$s_!Mrad!,w_64,h_64,c_fill,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fbd8cbd5e-7e5a-41b0-99bd-96903aabd88a_144x144.png 64w, https://substackcdn.com/image/fetch/$s_!Mrad!,w_96,h_96,c_fill,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fbd8cbd5e-7e5a-41b0-99bd-96903aabd88a_144x144.png 96w" sizes="32px"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/bd8cbd5e-7e5a-41b0-99bd-96903aabd88a_144x144.png" sizes="32px" alt="Eswar Divi&#39;s avatar" srcset="https://substackcdn.com/image/fetch/$s_!Mrad!,w_32,h_32,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fbd8cbd5e-7e5a-41b0-99bd-96903aabd88a_144x144.png 32w, https://substackcdn.com/image/fetch/$s_!Mrad!,w_64,h_64,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fbd8cbd5e-7e5a-41b0-99bd-96903aabd88a_144x144.png 64w, https://substackcdn.com/image/fetch/$s_!Mrad!,w_96,h_96,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fbd8cbd5e-7e5a-41b0-99bd-96903aabd88a_144x144.png 96w" width="32" height="32" draggable="false" class="img-OACg1c object-fit-cover-u4ReeV pencraft pc-reset"></picture></div></div></a></div><div class="profile-hover-card-target profileHoverCardTarget-PBxvGm"><a href="https://substack.com/profile/6080836-boi" aria-label="View Boi&#39;s profile" class="pencraft pc-display-contents pc-reset"><div tabindex="0" class="pencraft pc-display-flex pc-width-32 pc-height-32 pc-justifyContent-center pc-alignItems-center pc-position-relative pc-reset bg-secondary-UUD3_J flex-auto-j3S2WA animate-XFJxE4 outline-detail-vcQLyr pc-borderRadius-full overflow-hidden-WdpwT6 sizing-border-box-DggLA4 pressable-sm-YIJFKJ showFocus-sk_vEm container-TAtrWj interactive-UkK0V6 avatar-u8q6xB overlap-q75iOo" style="--scale: 32px;"><div title="Boi" class="pencraft pc-display-flex pc-width-32 pc-height-32 pc-justifyContent-center pc-alignItems-center pc-position-relative pc-reset bg-secondary-UUD3_J flex-auto-j3S2WA outline-detail-vcQLyr pc-borderRadius-full overflow-hidden-WdpwT6 sizing-border-box-DggLA4 container-TAtrWj" style="--scale: 32px;"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!5OXe!,w_32,h_32,c_fill,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F1bb7bd86-2841-4ca0-bb98-a219368bcd5f_980x653.jpeg 32w, https://substackcdn.com/image/fetch/$s_!5OXe!,w_64,h_64,c_fill,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F1bb7bd86-2841-4ca0-bb98-a219368bcd5f_980x653.jpeg 64w, https://substackcdn.com/image/fetch/$s_!5OXe!,w_96,h_96,c_fill,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F1bb7bd86-2841-4ca0-bb98-a219368bcd5f_980x653.jpeg 96w" sizes="32px"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/1bb7bd86-2841-4ca0-bb98-a219368bcd5f_980x653.jpg" sizes="32px" alt="Boi&#39;s avatar" srcset="https://substackcdn.com/image/fetch/$s_!5OXe!,w_32,h_32,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F1bb7bd86-2841-4ca0-bb98-a219368bcd5f_980x653.jpeg 32w, https://substackcdn.com/image/fetch/$s_!5OXe!,w_64,h_64,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F1bb7bd86-2841-4ca0-bb98-a219368bcd5f_980x653.jpeg 64w, https://substackcdn.com/image/fetch/$s_!5OXe!,w_96,h_96,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F1bb7bd86-2841-4ca0-bb98-a219368bcd5f_980x653.jpeg 96w" width="32" height="32" draggable="false" class="img-OACg1c object-fit-cover-u4ReeV pencraft pc-reset"></picture></div></div></a></div><div class="profile-hover-card-target profileHoverCardTarget-PBxvGm"><a href="https://substack.com/profile/119560333-kiran-adimatyam" aria-label="View Kiran Adimatyam&#39;s profile" class="pencraft pc-display-contents pc-reset"><div tabindex="0" class="pencraft pc-display-flex pc-width-32 pc-height-32 pc-justifyContent-center pc-alignItems-center pc-position-relative pc-reset bg-secondary-UUD3_J flex-auto-j3S2WA animate-XFJxE4 outline-detail-vcQLyr pc-borderRadius-full overflow-hidden-WdpwT6 sizing-border-box-DggLA4 pressable-sm-YIJFKJ showFocus-sk_vEm container-TAtrWj interactive-UkK0V6 avatar-u8q6xB overlap-q75iOo" style="--scale: 32px;"><div title="Kiran Adimatyam" class="pencraft pc-display-flex pc-width-32 pc-height-32 pc-justifyContent-center pc-alignItems-center pc-position-relative pc-reset bg-secondary-UUD3_J flex-auto-j3S2WA outline-detail-vcQLyr pc-borderRadius-full overflow-hidden-WdpwT6 sizing-border-box-DggLA4 container-TAtrWj" style="--scale: 32px;"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!1-dh!,w_32,h_32,c_fill,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F914ce083-db2b-4f5b-891f-38c5abdf007e_1024x1024.png 32w, https://substackcdn.com/image/fetch/$s_!1-dh!,w_64,h_64,c_fill,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F914ce083-db2b-4f5b-891f-38c5abdf007e_1024x1024.png 64w, https://substackcdn.com/image/fetch/$s_!1-dh!,w_96,h_96,c_fill,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F914ce083-db2b-4f5b-891f-38c5abdf007e_1024x1024.png 96w" sizes="32px"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/914ce083-db2b-4f5b-891f-38c5abdf007e_1024x1024.jpg" sizes="32px" alt="Kiran Adimatyam&#39;s avatar" srcset="https://substackcdn.com/image/fetch/$s_!1-dh!,w_32,h_32,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F914ce083-db2b-4f5b-891f-38c5abdf007e_1024x1024.png 32w, https://substackcdn.com/image/fetch/$s_!1-dh!,w_64,h_64,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F914ce083-db2b-4f5b-891f-38c5abdf007e_1024x1024.png 64w, https://substackcdn.com/image/fetch/$s_!1-dh!,w_96,h_96,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F914ce083-db2b-4f5b-891f-38c5abdf007e_1024x1024.png 96w" width="32" height="32" draggable="false" class="img-OACg1c object-fit-cover-u4ReeV pencraft pc-reset"></picture></div></div></a></div><div class="profile-hover-card-target profileHoverCardTarget-PBxvGm"><a href="https://substack.com/profile/100785516-lazaro-hurtado" aria-label="View Lazaro  Hurtado&#39;s profile" class="pencraft pc-display-contents pc-reset"><div tabindex="0" class="pencraft pc-display-flex pc-width-32 pc-height-32 pc-justifyContent-center pc-alignItems-center pc-position-relative pc-reset bg-secondary-UUD3_J flex-auto-j3S2WA animate-XFJxE4 outline-detail-vcQLyr pc-borderRadius-full overflow-hidden-WdpwT6 sizing-border-box-DggLA4 pressable-sm-YIJFKJ showFocus-sk_vEm container-TAtrWj interactive-UkK0V6 avatar-u8q6xB overlap-q75iOo" style="--scale: 32px;"><div title="Lazaro  Hurtado" class="pencraft pc-display-flex pc-width-32 pc-height-32 pc-justifyContent-center pc-alignItems-center pc-position-relative pc-reset bg-secondary-UUD3_J flex-auto-j3S2WA outline-detail-vcQLyr pc-borderRadius-full overflow-hidden-WdpwT6 sizing-border-box-DggLA4 container-TAtrWj" style="--scale: 32px;"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!_ZtY!,w_32,h_32,c_fill,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd090f3a8-f320-4a21-aa62-dd22ba4b707b_144x144.png 32w, https://substackcdn.com/image/fetch/$s_!_ZtY!,w_64,h_64,c_fill,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd090f3a8-f320-4a21-aa62-dd22ba4b707b_144x144.png 64w, https://substackcdn.com/image/fetch/$s_!_ZtY!,w_96,h_96,c_fill,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd090f3a8-f320-4a21-aa62-dd22ba4b707b_144x144.png 96w" sizes="32px"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/d090f3a8-f320-4a21-aa62-dd22ba4b707b_144x144.png" sizes="32px" alt="Lazaro  Hurtado&#39;s avatar" srcset="https://substackcdn.com/image/fetch/$s_!_ZtY!,w_32,h_32,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd090f3a8-f320-4a21-aa62-dd22ba4b707b_144x144.png 32w, https://substackcdn.com/image/fetch/$s_!_ZtY!,w_64,h_64,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd090f3a8-f320-4a21-aa62-dd22ba4b707b_144x144.png 64w, https://substackcdn.com/image/fetch/$s_!_ZtY!,w_96,h_96,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd090f3a8-f320-4a21-aa62-dd22ba4b707b_144x144.png 96w" width="32" height="32" draggable="false" class="img-OACg1c object-fit-cover-u4ReeV pencraft pc-reset"></picture></div></div></a></div><div class="profile-hover-card-target profileHoverCardTarget-PBxvGm"><a href="https://substack.com/profile/45646766-obrian-henry" aria-label="View Obrian Henry&#39;s profile" class="pencraft pc-display-contents pc-reset"><div tabindex="0" class="pencraft pc-display-flex pc-width-32 pc-height-32 pc-justifyContent-center pc-alignItems-center pc-position-relative pc-reset bg-secondary-UUD3_J flex-auto-j3S2WA animate-XFJxE4 outline-detail-vcQLyr pc-borderRadius-full overflow-hidden-WdpwT6 sizing-border-box-DggLA4 pressable-sm-YIJFKJ showFocus-sk_vEm container-TAtrWj interactive-UkK0V6 avatar-u8q6xB overlap-q75iOo last-JfNEJ_" style="--scale: 32px;"><div title="Obrian Henry" class="pencraft pc-display-flex pc-width-32 pc-height-32 pc-justifyContent-center pc-alignItems-center pc-position-relative pc-reset bg-secondary-UUD3_J flex-auto-j3S2WA outline-detail-vcQLyr pc-borderRadius-full overflow-hidden-WdpwT6 sizing-border-box-DggLA4 container-TAtrWj" style="--scale: 32px;"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!89a0!,w_32,h_32,c_fill,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F27fddcfd-ebf9-48af-82d9-1331d5b8a902_4167x4167.png 32w, https://substackcdn.com/image/fetch/$s_!89a0!,w_64,h_64,c_fill,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F27fddcfd-ebf9-48af-82d9-1331d5b8a902_4167x4167.png 64w, https://substackcdn.com/image/fetch/$s_!89a0!,w_96,h_96,c_fill,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F27fddcfd-ebf9-48af-82d9-1331d5b8a902_4167x4167.png 96w" sizes="32px"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/27fddcfd-ebf9-48af-82d9-1331d5b8a902_4167x4167.png" sizes="32px" alt="Obrian Henry&#39;s avatar" srcset="https://substackcdn.com/image/fetch/$s_!89a0!,w_32,h_32,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F27fddcfd-ebf9-48af-82d9-1331d5b8a902_4167x4167.png 32w, https://substackcdn.com/image/fetch/$s_!89a0!,w_64,h_64,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F27fddcfd-ebf9-48af-82d9-1331d5b8a902_4167x4167.png 64w, https://substackcdn.com/image/fetch/$s_!89a0!,w_96,h_96,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F27fddcfd-ebf9-48af-82d9-1331d5b8a902_4167x4167.png 96w" width="32" height="32" draggable="false" class="img-OACg1c object-fit-cover-u4ReeV pencraft pc-reset"></picture></div></div></a></div></div></div><div class="pencraft pc-reset color-secondary-ls1g8s line-height-20-t4M0El font-text-qe4AeH size-13-hZTUKr weight-regular-mUq6Gb reset-IxiVJZ"><div class="pencraft pc-display-flex pc-gap-4 pc-alignItems-center pc-reset"><a class="pencraft pc-reset cursor-pointer-LYORKw color-secondary-ls1g8s decoration-hover-underline-ClDVRM reset-IxiVJZ">44 Likes</a>∙<div class="pencraft pc-reset color-secondary-ls1g8s line-height-20-t4M0El font-text-qe4AeH size-13-hZTUKr weight-regular-mUq6Gb reset-IxiVJZ"><a href="https://substack.com/note/p-135824233/restacks?utm_source=substack&amp;utm_content=facepile-restacks" class="pencraft pc-reset color-secondary-ls1g8s decoration-hover-underline-ClDVRM reset-IxiVJZ">6 Restacks</a></div></div></div></div></div><div class="post-footer"><div class="pencraft pc-display-flex pc-gap-16 pc-paddingTop-16 pc-paddingBottom-16 pc-justifyContent-space-between pc-alignItems-center pc-reset flex-grow-rzmknG border-top-detail-themed-k9TZAY border-bottom-detail-themed-Ua9186 post-ufi"><div class="pencraft pc-display-flex pc-gap-8 pc-reset"><div class="like-button-container post-ufi-button style-button"><a role="button" aria-label="Like (44)" aria-pressed="false" class="post-ufi-button style-button has-label with-border"><svg role="img" width="20" height="20" viewBox="0 0 24 24" fill="#000000" stroke-width="2" stroke="#000" xmlns="http://www.w3.org/2000/svg" class="icon" style="height: 20px; width: 20px;"><g><title></title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-heart"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"></path></svg></g></svg><div class="label">44</div></a><div inert="" role="dialog" class="modal typography out gone reader-onboarding-modal wide popup"><div class="modal-table"><div class="modal-row"><div class="modal-cell modal-content"><div class="container"><button tabindex="0" type="button" aria-label="X" data-testid="close-modal" class="pencraft pc-reset pencraft modal-btn modal-exit-btn no-margin iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_md-gCDS3o priority_tertiary-rlke8z"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="secondary" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg></button><div class="reader-onboarding-modal-container"></div></div></div></div></div></div><div inert="" role="dialog" class="modal typography out gone share-dialog popup"><div class="modal-table"><div class="modal-row"><div class="modal-cell modal-content no-fullscreen"><div class="container"><button tabindex="0" type="button" aria-label="X" data-testid="close-modal" class="pencraft pc-reset pencraft modal-btn modal-exit-btn no-margin iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_md-gCDS3o priority_tertiary-rlke8z"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="secondary" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg></button><div class="pencraft pc-display-contents pc-reset pubTheme-yiXxQA"><div class="pencraft pc-display-contents pc-reset elevatedTheme-fBklGV"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-24 pc-padding-24 pc-reset bg-primary-zk6FDl border-detail-EGrm7T pc-borderRadius-md container-xiJVit"><h4 class="pencraft pc-reset flex-grow-rzmknG align-center-y7ZD4w line-height-24-jnGwiv font-display-nhmvtD size-20-P_cSRT weight-bold-DmI9lw reset-IxiVJZ">Share this post</h4><a href="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up#" class="pencraft pc-display-contents pc-reset"><div class="pencraft pc-display-contents pc-reset elevatedTheme-fBklGV"><div tabindex="0" draggable="false" class="pencraft pc-display-flex pc-flexDirection-column pc-minWidth-0 pc-position-relative pc-reset bg-primary-zk6FDl pc-borderRadius-md showFocus-sk_vEm postAttachment-eYV3fM" style="background: linear-gradient(180deg, rgba(80,80,80,0.75), rgba(80,80,80,0.75)), var(--color-dark-bg-secondary);"><div class="pencraft pc-display-flex pc-flexDirection-column pc-reset border-bottom-detail-k1F6C4 vibrantHeader-We3FVb"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!D1xF!,w_424,h_222,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 424w, https://substackcdn.com/image/fetch/$s_!D1xF!,w_520,h_272,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 520w, https://substackcdn.com/image/fetch/$s_!D1xF!,w_848,h_444,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 848w, https://substackcdn.com/image/fetch/$s_!D1xF!,w_1040,h_545,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 1040w, https://substackcdn.com/image/fetch/$s_!D1xF!,w_1272,h_666,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 1272w, https://substackcdn.com/image/fetch/$s_!D1xF!,w_1456,h_762,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 1456w, https://substackcdn.com/image/fetch/$s_!D1xF!,w_1560,h_817,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 1560w" sizes="520px"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/ed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.jpg" sizes="520px" alt="" srcset="https://substackcdn.com/image/fetch/$s_!D1xF!,w_424,h_222,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 424w, https://substackcdn.com/image/fetch/$s_!D1xF!,w_520,h_272,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 520w, https://substackcdn.com/image/fetch/$s_!D1xF!,w_848,h_444,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 848w, https://substackcdn.com/image/fetch/$s_!D1xF!,w_1040,h_545,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 1040w, https://substackcdn.com/image/fetch/$s_!D1xF!,w_1272,h_666,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 1272w, https://substackcdn.com/image/fetch/$s_!D1xF!,w_1456,h_762,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 1456w, https://substackcdn.com/image/fetch/$s_!D1xF!,w_1560,h_817,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png 1560w" width="520" draggable="false" class="img-OACg1c postImage-L4FlO9 vibrantPostImage-TTXyOq pencraft pc-reset"></picture></div><div class="pencraft pc-display-flex pc-gap-12 pc-padding-12 pc-alignItems-center pc-reset"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-2 pc-minWidth-0 pc-reset flex-grow-rzmknG"><div class="pencraft pc-display-flex pc-gap-8 pc-paddingBottom-4 pc-alignItems-center pc-reset"><div draggable="false" class="pencraft pc-display-flex pc-position-relative pc-reset"><div class="pencraft pc-display-flex pc-reset bg-white-ZBV5av pc-borderRadius-xs overflow-hidden-WdpwT6 sizing-border-box-DggLA4" style="width: 18px; height: 18px;"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!87xa!,w_36,h_36,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fab9b43fb-52d5-40da-995d-5b7cd3f91064_896x896.png"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/ab9b43fb-52d5-40da-995d-5b7cd3f91064_896x896(1).jpg" sizes="100vw" alt="Deep (Learning) Focus" width="36" height="36" draggable="false" class="img-OACg1c object-fit-cover-u4ReeV pencraft pc-reset" style="width: 18px; height: 18px;"></picture></div></div><div class="pencraft pc-reset flex-grow-rzmknG ellipsis-Jb8om8 color-vibrance-secondary-k5eqjt line-height-20-t4M0El font-text-qe4AeH size-13-hZTUKr weight-regular-mUq6Gb nowrap-QngyoB reset-IxiVJZ">Deep (Learning) Focus</div></div><div class="pencraft pc-reset color-vibrance-primary-KHCdqV line-height-20-t4M0El font-text-qe4AeH size-15-Psle70 weight-medium-fw81nC clamp-y7pNm8 clamp-2-kM02pu reset-IxiVJZ">LLaMA-2 from the Ground Up</div></div></div></div></div></a><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-16 pc-reset"><div class="pencraft pc-display-flex pc-justifyContent-space-between pc-reset"><button tabindex="0" type="button" class="pencraft pc-reset pc-borderRadius-sm pencraft buttonBase-GK1x3M"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-width-64 pc-alignItems-center pc-reset container-iTCOuF"><div class="pencraft pc-display-flex pc-flexDirection-column pc-width-64 pc-height-64 pc-justifyContent-center pc-alignItems-center pc-reset bg-secondary-UUD3_J animate-XFJxE4 pc-borderRadius-lg button-zkMi7O"><svg role="img" width="20" height="20" viewBox="0 0 20 20" fill="none" stroke-width="2" stroke="var(--color-fg-primary)" xmlns="http://www.w3.org/2000/svg" style="height: 20px; width: 20px;"><g><title></title><path d="M7.50008 14.1666H5.83341C4.72835 14.1666 3.66854 13.7276 2.88714 12.9462C2.10573 12.1648 1.66675 11.105 1.66675 9.99992C1.66675 8.89485 2.10573 7.83504 2.88714 7.05364C3.66854 6.27224 4.72835 5.83325 5.83341 5.83325H7.50008M12.5001 5.83325H14.1667C15.2718 5.83325 16.3316 6.27224 17.113 7.05364C17.8944 7.83504 18.3334 8.89485 18.3334 9.99992C18.3334 11.105 17.8944 12.1648 17.113 12.9462C16.3316 13.7276 15.2718 14.1666 14.1667 14.1666H12.5001M6.66675 9.99992H13.3334"></path></g></svg></div><div class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-11-NuY2Zx weight-semibold-uqA4FV reset-IxiVJZ">Copy link</div></div></button><button tabindex="0" type="button" class="pencraft pc-reset pc-borderRadius-sm pencraft buttonBase-GK1x3M"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-width-64 pc-alignItems-center pc-reset container-iTCOuF"><div class="pencraft pc-display-flex pc-flexDirection-column pc-width-64 pc-height-64 pc-justifyContent-center pc-alignItems-center pc-reset bg-secondary-UUD3_J animate-XFJxE4 pc-borderRadius-lg button-zkMi7O"><svg role="img" width="20" height="20" viewBox="0 0 20 20" fill="var(--color-fg-primary)" stroke-width="1.8" stroke="none" xmlns="http://www.w3.org/2000/svg" style="height: 20px; width: 20px;"><g><title></title><path stroke="none" d="M20 10C20 4.47715 15.5229 0 10 0C4.47715 0 0 4.47715 0 10C0 14.9912 3.65684 19.1283 8.4375 19.8785V12.8906H5.89844V10H8.4375V7.79688C8.4375 5.29063 9.93047 3.90625 12.2146 3.90625C13.3084 3.90625 14.4531 4.10156 14.4531 4.10156V6.5625H13.1922C11.95 6.5625 11.5625 7.3334 11.5625 8.125V10H14.3359L13.8926 12.8906H11.5625V19.8785C16.3432 19.1283 20 14.9912 20 10Z"></path></g></svg></div><div class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-11-NuY2Zx weight-semibold-uqA4FV reset-IxiVJZ">Facebook</div></div></button><button tabindex="0" type="button" class="pencraft pc-reset pc-borderRadius-sm pencraft buttonBase-GK1x3M"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-width-64 pc-alignItems-center pc-reset container-iTCOuF"><div class="pencraft pc-display-flex pc-flexDirection-column pc-width-64 pc-height-64 pc-justifyContent-center pc-alignItems-center pc-reset bg-secondary-UUD3_J animate-XFJxE4 pc-borderRadius-lg button-zkMi7O"><svg role="img" width="20" height="20" viewBox="0 0 20 20" fill="var(--color-fg-primary)" stroke-width="1.8" stroke="var(--color-fg-primary)" xmlns="http://www.w3.org/2000/svg" style="height: 20px; width: 20px;"><g><title></title><path stroke="none" d="M9.9958 11.0646C10.2693 11.0646 10.5346 10.9569 10.7915 10.7248L19.0717 3.431C18.6241 3.13262 18.1102 3 17.3974 3H2.60257C1.88976 3 1.37587 3.13262 0.920011 3.431L9.20011 10.7248C9.46534 10.9569 9.73057 11.0646 9.9958 11.0646ZM0.215499 15.9465L6.34893 9.82137L0.198922 4.40075C0.107749 4.5748 0 4.99751 0 5.56941V14.7199C0 15.2503 0.0828842 15.6316 0.215499 15.9465ZM2.35391 17.2892H17.646C18.2511 17.2892 18.7235 17.14 19.0385 16.9245L12.731 10.6171L11.5209 11.6945C11.0402 12.1173 10.518 12.3328 9.9958 12.3328C9.48197 12.3328 8.95975 12.1173 8.47905 11.6945L7.26894 10.6171L0.961455 16.9245C1.27642 17.14 1.74057 17.2892 2.35391 17.2892ZM19.7844 15.9465C19.9088 15.6316 20 15.2503 20 14.7199V5.56941C20 4.99751 19.8922 4.5748 19.8011 4.40075L13.651 9.82137L19.7844 15.9465Z"></path></g></svg></div><div class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-11-NuY2Zx weight-semibold-uqA4FV reset-IxiVJZ">Email</div></div></button><button tabindex="0" type="button" class="pencraft pc-reset pc-borderRadius-sm pencraft buttonBase-GK1x3M"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-width-64 pc-alignItems-center pc-reset container-iTCOuF"><div class="pencraft pc-display-flex pc-flexDirection-column pc-width-64 pc-height-64 pc-justifyContent-center pc-alignItems-center pc-reset bg-secondary-UUD3_J animate-XFJxE4 pc-borderRadius-lg button-zkMi7O"><svg role="img" width="20" height="20" viewBox="0 0 20 20" fill="var(--color-fg-primary)" stroke-width="1.8" stroke="none" xmlns="http://www.w3.org/2000/svg" style="height: 20px; width: 20px;"><g><title></title><path d="M1.96484 0.624512H18.0354V2.70052H1.96484V0.624512Z" stroke="none"></path><path d="M1.96484 4.77655H18.0354V6.85254H1.96484V4.77655Z" stroke="none"></path><path d="M1.96484 8.92857V19.9505L10.0001 14.6347L18.0354 19.9505V8.92857H1.96484Z" stroke="none"></path></g></svg></div><div class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-11-NuY2Zx weight-semibold-uqA4FV reset-IxiVJZ">Notes</div></div></button><button tabindex="0" type="button" class="pencraft pc-reset pc-borderRadius-sm pencraft buttonBase-GK1x3M"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-width-64 pc-alignItems-center pc-reset container-iTCOuF"><div class="pencraft pc-display-flex pc-flexDirection-column pc-width-64 pc-height-64 pc-justifyContent-center pc-alignItems-center pc-reset bg-secondary-UUD3_J animate-XFJxE4 pc-borderRadius-lg button-zkMi7O"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--color-fg-primary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-ellipsis"><circle cx="12" cy="12" r="1"></circle><circle cx="19" cy="12" r="1"></circle><circle cx="5" cy="12" r="1"></circle></svg></div><div class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-11-NuY2Zx weight-semibold-uqA4FV reset-IxiVJZ">More</div></div></button></div></div></div></div></div></div></div></div></div></div></div><a role="button" href="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up/comments" aria-label="View comments (6)" class="post-ufi-button style-button post-ufi-comment-button has-label with-border"><svg role="img" width="20" height="20" viewBox="0 0 24 24" fill="#000000" stroke-width="2" stroke="#000" xmlns="http://www.w3.org/2000/svg" class="icon" style="height: 20px; width: 20px;"><g><title></title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-message-circle"><path d="M7.9 20A9 9 0 1 0 4 16.1L2 22Z"></path></svg></g></svg><div class="label">6</div></a><a role="button" class="post-ufi-button style-button has-label with-border"><svg role="img" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke="#000" xmlns="http://www.w3.org/2000/svg" class="icon" style="height: 20px; width: 20px;"><g><title></title><path d="M21 3V8M21 8H16M21 8L18 5.29962C16.7056 4.14183 15.1038 3.38328 13.3879 3.11547C11.6719 2.84766 9.9152 3.08203 8.32951 3.79031C6.74382 4.49858 5.39691 5.65051 4.45125 7.10715C3.5056 8.5638 3.00158 10.2629 3 11.9996M3 21V16M3 16H8M3 16L6 18.7C7.29445 19.8578 8.89623 20.6163 10.6121 20.8841C12.3281 21.152 14.0848 20.9176 15.6705 20.2093C17.2562 19.501 18.6031 18.3491 19.5487 16.8925C20.4944 15.4358 20.9984 13.7367 21 12" stroke-linecap="round" stroke-linejoin="round"></path></g></svg><div class="label">6</div></a><div inert="" role="dialog" class="modal typography out gone reader-onboarding-modal wide popup"><div class="modal-table"><div class="modal-row"><div class="modal-cell modal-content"><div class="container"><button tabindex="0" type="button" aria-label="X" data-testid="close-modal" class="pencraft pc-reset pencraft modal-btn modal-exit-btn no-margin iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_md-gCDS3o priority_tertiary-rlke8z"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="secondary" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg></button><div class="reader-onboarding-modal-container"></div></div></div></div></div></div></div><div class="pencraft pc-display-flex pc-gap-8 pc-reset"><a role="button" href="javascript:void(0)" aria-label="View share options" class="post-ufi-button style-button no-icon has-label with-border"><div class="label">Share</div></a></div></div></div></div></article></div></div></div><div class="pencraft pc-display-contents pc-reset pubTheme-yiXxQA"><div class="visibility-check"></div><div id="discussion" class="pencraft pc-display-flex pc-flexDirection-column pc-gap-16 pc-paddingTop-32 pc-paddingBottom-32 pc-reset"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-32 pc-reset container"><h4 class="pencraft pc-reset line-height-24-jnGwiv font-display-nhmvtD size-20-P_cSRT weight-bold-DmI9lw reset-IxiVJZ">Discussion about this post</h4><div class="pencraft pc-alignSelf-flex-start pc-reset"><div class="pencraft pc-display-flex pc-flexDirection-column pc-position-relative pc-minWidth-0 pc-reset bg-primary-zk6FDl pc-borderRadius-sm overflow-hidden-WdpwT6"><div aria-label="Select discussion type" role="tablist" aria-orientation="horizontal" class="pencraft pc-display-flex pc-gap-4 pc-padding-4 pc-position-relative pc-reset cursor-default-flE2S1 outline-detail-vcQLyr pc-borderRadius-sm overflow-auto-7WTsTi scrollBar-hidden-HcAIpI"><button type="button" id="headlessui-tabs-tab-P0-10" role="tab" aria-selected="true" data-headlessui-state="selected" class="pencraft pc-reset pencraft segment-LBFzmC buttonBase-GK1x3M buttonText-X0uSmG buttonStyle-r7yGCK priority_tertiary-rlke8z size_sm-G3LciD" tabindex="0">Comments</button><button type="button" id="headlessui-tabs-tab-P0-11" role="tab" aria-selected="false" data-headlessui-state="" class="pencraft pc-reset pencraft segment-LBFzmC buttonBase-GK1x3M buttonText-X0uSmG buttonStyle-r7yGCK priority_quaternary-kpMibu size_sm-G3LciD" tabindex="-1">Restacks</button><div class="pencraft pc-position-absolute pc-height-32 pc-reset bg-secondary-UUD3_J pc-borderRadius-xs sizing-border-box-DggLA4 highlight-U002IP" style="--highlight-width: 83.5px; --highlight-x: 0px;"></div></div><div class="pencraft pc-display-flex pc-alignItems-center pc-reset arrowButtonContainer-O4uSiH arrowButtonOverlaidContainer-t10AyH left-Tg8vqp"><div class="overlay-zrMCxn primary-lv_sOW"></div></div><div class="pencraft pc-display-flex pc-alignItems-center pc-reset arrowButtonContainer-O4uSiH arrowButtonOverlaidContainer-t10AyH right-i3oWGi"><div class="overlay-zrMCxn primary-lv_sOW"></div></div></div></div></div><div class="single-post-section comments-section"><div class="container"><div class="visibility-check"></div><div class="pencraft pc-display-contents pc-reset pubTheme-yiXxQA"><div data-test-id="comment-input" class="pencraft pc-display-flex pc-reset flex-grow-rzmknG"><form class="form-CkZ7Kt"><div style="--scale: 32px;" class="pencraft pc-display-flex pc-width-32 pc-height-32 pc-justifyContent-center pc-alignItems-center pc-position-relative pc-reset bg-secondary-UUD3_J flex-auto-j3S2WA outline-detail-vcQLyr pc-borderRadius-full overflow-hidden-WdpwT6 sizing-border-box-DggLA4 container-TAtrWj"><div style="--scale: 32px;" title="User" class="pencraft pc-display-flex pc-width-32 pc-height-32 pc-justifyContent-center pc-alignItems-center pc-position-relative pc-reset bg-secondary-UUD3_J flex-auto-j3S2WA outline-detail-vcQLyr pc-borderRadius-full overflow-hidden-WdpwT6 sizing-border-box-DggLA4 container-TAtrWj"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!owWd!,w_32,h_32,c_fill,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack.com%2Fimg%2Favatars%2Fdefault-dark.png 32w, https://substackcdn.com/image/fetch/$s_!owWd!,w_64,h_64,c_fill,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack.com%2Fimg%2Favatars%2Fdefault-dark.png 64w, https://substackcdn.com/image/fetch/$s_!owWd!,w_96,h_96,c_fill,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack.com%2Fimg%2Favatars%2Fdefault-dark.png 96w" sizes="32px"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/default-dark.jpg" sizes="32px" alt="User&#39;s avatar" srcset="https://substackcdn.com/image/fetch/$s_!owWd!,w_32,h_32,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack.com%2Fimg%2Favatars%2Fdefault-dark.png 32w, https://substackcdn.com/image/fetch/$s_!owWd!,w_64,h_64,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack.com%2Fimg%2Favatars%2Fdefault-dark.png 64w, https://substackcdn.com/image/fetch/$s_!owWd!,w_96,h_96,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack.com%2Fimg%2Favatars%2Fdefault-dark.png 96w" width="32" height="32" draggable="false" class="img-OACg1c object-fit-cover-u4ReeV pencraft pc-reset"></picture></div></div><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-reset flex-grow-rzmknG"><textarea name="body" placeholder="Write a comment..." aria-label="Write a comment..." rows="4" class="pencraft input-qHk4bN autogrowing-_ipn9Y textarea-GbEjRX inputText-pV_yWb" style="height: 96px;"></textarea><div style="height: 0px; transition: height 250ms var(--animation-smooth), opacity 250ms var(--animation-smooth); display: block; flex-direction: column; opacity: 0;"><div style="padding-top: 0.05px; padding-bottom: 0.05px; display: block; flex: 0 0 auto; flex-direction: column; transition: transform 250ms var(--animation-smooth);"></div></div></div></form></div></div><div class="comment-list post-page-root-comment-list"><div class="comment-list-items"><div class="comment"><div id="comment-58676835" class="comment-anchor"></div><div id="comment-58676835-reply" class="comment-anchor"></div><div role="article" aria-label="Comment by Oleksandr Rechynskyi" class="pencraft pc-display-flex pc-gap-12 pc-paddingBottom-12 pc-reset comment-content"><div class="pencraft pc-display-flex pc-flexDirection-column pc-reset"><div class="profile-hover-card-target profileHoverCardTarget-PBxvGm"><a href="https://substack.com/profile/134301190-oleksandr-rechynskyi?utm_source=comment" aria-label="View Oleksandr Rechynskyi&#39;s profile" class="pencraft pc-display-contents pc-reset"><div tabindex="0" class="pencraft pc-display-flex pc-width-32 pc-height-32 pc-justifyContent-center pc-alignItems-center pc-position-relative pc-reset bg-secondary-UUD3_J flex-auto-j3S2WA animate-XFJxE4 outline-detail-vcQLyr pc-borderRadius-full overflow-hidden-WdpwT6 sizing-border-box-DggLA4 pressable-sm-YIJFKJ showFocus-sk_vEm container-TAtrWj interactive-UkK0V6" style="--scale: 32px;"><div title="Oleksandr Rechynskyi" class="pencraft pc-display-flex pc-width-32 pc-height-32 pc-justifyContent-center pc-alignItems-center pc-position-relative pc-reset bg-secondary-UUD3_J flex-auto-j3S2WA outline-detail-vcQLyr pc-borderRadius-full overflow-hidden-WdpwT6 sizing-border-box-DggLA4 container-TAtrWj" style="--scale: 32px;"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!Sdeh!,w_32,h_32,c_fill,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F484cd279-07e6-417d-82a9-65fa67c93d7e_144x144.png 32w, https://substackcdn.com/image/fetch/$s_!Sdeh!,w_64,h_64,c_fill,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F484cd279-07e6-417d-82a9-65fa67c93d7e_144x144.png 64w, https://substackcdn.com/image/fetch/$s_!Sdeh!,w_96,h_96,c_fill,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F484cd279-07e6-417d-82a9-65fa67c93d7e_144x144.png 96w" sizes="32px"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/484cd279-07e6-417d-82a9-65fa67c93d7e_144x144.jpg" sizes="32px" alt="Oleksandr Rechynskyi&#39;s avatar" srcset="https://substackcdn.com/image/fetch/$s_!Sdeh!,w_32,h_32,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F484cd279-07e6-417d-82a9-65fa67c93d7e_144x144.png 32w, https://substackcdn.com/image/fetch/$s_!Sdeh!,w_64,h_64,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F484cd279-07e6-417d-82a9-65fa67c93d7e_144x144.png 64w, https://substackcdn.com/image/fetch/$s_!Sdeh!,w_96,h_96,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F484cd279-07e6-417d-82a9-65fa67c93d7e_144x144.png 96w" width="32" height="32" draggable="false" class="img-OACg1c object-fit-cover-u4ReeV pencraft pc-reset"></picture></div></div></a></div></div><div class="pencraft pc-display-flex pc-flexDirection-column pc-reset flex-grow-rzmknG"><div class="pencraft pc-display-flex pc-reset"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-4 pc-reset"><div class="pencraft pc-display-flex pc-minWidth-0 pc-gap-8 pc-alignItems-center pc-height-20 pc-reset line-height-20-t4M0El font-text-qe4AeH size-15-Psle70 weight-regular-mUq6Gb"><div class="pencraft pc-display-flex pc-minWidth-0 pc-gap-6 pc-alignItems-center pc-reset flex-grow-rzmknG"><div class="pencraft pc-display-flex pc-gap-6 pc-reset line-height-20-t4M0El font-text-qe4AeH size-13-hZTUKr weight-regular-mUq6Gb reset-IxiVJZ"><span class="pencraft pc-reset weight-medium-fw81nC reset-IxiVJZ"><div class="profile-hover-card-target profileHoverCardTarget-PBxvGm inline-lJXy8b"><span class="pencraft pc-reset decoration-hover-underline-ClDVRM reset-IxiVJZ"><a href="https://substack.com/profile/134301190-oleksandr-rechynskyi?utm_source=substack-feed-item" class="link-LIBpto" showback="true">Oleksandr Rechynskyi</a></span></div></span></div><div class="publicationHoverCardTarget-sPJ4jb"></div><a href="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up/comment/58676835" rel="nofollow" native="true" title="Jun 10, 2024, 7:20 PM" class="pencraft pc-reset color-secondary-ls1g8s decoration-hover-underline-ClDVRM reset-IxiVJZ"><span class="pencraft pc-reset color-secondary-ls1g8s line-height-20-t4M0El font-text-qe4AeH size-13-hZTUKr weight-regular-mUq6Gb reset-IxiVJZ">Jun 10, 2024</span></a></div></div><div class="pencraft pc-display-flex pc-gap-4 pc-reset"><button type="button" class="pencraft pc-display-flex pc-gap-4 pc-height-20 pc-paddingLeft-6 pc-paddingRight-6 pc-paddingTop-2 pc-paddingBottom-2 pc-alignItems-center pc-reset cursor-inherit-LxLBJ6 pc-borderRadius-xs size-11-NuY2Zx weight-medium-fw81nC pencraft tag-XbOVLt theme_accent-Y2sqZY priority_secondary-outline-RpooJS" tabindex="-1"><div class="pencraft pc-display-flex pc-alignItems-center pc-reset leading-mI5Ihl fillIcon-dQ0mii"><svg role="img" style="height: 14px; width: 14px;" width="14" height="14" viewBox="0 0 20 20" fill="var(--color-fg-primary)" stroke-width="2.5" stroke="#000" xmlns="http://www.w3.org/2000/svg"><g><title></title><path stroke="none" d="M9.99915 16.7256C9.90515 16.7256 9.79102 16.692 9.65674 16.6249C9.52246 16.5622 9.3949 16.4906 9.27405 16.41C8.02974 15.6044 6.94657 14.7584 6.02454 13.8722C5.10697 12.9815 4.3953 12.0662 3.88953 11.1262C3.38375 10.1818 3.13086 9.23067 3.13086 8.27283C3.13086 7.63725 3.23157 7.05762 3.43298 6.53394C3.63888 6.01025 3.92086 5.55819 4.27893 5.17773C4.64148 4.79728 5.05774 4.50635 5.52771 4.30493C6.00216 4.09904 6.51241 3.99609 7.05847 3.99609C7.73433 3.99609 8.31844 4.16618 8.81079 4.50635C9.30762 4.84652 9.70374 5.28963 9.99915 5.83569C10.299 5.28516 10.6951 4.84204 11.1875 4.50635C11.6843 4.16618 12.2707 3.99609 12.9465 3.99609C13.4836 3.99609 13.9894 4.09904 14.4639 4.30493C14.9428 4.50635 15.3613 4.79728 15.7194 5.17773C16.0774 5.55819 16.3572 6.01025 16.5586 6.53394C16.7645 7.05762 16.8674 7.63725 16.8674 8.27283C16.8674 9.23067 16.6145 10.1818 16.1088 11.1262C15.603 12.0662 14.8891 12.9815 13.967 13.8722C13.0495 14.7584 11.9708 15.6044 10.731 16.41C10.6056 16.4906 10.4758 16.5622 10.3416 16.6249C10.2118 16.692 10.0976 16.7256 9.99915 16.7256Z"></path></g></svg></div>Liked by Cameron R. Wolfe, Ph.D.</button></div></div><div class="pencraft pc-display-flex pc-flexDirection-column pc-reset flex-grow-rzmknG"></div><div id="trigger9" aria-expanded="false" aria-haspopup="dialog" aria-controls="dialog10" class="pencraft pc-display-flex pc-reset triggerContainer-eX588u" aria-label="View more"><button type="button" aria-label="Ellipsis" class="pencraft pc-reset pencraft trigger-j08Uop iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_sm-G3LciD priority_quaternary-kpMibu" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-ellipsis"><circle cx="12" cy="12" r="1"></circle><circle cx="19" cy="12" r="1"></circle><circle cx="5" cy="12" r="1"></circle></svg></button></div></div><div class="comment-body"><p><span>wow, that's a really deep and comprehensive explanation. Thanks a lot!</span></p><div role="button" class="show-all-toggle"><div class="show-all-toggle-label">Expand full comment</div></div></div><div class="pencraft pc-display-flex pc-gap-16 pc-paddingTop-8 pc-justifyContent-flex-start pc-alignItems-center pc-reset comment-actions withShareButton-hQzuEn"><span class="pencraft pc-reset color-pub-secondary-text-hGQ02T decoration-hover-underline-ClDVRM reset-IxiVJZ"><a class="like-button" href="javascript:void(0)"><div class="pencraft pc-display-flex pc-gap-6 pc-alignItems-center pc-reset"><div class="pencraft pc-display-flex pc-reset reaction-container"><svg role="img" width="24" height="24" viewBox="0 0 24 24" fill="#000000" stroke-width="1.8" stroke="#000" xmlns="http://www.w3.org/2000/svg" class="animation"><g><title></title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-heart"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"></path></svg></g></svg><svg role="img" width="16" height="16" viewBox="0 0 24 24" fill="transparent" stroke-width="2" stroke="var(--color-fg-secondary-themed)" xmlns="http://www.w3.org/2000/svg" style="height: 16px; width: 16px;"><g><title></title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="transparent" stroke="var(--color-fg-secondary-themed)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-heart"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"></path></svg></g></svg></div><div class="pencraft pc-reset color-pub-secondary-text-hGQ02T line-height-20-t4M0El font-meta-MWBumP size-11-NuY2Zx weight-medium-fw81nC transform-uppercase-yKDgcq reset-IxiVJZ meta-EgzBVA like-count">Like (1)</div></div></a></span><span class="pencraft pc-reset decoration-hover-underline-ClDVRM reset-IxiVJZ"><a class="pencraft pc-reset link-_X6et2 link-LIBpto"><div class="pencraft pc-display-flex pc-gap-6 pc-alignItems-center pc-reset"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--color-fg-secondary-themed)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-message-circle"><path d="M7.9 20A9 9 0 1 0 4 16.1L2 22Z"></path></svg><div class="pencraft pc-reset color-pub-secondary-text-hGQ02T line-height-20-t4M0El font-meta-MWBumP size-11-NuY2Zx weight-medium-fw81nC transform-uppercase-yKDgcq reset-IxiVJZ meta-EgzBVA">Reply</div></div></a></span><span class="pencraft pc-reset decoration-hover-underline-ClDVRM reset-IxiVJZ"><a class="pencraft pc-reset link-_X6et2 link-LIBpto"><div class="pencraft pc-display-flex pc-gap-6 pc-alignItems-center pc-reset"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--color-fg-secondary-themed)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-share"><path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"></path><polyline points="16 6 12 2 8 6"></polyline><line x1="12" x2="12" y1="2" y2="15"></line></svg><div class="pencraft pc-reset color-pub-secondary-text-hGQ02T line-height-20-t4M0El font-meta-MWBumP size-11-NuY2Zx weight-medium-fw81nC transform-uppercase-yKDgcq reset-IxiVJZ meta-EgzBVA">Share</div></div></a></span></div><div style="height: 0px; transition: height 250ms var(--animation-smooth), opacity 250ms var(--animation-smooth); display: block; flex-direction: column; opacity: 0;"><div style="padding-top: 0.05px; padding-bottom: 0.05px; display: block; flex: 0 0 auto; flex-direction: column; transition: transform 250ms var(--animation-smooth);"></div></div></div></div><div class="more-replies-container"><a href="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up/comment/58676835" class="more-replies">1 reply by Cameron R. Wolfe, Ph.D.</a></div></div><div class="comment"><div id="comment-50759769" class="comment-anchor"></div><div id="comment-50759769-reply" class="comment-anchor"></div><div role="article" aria-label="Comment by Rahul" class="pencraft pc-display-flex pc-gap-12 pc-paddingBottom-12 pc-reset comment-content"><div class="pencraft pc-display-flex pc-flexDirection-column pc-reset"><div class="profile-hover-card-target profileHoverCardTarget-PBxvGm"><a href="https://substack.com/profile/142072296-rahul?utm_source=comment" aria-label="View Rahul&#39;s profile" class="pencraft pc-display-contents pc-reset"><div tabindex="0" class="pencraft pc-display-flex pc-width-32 pc-height-32 pc-justifyContent-center pc-alignItems-center pc-position-relative pc-reset bg-secondary-UUD3_J flex-auto-j3S2WA animate-XFJxE4 outline-detail-vcQLyr pc-borderRadius-full overflow-hidden-WdpwT6 sizing-border-box-DggLA4 pressable-sm-YIJFKJ showFocus-sk_vEm container-TAtrWj interactive-UkK0V6" style="--scale: 32px;"><div title="Rahul" class="pencraft pc-display-flex pc-width-32 pc-height-32 pc-justifyContent-center pc-alignItems-center pc-position-relative pc-reset bg-secondary-UUD3_J flex-auto-j3S2WA outline-detail-vcQLyr pc-borderRadius-full overflow-hidden-WdpwT6 sizing-border-box-DggLA4 container-TAtrWj" style="--scale: 32px;"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!OOhY!,w_32,h_32,c_fill,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2fe4a66c-ed97-4468-a7e0-69396ad9233b_144x144.png 32w, https://substackcdn.com/image/fetch/$s_!OOhY!,w_64,h_64,c_fill,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2fe4a66c-ed97-4468-a7e0-69396ad9233b_144x144.png 64w, https://substackcdn.com/image/fetch/$s_!OOhY!,w_96,h_96,c_fill,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2fe4a66c-ed97-4468-a7e0-69396ad9233b_144x144.png 96w" sizes="32px"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/2fe4a66c-ed97-4468-a7e0-69396ad9233b_144x144.png" sizes="32px" alt="Rahul&#39;s avatar" srcset="https://substackcdn.com/image/fetch/$s_!OOhY!,w_32,h_32,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2fe4a66c-ed97-4468-a7e0-69396ad9233b_144x144.png 32w, https://substackcdn.com/image/fetch/$s_!OOhY!,w_64,h_64,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2fe4a66c-ed97-4468-a7e0-69396ad9233b_144x144.png 64w, https://substackcdn.com/image/fetch/$s_!OOhY!,w_96,h_96,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2fe4a66c-ed97-4468-a7e0-69396ad9233b_144x144.png 96w" width="32" height="32" draggable="false" class="img-OACg1c object-fit-cover-u4ReeV pencraft pc-reset"></picture></div></div></a></div></div><div class="pencraft pc-display-flex pc-flexDirection-column pc-reset flex-grow-rzmknG"><div class="pencraft pc-display-flex pc-reset"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-4 pc-reset"><div class="pencraft pc-display-flex pc-minWidth-0 pc-gap-8 pc-alignItems-center pc-height-20 pc-reset line-height-20-t4M0El font-text-qe4AeH size-15-Psle70 weight-regular-mUq6Gb"><div class="pencraft pc-display-flex pc-minWidth-0 pc-gap-6 pc-alignItems-center pc-reset flex-grow-rzmknG"><div class="pencraft pc-display-flex pc-gap-6 pc-reset line-height-20-t4M0El font-text-qe4AeH size-13-hZTUKr weight-regular-mUq6Gb reset-IxiVJZ"><span class="pencraft pc-reset weight-medium-fw81nC reset-IxiVJZ"><div class="profile-hover-card-target profileHoverCardTarget-PBxvGm inline-lJXy8b"><span class="pencraft pc-reset decoration-hover-underline-ClDVRM reset-IxiVJZ"><a href="https://substack.com/profile/142072296-rahul?utm_source=substack-feed-item" class="link-LIBpto" showback="true">Rahul</a></span></div></span></div><a href="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up/comment/50759769" rel="nofollow" native="true" title="Mar 2, 2024, 5:33 PM" class="pencraft pc-reset color-secondary-ls1g8s decoration-hover-underline-ClDVRM reset-IxiVJZ"><span class="pencraft pc-reset color-secondary-ls1g8s line-height-20-t4M0El font-text-qe4AeH size-13-hZTUKr weight-regular-mUq6Gb reset-IxiVJZ">Mar 2, 2024</span></a></div></div><div class="pencraft pc-display-flex pc-gap-4 pc-reset"><button type="button" class="pencraft pc-display-flex pc-gap-4 pc-height-20 pc-paddingLeft-6 pc-paddingRight-6 pc-paddingTop-2 pc-paddingBottom-2 pc-alignItems-center pc-reset cursor-inherit-LxLBJ6 pc-borderRadius-xs size-11-NuY2Zx weight-medium-fw81nC pencraft tag-XbOVLt theme_accent-Y2sqZY priority_secondary-outline-RpooJS" tabindex="-1"><div class="pencraft pc-display-flex pc-alignItems-center pc-reset leading-mI5Ihl fillIcon-dQ0mii"><svg role="img" style="height: 14px; width: 14px;" width="14" height="14" viewBox="0 0 20 20" fill="var(--color-fg-primary)" stroke-width="2.5" stroke="#000" xmlns="http://www.w3.org/2000/svg"><g><title></title><path stroke="none" d="M9.99915 16.7256C9.90515 16.7256 9.79102 16.692 9.65674 16.6249C9.52246 16.5622 9.3949 16.4906 9.27405 16.41C8.02974 15.6044 6.94657 14.7584 6.02454 13.8722C5.10697 12.9815 4.3953 12.0662 3.88953 11.1262C3.38375 10.1818 3.13086 9.23067 3.13086 8.27283C3.13086 7.63725 3.23157 7.05762 3.43298 6.53394C3.63888 6.01025 3.92086 5.55819 4.27893 5.17773C4.64148 4.79728 5.05774 4.50635 5.52771 4.30493C6.00216 4.09904 6.51241 3.99609 7.05847 3.99609C7.73433 3.99609 8.31844 4.16618 8.81079 4.50635C9.30762 4.84652 9.70374 5.28963 9.99915 5.83569C10.299 5.28516 10.6951 4.84204 11.1875 4.50635C11.6843 4.16618 12.2707 3.99609 12.9465 3.99609C13.4836 3.99609 13.9894 4.09904 14.4639 4.30493C14.9428 4.50635 15.3613 4.79728 15.7194 5.17773C16.0774 5.55819 16.3572 6.01025 16.5586 6.53394C16.7645 7.05762 16.8674 7.63725 16.8674 8.27283C16.8674 9.23067 16.6145 10.1818 16.1088 11.1262C15.603 12.0662 14.8891 12.9815 13.967 13.8722C13.0495 14.7584 11.9708 15.6044 10.731 16.41C10.6056 16.4906 10.4758 16.5622 10.3416 16.6249C10.2118 16.692 10.0976 16.7256 9.99915 16.7256Z"></path></g></svg></div>Liked by Cameron R. Wolfe, Ph.D.</button></div></div><div class="pencraft pc-display-flex pc-flexDirection-column pc-reset flex-grow-rzmknG"></div><div id="trigger11" aria-expanded="false" aria-haspopup="dialog" aria-controls="dialog12" class="pencraft pc-display-flex pc-reset triggerContainer-eX588u" aria-label="View more"><button type="button" aria-label="Ellipsis" class="pencraft pc-reset pencraft trigger-j08Uop iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_sm-G3LciD priority_quaternary-kpMibu" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-ellipsis"><circle cx="12" cy="12" r="1"></circle><circle cx="19" cy="12" r="1"></circle><circle cx="5" cy="12" r="1"></circle></svg></button></div></div><div class="comment-body"><p><span>What a great article. Saved me tens of hours of going through multiple sources. Thank you Dr. Cameron!</span></p><div role="button" class="show-all-toggle"><div class="show-all-toggle-label">Expand full comment</div></div></div><div class="pencraft pc-display-flex pc-gap-16 pc-paddingTop-8 pc-justifyContent-flex-start pc-alignItems-center pc-reset comment-actions withShareButton-hQzuEn"><span class="pencraft pc-reset color-pub-secondary-text-hGQ02T decoration-hover-underline-ClDVRM reset-IxiVJZ"><a class="like-button" href="javascript:void(0)"><div class="pencraft pc-display-flex pc-gap-6 pc-alignItems-center pc-reset"><div class="pencraft pc-display-flex pc-reset reaction-container"><svg role="img" width="24" height="24" viewBox="0 0 24 24" fill="#000000" stroke-width="1.8" stroke="#000" xmlns="http://www.w3.org/2000/svg" class="animation"><g><title></title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-heart"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"></path></svg></g></svg><svg role="img" width="16" height="16" viewBox="0 0 24 24" fill="transparent" stroke-width="2" stroke="var(--color-fg-secondary-themed)" xmlns="http://www.w3.org/2000/svg" style="height: 16px; width: 16px;"><g><title></title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="transparent" stroke="var(--color-fg-secondary-themed)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-heart"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"></path></svg></g></svg></div><div class="pencraft pc-reset color-pub-secondary-text-hGQ02T line-height-20-t4M0El font-meta-MWBumP size-11-NuY2Zx weight-medium-fw81nC transform-uppercase-yKDgcq reset-IxiVJZ meta-EgzBVA like-count">Like (1)</div></div></a></span><span class="pencraft pc-reset decoration-hover-underline-ClDVRM reset-IxiVJZ"><a class="pencraft pc-reset link-_X6et2 link-LIBpto"><div class="pencraft pc-display-flex pc-gap-6 pc-alignItems-center pc-reset"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--color-fg-secondary-themed)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-message-circle"><path d="M7.9 20A9 9 0 1 0 4 16.1L2 22Z"></path></svg><div class="pencraft pc-reset color-pub-secondary-text-hGQ02T line-height-20-t4M0El font-meta-MWBumP size-11-NuY2Zx weight-medium-fw81nC transform-uppercase-yKDgcq reset-IxiVJZ meta-EgzBVA">Reply</div></div></a></span><span class="pencraft pc-reset decoration-hover-underline-ClDVRM reset-IxiVJZ"><a class="pencraft pc-reset link-_X6et2 link-LIBpto"><div class="pencraft pc-display-flex pc-gap-6 pc-alignItems-center pc-reset"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--color-fg-secondary-themed)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-share"><path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"></path><polyline points="16 6 12 2 8 6"></polyline><line x1="12" x2="12" y1="2" y2="15"></line></svg><div class="pencraft pc-reset color-pub-secondary-text-hGQ02T line-height-20-t4M0El font-meta-MWBumP size-11-NuY2Zx weight-medium-fw81nC transform-uppercase-yKDgcq reset-IxiVJZ meta-EgzBVA">Share</div></div></a></span></div><div style="height: 0px; transition: height 250ms var(--animation-smooth), opacity 250ms var(--animation-smooth); display: block; flex-direction: column; opacity: 0;"><div style="padding-top: 0.05px; padding-bottom: 0.05px; display: block; flex: 0 0 auto; flex-direction: column; transition: transform 250ms var(--animation-smooth);"></div></div></div></div><div class="more-replies-container"><a href="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up/comment/50759769" class="more-replies">1 reply by Cameron R. Wolfe, Ph.D.</a></div></div></div></div><a href="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up/comments" class="more-comments">4 more comments...</a></div></div></div><div class="single-post-section"><div class="container"><div class="visibility-check"></div><div style="margin-left: -8px; margin-right: -8px;" aria-label="Top Posts Footer" role="region" class="pencraft pc-paddingTop-24 pc-paddingBottom-24 pc-reset"><div class="portable-archive"><div aria-label="Archive sort tabs" role="navigation" class="pencraft pc-display-flex pc-gap-12 pc-paddingLeft-8 pc-paddingRight-8 pc-paddingBottom-16 pc-justifyContent-space-between pc-alignItems-center pc-reset"><div class="pencraft pc-display-flex pc-flexDirection-column pc-position-relative pc-minWidth-0 pc-reset bg-primary-zk6FDl pc-borderRadius-sm overflow-hidden-WdpwT6"><div aria-label="Tabs" role="tablist" aria-orientation="horizontal" class="pencraft pc-display-flex pc-gap-4 pc-padding-4 pc-position-relative pc-reset cursor-default-flE2S1 outline-detail-vcQLyr pc-borderRadius-sm overflow-auto-7WTsTi scrollBar-hidden-HcAIpI"><button type="button" id="headlessui-tabs-tab-P0-12" role="tab" aria-selected="true" data-headlessui-state="selected" class="pencraft pc-reset pencraft segment-LBFzmC buttonBase-GK1x3M buttonText-X0uSmG buttonStyle-r7yGCK priority_tertiary-rlke8z size_sm-G3LciD" tabindex="0">Top</button><button type="button" id="headlessui-tabs-tab-P0-13" role="tab" aria-selected="false" data-headlessui-state="" class="pencraft pc-reset pencraft segment-LBFzmC buttonBase-GK1x3M buttonText-X0uSmG buttonStyle-r7yGCK priority_quaternary-kpMibu size_sm-G3LciD" tabindex="-1">Latest</button><button type="button" id="headlessui-tabs-tab-P0-14" role="tab" aria-selected="false" data-headlessui-state="" class="pencraft pc-reset pencraft segment-LBFzmC buttonBase-GK1x3M buttonText-X0uSmG buttonStyle-r7yGCK priority_quaternary-kpMibu size_sm-G3LciD" tabindex="-1">Discussions</button><div class="pencraft pc-position-absolute pc-height-32 pc-reset bg-secondary-UUD3_J pc-borderRadius-xs sizing-border-box-DggLA4 highlight-U002IP" style="--highlight-width: 40.35000228881836px; --highlight-x: 0px;"></div></div><div class="pencraft pc-display-flex pc-alignItems-center pc-reset arrowButtonContainer-O4uSiH arrowButtonOverlaidContainer-t10AyH left-Tg8vqp"><div class="overlay-zrMCxn primary-lv_sOW"></div></div><div class="pencraft pc-display-flex pc-alignItems-center pc-reset arrowButtonContainer-O4uSiH arrowButtonOverlaidContainer-t10AyH right-i3oWGi"><div class="overlay-zrMCxn primary-lv_sOW"></div></div></div><button type="button" aria-label="Search" class="pencraft pc-reset pencraft iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_md-gCDS3o priority_tertiary-rlke8z" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-search"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.3-4.3"></path></svg></button></div><div class="portable-archive-list"><div><div class="container-O1YsI6 two-column-list-BLHtzo two-column-list--with-dividers-cHfR0M"><div aria-label="Post preview for Decoder-Only Transformers: The Workhorse of Generative LLMs" role="article" class="pencraft pc-display-flex pc-flexDirection-column pc-padding-8 pc-position-relative pc-reset pc-borderRadius-sm container-H2dyKk"><div class="container-Qnseki"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-4 pc-position-relative pc-reset flex-grow-rzmknG"><div class="pencraft pc-display-flex pc-flexDirection-column pc-reset"><a href="https://cameronrwolfe.substack.com/p/decoder-only-transformers-the-workhorse" data-testid="post-preview-title" class="pencraft pc-reset color-pub-primary-text-NyXPlw font-pub-headings-FE5byy clamp-y7pNm8 clamp-3-lxFDfR reset-IxiVJZ" style="font-size: 19px; line-height: 26px;">Decoder-Only Transformers: The Workhorse of Generative LLMs</a></div><div class="pencraft pc-display-flex pc-flexDirection-column pc-reset"><a href="https://cameronrwolfe.substack.com/p/decoder-only-transformers-the-workhorse" class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-15-Psle70 clamp-y7pNm8 clamp-2-kM02pu reset-IxiVJZ">Building the world's most influential neural network architecture from scratch...</a></div><div class="pencraft pc-display-inline pc-reset color-pub-secondary-text-hGQ02T line-height-20-t4M0El font-meta-MWBumP size-11-NuY2Zx weight-medium-fw81nC transform-uppercase-yKDgcq reset-IxiVJZ meta-EgzBVA"><time datetime="2024-03-04T09:33:07.426Z" class="date-rtYe1v">Mar 4, 2024</time>&nbsp;<span class="dividerChar-SbAJEi">•</span>&nbsp;<span class="pencraft pc-reset reset-IxiVJZ"><div class="profile-hover-card-target profileHoverCardTarget-PBxvGm"><a href="https://substack.com/@cwolferesearch" class="link-HFGLqU">Cameron R. Wolfe, Ph.D.</a></div></span></div><div class="pencraft pc-display-flex pc-flexDirection-column pc-reset actions-YFg47u"><div class="post-ufi style-compressed justified themed"><div class="like-button-container post-ufi-button style-compressed"><a role="button" aria-label="Like (136)" aria-pressed="false" class="post-ufi-button style-compressed has-label with-border"><svg role="img" width="14" height="14" viewBox="0 0 24 24" fill="#000000" stroke-width="2" stroke="#000" xmlns="http://www.w3.org/2000/svg" class="icon" style="height: 14px; width: 14px;"><g><title></title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-heart"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"></path></svg></g></svg><div class="label">136</div></a><div inert="" role="dialog" class="modal typography out gone reader-onboarding-modal wide popup"><div class="modal-table"><div class="modal-row"><div class="modal-cell modal-content"><div class="container"><button tabindex="0" type="button" aria-label="X" data-testid="close-modal" class="pencraft pc-reset pencraft modal-btn modal-exit-btn no-margin iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_md-gCDS3o priority_tertiary-rlke8z"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="secondary" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg></button><div class="reader-onboarding-modal-container"></div></div></div></div></div></div><div inert="" role="dialog" class="modal typography out gone share-dialog popup"><div class="modal-table"><div class="modal-row"><div class="modal-cell modal-content no-fullscreen"><div class="container"><button tabindex="0" type="button" aria-label="X" data-testid="close-modal" class="pencraft pc-reset pencraft modal-btn modal-exit-btn no-margin iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_md-gCDS3o priority_tertiary-rlke8z"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="secondary" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg></button><div class="pencraft pc-display-contents pc-reset pubTheme-yiXxQA"><div class="pencraft pc-display-contents pc-reset elevatedTheme-fBklGV"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-24 pc-padding-24 pc-reset bg-primary-zk6FDl border-detail-EGrm7T pc-borderRadius-md container-xiJVit"><h4 class="pencraft pc-reset flex-grow-rzmknG align-center-y7ZD4w line-height-24-jnGwiv font-display-nhmvtD size-20-P_cSRT weight-bold-DmI9lw reset-IxiVJZ">Share this post</h4><a href="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up#" class="pencraft pc-display-contents pc-reset"><div class="pencraft pc-display-contents pc-reset elevatedTheme-fBklGV"><div tabindex="0" draggable="false" class="pencraft pc-display-flex pc-flexDirection-column pc-minWidth-0 pc-position-relative pc-reset bg-primary-zk6FDl pc-borderRadius-md showFocus-sk_vEm postAttachment-eYV3fM" style="background: linear-gradient(180deg, rgba(24.323076923076925,86.3076923076923,128.67692307692306,0.75), rgba(24.323076923076925,86.3076923076923,128.67692307692306,0.75)), var(--color-dark-bg-secondary);"><div class="pencraft pc-display-flex pc-flexDirection-column pc-reset border-bottom-detail-k1F6C4 vibrantHeader-We3FVb"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!-1vf!,w_424,h_222,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F6e3c9db5-400a-49de-a235-e09bc3aa3689_2392x1342.png 424w, https://substackcdn.com/image/fetch/$s_!-1vf!,w_520,h_272,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F6e3c9db5-400a-49de-a235-e09bc3aa3689_2392x1342.png 520w, https://substackcdn.com/image/fetch/$s_!-1vf!,w_848,h_444,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F6e3c9db5-400a-49de-a235-e09bc3aa3689_2392x1342.png 848w, https://substackcdn.com/image/fetch/$s_!-1vf!,w_1040,h_545,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F6e3c9db5-400a-49de-a235-e09bc3aa3689_2392x1342.png 1040w, https://substackcdn.com/image/fetch/$s_!-1vf!,w_1272,h_666,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F6e3c9db5-400a-49de-a235-e09bc3aa3689_2392x1342.png 1272w, https://substackcdn.com/image/fetch/$s_!-1vf!,w_1456,h_762,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F6e3c9db5-400a-49de-a235-e09bc3aa3689_2392x1342.png 1456w, https://substackcdn.com/image/fetch/$s_!-1vf!,w_1560,h_817,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F6e3c9db5-400a-49de-a235-e09bc3aa3689_2392x1342.png 1560w" sizes="520px"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/6e3c9db5-400a-49de-a235-e09bc3aa3689_2392x1342.jpg" sizes="520px" alt="" srcset="https://substackcdn.com/image/fetch/$s_!-1vf!,w_424,h_222,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F6e3c9db5-400a-49de-a235-e09bc3aa3689_2392x1342.png 424w, https://substackcdn.com/image/fetch/$s_!-1vf!,w_520,h_272,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F6e3c9db5-400a-49de-a235-e09bc3aa3689_2392x1342.png 520w, https://substackcdn.com/image/fetch/$s_!-1vf!,w_848,h_444,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F6e3c9db5-400a-49de-a235-e09bc3aa3689_2392x1342.png 848w, https://substackcdn.com/image/fetch/$s_!-1vf!,w_1040,h_545,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F6e3c9db5-400a-49de-a235-e09bc3aa3689_2392x1342.png 1040w, https://substackcdn.com/image/fetch/$s_!-1vf!,w_1272,h_666,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F6e3c9db5-400a-49de-a235-e09bc3aa3689_2392x1342.png 1272w, https://substackcdn.com/image/fetch/$s_!-1vf!,w_1456,h_762,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F6e3c9db5-400a-49de-a235-e09bc3aa3689_2392x1342.png 1456w, https://substackcdn.com/image/fetch/$s_!-1vf!,w_1560,h_817,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F6e3c9db5-400a-49de-a235-e09bc3aa3689_2392x1342.png 1560w" width="520" draggable="false" class="img-OACg1c postImage-L4FlO9 vibrantPostImage-TTXyOq pencraft pc-reset"></picture></div><div class="pencraft pc-display-flex pc-gap-12 pc-padding-12 pc-alignItems-center pc-reset"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-2 pc-minWidth-0 pc-reset flex-grow-rzmknG"><div class="pencraft pc-display-flex pc-gap-8 pc-paddingBottom-4 pc-alignItems-center pc-reset"><div draggable="false" class="pencraft pc-display-flex pc-position-relative pc-reset"><div class="pencraft pc-display-flex pc-reset bg-white-ZBV5av pc-borderRadius-xs overflow-hidden-WdpwT6 sizing-border-box-DggLA4" style="width: 18px; height: 18px;"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!87xa!,w_36,h_36,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fab9b43fb-52d5-40da-995d-5b7cd3f91064_896x896.png"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/ab9b43fb-52d5-40da-995d-5b7cd3f91064_896x896(1).jpg" sizes="100vw" alt="Deep (Learning) Focus" width="36" height="36" draggable="false" class="img-OACg1c object-fit-cover-u4ReeV pencraft pc-reset" style="width: 18px; height: 18px;"></picture></div></div><div class="pencraft pc-reset flex-grow-rzmknG ellipsis-Jb8om8 color-vibrance-secondary-k5eqjt line-height-20-t4M0El font-text-qe4AeH size-13-hZTUKr weight-regular-mUq6Gb nowrap-QngyoB reset-IxiVJZ">Deep (Learning) Focus</div></div><div class="pencraft pc-reset color-vibrance-primary-KHCdqV line-height-20-t4M0El font-text-qe4AeH size-15-Psle70 weight-medium-fw81nC clamp-y7pNm8 clamp-2-kM02pu reset-IxiVJZ">Decoder-Only Transformers: The Workhorse of Generative LLMs</div></div></div></div></div></a><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-16 pc-reset"><div class="pencraft pc-display-flex pc-justifyContent-space-between pc-reset"><button tabindex="0" type="button" class="pencraft pc-reset pc-borderRadius-sm pencraft buttonBase-GK1x3M"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-width-64 pc-alignItems-center pc-reset container-iTCOuF"><div class="pencraft pc-display-flex pc-flexDirection-column pc-width-64 pc-height-64 pc-justifyContent-center pc-alignItems-center pc-reset bg-secondary-UUD3_J animate-XFJxE4 pc-borderRadius-lg button-zkMi7O"><svg role="img" width="20" height="20" viewBox="0 0 20 20" fill="none" stroke-width="2" stroke="var(--color-fg-primary)" xmlns="http://www.w3.org/2000/svg" style="height: 20px; width: 20px;"><g><title></title><path d="M7.50008 14.1666H5.83341C4.72835 14.1666 3.66854 13.7276 2.88714 12.9462C2.10573 12.1648 1.66675 11.105 1.66675 9.99992C1.66675 8.89485 2.10573 7.83504 2.88714 7.05364C3.66854 6.27224 4.72835 5.83325 5.83341 5.83325H7.50008M12.5001 5.83325H14.1667C15.2718 5.83325 16.3316 6.27224 17.113 7.05364C17.8944 7.83504 18.3334 8.89485 18.3334 9.99992C18.3334 11.105 17.8944 12.1648 17.113 12.9462C16.3316 13.7276 15.2718 14.1666 14.1667 14.1666H12.5001M6.66675 9.99992H13.3334"></path></g></svg></div><div class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-11-NuY2Zx weight-semibold-uqA4FV reset-IxiVJZ">Copy link</div></div></button><button tabindex="0" type="button" class="pencraft pc-reset pc-borderRadius-sm pencraft buttonBase-GK1x3M"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-width-64 pc-alignItems-center pc-reset container-iTCOuF"><div class="pencraft pc-display-flex pc-flexDirection-column pc-width-64 pc-height-64 pc-justifyContent-center pc-alignItems-center pc-reset bg-secondary-UUD3_J animate-XFJxE4 pc-borderRadius-lg button-zkMi7O"><svg role="img" width="20" height="20" viewBox="0 0 20 20" fill="var(--color-fg-primary)" stroke-width="1.8" stroke="none" xmlns="http://www.w3.org/2000/svg" style="height: 20px; width: 20px;"><g><title></title><path stroke="none" d="M20 10C20 4.47715 15.5229 0 10 0C4.47715 0 0 4.47715 0 10C0 14.9912 3.65684 19.1283 8.4375 19.8785V12.8906H5.89844V10H8.4375V7.79688C8.4375 5.29063 9.93047 3.90625 12.2146 3.90625C13.3084 3.90625 14.4531 4.10156 14.4531 4.10156V6.5625H13.1922C11.95 6.5625 11.5625 7.3334 11.5625 8.125V10H14.3359L13.8926 12.8906H11.5625V19.8785C16.3432 19.1283 20 14.9912 20 10Z"></path></g></svg></div><div class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-11-NuY2Zx weight-semibold-uqA4FV reset-IxiVJZ">Facebook</div></div></button><button tabindex="0" type="button" class="pencraft pc-reset pc-borderRadius-sm pencraft buttonBase-GK1x3M"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-width-64 pc-alignItems-center pc-reset container-iTCOuF"><div class="pencraft pc-display-flex pc-flexDirection-column pc-width-64 pc-height-64 pc-justifyContent-center pc-alignItems-center pc-reset bg-secondary-UUD3_J animate-XFJxE4 pc-borderRadius-lg button-zkMi7O"><svg role="img" width="20" height="20" viewBox="0 0 20 20" fill="var(--color-fg-primary)" stroke-width="1.8" stroke="var(--color-fg-primary)" xmlns="http://www.w3.org/2000/svg" style="height: 20px; width: 20px;"><g><title></title><path stroke="none" d="M9.9958 11.0646C10.2693 11.0646 10.5346 10.9569 10.7915 10.7248L19.0717 3.431C18.6241 3.13262 18.1102 3 17.3974 3H2.60257C1.88976 3 1.37587 3.13262 0.920011 3.431L9.20011 10.7248C9.46534 10.9569 9.73057 11.0646 9.9958 11.0646ZM0.215499 15.9465L6.34893 9.82137L0.198922 4.40075C0.107749 4.5748 0 4.99751 0 5.56941V14.7199C0 15.2503 0.0828842 15.6316 0.215499 15.9465ZM2.35391 17.2892H17.646C18.2511 17.2892 18.7235 17.14 19.0385 16.9245L12.731 10.6171L11.5209 11.6945C11.0402 12.1173 10.518 12.3328 9.9958 12.3328C9.48197 12.3328 8.95975 12.1173 8.47905 11.6945L7.26894 10.6171L0.961455 16.9245C1.27642 17.14 1.74057 17.2892 2.35391 17.2892ZM19.7844 15.9465C19.9088 15.6316 20 15.2503 20 14.7199V5.56941C20 4.99751 19.8922 4.5748 19.8011 4.40075L13.651 9.82137L19.7844 15.9465Z"></path></g></svg></div><div class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-11-NuY2Zx weight-semibold-uqA4FV reset-IxiVJZ">Email</div></div></button><button tabindex="0" type="button" class="pencraft pc-reset pc-borderRadius-sm pencraft buttonBase-GK1x3M"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-width-64 pc-alignItems-center pc-reset container-iTCOuF"><div class="pencraft pc-display-flex pc-flexDirection-column pc-width-64 pc-height-64 pc-justifyContent-center pc-alignItems-center pc-reset bg-secondary-UUD3_J animate-XFJxE4 pc-borderRadius-lg button-zkMi7O"><svg role="img" width="20" height="20" viewBox="0 0 20 20" fill="var(--color-fg-primary)" stroke-width="1.8" stroke="none" xmlns="http://www.w3.org/2000/svg" style="height: 20px; width: 20px;"><g><title></title><path d="M1.96484 0.624512H18.0354V2.70052H1.96484V0.624512Z" stroke="none"></path><path d="M1.96484 4.77655H18.0354V6.85254H1.96484V4.77655Z" stroke="none"></path><path d="M1.96484 8.92857V19.9505L10.0001 14.6347L18.0354 19.9505V8.92857H1.96484Z" stroke="none"></path></g></svg></div><div class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-11-NuY2Zx weight-semibold-uqA4FV reset-IxiVJZ">Notes</div></div></button><button tabindex="0" type="button" class="pencraft pc-reset pc-borderRadius-sm pencraft buttonBase-GK1x3M"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-width-64 pc-alignItems-center pc-reset container-iTCOuF"><div class="pencraft pc-display-flex pc-flexDirection-column pc-width-64 pc-height-64 pc-justifyContent-center pc-alignItems-center pc-reset bg-secondary-UUD3_J animate-XFJxE4 pc-borderRadius-lg button-zkMi7O"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--color-fg-primary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-ellipsis"><circle cx="12" cy="12" r="1"></circle><circle cx="19" cy="12" r="1"></circle><circle cx="5" cy="12" r="1"></circle></svg></div><div class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-11-NuY2Zx weight-semibold-uqA4FV reset-IxiVJZ">More</div></div></button></div></div></div></div></div></div></div></div></div></div></div><a role="button" href="https://cameronrwolfe.substack.com/p/decoder-only-transformers-the-workhorse/comments" aria-label="View comments (15)" class="post-ufi-button style-compressed post-ufi-comment-button has-label with-border"><svg role="img" width="14" height="14" viewBox="0 0 24 24" fill="#000000" stroke-width="2" stroke="#000" xmlns="http://www.w3.org/2000/svg" class="icon" style="height: 14px; width: 14px;"><g><title></title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-message-circle"><path d="M7.9 20A9 9 0 1 0 4 16.1L2 22Z"></path></svg></g></svg><div class="label">15</div></a><a role="button" class="post-ufi-button style-compressed no-label with-border"><svg role="img" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke="#000" xmlns="http://www.w3.org/2000/svg" class="icon" style="height: 14px; width: 14px;"><g><title></title><path d="M21 3V8M21 8H16M21 8L18 5.29962C16.7056 4.14183 15.1038 3.38328 13.3879 3.11547C11.6719 2.84766 9.9152 3.08203 8.32951 3.79031C6.74382 4.49858 5.39691 5.65051 4.45125 7.10715C3.5056 8.5638 3.00158 10.2629 3 11.9996M3 21V16M3 16H8M3 16L6 18.7C7.29445 19.8578 8.89623 20.6163 10.6121 20.8841C12.3281 21.152 14.0848 20.9176 15.6705 20.2093C17.2562 19.501 18.6031 18.3491 19.5487 16.8925C20.4944 15.4358 20.9984 13.7367 21 12" stroke-linecap="round" stroke-linejoin="round"></path></g></svg></a><div inert="" role="dialog" class="modal typography out gone reader-onboarding-modal wide popup"><div class="modal-table"><div class="modal-row"><div class="modal-cell modal-content"><div class="container"><button tabindex="0" type="button" aria-label="X" data-testid="close-modal" class="pencraft pc-reset pencraft modal-btn modal-exit-btn no-margin iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_md-gCDS3o priority_tertiary-rlke8z"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="secondary" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg></button><div class="reader-onboarding-modal-container"></div></div></div></div></div></div><a role="button" href="javascript:void(0)" aria-label="View share options" class="post-ufi-button style-compressed no-label with-border"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"></path><polyline points="16 6 12 2 8 6"></polyline><line x1="12" x2="12" y1="2" y2="15"></line></svg></a></div></div></div><div><div class="image-tkPTAj container-XxSyR3" style="aspect-ratio: 1.5 / 1;"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!-1vf!,w_320,h_213,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_center/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F6e3c9db5-400a-49de-a235-e09bc3aa3689_2392x1342.png"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/6e3c9db5-400a-49de-a235-e09bc3aa3689_2392x1342(1).jpg" sizes="(min-width:768px) 50vw, 100vw" alt="" width="320" height="213" loading="lazy" class="img-OACg1c image-nBNbRY pencraft pc-reset" style="aspect-ratio: 1.5 / 1;"></picture></div></div></div></div><div class="pencraft pc-display-flex pc-reset border-bottom-detail-themed-Ua9186 divider-QOeHtM"></div><div aria-label="Post preview for Demystifying Reasoning Models" role="article" class="pencraft pc-display-flex pc-flexDirection-column pc-padding-8 pc-position-relative pc-reset pc-borderRadius-sm container-H2dyKk"><div class="container-Qnseki"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-4 pc-position-relative pc-reset flex-grow-rzmknG"><div class="pencraft pc-display-flex pc-flexDirection-column pc-reset"><a href="https://cameronrwolfe.substack.com/p/demystifying-reasoning-models" data-testid="post-preview-title" class="pencraft pc-reset color-pub-primary-text-NyXPlw font-pub-headings-FE5byy clamp-y7pNm8 clamp-3-lxFDfR reset-IxiVJZ" style="font-size: 19px; line-height: 26px;">Demystifying Reasoning Models</a></div><div class="pencraft pc-display-flex pc-flexDirection-column pc-reset"><a href="https://cameronrwolfe.substack.com/p/demystifying-reasoning-models" class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-15-Psle70 clamp-y7pNm8 clamp-2-kM02pu reset-IxiVJZ">Understanding reasoning models and their relation to standard LLMs...</a></div><div class="pencraft pc-display-inline pc-reset color-pub-secondary-text-hGQ02T line-height-20-t4M0El font-meta-MWBumP size-11-NuY2Zx weight-medium-fw81nC transform-uppercase-yKDgcq reset-IxiVJZ meta-EgzBVA"><time datetime="2025-02-18T10:33:55.513Z" class="date-rtYe1v">Feb 18</time>&nbsp;<span class="dividerChar-SbAJEi">•</span>&nbsp;<span class="pencraft pc-reset reset-IxiVJZ"><div class="profile-hover-card-target profileHoverCardTarget-PBxvGm"><a href="https://substack.com/@cwolferesearch" class="link-HFGLqU">Cameron R. Wolfe, Ph.D.</a></div></span></div><div class="pencraft pc-display-flex pc-flexDirection-column pc-reset actions-YFg47u"><div class="post-ufi style-compressed justified themed"><div class="like-button-container post-ufi-button style-compressed"><a role="button" aria-label="Like (235)" aria-pressed="false" class="post-ufi-button style-compressed has-label with-border"><svg role="img" width="14" height="14" viewBox="0 0 24 24" fill="#000000" stroke-width="2" stroke="#000" xmlns="http://www.w3.org/2000/svg" class="icon" style="height: 14px; width: 14px;"><g><title></title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-heart"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"></path></svg></g></svg><div class="label">235</div></a><div inert="" role="dialog" class="modal typography out gone reader-onboarding-modal wide popup"><div class="modal-table"><div class="modal-row"><div class="modal-cell modal-content"><div class="container"><button tabindex="0" type="button" aria-label="X" data-testid="close-modal" class="pencraft pc-reset pencraft modal-btn modal-exit-btn no-margin iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_md-gCDS3o priority_tertiary-rlke8z"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="secondary" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg></button><div class="reader-onboarding-modal-container"></div></div></div></div></div></div><div inert="" role="dialog" class="modal typography out gone share-dialog popup"><div class="modal-table"><div class="modal-row"><div class="modal-cell modal-content no-fullscreen"><div class="container"><button tabindex="0" type="button" aria-label="X" data-testid="close-modal" class="pencraft pc-reset pencraft modal-btn modal-exit-btn no-margin iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_md-gCDS3o priority_tertiary-rlke8z"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="secondary" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg></button><div class="pencraft pc-display-contents pc-reset pubTheme-yiXxQA"><div class="pencraft pc-display-contents pc-reset elevatedTheme-fBklGV"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-24 pc-padding-24 pc-reset bg-primary-zk6FDl border-detail-EGrm7T pc-borderRadius-md container-xiJVit"><h4 class="pencraft pc-reset flex-grow-rzmknG align-center-y7ZD4w line-height-24-jnGwiv font-display-nhmvtD size-20-P_cSRT weight-bold-DmI9lw reset-IxiVJZ">Share this post</h4><a href="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up#" class="pencraft pc-display-contents pc-reset"><div class="pencraft pc-display-contents pc-reset elevatedTheme-fBklGV"><div tabindex="0" draggable="false" class="pencraft pc-display-flex pc-flexDirection-column pc-minWidth-0 pc-position-relative pc-reset bg-primary-zk6FDl pc-borderRadius-md showFocus-sk_vEm postAttachment-eYV3fM" style="background: linear-gradient(180deg, rgba(68,68,68,0.75), rgba(68,68,68,0.75)), var(--color-dark-bg-secondary);"><div class="pencraft pc-display-flex pc-flexDirection-column pc-reset border-bottom-detail-k1F6C4 vibrantHeader-We3FVb"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!mk9r!,w_424,h_222,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F23d9c87e-b238-4fdd-996e-4ed4465b9931_2334x1282.png 424w, https://substackcdn.com/image/fetch/$s_!mk9r!,w_520,h_272,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F23d9c87e-b238-4fdd-996e-4ed4465b9931_2334x1282.png 520w, https://substackcdn.com/image/fetch/$s_!mk9r!,w_848,h_444,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F23d9c87e-b238-4fdd-996e-4ed4465b9931_2334x1282.png 848w, https://substackcdn.com/image/fetch/$s_!mk9r!,w_1040,h_545,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F23d9c87e-b238-4fdd-996e-4ed4465b9931_2334x1282.png 1040w, https://substackcdn.com/image/fetch/$s_!mk9r!,w_1272,h_666,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F23d9c87e-b238-4fdd-996e-4ed4465b9931_2334x1282.png 1272w, https://substackcdn.com/image/fetch/$s_!mk9r!,w_1456,h_762,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F23d9c87e-b238-4fdd-996e-4ed4465b9931_2334x1282.png 1456w, https://substackcdn.com/image/fetch/$s_!mk9r!,w_1560,h_817,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F23d9c87e-b238-4fdd-996e-4ed4465b9931_2334x1282.png 1560w" sizes="520px"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/23d9c87e-b238-4fdd-996e-4ed4465b9931_2334x1282.jpg" sizes="520px" alt="" srcset="https://substackcdn.com/image/fetch/$s_!mk9r!,w_424,h_222,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F23d9c87e-b238-4fdd-996e-4ed4465b9931_2334x1282.png 424w, https://substackcdn.com/image/fetch/$s_!mk9r!,w_520,h_272,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F23d9c87e-b238-4fdd-996e-4ed4465b9931_2334x1282.png 520w, https://substackcdn.com/image/fetch/$s_!mk9r!,w_848,h_444,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F23d9c87e-b238-4fdd-996e-4ed4465b9931_2334x1282.png 848w, https://substackcdn.com/image/fetch/$s_!mk9r!,w_1040,h_545,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F23d9c87e-b238-4fdd-996e-4ed4465b9931_2334x1282.png 1040w, https://substackcdn.com/image/fetch/$s_!mk9r!,w_1272,h_666,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F23d9c87e-b238-4fdd-996e-4ed4465b9931_2334x1282.png 1272w, https://substackcdn.com/image/fetch/$s_!mk9r!,w_1456,h_762,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F23d9c87e-b238-4fdd-996e-4ed4465b9931_2334x1282.png 1456w, https://substackcdn.com/image/fetch/$s_!mk9r!,w_1560,h_817,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F23d9c87e-b238-4fdd-996e-4ed4465b9931_2334x1282.png 1560w" width="520" draggable="false" class="img-OACg1c postImage-L4FlO9 vibrantPostImage-TTXyOq pencraft pc-reset"></picture></div><div class="pencraft pc-display-flex pc-gap-12 pc-padding-12 pc-alignItems-center pc-reset"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-2 pc-minWidth-0 pc-reset flex-grow-rzmknG"><div class="pencraft pc-display-flex pc-gap-8 pc-paddingBottom-4 pc-alignItems-center pc-reset"><div draggable="false" class="pencraft pc-display-flex pc-position-relative pc-reset"><div class="pencraft pc-display-flex pc-reset bg-white-ZBV5av pc-borderRadius-xs overflow-hidden-WdpwT6 sizing-border-box-DggLA4" style="width: 18px; height: 18px;"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!87xa!,w_36,h_36,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fab9b43fb-52d5-40da-995d-5b7cd3f91064_896x896.png"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/ab9b43fb-52d5-40da-995d-5b7cd3f91064_896x896(1).jpg" sizes="100vw" alt="Deep (Learning) Focus" width="36" height="36" draggable="false" class="img-OACg1c object-fit-cover-u4ReeV pencraft pc-reset" style="width: 18px; height: 18px;"></picture></div></div><div class="pencraft pc-reset flex-grow-rzmknG ellipsis-Jb8om8 color-vibrance-secondary-k5eqjt line-height-20-t4M0El font-text-qe4AeH size-13-hZTUKr weight-regular-mUq6Gb nowrap-QngyoB reset-IxiVJZ">Deep (Learning) Focus</div></div><div class="pencraft pc-reset color-vibrance-primary-KHCdqV line-height-20-t4M0El font-text-qe4AeH size-15-Psle70 weight-medium-fw81nC clamp-y7pNm8 clamp-2-kM02pu reset-IxiVJZ">Demystifying Reasoning Models</div></div></div></div></div></a><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-16 pc-reset"><div class="pencraft pc-display-flex pc-justifyContent-space-between pc-reset"><button tabindex="0" type="button" class="pencraft pc-reset pc-borderRadius-sm pencraft buttonBase-GK1x3M"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-width-64 pc-alignItems-center pc-reset container-iTCOuF"><div class="pencraft pc-display-flex pc-flexDirection-column pc-width-64 pc-height-64 pc-justifyContent-center pc-alignItems-center pc-reset bg-secondary-UUD3_J animate-XFJxE4 pc-borderRadius-lg button-zkMi7O"><svg role="img" width="20" height="20" viewBox="0 0 20 20" fill="none" stroke-width="2" stroke="var(--color-fg-primary)" xmlns="http://www.w3.org/2000/svg" style="height: 20px; width: 20px;"><g><title></title><path d="M7.50008 14.1666H5.83341C4.72835 14.1666 3.66854 13.7276 2.88714 12.9462C2.10573 12.1648 1.66675 11.105 1.66675 9.99992C1.66675 8.89485 2.10573 7.83504 2.88714 7.05364C3.66854 6.27224 4.72835 5.83325 5.83341 5.83325H7.50008M12.5001 5.83325H14.1667C15.2718 5.83325 16.3316 6.27224 17.113 7.05364C17.8944 7.83504 18.3334 8.89485 18.3334 9.99992C18.3334 11.105 17.8944 12.1648 17.113 12.9462C16.3316 13.7276 15.2718 14.1666 14.1667 14.1666H12.5001M6.66675 9.99992H13.3334"></path></g></svg></div><div class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-11-NuY2Zx weight-semibold-uqA4FV reset-IxiVJZ">Copy link</div></div></button><button tabindex="0" type="button" class="pencraft pc-reset pc-borderRadius-sm pencraft buttonBase-GK1x3M"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-width-64 pc-alignItems-center pc-reset container-iTCOuF"><div class="pencraft pc-display-flex pc-flexDirection-column pc-width-64 pc-height-64 pc-justifyContent-center pc-alignItems-center pc-reset bg-secondary-UUD3_J animate-XFJxE4 pc-borderRadius-lg button-zkMi7O"><svg role="img" width="20" height="20" viewBox="0 0 20 20" fill="var(--color-fg-primary)" stroke-width="1.8" stroke="none" xmlns="http://www.w3.org/2000/svg" style="height: 20px; width: 20px;"><g><title></title><path stroke="none" d="M20 10C20 4.47715 15.5229 0 10 0C4.47715 0 0 4.47715 0 10C0 14.9912 3.65684 19.1283 8.4375 19.8785V12.8906H5.89844V10H8.4375V7.79688C8.4375 5.29063 9.93047 3.90625 12.2146 3.90625C13.3084 3.90625 14.4531 4.10156 14.4531 4.10156V6.5625H13.1922C11.95 6.5625 11.5625 7.3334 11.5625 8.125V10H14.3359L13.8926 12.8906H11.5625V19.8785C16.3432 19.1283 20 14.9912 20 10Z"></path></g></svg></div><div class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-11-NuY2Zx weight-semibold-uqA4FV reset-IxiVJZ">Facebook</div></div></button><button tabindex="0" type="button" class="pencraft pc-reset pc-borderRadius-sm pencraft buttonBase-GK1x3M"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-width-64 pc-alignItems-center pc-reset container-iTCOuF"><div class="pencraft pc-display-flex pc-flexDirection-column pc-width-64 pc-height-64 pc-justifyContent-center pc-alignItems-center pc-reset bg-secondary-UUD3_J animate-XFJxE4 pc-borderRadius-lg button-zkMi7O"><svg role="img" width="20" height="20" viewBox="0 0 20 20" fill="var(--color-fg-primary)" stroke-width="1.8" stroke="var(--color-fg-primary)" xmlns="http://www.w3.org/2000/svg" style="height: 20px; width: 20px;"><g><title></title><path stroke="none" d="M9.9958 11.0646C10.2693 11.0646 10.5346 10.9569 10.7915 10.7248L19.0717 3.431C18.6241 3.13262 18.1102 3 17.3974 3H2.60257C1.88976 3 1.37587 3.13262 0.920011 3.431L9.20011 10.7248C9.46534 10.9569 9.73057 11.0646 9.9958 11.0646ZM0.215499 15.9465L6.34893 9.82137L0.198922 4.40075C0.107749 4.5748 0 4.99751 0 5.56941V14.7199C0 15.2503 0.0828842 15.6316 0.215499 15.9465ZM2.35391 17.2892H17.646C18.2511 17.2892 18.7235 17.14 19.0385 16.9245L12.731 10.6171L11.5209 11.6945C11.0402 12.1173 10.518 12.3328 9.9958 12.3328C9.48197 12.3328 8.95975 12.1173 8.47905 11.6945L7.26894 10.6171L0.961455 16.9245C1.27642 17.14 1.74057 17.2892 2.35391 17.2892ZM19.7844 15.9465C19.9088 15.6316 20 15.2503 20 14.7199V5.56941C20 4.99751 19.8922 4.5748 19.8011 4.40075L13.651 9.82137L19.7844 15.9465Z"></path></g></svg></div><div class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-11-NuY2Zx weight-semibold-uqA4FV reset-IxiVJZ">Email</div></div></button><button tabindex="0" type="button" class="pencraft pc-reset pc-borderRadius-sm pencraft buttonBase-GK1x3M"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-width-64 pc-alignItems-center pc-reset container-iTCOuF"><div class="pencraft pc-display-flex pc-flexDirection-column pc-width-64 pc-height-64 pc-justifyContent-center pc-alignItems-center pc-reset bg-secondary-UUD3_J animate-XFJxE4 pc-borderRadius-lg button-zkMi7O"><svg role="img" width="20" height="20" viewBox="0 0 20 20" fill="var(--color-fg-primary)" stroke-width="1.8" stroke="none" xmlns="http://www.w3.org/2000/svg" style="height: 20px; width: 20px;"><g><title></title><path d="M1.96484 0.624512H18.0354V2.70052H1.96484V0.624512Z" stroke="none"></path><path d="M1.96484 4.77655H18.0354V6.85254H1.96484V4.77655Z" stroke="none"></path><path d="M1.96484 8.92857V19.9505L10.0001 14.6347L18.0354 19.9505V8.92857H1.96484Z" stroke="none"></path></g></svg></div><div class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-11-NuY2Zx weight-semibold-uqA4FV reset-IxiVJZ">Notes</div></div></button><button tabindex="0" type="button" class="pencraft pc-reset pc-borderRadius-sm pencraft buttonBase-GK1x3M"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-width-64 pc-alignItems-center pc-reset container-iTCOuF"><div class="pencraft pc-display-flex pc-flexDirection-column pc-width-64 pc-height-64 pc-justifyContent-center pc-alignItems-center pc-reset bg-secondary-UUD3_J animate-XFJxE4 pc-borderRadius-lg button-zkMi7O"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--color-fg-primary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-ellipsis"><circle cx="12" cy="12" r="1"></circle><circle cx="19" cy="12" r="1"></circle><circle cx="5" cy="12" r="1"></circle></svg></div><div class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-11-NuY2Zx weight-semibold-uqA4FV reset-IxiVJZ">More</div></div></button></div></div></div></div></div></div></div></div></div></div></div><a role="button" href="https://cameronrwolfe.substack.com/p/demystifying-reasoning-models/comments" aria-label="View comments (3)" class="post-ufi-button style-compressed post-ufi-comment-button has-label with-border"><svg role="img" width="14" height="14" viewBox="0 0 24 24" fill="#000000" stroke-width="2" stroke="#000" xmlns="http://www.w3.org/2000/svg" class="icon" style="height: 14px; width: 14px;"><g><title></title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-message-circle"><path d="M7.9 20A9 9 0 1 0 4 16.1L2 22Z"></path></svg></g></svg><div class="label">3</div></a><a role="button" class="post-ufi-button style-compressed no-label with-border"><svg role="img" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke="#000" xmlns="http://www.w3.org/2000/svg" class="icon" style="height: 14px; width: 14px;"><g><title></title><path d="M21 3V8M21 8H16M21 8L18 5.29962C16.7056 4.14183 15.1038 3.38328 13.3879 3.11547C11.6719 2.84766 9.9152 3.08203 8.32951 3.79031C6.74382 4.49858 5.39691 5.65051 4.45125 7.10715C3.5056 8.5638 3.00158 10.2629 3 11.9996M3 21V16M3 16H8M3 16L6 18.7C7.29445 19.8578 8.89623 20.6163 10.6121 20.8841C12.3281 21.152 14.0848 20.9176 15.6705 20.2093C17.2562 19.501 18.6031 18.3491 19.5487 16.8925C20.4944 15.4358 20.9984 13.7367 21 12" stroke-linecap="round" stroke-linejoin="round"></path></g></svg></a><div inert="" role="dialog" class="modal typography out gone reader-onboarding-modal wide popup"><div class="modal-table"><div class="modal-row"><div class="modal-cell modal-content"><div class="container"><button tabindex="0" type="button" aria-label="X" data-testid="close-modal" class="pencraft pc-reset pencraft modal-btn modal-exit-btn no-margin iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_md-gCDS3o priority_tertiary-rlke8z"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="secondary" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg></button><div class="reader-onboarding-modal-container"></div></div></div></div></div></div><a role="button" href="javascript:void(0)" aria-label="View share options" class="post-ufi-button style-compressed no-label with-border"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"></path><polyline points="16 6 12 2 8 6"></polyline><line x1="12" x2="12" y1="2" y2="15"></line></svg></a></div></div></div><div><div class="image-tkPTAj container-XxSyR3" style="aspect-ratio: 1.5 / 1;"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!mk9r!,w_320,h_213,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_center/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F23d9c87e-b238-4fdd-996e-4ed4465b9931_2334x1282.png"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/23d9c87e-b238-4fdd-996e-4ed4465b9931_2334x1282(1).jpg" sizes="(min-width:768px) 50vw, 100vw" alt="" width="320" height="213" loading="lazy" class="img-OACg1c image-nBNbRY pencraft pc-reset" style="aspect-ratio: 1.5 / 1;"></picture></div></div></div></div><div class="pencraft pc-display-flex pc-reset border-bottom-detail-themed-Ua9186 divider-QOeHtM"></div><div aria-label="Post preview for AI Agents from First Principles" role="article" class="pencraft pc-display-flex pc-flexDirection-column pc-padding-8 pc-position-relative pc-reset pc-borderRadius-sm container-H2dyKk"><div class="container-Qnseki"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-4 pc-position-relative pc-reset flex-grow-rzmknG"><div class="pencraft pc-display-flex pc-flexDirection-column pc-reset"><a href="https://cameronrwolfe.substack.com/p/ai-agents" data-testid="post-preview-title" class="pencraft pc-reset color-pub-primary-text-NyXPlw font-pub-headings-FE5byy clamp-y7pNm8 clamp-3-lxFDfR reset-IxiVJZ" style="font-size: 19px; line-height: 26px;">AI Agents from First Principles</a></div><div class="pencraft pc-display-flex pc-flexDirection-column pc-reset"><a href="https://cameronrwolfe.substack.com/p/ai-agents" class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-15-Psle70 clamp-y7pNm8 clamp-2-kM02pu reset-IxiVJZ">Understanding AI agents by building upon the most basic concepts of LLMs...</a></div><div class="pencraft pc-display-inline pc-reset color-pub-secondary-text-hGQ02T line-height-20-t4M0El font-meta-MWBumP size-11-NuY2Zx weight-medium-fw81nC transform-uppercase-yKDgcq reset-IxiVJZ meta-EgzBVA"><time datetime="2025-06-09T09:33:09.032Z" class="date-rtYe1v">Jun 9</time>&nbsp;<span class="dividerChar-SbAJEi">•</span>&nbsp;<span class="pencraft pc-reset reset-IxiVJZ"><div class="profile-hover-card-target profileHoverCardTarget-PBxvGm"><a href="https://substack.com/@cwolferesearch" class="link-HFGLqU">Cameron R. Wolfe, Ph.D.</a></div></span></div><div class="pencraft pc-display-flex pc-flexDirection-column pc-reset actions-YFg47u"><div class="post-ufi style-compressed justified themed"><div class="like-button-container post-ufi-button style-compressed"><a role="button" aria-label="Like (314)" aria-pressed="false" class="post-ufi-button style-compressed has-label with-border"><svg role="img" width="14" height="14" viewBox="0 0 24 24" fill="#000000" stroke-width="2" stroke="#000" xmlns="http://www.w3.org/2000/svg" class="icon" style="height: 14px; width: 14px;"><g><title></title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-heart"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"></path></svg></g></svg><div class="label">314</div></a><div inert="" role="dialog" class="modal typography out gone reader-onboarding-modal wide popup"><div class="modal-table"><div class="modal-row"><div class="modal-cell modal-content"><div class="container"><button tabindex="0" type="button" aria-label="X" data-testid="close-modal" class="pencraft pc-reset pencraft modal-btn modal-exit-btn no-margin iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_md-gCDS3o priority_tertiary-rlke8z"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="secondary" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg></button><div class="reader-onboarding-modal-container"></div></div></div></div></div></div><div inert="" role="dialog" class="modal typography out gone share-dialog popup"><div class="modal-table"><div class="modal-row"><div class="modal-cell modal-content no-fullscreen"><div class="container"><button tabindex="0" type="button" aria-label="X" data-testid="close-modal" class="pencraft pc-reset pencraft modal-btn modal-exit-btn no-margin iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_md-gCDS3o priority_tertiary-rlke8z"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="secondary" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg></button><div class="pencraft pc-display-contents pc-reset pubTheme-yiXxQA"><div class="pencraft pc-display-contents pc-reset elevatedTheme-fBklGV"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-24 pc-padding-24 pc-reset bg-primary-zk6FDl border-detail-EGrm7T pc-borderRadius-md container-xiJVit"><h4 class="pencraft pc-reset flex-grow-rzmknG align-center-y7ZD4w line-height-24-jnGwiv font-display-nhmvtD size-20-P_cSRT weight-bold-DmI9lw reset-IxiVJZ">Share this post</h4><a href="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up#" class="pencraft pc-display-contents pc-reset"><div class="pencraft pc-display-contents pc-reset elevatedTheme-fBklGV"><div tabindex="0" draggable="false" class="pencraft pc-display-flex pc-flexDirection-column pc-minWidth-0 pc-position-relative pc-reset bg-primary-zk6FDl pc-borderRadius-md showFocus-sk_vEm postAttachment-eYV3fM" style="background: linear-gradient(180deg, rgba(81,82,79,0.75), rgba(81,82,79,0.75)), var(--color-dark-bg-secondary);"><div class="pencraft pc-display-flex pc-flexDirection-column pc-reset border-bottom-detail-k1F6C4 vibrantHeader-We3FVb"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!IitU!,w_424,h_222,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fcee4a772-78a7-41b7-8cf1-4da233376ea6_2002x1122.png 424w, https://substackcdn.com/image/fetch/$s_!IitU!,w_520,h_272,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fcee4a772-78a7-41b7-8cf1-4da233376ea6_2002x1122.png 520w, https://substackcdn.com/image/fetch/$s_!IitU!,w_848,h_444,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fcee4a772-78a7-41b7-8cf1-4da233376ea6_2002x1122.png 848w, https://substackcdn.com/image/fetch/$s_!IitU!,w_1040,h_545,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fcee4a772-78a7-41b7-8cf1-4da233376ea6_2002x1122.png 1040w, https://substackcdn.com/image/fetch/$s_!IitU!,w_1272,h_666,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fcee4a772-78a7-41b7-8cf1-4da233376ea6_2002x1122.png 1272w, https://substackcdn.com/image/fetch/$s_!IitU!,w_1456,h_762,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fcee4a772-78a7-41b7-8cf1-4da233376ea6_2002x1122.png 1456w, https://substackcdn.com/image/fetch/$s_!IitU!,w_1560,h_817,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fcee4a772-78a7-41b7-8cf1-4da233376ea6_2002x1122.png 1560w" sizes="520px"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/cee4a772-78a7-41b7-8cf1-4da233376ea6_2002x1122.jpg" sizes="520px" alt="" srcset="https://substackcdn.com/image/fetch/$s_!IitU!,w_424,h_222,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fcee4a772-78a7-41b7-8cf1-4da233376ea6_2002x1122.png 424w, https://substackcdn.com/image/fetch/$s_!IitU!,w_520,h_272,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fcee4a772-78a7-41b7-8cf1-4da233376ea6_2002x1122.png 520w, https://substackcdn.com/image/fetch/$s_!IitU!,w_848,h_444,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fcee4a772-78a7-41b7-8cf1-4da233376ea6_2002x1122.png 848w, https://substackcdn.com/image/fetch/$s_!IitU!,w_1040,h_545,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fcee4a772-78a7-41b7-8cf1-4da233376ea6_2002x1122.png 1040w, https://substackcdn.com/image/fetch/$s_!IitU!,w_1272,h_666,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fcee4a772-78a7-41b7-8cf1-4da233376ea6_2002x1122.png 1272w, https://substackcdn.com/image/fetch/$s_!IitU!,w_1456,h_762,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fcee4a772-78a7-41b7-8cf1-4da233376ea6_2002x1122.png 1456w, https://substackcdn.com/image/fetch/$s_!IitU!,w_1560,h_817,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fcee4a772-78a7-41b7-8cf1-4da233376ea6_2002x1122.png 1560w" width="520" draggable="false" class="img-OACg1c postImage-L4FlO9 vibrantPostImage-TTXyOq pencraft pc-reset"></picture></div><div class="pencraft pc-display-flex pc-gap-12 pc-padding-12 pc-alignItems-center pc-reset"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-2 pc-minWidth-0 pc-reset flex-grow-rzmknG"><div class="pencraft pc-display-flex pc-gap-8 pc-paddingBottom-4 pc-alignItems-center pc-reset"><div draggable="false" class="pencraft pc-display-flex pc-position-relative pc-reset"><div class="pencraft pc-display-flex pc-reset bg-white-ZBV5av pc-borderRadius-xs overflow-hidden-WdpwT6 sizing-border-box-DggLA4" style="width: 18px; height: 18px;"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!87xa!,w_36,h_36,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fab9b43fb-52d5-40da-995d-5b7cd3f91064_896x896.png"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/ab9b43fb-52d5-40da-995d-5b7cd3f91064_896x896(1).jpg" sizes="100vw" alt="Deep (Learning) Focus" width="36" height="36" draggable="false" class="img-OACg1c object-fit-cover-u4ReeV pencraft pc-reset" style="width: 18px; height: 18px;"></picture></div></div><div class="pencraft pc-reset flex-grow-rzmknG ellipsis-Jb8om8 color-vibrance-secondary-k5eqjt line-height-20-t4M0El font-text-qe4AeH size-13-hZTUKr weight-regular-mUq6Gb nowrap-QngyoB reset-IxiVJZ">Deep (Learning) Focus</div></div><div class="pencraft pc-reset color-vibrance-primary-KHCdqV line-height-20-t4M0El font-text-qe4AeH size-15-Psle70 weight-medium-fw81nC clamp-y7pNm8 clamp-2-kM02pu reset-IxiVJZ">AI Agents from First Principles</div></div></div></div></div></a><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-16 pc-reset"><div class="pencraft pc-display-flex pc-justifyContent-space-between pc-reset"><button tabindex="0" type="button" class="pencraft pc-reset pc-borderRadius-sm pencraft buttonBase-GK1x3M"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-width-64 pc-alignItems-center pc-reset container-iTCOuF"><div class="pencraft pc-display-flex pc-flexDirection-column pc-width-64 pc-height-64 pc-justifyContent-center pc-alignItems-center pc-reset bg-secondary-UUD3_J animate-XFJxE4 pc-borderRadius-lg button-zkMi7O"><svg role="img" width="20" height="20" viewBox="0 0 20 20" fill="none" stroke-width="2" stroke="var(--color-fg-primary)" xmlns="http://www.w3.org/2000/svg" style="height: 20px; width: 20px;"><g><title></title><path d="M7.50008 14.1666H5.83341C4.72835 14.1666 3.66854 13.7276 2.88714 12.9462C2.10573 12.1648 1.66675 11.105 1.66675 9.99992C1.66675 8.89485 2.10573 7.83504 2.88714 7.05364C3.66854 6.27224 4.72835 5.83325 5.83341 5.83325H7.50008M12.5001 5.83325H14.1667C15.2718 5.83325 16.3316 6.27224 17.113 7.05364C17.8944 7.83504 18.3334 8.89485 18.3334 9.99992C18.3334 11.105 17.8944 12.1648 17.113 12.9462C16.3316 13.7276 15.2718 14.1666 14.1667 14.1666H12.5001M6.66675 9.99992H13.3334"></path></g></svg></div><div class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-11-NuY2Zx weight-semibold-uqA4FV reset-IxiVJZ">Copy link</div></div></button><button tabindex="0" type="button" class="pencraft pc-reset pc-borderRadius-sm pencraft buttonBase-GK1x3M"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-width-64 pc-alignItems-center pc-reset container-iTCOuF"><div class="pencraft pc-display-flex pc-flexDirection-column pc-width-64 pc-height-64 pc-justifyContent-center pc-alignItems-center pc-reset bg-secondary-UUD3_J animate-XFJxE4 pc-borderRadius-lg button-zkMi7O"><svg role="img" width="20" height="20" viewBox="0 0 20 20" fill="var(--color-fg-primary)" stroke-width="1.8" stroke="none" xmlns="http://www.w3.org/2000/svg" style="height: 20px; width: 20px;"><g><title></title><path stroke="none" d="M20 10C20 4.47715 15.5229 0 10 0C4.47715 0 0 4.47715 0 10C0 14.9912 3.65684 19.1283 8.4375 19.8785V12.8906H5.89844V10H8.4375V7.79688C8.4375 5.29063 9.93047 3.90625 12.2146 3.90625C13.3084 3.90625 14.4531 4.10156 14.4531 4.10156V6.5625H13.1922C11.95 6.5625 11.5625 7.3334 11.5625 8.125V10H14.3359L13.8926 12.8906H11.5625V19.8785C16.3432 19.1283 20 14.9912 20 10Z"></path></g></svg></div><div class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-11-NuY2Zx weight-semibold-uqA4FV reset-IxiVJZ">Facebook</div></div></button><button tabindex="0" type="button" class="pencraft pc-reset pc-borderRadius-sm pencraft buttonBase-GK1x3M"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-width-64 pc-alignItems-center pc-reset container-iTCOuF"><div class="pencraft pc-display-flex pc-flexDirection-column pc-width-64 pc-height-64 pc-justifyContent-center pc-alignItems-center pc-reset bg-secondary-UUD3_J animate-XFJxE4 pc-borderRadius-lg button-zkMi7O"><svg role="img" width="20" height="20" viewBox="0 0 20 20" fill="var(--color-fg-primary)" stroke-width="1.8" stroke="var(--color-fg-primary)" xmlns="http://www.w3.org/2000/svg" style="height: 20px; width: 20px;"><g><title></title><path stroke="none" d="M9.9958 11.0646C10.2693 11.0646 10.5346 10.9569 10.7915 10.7248L19.0717 3.431C18.6241 3.13262 18.1102 3 17.3974 3H2.60257C1.88976 3 1.37587 3.13262 0.920011 3.431L9.20011 10.7248C9.46534 10.9569 9.73057 11.0646 9.9958 11.0646ZM0.215499 15.9465L6.34893 9.82137L0.198922 4.40075C0.107749 4.5748 0 4.99751 0 5.56941V14.7199C0 15.2503 0.0828842 15.6316 0.215499 15.9465ZM2.35391 17.2892H17.646C18.2511 17.2892 18.7235 17.14 19.0385 16.9245L12.731 10.6171L11.5209 11.6945C11.0402 12.1173 10.518 12.3328 9.9958 12.3328C9.48197 12.3328 8.95975 12.1173 8.47905 11.6945L7.26894 10.6171L0.961455 16.9245C1.27642 17.14 1.74057 17.2892 2.35391 17.2892ZM19.7844 15.9465C19.9088 15.6316 20 15.2503 20 14.7199V5.56941C20 4.99751 19.8922 4.5748 19.8011 4.40075L13.651 9.82137L19.7844 15.9465Z"></path></g></svg></div><div class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-11-NuY2Zx weight-semibold-uqA4FV reset-IxiVJZ">Email</div></div></button><button tabindex="0" type="button" class="pencraft pc-reset pc-borderRadius-sm pencraft buttonBase-GK1x3M"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-width-64 pc-alignItems-center pc-reset container-iTCOuF"><div class="pencraft pc-display-flex pc-flexDirection-column pc-width-64 pc-height-64 pc-justifyContent-center pc-alignItems-center pc-reset bg-secondary-UUD3_J animate-XFJxE4 pc-borderRadius-lg button-zkMi7O"><svg role="img" width="20" height="20" viewBox="0 0 20 20" fill="var(--color-fg-primary)" stroke-width="1.8" stroke="none" xmlns="http://www.w3.org/2000/svg" style="height: 20px; width: 20px;"><g><title></title><path d="M1.96484 0.624512H18.0354V2.70052H1.96484V0.624512Z" stroke="none"></path><path d="M1.96484 4.77655H18.0354V6.85254H1.96484V4.77655Z" stroke="none"></path><path d="M1.96484 8.92857V19.9505L10.0001 14.6347L18.0354 19.9505V8.92857H1.96484Z" stroke="none"></path></g></svg></div><div class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-11-NuY2Zx weight-semibold-uqA4FV reset-IxiVJZ">Notes</div></div></button><button tabindex="0" type="button" class="pencraft pc-reset pc-borderRadius-sm pencraft buttonBase-GK1x3M"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-width-64 pc-alignItems-center pc-reset container-iTCOuF"><div class="pencraft pc-display-flex pc-flexDirection-column pc-width-64 pc-height-64 pc-justifyContent-center pc-alignItems-center pc-reset bg-secondary-UUD3_J animate-XFJxE4 pc-borderRadius-lg button-zkMi7O"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--color-fg-primary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-ellipsis"><circle cx="12" cy="12" r="1"></circle><circle cx="19" cy="12" r="1"></circle><circle cx="5" cy="12" r="1"></circle></svg></div><div class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-11-NuY2Zx weight-semibold-uqA4FV reset-IxiVJZ">More</div></div></button></div></div></div></div></div></div></div></div></div></div></div><a role="button" href="https://cameronrwolfe.substack.com/p/ai-agents/comments" aria-label="View comments (24)" class="post-ufi-button style-compressed post-ufi-comment-button has-label with-border"><svg role="img" width="14" height="14" viewBox="0 0 24 24" fill="#000000" stroke-width="2" stroke="#000" xmlns="http://www.w3.org/2000/svg" class="icon" style="height: 14px; width: 14px;"><g><title></title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-message-circle"><path d="M7.9 20A9 9 0 1 0 4 16.1L2 22Z"></path></svg></g></svg><div class="label">24</div></a><a role="button" class="post-ufi-button style-compressed no-label with-border"><svg role="img" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke="#000" xmlns="http://www.w3.org/2000/svg" class="icon" style="height: 14px; width: 14px;"><g><title></title><path d="M21 3V8M21 8H16M21 8L18 5.29962C16.7056 4.14183 15.1038 3.38328 13.3879 3.11547C11.6719 2.84766 9.9152 3.08203 8.32951 3.79031C6.74382 4.49858 5.39691 5.65051 4.45125 7.10715C3.5056 8.5638 3.00158 10.2629 3 11.9996M3 21V16M3 16H8M3 16L6 18.7C7.29445 19.8578 8.89623 20.6163 10.6121 20.8841C12.3281 21.152 14.0848 20.9176 15.6705 20.2093C17.2562 19.501 18.6031 18.3491 19.5487 16.8925C20.4944 15.4358 20.9984 13.7367 21 12" stroke-linecap="round" stroke-linejoin="round"></path></g></svg></a><div inert="" role="dialog" class="modal typography out gone reader-onboarding-modal wide popup"><div class="modal-table"><div class="modal-row"><div class="modal-cell modal-content"><div class="container"><button tabindex="0" type="button" aria-label="X" data-testid="close-modal" class="pencraft pc-reset pencraft modal-btn modal-exit-btn no-margin iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_md-gCDS3o priority_tertiary-rlke8z"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="secondary" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg></button><div class="reader-onboarding-modal-container"></div></div></div></div></div></div><a role="button" href="javascript:void(0)" aria-label="View share options" class="post-ufi-button style-compressed no-label with-border"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"></path><polyline points="16 6 12 2 8 6"></polyline><line x1="12" x2="12" y1="2" y2="15"></line></svg></a></div></div></div><div><div class="image-tkPTAj container-XxSyR3" style="aspect-ratio: 1.5 / 1;"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!IitU!,w_320,h_213,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_center/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fcee4a772-78a7-41b7-8cf1-4da233376ea6_2002x1122.png"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/cee4a772-78a7-41b7-8cf1-4da233376ea6_2002x1122(1).jpg" sizes="(min-width:768px) 50vw, 100vw" alt="" width="320" height="213" loading="lazy" class="img-OACg1c image-nBNbRY pencraft pc-reset" style="aspect-ratio: 1.5 / 1;"></picture></div></div></div></div></div></div><div class="pencraft pc-display-flex pc-paddingLeft-8 pc-paddingRight-8 pc-paddingTop-16 pc-reset"><button tabindex="0" type="button" data-testid="archive-view-all" data-href="/archive?sort=top" class="pencraft pc-reset pencraft buttonBase-GK1x3M buttonText-X0uSmG buttonStyle-r7yGCK priority_secondary-S63h9o size_md-gCDS3o">See all<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right"><path d="m9 18 6-6-6-6"></path></svg></button></div></div></div></div></div></div><div class="visibility-check"></div><div class="subscribe-footer"><div class="container"><p>Ready for more?</p><div class="pencraft pc-display-flex pc-justifyContent-center pc-reset"><div><div class="container-IpPqBD"><form action="https://cameronrwolfe.substack.com/api/v1/free?nojs=true" method="post" class="form form-M5sC90" novalidate=""><input type="hidden" name="first_url" value="https://cameronrwolfe.substack.com/p/decoder-only-transformers-the-workhorse"><input type="hidden" name="first_referrer" value="https://www.google.com/"><input type="hidden" name="current_url" value="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up"><input type="hidden" name="current_referrer"><input type="hidden" name="first_session_url" value="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up"><input type="hidden" name="first_session_referrer" value=""><input type="hidden" name="referral_code"><input type="hidden" name="source" value="subscribe_footer"><input type="hidden" name="referring_pub_id"><input type="hidden" name="additional_referring_pub_ids"><div class="sideBySideWrap-vGXrwP"><div class="emailInputWrapper-QlA86j"><div class="pencraft pc-display-flex pc-minWidth-0 pc-position-relative pc-reset flex-auto-j3S2WA"><input name="email" placeholder="Type your email..." type="email" class="pencraft emailInput-OkIMeB emailInputOnAccentBackground-TfaCGr input-y4v6N4 inputText-pV_yWb"></div></div><button type="submit" class="pencraft pc-reset pencraft rightButton primary subscribe-btn button-VFSdkv buttonOnAccentBackground-vmEt94 buttonBase-GK1x3M" tabindex="0"><span class="button-text ">Subscribe</span></button></div><div id="error-container"></div></form><div class="animationWrapper-QRL6aQ"></div></div></div></div></div></div></div></div><script type="text/javascript" async="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/f.txt"></script></div><div class="footer-wrap publication-footer"><div class="visibility-check"></div><div class="footer themed-background"><div class="container"><div class="footer-blurbs"><div class="footer-copyright-blurb">© 2025 Cameron R. Wolfe</div><div class="footer-terms-blurb"><a href="https://substack.com/privacy" target="_blank" rel="noopener" class="pencraft pc-reset decoration-underline-ClTkYc">Privacy</a><span> ∙ </span><a href="https://substack.com/tos" target="_blank" rel="noopener" class="pencraft pc-reset decoration-underline-ClTkYc">Terms</a><span> ∙ </span><a href="https://substack.com/ccpa#personal-data-collected" target="_blank" rel="noopener" class="pencraft pc-reset decoration-underline-ClTkYc">Collection notice</a></div></div><div class="footer-buttons"><a native="true" href="https://substack.com/signup?utm_source=substack&amp;utm_medium=web&amp;utm_content=footer" class="footer-substack-cta start-publishing"><svg role="img" width="1000" height="1000" viewBox="0 0 1000 1000" fill="#ff6719" stroke-width="1.8" stroke="none" xmlns="http://www.w3.org/2000/svg"><g><title></title><path d="M764.166 348.371H236.319V419.402H764.166V348.371Z"></path><path d="M236.319 483.752V813.999L500.231 666.512L764.19 813.999V483.752H236.319Z"></path><path d="M764.166 213H236.319V284.019H764.166V213Z"></path></g></svg> Start writing</a><a native="true" href="https://substack.com/app/app-store-redirect?utm_campaign=app-marketing&amp;utm_content=web-footer-button" class="footer-substack-cta get-the-app no-icon">Get the app</a></div><div translated="true" class="pencraft pc-reset reset-IxiVJZ footer-slogan-blurb"><a href="https://substack.com/" native="true">Substack</a> is the home for great culture</div></div></div></div><div inert="" role="dialog" class="modal typography out gone reader-onboarding-modal wide popup" style="z-index: 1001;"><div class="modal-table"><div class="modal-row"><div class="modal-cell modal-content"><div class="container"><button tabindex="0" type="button" aria-label="X" data-testid="close-modal" class="pencraft pc-reset pencraft modal-btn modal-exit-btn no-margin iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_md-gCDS3o priority_tertiary-rlke8z"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="secondary" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg></button><div class="reader-onboarding-modal-container"></div></div></div></div></div></div></div><div inert="" role="dialog" class="modal typography out gone share-dialog popup"><div class="modal-table"><div class="modal-row"><div class="modal-cell modal-content no-fullscreen"><div class="container"><button type="button" aria-label="X" data-testid="close-modal" class="pencraft pc-reset pencraft modal-btn modal-exit-btn no-margin iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_md-gCDS3o priority_tertiary-rlke8z" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="secondary" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg></button><div class="pencraft pc-display-contents pc-reset pubTheme-yiXxQA"><div class="pencraft pc-display-contents pc-reset elevatedTheme-fBklGV"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-24 pc-padding-24 pc-reset bg-primary-zk6FDl border-detail-EGrm7T pc-borderRadius-md container-xiJVit"><h4 class="pencraft pc-reset flex-grow-rzmknG align-center-y7ZD4w line-height-24-jnGwiv font-display-nhmvtD size-20-P_cSRT weight-bold-DmI9lw reset-IxiVJZ">Share</h4><a href="https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up#" class="pencraft pc-display-contents pc-reset"><div class="pencraft pc-display-contents pc-reset elevatedTheme-fBklGV"><div rel="nofollow noopener ugc" target="_blank" draggable="false" class="pencraft pc-display-flex pc-gap-12 pc-minWidth-0 pc-padding-12 pc-position-relative pc-reset bg-primary-zk6FDl pc-borderRadius-md showFocus-sk_vEm postAttachment-eYV3fM" tabindex="0"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-2 pc-minWidth-0 pc-reset flex-grow-rzmknG"><div class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-15-Psle70 weight-medium-fw81nC clamp-y7pNm8 clamp-2-kM02pu reset-IxiVJZ"></div></div><div class="pencraft pc-display-flex pc-width-64 pc-height-64 pc-justifyContent-center pc-alignItems-center pc-reset bg-secondary-UUD3_J pc-borderRadius-md"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--color-fg-secondary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></div></div></div></a><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-16 pc-reset"><div class="pencraft pc-display-flex pc-justifyContent-space-between pc-reset"><button type="button" class="pencraft pc-reset pc-borderRadius-sm pencraft buttonBase-GK1x3M" tabindex="0"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-width-64 pc-alignItems-center pc-reset container-iTCOuF"><div class="pencraft pc-display-flex pc-flexDirection-column pc-width-64 pc-height-64 pc-justifyContent-center pc-alignItems-center pc-reset bg-secondary-UUD3_J animate-XFJxE4 pc-borderRadius-lg button-zkMi7O"><svg role="img" style="height: 20px; width: 20px;" width="20" height="20" viewBox="0 0 20 20" fill="none" stroke-width="2" stroke="var(--color-fg-primary)" xmlns="http://www.w3.org/2000/svg"><g><title></title><path d="M7.50008 14.1666H5.83341C4.72835 14.1666 3.66854 13.7276 2.88714 12.9462C2.10573 12.1648 1.66675 11.105 1.66675 9.99992C1.66675 8.89485 2.10573 7.83504 2.88714 7.05364C3.66854 6.27224 4.72835 5.83325 5.83341 5.83325H7.50008M12.5001 5.83325H14.1667C15.2718 5.83325 16.3316 6.27224 17.113 7.05364C17.8944 7.83504 18.3334 8.89485 18.3334 9.99992C18.3334 11.105 17.8944 12.1648 17.113 12.9462C16.3316 13.7276 15.2718 14.1666 14.1667 14.1666H12.5001M6.66675 9.99992H13.3334"></path></g></svg></div><div class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-11-NuY2Zx weight-semibold-uqA4FV reset-IxiVJZ">Copy link</div></div></button><button type="button" class="pencraft pc-reset pc-borderRadius-sm pencraft buttonBase-GK1x3M" tabindex="0"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-width-64 pc-alignItems-center pc-reset container-iTCOuF"><div class="pencraft pc-display-flex pc-flexDirection-column pc-width-64 pc-height-64 pc-justifyContent-center pc-alignItems-center pc-reset bg-secondary-UUD3_J animate-XFJxE4 pc-borderRadius-lg button-zkMi7O"><svg role="img" style="height: 20px; width: 20px;" width="20" height="20" viewBox="0 0 20 20" fill="var(--color-fg-primary)" stroke-width="1.8" stroke="none" xmlns="http://www.w3.org/2000/svg"><g><title></title><path stroke="none" d="M20 10C20 4.47715 15.5229 0 10 0C4.47715 0 0 4.47715 0 10C0 14.9912 3.65684 19.1283 8.4375 19.8785V12.8906H5.89844V10H8.4375V7.79688C8.4375 5.29063 9.93047 3.90625 12.2146 3.90625C13.3084 3.90625 14.4531 4.10156 14.4531 4.10156V6.5625H13.1922C11.95 6.5625 11.5625 7.3334 11.5625 8.125V10H14.3359L13.8926 12.8906H11.5625V19.8785C16.3432 19.1283 20 14.9912 20 10Z"></path></g></svg></div><div class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-11-NuY2Zx weight-semibold-uqA4FV reset-IxiVJZ">Facebook</div></div></button><button type="button" class="pencraft pc-reset pc-borderRadius-sm pencraft buttonBase-GK1x3M" tabindex="0"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-width-64 pc-alignItems-center pc-reset container-iTCOuF"><div class="pencraft pc-display-flex pc-flexDirection-column pc-width-64 pc-height-64 pc-justifyContent-center pc-alignItems-center pc-reset bg-secondary-UUD3_J animate-XFJxE4 pc-borderRadius-lg button-zkMi7O"><svg role="img" style="height: 20px; width: 20px;" width="20" height="20" viewBox="0 0 20 20" fill="var(--color-fg-primary)" stroke-width="1.8" stroke="var(--color-fg-primary)" xmlns="http://www.w3.org/2000/svg"><g><title></title><path stroke="none" d="M9.9958 11.0646C10.2693 11.0646 10.5346 10.9569 10.7915 10.7248L19.0717 3.431C18.6241 3.13262 18.1102 3 17.3974 3H2.60257C1.88976 3 1.37587 3.13262 0.920011 3.431L9.20011 10.7248C9.46534 10.9569 9.73057 11.0646 9.9958 11.0646ZM0.215499 15.9465L6.34893 9.82137L0.198922 4.40075C0.107749 4.5748 0 4.99751 0 5.56941V14.7199C0 15.2503 0.0828842 15.6316 0.215499 15.9465ZM2.35391 17.2892H17.646C18.2511 17.2892 18.7235 17.14 19.0385 16.9245L12.731 10.6171L11.5209 11.6945C11.0402 12.1173 10.518 12.3328 9.9958 12.3328C9.48197 12.3328 8.95975 12.1173 8.47905 11.6945L7.26894 10.6171L0.961455 16.9245C1.27642 17.14 1.74057 17.2892 2.35391 17.2892ZM19.7844 15.9465C19.9088 15.6316 20 15.2503 20 14.7199V5.56941C20 4.99751 19.8922 4.5748 19.8011 4.40075L13.651 9.82137L19.7844 15.9465Z"></path></g></svg></div><div class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-11-NuY2Zx weight-semibold-uqA4FV reset-IxiVJZ">Email</div></div></button><button type="button" class="pencraft pc-reset pc-borderRadius-sm pencraft buttonBase-GK1x3M" tabindex="0"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-width-64 pc-alignItems-center pc-reset container-iTCOuF"><div class="pencraft pc-display-flex pc-flexDirection-column pc-width-64 pc-height-64 pc-justifyContent-center pc-alignItems-center pc-reset bg-secondary-UUD3_J animate-XFJxE4 pc-borderRadius-lg button-zkMi7O"><svg role="img" style="height: 20px; width: 20px;" width="20" height="20" viewBox="0 0 20 20" fill="var(--color-fg-primary)" stroke-width="1.8" stroke="none" xmlns="http://www.w3.org/2000/svg"><g><title></title><path d="M1.96484 0.624512H18.0354V2.70052H1.96484V0.624512Z" stroke="none"></path><path d="M1.96484 4.77655H18.0354V6.85254H1.96484V4.77655Z" stroke="none"></path><path d="M1.96484 8.92857V19.9505L10.0001 14.6347L18.0354 19.9505V8.92857H1.96484Z" stroke="none"></path></g></svg></div><div class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-11-NuY2Zx weight-semibold-uqA4FV reset-IxiVJZ">Notes</div></div></button><button type="button" class="pencraft pc-reset pc-borderRadius-sm pencraft buttonBase-GK1x3M" tabindex="0"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-width-64 pc-alignItems-center pc-reset container-iTCOuF"><div class="pencraft pc-display-flex pc-flexDirection-column pc-width-64 pc-height-64 pc-justifyContent-center pc-alignItems-center pc-reset bg-secondary-UUD3_J animate-XFJxE4 pc-borderRadius-lg button-zkMi7O"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--color-fg-primary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-ellipsis"><circle cx="12" cy="12" r="1"></circle><circle cx="19" cy="12" r="1"></circle><circle cx="5" cy="12" r="1"></circle></svg></div><div class="pencraft pc-reset color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-11-NuY2Zx weight-semibold-uqA4FV reset-IxiVJZ">More</div></div></button></div></div></div></div></div></div></div></div></div></div><div class="pencraft pc-display-contents pc-reset pubAccentTheme-rgl9Hv"></div><div inert="" role="dialog" class="modal typography out gone reader-onboarding-modal wide popup"><div class="modal-table"><div class="modal-row"><div class="modal-cell modal-content"><div class="container"><button tabindex="0" type="button" aria-label="X" data-testid="close-modal" class="pencraft pc-reset pencraft modal-btn modal-exit-btn no-margin iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_md-gCDS3o priority_tertiary-rlke8z"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="secondary" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg></button><div class="reader-onboarding-modal-container"></div></div></div></div></div></div><div style="left: auto; right: 16px; bottom: 16px; z-index: 1001; transform: translateY(0px);" role="region" aria-label="Notification" class="pencraft pc-position-fixed pc-reset sizing-border-box-DggLA4"></div><div><div inert="" role="dialog" class="modal typography out gone popup"><div class="modal-table"><div class="modal-row"><div class="modal-cell modal-content"><div class="container"><button tabindex="0" type="button" aria-label="X" data-testid="close-modal" class="pencraft pc-reset pencraft modal-btn modal-exit-btn no-margin iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_md-gCDS3o priority_tertiary-rlke8z"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="secondary" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg></button><div class="profile-updater-modal"><div class="profile-updater"><h4 class="pencraft pc-paddingBottom-20 pc-reset align-left-PENAI6 line-height-24-jnGwiv font-display-nhmvtD size-20-P_cSRT weight-bold-DmI9lw reset-IxiVJZ">Create your profile</h4><div class="pencraft pc-display-flex pc-justifyContent-center pc-alignItems-center pc-reset flex-grow-rzmknG"><div class="pencraft pc-position-relative pc-reset"><div class="pencraft pc-display-flex pc-width-94 pc-height-94 pc-justifyContent-center pc-alignItems-center pc-position-relative pc-reset bg-secondary-UUD3_J flex-auto-j3S2WA outline-detail-vcQLyr pc-borderRadius-full overflow-hidden-WdpwT6 sizing-border-box-DggLA4 container-TAtrWj avatar-pXO8aB" style="--scale: 94px;"><div title="User" class="pencraft pc-display-flex pc-width-94 pc-height-94 pc-justifyContent-center pc-alignItems-center pc-position-relative pc-reset bg-secondary-UUD3_J flex-auto-j3S2WA outline-detail-vcQLyr pc-borderRadius-full overflow-hidden-WdpwT6 sizing-border-box-DggLA4 container-TAtrWj" style="--scale: 94px;"><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!owWd!,w_94,h_94,c_fill,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack.com%2Fimg%2Favatars%2Fdefault-dark.png 94w, https://substackcdn.com/image/fetch/$s_!owWd!,w_188,h_188,c_fill,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack.com%2Fimg%2Favatars%2Fdefault-dark.png 188w, https://substackcdn.com/image/fetch/$s_!owWd!,w_282,h_282,c_fill,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack.com%2Fimg%2Favatars%2Fdefault-dark.png 282w" sizes="94px"><img src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/default-dark(1).jpg" sizes="94px" alt="User&#39;s avatar" srcset="https://substackcdn.com/image/fetch/$s_!owWd!,w_94,h_94,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack.com%2Fimg%2Favatars%2Fdefault-dark.png 94w, https://substackcdn.com/image/fetch/$s_!owWd!,w_188,h_188,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack.com%2Fimg%2Favatars%2Fdefault-dark.png 188w, https://substackcdn.com/image/fetch/$s_!owWd!,w_282,h_282,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack.com%2Fimg%2Favatars%2Fdefault-dark.png 282w" width="94" height="94" draggable="false" class="img-OACg1c object-fit-cover-u4ReeV pencraft pc-reset"></picture></div></div><button tabindex="0" type="button" aria-label="Edit profile image" class="pencraft pc-reset pencraft addButton-F9NSy4 iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_sm-G3LciD priority_secondary-S63h9o rounded-SYxRdz"><input type="file" name="photo" accept="image/*" class="input-QmLEx0"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-pencil"><path d="M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z"></path><path d="m15 5 4 4"></path></svg></button></div></div><form action="https://cameronrwolfe.substack.com/api/v1/user/profile" method="post" novalidate="" class="form "><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-20 pc-reset"><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-reset"><label for="name" class="pencraft pc-reset cursor-inherit-LxLBJ6 color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-13-hZTUKr weight-medium-fw81nC reset-IxiVJZ pencraft pencraft"><div class="pencraft pc-display-flex pc-gap-4 pc-alignItems-center pc-reset">Name<span class="pencraft pc-reset color-error-lkpu58 reset-IxiVJZ">*</span></div></label><div class="pencraft pc-display-flex pc-minWidth-0 pc-position-relative pc-reset flex-auto-j3S2WA"><input autofocus="true" placeholder="Type your name..." name="name" id="name" type="text" class="profile-name input-y4v6N4 inputText-pV_yWb"></div></div><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-reset"><label for="email" class="pencraft pc-reset cursor-inherit-LxLBJ6 color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-13-hZTUKr weight-medium-fw81nC reset-IxiVJZ pencraft pencraft"><div class="pencraft pc-display-flex pc-gap-4 pc-alignItems-center pc-reset">Email<span class="pencraft pc-reset color-error-lkpu58 reset-IxiVJZ">*</span></div></label><div class="pencraft pc-display-flex pc-minWidth-0 pc-position-relative pc-reset flex-auto-j3S2WA"><input placeholder="Enter your email address..." name="email" type="email" class="input-y4v6N4 inputText-pV_yWb"></div></div><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-reset"><label for="handle" class="pencraft pc-reset cursor-inherit-LxLBJ6 color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-13-hZTUKr weight-medium-fw81nC reset-IxiVJZ pencraft">Handle</label><div class="pencraft pc-display-flex pc-minWidth-0 pc-position-relative pc-reset flex-auto-j3S2WA"><input placeholder="Type your handle..." name="handle" id="handle" type="text" class="profile-name input-y4v6N4 inputText-pV_yWb"></div></div><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-reset"><label for="bio" class="pencraft pc-reset cursor-inherit-LxLBJ6 color-primary-zABazT line-height-20-t4M0El font-text-qe4AeH size-13-hZTUKr weight-medium-fw81nC reset-IxiVJZ pencraft">Bio</label><textarea placeholder="Say something about yourself..." name="bio" id="bio" rows="4" class="pencraft textarea-GbEjRX inputText-pV_yWb"></textarea></div><label class="pencraft pc-display-flex pc-gap-8 pc-reset checkbox-jbvy_H"><div class="pencraft pc-reset pencraft"><div tabindex="-1" class="pencraft pc-display-flex pc-justifyContent-center pc-alignItems-center pc-boxShadow-xs pc-position-relative pc-reset flex-auto-j3S2WA animate-XFJxE4 cursor-pointer-LYORKw outline-detail-vcQLyr pc-borderRadius-xs sizing-border-box-DggLA4 pencraft checkbox-h4aRbX sm-rkc_jb enabled-BlbymI checked-FCMkyU theme_accent-BLPCPx"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="icon-JVHTJb"><path d="M20 6 9 17l-5-5"></path></svg><input checked="" type="checkbox" role="checkbox" name="free_signup" data-testid="free_signup" data-state="selected" aria-checked="true" aria-label="free_signup" tabindex="0" class="pencraft"></div></div><span class="pencraft pc-reset line-height-20-t4M0El font-text-qe4AeH size-15-Psle70 weight-regular-mUq6Gb reset-IxiVJZ">Subscribe to the newsletter</span></label><input type="hidden" name="confirmation_redirect_pathname" value="/p/llama-2-from-the-ground-up"><input type="hidden" name="photo_url"><input type="hidden" name="user_id"><input type="hidden" name="needs_photo" value="false"><input type="hidden" name="token"><div id="error-container"></div></div><div class="pencraft pc-display-flex pc-flexDirection-column pc-gap-8 pc-paddingTop-20 pc-reset"><div class="pencraft pc-paddingBottom-12 pc-reset tosCheckboxContainer-vfMi_Y"><div class="visibility-check"></div><label class="pencraft pc-display-flex pc-gap-8 pc-justifyContent-center pc-alignItems-center pc-reset tosCheckbox-XbLWCT" style="display: flex;"><div class="tosCheckboxBox-KXqPaU"><div class="pencraft pc-reset pencraft"><div tabindex="-1" class="pencraft pc-display-flex pc-justifyContent-center pc-alignItems-center pc-boxShadow-xs pc-position-relative pc-reset flex-auto-j3S2WA animate-XFJxE4 cursor-pointer-LYORKw outline-detail-vcQLyr pc-borderRadius-xs sizing-border-box-DggLA4 pencraft checkbox-h4aRbX sm-rkc_jb enabled-BlbymI unchecked-ixpycg theme_accent-BLPCPx"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="icon-JVHTJb"><path d="M20 6 9 17l-5-5"></path></svg><input type="checkbox" role="checkbox" data-state="unselected" aria-checked="false" tabindex="0" class="pencraft"></div></div></div><div class="pencraft pc-reset color-primary-zABazT align-left-PENAI6 line-height-20-t4M0El font-text-qe4AeH size-13-hZTUKr weight-regular-mUq6Gb reset-IxiVJZ"> I agree to Substack's <a href="https://substack.com/tos" target="_blank" class="pencraft pc-reset reset-IxiVJZ" style="text-decoration: underline;">Terms of Use</a>, and acknowledge its <a href="https://substack.com/ccpa#personal-data-collected" target="_blank" class="pencraft pc-reset reset-IxiVJZ" style="text-decoration: underline;">Information Collection Notice</a> and <a href="https://substack.com/privacy" target="_blank" class="pencraft pc-reset reset-IxiVJZ" style="text-decoration: underline;">Privacy Policy</a>.</div></label></div><button tabindex="0" type="submit" disabled="" class="pencraft pc-reset pencraft buttonBase-GK1x3M buttonText-X0uSmG buttonStyle-r7yGCK priority_primary-RfbeYt size_lg-A_bUNK">Save &amp; Post Comment</button></div></form></div></div></div></div></div></div></div><div inert="" role="dialog" class="modal typography out gone popup"><div class="modal-table"><div class="modal-row"><div class="modal-cell modal-content"><div class="container"><button tabindex="0" type="button" aria-label="X" data-testid="close-modal" class="pencraft pc-reset pencraft modal-btn modal-exit-btn no-margin iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_md-gCDS3o priority_tertiary-rlke8z"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="secondary" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg></button><div data-testid="paywall" data-component-name="Paywall" role="region" aria-label="Paywall" class="paywall modal-paywall"><h2 class="paywall-title">Only paid subscribers can comment on this post</h2><div class="paywall-cta"><a href="https://cameronrwolfe.substack.com/subscribe?simple=true&amp;next=https%3A%2F%2Fcameronrwolfe.substack.com%2Fp%2Fllama-2-from-the-ground-up&amp;utm_source=paywall&amp;utm_medium=web&amp;utm_content=135824233" native="true"><button tabindex="0" type="button" class="pencraft pc-reset pencraft subscribe-btn subscribeButton-LcKYi7 buttonBase-GK1x3M">Subscribe</button></a></div><div class="paywall-login"><a href="https://substack.com/sign-in?redirect=%2Fp%2Fllama-2-from-the-ground-up&amp;for_pub=cameronrwolfe&amp;change_user=false" native="true">Already a paid subscriber? <b>Sign in</b></a></div></div></div></div></div></div></div><div inert="" role="dialog" class="modal typography out gone finish-magic-login-modal popup"><div class="modal-table"><div class="modal-row"><div class="modal-cell modal-content"><div class="container"><button tabindex="0" type="button" aria-label="X" data-testid="close-modal" class="pencraft pc-reset pencraft modal-btn modal-exit-btn no-margin iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_md-gCDS3o priority_tertiary-rlke8z"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="secondary" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg></button><h4>Check your email</h4><p>For your security, we need to re-authenticate you.</p><p translated="true" class="pencraft pc-reset reset-IxiVJZ">Click the link we sent to , or <a href="https://substack.com/sign-in?redirect=%2Fp%2Fllama-2-from-the-ground-up&amp;for_pub=cameronrwolfe&amp;with_password=true" native="true">click here to sign in</a>.</p></div></div></div></div></div></div>
            
        </div>

        
            <script src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/6c2ff3e3828e4017b7faf7b63e24cdf8.min.js" crossorigin="anonymous"></script>
            <script>
                window.Sentry && window.Sentry.onLoad(function() {
                    window.Sentry.init({
                        environment: window._preloads.sentry_environment,
                        dsn: window._preloads.sentry_dsn,
                    })
                })
            </script>
        


        
        
        
        <script>window._preloads        = JSON.parse("{\"isEU\":false,\"language\":\"en\",\"country\":\"IN\",\"userLocale\":{\"language\":\"en\",\"region\":\"US\",\"source\":\"accept-language\"},\"base_url\":\"https://cameronrwolfe.substack.com\",\"stripe_publishable_key\":\"pk_live_51QfnARLDSWi1i85FBpvw6YxfQHljOpWXw8IKi5qFWEzvW8HvoD8cqTulR9UWguYbYweLvA16P7LN6WZsGdZKrNkE00uGbFaOE3\",\"captcha_site_key\":\"6LdYbsYZAAAAAIFIRh8X_16GoFRLIReh-e-q6qSa\",\"pub\":{\"apple_pay_disabled\":false,\"apex_domain\":null,\"author_id\":29736521,\"byline_images_enabled\":true,\"bylines_enabled\":true,\"chartable_token\":null,\"community_enabled\":true,\"copyright\":\"Cameron R. Wolfe\",\"cover_photo_url\":\"https://substack-post-media.s3.amazonaws.com/public/images/653beb9d-15e2-4ad4-8146-526412e4fd0a_1200x509.png\",\"created_at\":\"2022-09-17T15:12:33.160Z\",\"custom_domain_optional\":false,\"custom_domain\":null,\"default_comment_sort\":\"best_first\",\"default_coupon\":null,\"default_group_coupon\":\"8b590093\",\"default_show_guest_bios\":true,\"email_banner_url\":null,\"email_from_name\":\"Deep (Learning) Focus\",\"email_from\":null,\"embed_tracking_disabled\":false,\"explicit\":false,\"expose_paywall_content_to_search_engines\":true,\"fb_pixel_id\":null,\"fb_site_verification_token\":null,\"flagged_as_spam\":false,\"founding_subscription_benefits\":[],\"free_subscription_benefits\":[\"Free subscribers can access everything!\"],\"ga_pixel_id\":null,\"google_site_verification_token\":null,\"google_tag_manager_token\":null,\"hero_image\":null,\"hero_text\":\"I contextualize and explain important topics in AI research.\",\"hide_intro_subtitle\":null,\"hide_intro_title\":true,\"hide_podcast_feed_link\":false,\"homepage_type\":\"newspaper\",\"id\":1092659,\"image_thumbnails_always_enabled\":true,\"invite_only\":false,\"language\":\"en\",\"logo_url_wide\":null,\"logo_url\":\"https://substackcdn.com/image/fetch/$s_!87xa!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fab9b43fb-52d5-40da-995d-5b7cd3f91064_896x896.png\",\"minimum_group_size\":2,\"moderation_enabled\":true,\"name\":\"Deep (Learning) Focus\",\"paid_subscription_benefits\":[\"Paid subscription is completely optional!\",\"Paid subscriptions help to support the newsletter.\"],\"parsely_pixel_id\":null,\"payments_state\":\"enabled\",\"paywall_free_trial_enabled\":false,\"podcast_art_url\":null,\"paid_podcast_episode_art_url\":null,\"podcast_byline\":null,\"podcast_description\":null,\"podcast_enabled\":false,\"podcast_feed_url\":null,\"podcast_title\":null,\"post_preview_limit\":null,\"primary_user_id\":29736521,\"require_clickthrough\":false,\"show_pub_podcast_tab\":false,\"show_recs_on_homepage\":true,\"subdomain\":\"cameronrwolfe\",\"subscriber_invites\":0,\"support_email\":null,\"theme_var_background_pop\":\"#6C0095\",\"theme_var_color_links\":true,\"theme_var_cover_bg_color\":null,\"trial_end_override\":null,\"twitter_pixel_id\":null,\"type\":\"newsletter\",\"post_reaction_faces_enabled\":false,\"is_personal_mode\":false,\"plans\":[{\"id\":\"yearly50usd\",\"object\":\"plan\",\"active\":true,\"aggregate_usage\":null,\"amount\":5000,\"amount_decimal\":\"5000\",\"billing_scheme\":\"per_unit\",\"created\":1737873534,\"currency\":\"usd\",\"interval\":\"year\",\"interval_count\":1,\"livemode\":true,\"metadata\":{\"substack\":\"yes\"},\"meter\":null,\"nickname\":\"$50 a year\",\"product\":\"prod_Reiw6UxXQp2Ei5\",\"tiers\":null,\"tiers_mode\":null,\"transform_usage\":null,\"trial_period_days\":null,\"usage_type\":\"licensed\",\"currency_options\":{\"aud\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":8000,\"unit_amount_decimal\":\"8000\"},\"brl\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":27500,\"unit_amount_decimal\":\"27500\"},\"cad\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":7000,\"unit_amount_decimal\":\"7000\"},\"chf\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":4000,\"unit_amount_decimal\":\"4000\"},\"dkk\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":32000,\"unit_amount_decimal\":\"32000\"},\"eur\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":4300,\"unit_amount_decimal\":\"4300\"},\"gbp\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":3700,\"unit_amount_decimal\":\"3700\"},\"mxn\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":94000,\"unit_amount_decimal\":\"94000\"},\"nok\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":50500,\"unit_amount_decimal\":\"50500\"},\"nzd\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":8500,\"unit_amount_decimal\":\"8500\"},\"pln\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":18500,\"unit_amount_decimal\":\"18500\"},\"sek\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":47500,\"unit_amount_decimal\":\"47500\"},\"usd\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":5000,\"unit_amount_decimal\":\"5000\"}}},{\"id\":\"monthly5usd\",\"object\":\"plan\",\"active\":true,\"aggregate_usage\":null,\"amount\":500,\"amount_decimal\":\"500\",\"billing_scheme\":\"per_unit\",\"created\":1737873534,\"currency\":\"usd\",\"interval\":\"month\",\"interval_count\":1,\"livemode\":true,\"metadata\":{\"substack\":\"yes\"},\"meter\":null,\"nickname\":\"$5 a month\",\"product\":\"prod_Reiw1WITu1j9gT\",\"tiers\":null,\"tiers_mode\":null,\"transform_usage\":null,\"trial_period_days\":null,\"usage_type\":\"licensed\",\"currency_options\":{\"aud\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":800,\"unit_amount_decimal\":\"800\"},\"brl\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":2800,\"unit_amount_decimal\":\"2800\"},\"cad\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":700,\"unit_amount_decimal\":\"700\"},\"chf\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":400,\"unit_amount_decimal\":\"400\"},\"dkk\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":3200,\"unit_amount_decimal\":\"3200\"},\"eur\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":500,\"unit_amount_decimal\":\"500\"},\"gbp\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":400,\"unit_amount_decimal\":\"400\"},\"mxn\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":9500,\"unit_amount_decimal\":\"9500\"},\"nok\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":5500,\"unit_amount_decimal\":\"5500\"},\"nzd\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":900,\"unit_amount_decimal\":\"900\"},\"pln\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":1900,\"unit_amount_decimal\":\"1900\"},\"sek\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":4800,\"unit_amount_decimal\":\"4800\"},\"usd\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":500,\"unit_amount_decimal\":\"500\"}}}],\"stripe_user_id\":\"acct_1NJxXfLBR5Rc0ibI\",\"stripe_country\":\"US\",\"stripe_publishable_key\":\"pk_live_51NJxXfLBR5Rc0ibIUMNtpfxwKgHPDMsKwS7TZPkKLrNt3PjH3z4GxfTso0oVqL7YtS2tJ0uLpauoJCLDe7btLWKO0074TH9U3e\",\"stripe_platform_account\":\"US\",\"automatic_tax_enabled\":false,\"author_name\":\"Cameron R. Wolfe, Ph.D.\",\"author_handle\":\"cwolferesearch\",\"author_photo_url\":\"https://substackcdn.com/image/fetch/$s_!VC2M!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F69aba7df-b571-4609-aa47-fc2d031c11b8_1242x1595.jpeg\",\"author_bio\":\"Research @ Netflix \u2022 Rice University PhD \u2022 I make AI understandable\",\"twitter_screen_name\":\"cwolferesearch\",\"has_custom_tos\":false,\"has_custom_privacy\":false,\"theme\":{\"background_pop_color\":\"#538cfa\",\"web_bg_color\":\"#ffffff\",\"cover_bg_color\":null,\"publication_id\":1092659,\"color_links\":null,\"font_preset_heading\":\"fancy_serif\",\"font_preset_body\":\"classic_serif\",\"font_family_headings\":null,\"font_family_body\":null,\"font_family_ui\":null,\"font_size_body_desktop\":null,\"print_secondary\":null,\"custom_css_web\":null,\"custom_css_email\":null,\"home_hero\":\"feature-media\",\"home_posts\":\"list\",\"home_show_top_posts\":true,\"hide_images_from_list\":false,\"home_hero_alignment\":\"left\",\"home_hero_show_podcast_links\":true,\"default_post_header_variant\":null},\"threads_v2_settings\":{\"photo_replies_enabled\":true,\"first_thread_email_sent_at\":null,\"create_thread_minimum_role\":\"contributor\",\"activated_at\":null,\"reader_thread_notifications_enabled\":false,\"boost_free_subscriber_chat_preview_enabled\":true,\"push_suppression_enabled\":false},\"default_group_coupon_percent_off\":\"20.00\",\"pause_return_date\":null,\"has_posts\":true,\"has_recommendations\":true,\"first_post_date\":\"2018-08-01T01:45:52.551Z\",\"has_podcast\":false,\"has_free_podcast\":false,\"has_subscriber_only_podcast\":false,\"has_community_content\":true,\"rankingDetail\":\"Launched 3 years ago\",\"rankingDetailFreeIncluded\":\"Tens of thousands of subscribers\",\"rankingDetailOrderOfMagnitude\":10,\"rankingDetailFreeIncludedOrderOfMagnitude\":10000,\"rankingDetailFreeSubscriberCount\":\"Over 49,000 subscribers\",\"rankingDetailByLanguage\":{\"de\":{\"rankingDetail\":\"Vor vor 3 Jahren gelauncht\",\"rankingDetailFreeIncluded\":\"Zehntausende von Abonnenten\",\"rankingDetailOrderOfMagnitude\":10,\"rankingDetailFreeIncludedOrderOfMagnitude\":10000,\"rankingDetailFreeSubscriberCount\":\"\u00DCber 49,000 Abonnenten\",\"freeSubscriberCount\":\"49,000\",\"freeSubscriberCountOrderOfMagnitude\":\"49K+\"},\"es\":{\"rankingDetail\":\"Lanzado hace 3 a\u00F1os\",\"rankingDetailFreeIncluded\":\"Decenas de miles de suscriptores\",\"rankingDetailOrderOfMagnitude\":10,\"rankingDetailFreeIncludedOrderOfMagnitude\":10000,\"rankingDetailFreeSubscriberCount\":\"M\u00E1s de 49,000 suscriptores\",\"freeSubscriberCount\":\"49,000\",\"freeSubscriberCountOrderOfMagnitude\":\"49K+\"},\"fr\":{\"rankingDetail\":\"Lanc\u00E9 il y a 3 ann\u00E9es\",\"rankingDetailFreeIncluded\":\"Des dizaines de milliers d'abonn\u00E9s\",\"rankingDetailOrderOfMagnitude\":10,\"rankingDetailFreeIncludedOrderOfMagnitude\":10000,\"rankingDetailFreeSubscriberCount\":\"Plus de 49,000 abonn\u00E9s\",\"freeSubscriberCount\":\"49,000\",\"freeSubscriberCountOrderOfMagnitude\":\"49K+\"},\"pt\":{\"rankingDetail\":\"Lan\u00E7ado 3 anos\",\"rankingDetailFreeIncluded\":\"Dezenas de milhares de subscritores\",\"rankingDetailOrderOfMagnitude\":10,\"rankingDetailFreeIncludedOrderOfMagnitude\":10000,\"rankingDetailFreeSubscriberCount\":\"Mais de 49,000 subscritores\",\"freeSubscriberCount\":\"49,000\",\"freeSubscriberCountOrderOfMagnitude\":\"49K+\"},\"pt-br\":{\"rankingDetail\":\"Lan\u00E7ado 3 anos\",\"rankingDetailFreeIncluded\":\"Dezenas de milhares de assinantes\",\"rankingDetailOrderOfMagnitude\":10,\"rankingDetailFreeIncludedOrderOfMagnitude\":10000,\"rankingDetailFreeSubscriberCount\":\"Mais de 49,000 assinantes\",\"freeSubscriberCount\":\"49,000\",\"freeSubscriberCountOrderOfMagnitude\":\"49K+\"},\"it\":{\"rankingDetail\":\"Lanciato 3 anni\",\"rankingDetailFreeIncluded\":\"Decine di migliaia di abbonati\",\"rankingDetailOrderOfMagnitude\":10,\"rankingDetailFreeIncludedOrderOfMagnitude\":10000,\"rankingDetailFreeSubscriberCount\":\"Oltre 49,000 abbonati\",\"freeSubscriberCount\":\"49,000\",\"freeSubscriberCountOrderOfMagnitude\":\"49K+\"},\"en\":{\"rankingDetail\":\"Launched 3 years ago\",\"rankingDetailFreeIncluded\":\"Tens of thousands of subscribers\",\"rankingDetailOrderOfMagnitude\":10,\"rankingDetailFreeIncludedOrderOfMagnitude\":10000,\"rankingDetailFreeSubscriberCount\":\"Over 49,000 subscribers\",\"freeSubscriberCount\":\"49,000\",\"freeSubscriberCountOrderOfMagnitude\":\"49K+\"}},\"freeSubscriberCount\":\"49,000\",\"freeSubscriberCountOrderOfMagnitude\":\"49K+\",\"author_bestseller_tier\":0,\"disable_monthly_subscriptions\":false,\"disable_annual_subscriptions\":false,\"hide_post_restacks\":false,\"notes_feed_enabled\":true,\"last_chat_post_at\":null,\"primary_profile_name\":\"Cameron R. Wolfe, Ph.D.\",\"primary_profile_photo_url\":\"https://substackcdn.com/image/fetch/$s_!VC2M!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F69aba7df-b571-4609-aa47-fc2d031c11b8_1242x1595.jpeg\",\"no_follow\":false,\"paywall_chat\":\"free\",\"sections\":[],\"multipub_migration\":null,\"navigationBarItems\":[{\"id\":\"c209da39-5bab-41a5-8462-c6592766811e\",\"publication_id\":1092659,\"sibling_rank\":0,\"link_title\":null,\"link_url\":null,\"section_id\":null,\"post_id\":null,\"is_hidden\":false,\"standard_key\":\"about\",\"post_tag_id\":null,\"post\":null,\"section\":null,\"postTag\":null},{\"id\":\"71f7794b-839a-45ee-8784-bccc795e76c2\",\"publication_id\":1092659,\"sibling_rank\":0,\"link_title\":null,\"link_url\":null,\"section_id\":null,\"post_id\":null,\"is_hidden\":true,\"standard_key\":\"chat\",\"post_tag_id\":null,\"post\":null,\"section\":null,\"postTag\":null},{\"id\":\"22e73dd8-fe4f-4421-93a0-f40b4aaf7647\",\"publication_id\":1092659,\"sibling_rank\":0,\"link_title\":null,\"link_url\":null,\"section_id\":null,\"post_id\":null,\"is_hidden\":false,\"standard_key\":\"archive\",\"post_tag_id\":null,\"post\":null,\"section\":null,\"postTag\":null},{\"id\":\"26a716ae-db15-43c0-b3c2-2c596c1ce347\",\"publication_id\":1092659,\"sibling_rank\":3,\"link_title\":\"The Author\",\"link_url\":\"https://cameronrwolfe.me\",\"section_id\":null,\"post_id\":null,\"is_hidden\":null,\"standard_key\":null,\"post_tag_id\":null,\"post\":null,\"section\":null,\"postTag\":null}],\"contributors\":[{\"name\":\"Cameron R. Wolfe, Ph.D.\",\"handle\":\"cwolferesearch\",\"role\":\"admin\",\"owner\":true,\"user_id\":29736521,\"photo_url\":\"https://bucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com/public/images/69aba7df-b571-4609-aa47-fc2d031c11b8_1242x1595.jpeg\",\"bio\":\"Research @ Netflix \u2022 Rice University PhD \u2022 I make AI understandable\"}],\"threads_v2_enabled\":true,\"viralGiftsConfig\":{\"id\":\"8ce99b40-c496-470f-b48e-3d5fbd30afc7\",\"publication_id\":1092659,\"enabled\":true,\"gifts_per_user\":5,\"gift_length_months\":1,\"send_extra_gifts\":true,\"message\":\"I contextualize and explain important topics in AI research.\",\"created_at\":\"2025-01-26T06:42:02.484384+00:00\",\"updated_at\":\"2025-01-26T06:42:02.484384+00:00\",\"days_til_invite\":14,\"send_emails\":true,\"show_link\":null,\"grant_email_body\":null,\"grant_email_subject\":null},\"tier\":2,\"no_index\":false,\"can_set_google_site_verification\":true,\"can_have_sitemap\":true,\"founding_plan_name_english\":\"Founding Member\",\"draft_plans\":[{\"id\":\"yearly50usd\",\"object\":\"plan\",\"active\":true,\"aggregate_usage\":null,\"amount\":5000,\"amount_decimal\":\"5000\",\"billing_scheme\":\"per_unit\",\"created\":1737873534,\"currency\":\"usd\",\"interval\":\"year\",\"interval_count\":1,\"livemode\":true,\"metadata\":{\"substack\":\"yes\"},\"meter\":null,\"nickname\":\"$50 a year\",\"product\":\"prod_Reiw6UxXQp2Ei5\",\"tiers\":null,\"tiers_mode\":null,\"transform_usage\":null,\"trial_period_days\":null,\"usage_type\":\"licensed\",\"currency_options\":{\"aud\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":8000,\"unit_amount_decimal\":\"8000\"},\"brl\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":27500,\"unit_amount_decimal\":\"27500\"},\"cad\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":7000,\"unit_amount_decimal\":\"7000\"},\"chf\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":4000,\"unit_amount_decimal\":\"4000\"},\"dkk\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":32000,\"unit_amount_decimal\":\"32000\"},\"eur\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":4300,\"unit_amount_decimal\":\"4300\"},\"gbp\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":3700,\"unit_amount_decimal\":\"3700\"},\"mxn\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":94000,\"unit_amount_decimal\":\"94000\"},\"nok\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":50500,\"unit_amount_decimal\":\"50500\"},\"nzd\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":8500,\"unit_amount_decimal\":\"8500\"},\"pln\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":18500,\"unit_amount_decimal\":\"18500\"},\"sek\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":47500,\"unit_amount_decimal\":\"47500\"},\"usd\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":5000,\"unit_amount_decimal\":\"5000\"}}},{\"id\":\"monthly5usd\",\"object\":\"plan\",\"active\":true,\"aggregate_usage\":null,\"amount\":500,\"amount_decimal\":\"500\",\"billing_scheme\":\"per_unit\",\"created\":1737873534,\"currency\":\"usd\",\"interval\":\"month\",\"interval_count\":1,\"livemode\":true,\"metadata\":{\"substack\":\"yes\"},\"meter\":null,\"nickname\":\"$5 a month\",\"product\":\"prod_Reiw1WITu1j9gT\",\"tiers\":null,\"tiers_mode\":null,\"transform_usage\":null,\"trial_period_days\":null,\"usage_type\":\"licensed\",\"currency_options\":{\"aud\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":800,\"unit_amount_decimal\":\"800\"},\"brl\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":2800,\"unit_amount_decimal\":\"2800\"},\"cad\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":700,\"unit_amount_decimal\":\"700\"},\"chf\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":400,\"unit_amount_decimal\":\"400\"},\"dkk\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":3200,\"unit_amount_decimal\":\"3200\"},\"eur\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":500,\"unit_amount_decimal\":\"500\"},\"gbp\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":400,\"unit_amount_decimal\":\"400\"},\"mxn\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":9500,\"unit_amount_decimal\":\"9500\"},\"nok\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":5500,\"unit_amount_decimal\":\"5500\"},\"nzd\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":900,\"unit_amount_decimal\":\"900\"},\"pln\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":1900,\"unit_amount_decimal\":\"1900\"},\"sek\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":4800,\"unit_amount_decimal\":\"4800\"},\"usd\":{\"custom_unit_amount\":null,\"tax_behavior\":\"unspecified\",\"unit_amount\":500,\"unit_amount_decimal\":\"500\"}}}],\"base_url\":\"https://cameronrwolfe.substack.com\",\"hostname\":\"cameronrwolfe.substack.com\",\"is_on_substack\":false,\"spotify_podcast_settings\":null,\"podcastPalette\":{\"DarkMuted\":{\"population\":72,\"rgb\":[73,153,137]},\"DarkVibrant\":{\"population\":6013,\"rgb\":[4,100,84]},\"LightMuted\":{\"population\":7,\"rgb\":[142,198,186]},\"LightVibrant\":{\"population\":3,\"rgb\":[166,214,206]},\"Muted\":{\"population\":6,\"rgb\":[92,164,156]},\"Vibrant\":{\"population\":5,\"rgb\":[76,164,146]}},\"pageThemes\":{\"podcast\":null},\"appTheme\":{\"colors\":{\"accent\":{\"name\":\"#538cfa\",\"primary\":{\"r\":83,\"g\":140,\"b\":250,\"a\":1},\"primary_hover\":{\"r\":58,\"g\":122,\"b\":230,\"a\":1},\"primary_elevated\":{\"r\":58,\"g\":122,\"b\":230,\"a\":1},\"secondary\":{\"r\":83,\"g\":140,\"b\":250,\"a\":0.2},\"contrast\":{\"r\":255,\"g\":255,\"b\":255,\"a\":1},\"bg\":{\"r\":83,\"g\":140,\"b\":250,\"a\":0.2},\"bg_hover\":{\"r\":83,\"g\":140,\"b\":250,\"a\":0.3},\"dark\":{\"primary\":{\"r\":83,\"g\":140,\"b\":250,\"a\":1},\"primary_hover\":{\"r\":107,\"g\":159,\"b\":255,\"a\":1},\"primary_elevated\":{\"r\":107,\"g\":159,\"b\":255,\"a\":1},\"secondary\":{\"r\":83,\"g\":140,\"b\":250,\"a\":0.2},\"contrast\":{\"r\":255,\"g\":255,\"b\":255,\"a\":1},\"bg\":{\"r\":83,\"g\":140,\"b\":250,\"a\":0.2},\"bg_hover\":{\"r\":83,\"g\":140,\"b\":250,\"a\":0.3}}},\"fg\":{\"primary\":{\"r\":0,\"g\":0,\"b\":0,\"a\":0.8},\"secondary\":{\"r\":0,\"g\":0,\"b\":0,\"a\":0.6},\"tertiary\":{\"r\":0,\"g\":0,\"b\":0,\"a\":0.4},\"accent\":{\"r\":45,\"g\":115,\"b\":221,\"a\":1},\"dark\":{\"primary\":{\"r\":255,\"g\":255,\"b\":255,\"a\":0.9},\"secondary\":{\"r\":255,\"g\":255,\"b\":255,\"a\":0.6},\"tertiary\":{\"r\":255,\"g\":255,\"b\":255,\"a\":0.4},\"accent\":{\"r\":83,\"g\":140,\"b\":250,\"a\":1}}},\"bg\":{\"name\":\"#ffffff\",\"hue\":{\"r\":255,\"g\":255,\"b\":255,\"a\":0},\"tint\":{\"r\":255,\"g\":255,\"b\":255,\"a\":0},\"primary\":{\"r\":255,\"g\":255,\"b\":255,\"a\":1},\"primary_hover\":{\"r\":250,\"g\":250,\"b\":250,\"a\":1},\"primary_elevated\":{\"r\":250,\"g\":250,\"b\":250,\"a\":1},\"secondary\":{\"r\":238,\"g\":238,\"b\":238,\"a\":1},\"secondary_elevated\":{\"r\":206.90096477355226,\"g\":206.90096477355175,\"b\":206.9009647735519,\"a\":1},\"tertiary\":{\"r\":219,\"g\":219,\"b\":219,\"a\":1},\"quaternary\":{\"r\":182,\"g\":182,\"b\":182,\"a\":1},\"dark\":{\"primary\":{\"r\":22,\"g\":23,\"b\":24,\"a\":1},\"primary_hover\":{\"r\":27,\"g\":28,\"b\":29,\"a\":1},\"primary_elevated\":{\"r\":27,\"g\":28,\"b\":29,\"a\":1},\"secondary\":{\"r\":35,\"g\":37,\"b\":37,\"a\":1},\"secondary_elevated\":{\"r\":41.35899397549579,\"g\":43.405356429195315,\"b\":43.40489285041963,\"a\":1},\"tertiary\":{\"r\":54,\"g\":55,\"b\":55,\"a\":1},\"quaternary\":{\"r\":90,\"g\":91,\"b\":91,\"a\":1}}}},\"cover_image\":{\"url\":\"https://substackcdn.com/image/fetch/$s_!eXeQ!,w_1200,h_400,c_fill,f_auto,q_auto:best,fl_progressive:steep,g_auto,b_rgb:FFFFFF/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F653beb9d-15e2-4ad4-8146-526412e4fd0a_1200x509.png\",\"height\":509,\"width\":1200}},\"live_subscriber_counts\":false,\"logoPalette\":{\"Vibrant\":{\"rgb\":[127.5,127.5,127.5],\"population\":0},\"DarkVibrant\":{\"rgb\":[66.3,66.3,66.3],\"population\":0},\"LightVibrant\":{\"rgb\":[188.7,188.7,188.7],\"population\":0},\"Muted\":{\"rgb\":[124,124,124],\"population\":34},\"DarkMuted\":{\"rgb\":[60,60,60],\"population\":33},\"LightMuted\":{\"rgb\":[188,188,188],\"population\":28}}},\"confirmedLogin\":false,\"hide_intro_popup\":false,\"block_auto_login\":false,\"domainInfo\":{\"isSubstack\":true,\"customDomain\":null},\"experimentFeatures\":{},\"experimentExposures\":{},\"siteConfigs\":{\"score_upsell_email\":\"control\",\"first_chat_email_enabled\":true,\"notes_video_max_duration_minutes\":5,\"reader-onboarding-promoted-pub\":737237,\"new_commenter_approval\":false,\"pub_update_opennode_api_key\":false,\"enable_user_report_review\":true,\"zendesk_automation_cancellations\":false,\"hide_book_a_meeting_button\":false,\"mfa_action_box_enabled\":false,\"publication_max_bylines\":35,\"no_contest_charge_disputes\":false,\"feed_posts_previously_seen_weight\":0.1,\"publication_tabs_reorder\":false,\"comp_expiry_email_new_copy\":\"NONE\",\"free_unlock_required\":false,\"traffic_rule_check_enabled\":false,\"amp_emails_enabled\":false,\"enable_post_summarization\":false,\"live_stream_host_warning_message\":\"\",\"bitcoin_enabled\":false,\"minimum_ios_os_version\":\"17.0.0\",\"show_entire_square_image\":false,\"hide_subscriber_count\":false,\"publication_author_display_override\":\"\",\"ios_webview_payments_enabled\":\"control\",\"generate_pdf_tax_report\":false,\"show_generic_post_importer\":false,\"enable_pledges_modal\":true,\"include_pdf_invoice\":false,\"app_upsell_after_posting_notes\":\"experiment\",\"notes_weight_watch_video\":5,\"use_post_podcast_import_batching\":true,\"meetings_v1\":false,\"exempt_from_gtm_filter\":false,\"group_sections_and_podcasts_in_menu\":false,\"boost_optin_modal_enabled\":true,\"standards_and_enforcement_features_enabled\":false,\"pub_creation_captcha_behavior\":\"risky_pubs_or_rate_limit\",\"post_blogspot_importer\":false,\"notes_weight_short_item_boost\":0.15,\"pub_tts_override\":\"default\",\"disable_monthly_subscriptions\":false,\"skip_welcome_email\":false,\"chat_reader_thread_notification_default\":false,\"scheduled_pinned_posts\":false,\"disable_redirect_outbound_utm_params\":false,\"reader_gift_referrals_enabled\":true,\"enable_bestseller_survey_modal\":false,\"dont_show_guest_byline\":false,\"like_comments_enabled\":true,\"subscription_bar_all_debug_enabled\":false,\"temporal_livestream_ended_draft\":true,\"enable_author_note_email_toggle\":false,\"meetings_embed_publication_name\":false,\"fallback_to_archive_search_on_section_pages\":false,\"livekit_track_egress_custom_base_url\":\"http://livekit-egress-custom-recorder-participant-test.s3-website-us-east-1.amazonaws.com\",\"people_you_may_know_algorithm\":\"experiment\",\"welcome_screen_blurb_override\":\"\",\"post_recipients_batch_limit\":1000,\"like_posts_enabled\":true,\"twitter_player_card_enabled\":true,\"dpn_weight_share\":1,\"feed_promoted_user\":false,\"writer_beta_android_enable_post_editor_v2\":false,\"show_note_stats_for_all_notes\":false,\"section_specific_csv_imports_enabled\":false,\"disable_podcast_feed_description_cta\":false,\"bypass_profile_substack_logo_detection\":false,\"use_preloaded_player_sources\":false,\"list_pruning_enabled\":false,\"facebook_connect\":false,\"opt_in_to_sections_during_subscribe\":false,\"underlined_colored_links\":false,\"rate_limit_live_reaction_messages_v3\":\"16ps\",\"modal_rec_variant_user\":\"control\",\"extract_stripe_receipt_url\":false,\"enable_aligned_images\":false,\"max_image_upload_mb\":64,\"enable_android_dms_writer_beta\":false,\"threads_suggested_ios_version\":null,\"pledges_disabled\":false,\"threads_minimum_ios_version\":812,\"hide_podcast_email_setup_link\":false,\"subscribe_captcha_behavior\":\"default\",\"publication_ban_sample_rate\":0,\"grant_viral_gifts_to_gift_recipients\":\"experiment\",\"ios_enable_publication_activity_tab\":false,\"custom_themes_substack_subscribe_modal\":false,\"share_viral_gift_as_link\":\"experiment\",\"opt_in_to_sections_during_subscribe_include_main_pub_newsletter\":false,\"continue_support_cta_in_newsletter_emails\":false,\"bloomberg_syndication_enabled\":false,\"lists_enabled\":false,\"ios_feed_media_content_mode\":\"fit\",\"generated_database_maintenance_mode\":false,\"allow_document_freeze\":false,\"subscription_bar_all_debug_subdomains\":null,\"podcast_main_feed_is_firehose\":false,\"pub_app_incentive_gift\":\"\",\"no_embed_redirect\":false,\"translate_mobile_app\":false,\"customized_email_from_name_for_new_follow_emails\":\"treatment\",\"spotify_open_access_sandbox_mode\":false,\"dpn_weight_follow_or_subscribe\":1,\"fullstory_enabled\":false,\"chat_reply_poll_interval\":3,\"enable_reader_marketing_page\":false,\"force_pub_links_to_use_subdomain\":false,\"always_show_cookie_banner\":false,\"hide_media_download_option\":false,\"hide_post_restacks\":false,\"feed_item_source_debug_mode\":false,\"writer_beta_android_enable_post_editor\":false,\"thefp_enable_account_menu\":false,\"enable_user_status_ui\":false,\"publication_homepage_title_display_override\":\"\",\"pub_banned_word_list\":\"\",\"post_preview_highlight_byline\":false,\"4k_video\":false,\"bypass_unlock_token_limit\":false,\"post_metering_enabled\":false,\"notifications_disabled\":\"\",\"cross_post_notification_threshold\":1000,\"facebook_connect_prod_app\":true,\"feed_enable_live_streams\":false,\"force_into_pymk_ranking\":false,\"minimum_android_version\":756,\"enable_transcription_translations\":false,\"ios_post_video_pager_alpha_enabled\":false,\"use_og_image_as_twitter_image_for_post_previews\":false,\"always_use_podcast_channel_art_as_episode_art_in_rss\":false,\"cookie_preference_middleware_enabled\":false,\"seo_tier_override\":\"NONE\",\"social_media_follower_thresholds_for_alerts\":\"750000|750000|750000\",\"no_follow_links\":false,\"publisher_api_enabled\":false,\"zendesk_support_priority\":\"default\",\"enable_post_clips_stats\":false,\"enable_subscriber_referrals_awards\":true,\"ios_profile_themes_feed_permalink_enabled\":false,\"use_publication_language_for_transcription\":false,\"show_substack_funded_gifts_tooltip\":true,\"disable_ai_transcription\":false,\"thread_permalink_preview_min_ios_version\":4192,\"feed_main_disabled\":false,\"android_toggle_on_website_enabled\":false,\"internal_android_enable_post_editor\":false,\"edit_profile_feed_item\":false,\"updated_inbox_ui\":false,\"web_reader_podcasts_tab\":false,\"use_temporal_thumbnail_selection_workflow\":false,\"live_stream_creation_enabled\":false,\"disable_card_element_in_europe\":false,\"enable_web_typing_indicators\":false,\"web_vitals_sample_rate\":0,\"allow_live_stream_auto_takedown\":\"true\",\"search_ranker_variant\":\"control\",\"partner_data_api_enabled\":false,\"ai_image_generation_enabled\":true,\"disable_personal_substack_initialization\":false,\"section_specific_welcome_pages\":false,\"local_payment_methods\":\"control\",\"feed_post_score_scale_factor\":0.1,\"posts_in_rss_feed\":20,\"post_rec_endpoint\":\"\",\"publisher_dashboard_section_selector\":false,\"reader_surveys_platform_question_order\":\"36,1,4,2,3,5,6,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35\",\"ios_toggle_on_website_enabled\":false,\"login_guard_app_link_in_email\":true,\"modal_rec_variant_content\":\"control\",\"monthly_sub_is_one_off\":false,\"unread_notes_activity_digest\":\"control\",\"display_cookie_settings\":false,\"welcome_page_query_params\":false,\"enable_free_podcast_urls\":false,\"comp_expiry_emails_disabled\":false,\"enable_description_on_polls\":false,\"use_microlink_for_instagram_embeds\":false,\"post_notification_batch_delay_ms\":30000,\"free_signup_confirmation_behavior\":\"with_email_validation\",\"social_context_in_pymk_feed_module_v2\":\"treatment-nofacepile\",\"ios_post_stats_for_admins\":false,\"live_stream_concurrent_viewer_count_drawer\":false,\"use_livestream_post_media_composition\":true,\"section_specific_preambles\":false,\"android_live_stream_multihost_enabled\":false,\"show_menu_on_posts\":false,\"app_upsell_follow_prompt\":\"control\",\"ios_post_subscribe_web_routing\":true,\"opt_into_all_trending_topics\":false,\"ios_writer_stats_public_launch_v2\":false,\"min_size_for_phishing_check\":1,\"enable_android_post_stats\":false,\"ios_chat_revamp_enabled\":false,\"app_onboarding_survey_email\":false,\"post_notification_batch_chunk_size\":100,\"thefp_enable_pullquote_alignment\":false,\"thefp_enable_pullquote_color\":false,\"republishing_enabled\":false,\"app_mode\":false,\"show_phone_banner\":false,\"live_stream_video_enhancer\":\"internal\",\"enable_author_pages\":false,\"enable_decagon_chat\":true,\"first_month_upsell\":\"control\",\"new_user_checklist_enabled\":\"use_follower_count\",\"enable_updated_webview_checkout\":false,\"show_attached_profile_for_pub_setting\":false,\"welcome_page_update_desktop_visuals_limited\":\"experiment\",\"rss_verification_code\":\"\",\"notification_post_emails\":\"experiment\",\"ios_profile_subdomain_chips\":true,\"chat_suppress_contributor_push_option_enabled\":false,\"live_stream_invite_ttl_seconds\":600,\"feed_ranking_per_post_clip_cap\":2,\"export_hooks_enabled\":false,\"audio_encoding_bitrate\":null,\"bestseller_pub_override\":false,\"extra_seats_coupon_type\":false,\"post_subdomain_universal_links\":false,\"post_import_max_file_size\":26214400,\"notes_weight_follow\":4,\"livekit_reconnect_slate_url\":\"https://mux-livestream-assets.s3.us-east-1.amazonaws.com/custom-disconnect-slate-tall.png\",\"exclude_from_pymk_suggestions\":false,\"minimum_ios_version\":2200,\"disable_annual_subscriptions\":false,\"enable_bestseller_survey_modal_override\":false,\"live_stream_guest_overlay\":\"experiment\",\"enable_android_dms\":false,\"non_mfa_password_login_guard\":\"block_suspicious\",\"feed_ranker_use_user_comment_reaction_cache\":true,\"pub_auto_moderation_enabled\":false,\"disable_live_stream_ai_trimming_by_default\":false,\"recipes_enabled\":false,\"disable_deletion\":false,\"ios_default_coupon_enabled\":false,\"notes_weight_read_post\":5,\"notes_weight_reply\":3,\"livekit_egress_custom_base_url\":\"http://livekit-egress-custom-recorder.s3-website-us-east-1.amazonaws.com\",\"clip_focused_video_upload_flow\":false,\"live_stream_max_guest_users\":2,\"enable_video_seo_data\":false,\"can_reimport_unsubscribed_users_with_2x_optin\":false,\"feed_posts_weight_subscribed\":0,\"included_in_demo_feed\":false,\"live_event_mixin\":\"\",\"review_incoming_email\":\"default\",\"app_install_prompts\":\"native_banner_if_supported\",\"enable_founding_gifts\":false,\"ios_chat_uikit\":false,\"enable_sponsorship_campaigns\":false,\"thread_permalink_preview_min_android_version\":2037,\"tabbed_notes_search\":\"control\",\"enable_home_screen_nav_bar_hiding_ios\":false,\"default_thumbnail_time\":10,\"pub_ranking_weight_immediate_engagement\":1,\"pub_ranking_weight_retained_engagement\":1,\"load_test_unichat\":false,\"notes_read_post_baseline\":0,\"live_stream_head_alignment_guide\":false,\"show_open_post_as_pdf_button\":false,\"free_press_combo_subscribe_flow_enabled\":false,\"restack_with_image\":false,\"free_press_tabbed_subscribe_flow\":\"control\",\"gift_from_substack_modal\":\"experiment\",\"gifts_from_substack_feature_available\":true,\"disable_ai_clips\":false,\"thefp_enable_web_livestream_kicking\":false,\"enable_elevenlabs_voiceovers\":false,\"use_snowflake_crm_bool\":true,\"android_upgrade_alert_dialog\":true,\"headline_testing_enabled\":true,\"translated_notifications_enabled\":false,\"show_simple_post_editor\":false,\"enable_live_stream_auto_publish_flow\":true,\"social_media_follower_thresholds_for_vitally_tag\":\"5000|5000|5000\",\"search_ranker_query_augmentation\":\"enabled\",\"enable_publication_podcasts_page\":false,\"ios_payment_connection_enabled\":true,\"app_install_reminder_email\":\"experiment\",\"use_landscape_livestream_for_post_draft\":false,\"use_growth_stats_tab_as_primary\":false,\"live_stream_install_app_reminders_enabled\":true,\"use_unified_livestream_workflow\":true,\"thefp_enable_america_250\":true,\"ios_note_composer_settings_enabled\":false,\"android_v2_post_video_player_enabled\":false,\"enable_direct_message_request_bypass\":false,\"enable_apple_news_sync\":false,\"postsById_batch_size\":20,\"banned_image_generation_word_list\":\"nude, naked, unclothed, undressed, withoutclothes, sex, sexy, erotic, topless, bottomless, barechest, barebody, scantilyclad, suggestive, lingerie, bikini, underwear, panties, bra, thong, porn, pornographic, provocative, orgy, fetish, kinky, bdsm, domination, submission, lewd, explicit, genitals, penis, vagina, buttocks, anus, breasts, nipples, areola, privateparts, crotch, pubicarea, thighgap, intercourse, masturbation, ejaculation, penetration, moaning, groping, fondling, exposing, stripping, flashing, adultcontent, XXX, NSFW, OnlyFans, camgirl, escort, prostitute, callgirl, massage, striptease, ass, busty, strip, stripclub, tits, spanking, pawg, bimbo, crotch, succubus, seductive\",\"free_press_newsletter_promo_enabled\":false,\"enable_ios_livestream_stats\":false,\"disable_live_stream_reactions\":false,\"enable_high_follower_dm\":true,\"ios_welcome_video_profile_prompt\":false,\"clip_generation_3rd_party_vendor\":\"internal\",\"ios_notification_settings_enabled\":false,\"notification_quality_filter_enabled\":false,\"notes_weight_negative\":1,\"ios_discover_tab_min_installed_date\":\"2025-06-09T16:56:58+0000\",\"notes_weight_click_see_more\":2,\"notification_quality_filter_threshold\":0.5,\"edit_profile_theme_colors\":false,\"backend_enable_subscription_bar\":true,\"disable_clipping_for_readers\":false,\"android_enable_subscription_bar\":false,\"apple_fee_percent\":15,\"allow_anonymous_personal_pub_creation\":false,\"feed_posts_weight_reply\":3,\"feed_posts_weight_negative\":5,\"feed_posts_weight_like\":1.5,\"feed_posts_weight_share\":3,\"feed_posts_weight_save\":3,\"use_snowflake_crm_rollout_percentage\":1,\"feed_posts_weight_sign_up\":4,\"live_stream_video_degradation_preference\":\"maintainFramerate\",\"render_high_quality_clips\":false,\"android_enable_publication_activity_tab\":false,\"clips_in_feed_headlines\":\"experiment\",\"pause_app_badges\":false,\"notes_weight_like\":2,\"profile_feed_expanded_inventory\":false,\"phone_verification_fallback_to_twilio\":false,\"livekit_mux_latency_mode\":\"low\",\"feed_posts_weight_long_click\":1,\"feed_juiced_user\":0,\"vertical_video_player_in_feed_1\":\"experiment\",\"show_branded_intro_setting\":true,\"use_growth_stats_tab\":false,\"free_press_single_screen_subscribe_flow_enabled\":false,\"notes_click_see_more_baseline\":0.35,\"android_edit_user_links\":true,\"ios_auto_advance_short_form_video\":\"control\",\"use_advanced_commerce_api_for_iap\":false,\"skip_free_preview_language_in_podcast_notes\":false,\"larger_wordmark_on_publication_homepage\":false,\"video_editor_full_screen\":false,\"enable_mobile_stats_for_admins\":false,\"allowed_email_domains\":\"\",\"ios_profile_themes_note_composer_enabled\":false,\"reduce_post_search_fuzziness\":\"treatment\",\"related_posts_web\":\"experiment\",\"notes_weight_click_item\":3,\"enable_milestone_notifications\":true,\"notes_weight_long_visit\":1,\"notes_watch_video_baseline\":0.08,\"social_media_follower_thresholds_for_auto_dm\":\"10000|10000|10000\",\"ios_pymk_subscribe\":\"control\",\"add_section_and_tag_metadata\":false,\"daily_promoted_notes_enabled\":true,\"feed_ranker_use_user_feed_restack_comment_cache\":true,\"enable_islands_cms\":false,\"enable_livestream_combined_stats\":false,\"post_share_assets_notification\":\"control\",\"dashboard_chat_enabled\":true,\"enable_drip_campaigns\":false,\"ios_offline_mode_enabled\":false,\"post_management_search_engine\":\"elasticsearch\",\"new_bestseller_leaderboard_feed_item_enabled\":false,\"suggested_search_prediction_markets_fetch_disabled\":false,\"enable_account_settings_revamp\":false,\"ios_viral_gift_entry_points\":\"experiment\",\"thefp_enable_fp_recirc_block\":false,\"ios_web_subscription_payments\":\"experiment\",\"ios_full_search_results\":\"control\",\"enable_debug_logs_ios\":false,\"show_pub_content_on_profile_for_pub_id\":0,\"use_mux_assets_for_livestream_ended_draft\":true,\"show_pub_content_on_profile\":false,\"livekit_track_egress\":true,\"video_tab_mixture_pattern\":\"npnnnn\",\"enable_theme_contexts\":false,\"onboarding_suggestions_search\":\"experiment\",\"feed_tuner_enabled\":false,\"enable_arr_milestone_notifications\":true,\"enable_pledges_milestone_notifications\":true,\"livekit_mux_latency_mode_rtmp\":\"low\",\"notes_weight_follow_boost\":3,\"iap_broad_launch_enabled\":false,\"dpn_weight_like\":2,\"suggested_search_metadata\":false,\"accessible_live_stream_end_button\":false,\"daily_promoted_notes_skipped_author_ids\":\"36419707,116060846,310933753,6485460,263729966,44182675,309355742,31686779,48009465,145856307,41359798,69552,213248354,298735086,364097960,321670521,330239969,221511238,320699447,363618587,329004483,228848922,112253164,157953275,257688178,17256371,32320638,174769549,250149022\",\"subscription_bar_top_selection_strategy_v2\":\"destination_wau_pub_score\",\"enable_live_stream_audio_enhancements_flow\":false,\"suggested_search_merges\":null,\"android_onboarding_progress_persistence\":\"control\",\"dpn_weight_tap\":5,\"ios_custom_buttons_enabled\":true,\"ios_livestream_feedback\":false,\"dpn_weight_negative\":1,\"activity_item_quality_filter_queue_enabled\":false,\"ios_iap_opt_out_enabled\":false,\"post_notification_quality_filter_enabled\":false,\"post_notification_quality_filter_threshold\":0.5,\"dpn_weight_reply\":1,\"new_user_subscribe_follow_prompt_v4\":\"control\",\"android_subscription_queue_experiment\":\"experiment\",\"ios_app_super_optimized_share_sheet\":\"treatment_optimized\",\"create_clips_with_headlines\":true,\"enable_speaker_focus_clips\":false,\"score_push_notifications_enabled\":true,\"ios_subscription_pogs\":\"experiment\",\"new_dashboard_overview_enabled\":false,\"use_elasticsearch_for_category_tabs\":\"control\",\"enable_subscribers_milestone_notifications\":true,\"enable_apns_app_badges\":\"experiment\",\"android_enable_edit_profile_theme\":false,\"android_enable_view_profile_theme\":false,\"dpn_weight_follow\":3,\"live_stream_audio_enhancer_v2\":\"auphonic\",\"iap_announcement_blog_url\":\"\",\"recent_note_in_related_notes\":\"experiment\",\"search_ranker_load_test_pct\":10,\"inline_note_reply_experiment\":\"treatment\",\"post_quality_filter_queue_enabled\":false,\"search_ranker_load_test_ranking_window\":500,\"ios_new_post_sharing_flow_enabled\":false,\"activity_item_experiment_filter_threshold\":0.18,\"ignore_video_in_notes_length_limit\":false,\"activity_item_quality_filter_experiment_v2\":\"control\",\"notes_weight_click_share\":3,\"direct_device_push_notifications\":false,\"inline_note_reply_bar\":true,\"allow_long_videos\":true,\"suggested_searches\":\"\",\"dpn_score_threshold\":0,\"mailgun_events_backfill_timestamp\":\"2025-04-30 00:00:00\",\"ios_post_subscribe_follow_related\":\"control\",\"use_intro_clip_and_branded_intro_by_default\":false,\"phone_verification_banned_countries\":\"PH, BD, UA, PK, UZ, ID, MA, KG, ML, AZ, GT, SN, BZ, EG, MM, VN, ZW, NG, JO, RU, MY, KE, CN, MZ, TZ, MW, ZM, KH, VE, CF, GH, GA, AO, BF, SY, TJ, KW, CI, KM, PS, IL, BI, LY, ET, TL, HN, BG, MG, CU, IR, GN, UG, SI\",\"publisher_banner\":\"\",\"new_user_subscribe_follow_prompt_override\":\"none\",\"dpn_weight_open\":2.5,\"ios_subscription_pogs_new_users\":\"experiment\",\"ios_subscription_pogs_old_users\":\"experiment\",\"android_subscription_queue_experiment_2\":\"experiment\",\"enable_viewing_all_livestream_viewers\":false,\"ios_inbox_tab_icon_experiment\":\"treatment_tray\",\"suggested_search_exclusions\":\"South Park,3 Silly Facts Challenge,feast of the assumption,Feast of the Assumption\",\"dpn_ranking_enabled\":true,\"sequential_retrieval_model_pct\":100,\"maximum_affinity_index_for_trending_topic_notification\":0,\"dpn_weight_long_session\":2,\"dpn_weight_restack\":1,\"dpn_model_variant\":\"experiment\",\"ios_notification_popup_cta\":\"control\",\"dashboard_payments_tab\":true,\"skip_default_welcome_email_for_app_users\":\"control\",\"post_quality_filter_experiment_v2\":\"control\",\"dpn_weight_disable\":1,\"android_vertical_post_player\":\"control\",\"new_note_communication_notification_experiment\":\"control\",\"blocked_email_domains\":\"nastyx.com,heweek.com,marchub.com,wesolar.io,cetnob.com,asaud.com,sigmazon.com,ofionk.com,degcos.com,janfab.com,obisims.com,esterace.com,barakal.com,coloruz.com,rogtat.com,ploncy.com,konetas.com,pelagius.net,teeuk.com,laafd.com,vjuum.com,txcct.com,rteet.com,dpptd.com,funvahnuwa.com,btcmod.com,vtext.com,tmomail.net,txt.att.net,vzwpix.com,mms.att.net,mymetropcs.com,messaging.sprintpcs.com,txt.bell.ca,mms.cricketwireless.net,msg.telus.com,pm.sprint.com,deliverydaily.org,allfreemail.net,gufum.com,yopmail.com,mailshan.com,reybenz.com,any.pink,cmail.asia,tempmailt.com,t-mail.asia,temp-mail.asia,otprmail.com,umail.asia,pmail.asia,enrmail.com,neert.com,okyre.com,ston-drop.com,ficbook.sbs,findw.cfd,fnisaojcsdijc.cc,fsadcsdcas.cc,grtsfedmoxksc.one,nvodoasods.cc,rtefadwsazc.cc,stobma.one,findw.cfd,a1.findw.cfd,a2.ston-drop.com,mdhnzsqo.findw.cfd,qrfxaqcc.findw.cfd,dksyl.findw.cfd,dbsoexv.findw.cfd\",\"webview_app_upsell_twitter\":\"control\"},\"publicationSettings\":{\"block_ai_crawlers\":false,\"credit_token_enabled\":true,\"custom_tos_and_privacy\":false,\"did_identity\":null,\"disable_optimistic_bank_payments\":false,\"display_welcome_page_details\":true,\"enable_meetings\":false,\"payment_pledges_enabled\":true,\"enable_post_page_conversion\":true,\"enable_prev_next_nav\":false,\"enable_restacking\":true,\"gifts_from_substack_disabled\":false,\"google_analytics_4_token\":null,\"group_sections_and_podcasts_in_menu_enabled\":false,\"live_stream_homepage_visibility\":\"contributorsAndAdmins\",\"live_stream_homepage_style\":\"autoPlay\",\"medium_length_description\":\"Deep (Learning) Focus is a newsletter that focuses on research in deep learning and artificial intelligence. Each edition picks a single topic and covers a variety of publications in this area. Despite covering cutting-edge topics in AI research, the newsletter is accessible even for beginners, as it contextualizes each topic with discussions of relevant background information. Deep (Learning) Focus inspires new ideas and research directions by making AI understandable. \",\"notes_feed_enabled\":true,\"paywall_unlock_tokens\":true,\"post_preview_crop_gravity\":\"center\",\"reader_referrals_enabled\":false,\"reader_referrals_leaderboard_enabled\":false,\"seen_coming_soon_explainer\":false,\"seen_google_analytics_migration_modal\":false,\"local_currency_modal_seen\":true,\"local_payment_methods_modal_seen\":false,\"twitter_pixel_signup_event_id\":null,\"twitter_pixel_subscribe_event_id\":null,\"use_local_currency\":true,\"welcome_page_opt_out_text\":\"No thanks\",\"cookie_settings\":\"\",\"show_restacks_below_posts\":true,\"holiday_gifting_post_header\":true,\"homepage_message_text\":\"\",\"homepage_message_link\":\"\",\"about_us_author_ids\":\"\",\"archived_section_ids\":\"\",\"column_section_ids\":\"\",\"fp_primary_column_section_ids\":\"\",\"event_section_ids\":\"\",\"podcasts_metadata\":\"\",\"video_section_ids\":\"\",\"post_metering_enabled\":false},\"publicationUserSettings\":null,\"userSettings\":{\"user_id\":null,\"activity_likes_enabled\":true,\"artist_mode_enabled\":false,\"dashboard_nav_refresh_enabled\":false,\"hasDismissedSectionToNewsletterRename\":false,\"is_guest_post_enabled\":true,\"feed_web_nux_seen_at\":null,\"has_seen_select_to_restack_tooltip_nux\":false,\"invite_friends_nux_dismissed_at\":null,\"suggestions_feed_item_last_shown_at\":null,\"has_seen_select_to_restack_modal\":false,\"last_home_tab\":null,\"last_notification_alert_shown_at\":null,\"disable_reply_hiding\":false,\"newest_seen_chat_item_published_at\":null,\"explicitContentEnabled\":false,\"contactMatchingEnabled\":false,\"messageRequestLevel\":\"everyone\",\"liveStreamAcceptableInviteLevel\":\"everyone\",\"liveStreamAcceptableChatLevel\":\"everyone\",\"creditTokensTreatmentExposed\":false,\"appBadgeIncludesChat\":false,\"autoPlayVideo\":true,\"smart_delivery_enabled\":false,\"chatbotTermsLastAcceptedAt\":null,\"has_seen_notes_post_app_upsell\":false,\"substack_summer_nux_dismissed_at\":null,\"first_note_id\":null,\"show_concurrent_live_stream_viewers\":false,\"has_dismissed_fp_download_pdf_nux\":false,\"edit_profile_feed_item_dismissed_at\":null,\"mobile_permalink_app_upsell_seen_at\":null,\"new_user_checklist_enabled\":false,\"new_user_follow_subscribe_prompt_dismissed_at\":null,\"has_seen_youtube_shorts_auto_publish_announcement\":false,\"notificationQualityFilterEnabled\":true},\"subscriberCountDetails\":\"tens of thousands of subscribers\",\"mux_env_key\":\"u42pci814i6011qg3segrcpp9\",\"sentry_environment\":\"production\",\"launchWelcomePage\":false,\"pendingInviteForActiveLiveStream\":null,\"noIndex\":false,\"post\":{\"audience\":\"everyone\",\"audience_before_archived\":null,\"canonical_url\":\"https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up\",\"default_comment_sort\":null,\"editor_v2\":false,\"exempt_from_archive_paywall\":false,\"free_unlock_required\":false,\"id\":135824233,\"podcast_art_url\":null,\"podcast_duration\":null,\"podcast_preview_upload_id\":null,\"podcast_upload_id\":null,\"podcast_url\":\"\",\"post_date\":\"2023-08-14T09:12:59.401Z\",\"updated_at\":\"2025-03-19T16:38:55.961Z\",\"publication_id\":1092659,\"search_engine_description\":null,\"search_engine_title\":null,\"section_id\":null,\"should_send_free_preview\":false,\"show_guest_bios\":true,\"slug\":\"llama-2-from-the-ground-up\",\"social_title\":null,\"subtitle\":\"Everything you need to know about the best open-source LLM on the market...\",\"teaser_post_eligible\":true,\"title\":\"LLaMA-2 from the Ground Up\",\"type\":\"newsletter\",\"video_upload_id\":null,\"write_comment_permissions\":\"everyone\",\"meter_type\":\"none\",\"live_stream_id\":null,\"is_published\":true,\"restacks\":6,\"reactions\":{\"\u2764\":44},\"top_exclusions\":[],\"pins\":[],\"section_pins\":[],\"has_shareable_clips\":false,\"previous_post_slug\":\"the-history-of-open-source-llms-imitation\",\"next_post_slug\":\"tree-of-thoughts-prompting\",\"cover_image\":\"https://substack-post-media.s3.amazonaws.com/public/images/ed09de03-e101-4d2c-83d8-a21fc2881274_2208x1240.png\",\"cover_image_is_square\":false,\"cover_image_is_explicit\":false,\"videoUpload\":null,\"podcastFields\":{\"post_id\":135824233,\"podcast_episode_number\":null,\"podcast_season_number\":null,\"podcast_episode_type\":null,\"should_syndicate_to_other_feed\":null,\"syndicate_to_section_id\":null,\"hide_from_feed\":false,\"free_podcast_url\":null,\"free_podcast_duration\":null},\"podcastUpload\":null,\"podcastPreviewUpload\":null,\"voiceover_upload_id\":null,\"voiceoverUpload\":null,\"has_voiceover\":false,\"description\":\"Everything you need to know about the best open-source LLM on the market...\",\"body_html\":\"<div class=\\\"captioned-image-container\\\"><figure><a class=\\\"image-link image2 is-viewable-img\\\" target=\\\"_blank\\\" href=\\\"https://substackcdn.com/image/fetch/$s_!jFdK!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff3464668-f880-4091-a4f0-0c26bfe9f4c9_2134x1182.png\\\" data-component-name=\\\"Image2ToDOM\\\"><div class=\\\"image2-inset\\\"><picture><source type=\\\"image/webp\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!jFdK!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff3464668-f880-4091-a4f0-0c26bfe9f4c9_2134x1182.png 424w, https://substackcdn.com/image/fetch/$s_!jFdK!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff3464668-f880-4091-a4f0-0c26bfe9f4c9_2134x1182.png 848w, https://substackcdn.com/image/fetch/$s_!jFdK!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff3464668-f880-4091-a4f0-0c26bfe9f4c9_2134x1182.png 1272w, https://substackcdn.com/image/fetch/$s_!jFdK!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff3464668-f880-4091-a4f0-0c26bfe9f4c9_2134x1182.png 1456w\\\" sizes=\\\"100vw\\\"><img src=\\\"https://substackcdn.com/image/fetch/$s_!jFdK!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff3464668-f880-4091-a4f0-0c26bfe9f4c9_2134x1182.png\\\" width=\\\"1456\\\" height=\\\"806\\\" data-attrs=\\\"{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/f3464668-f880-4091-a4f0-0c26bfe9f4c9_2134x1182.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:806,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:878634,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:false,&quot;topImage&quot;:true,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}\\\" class=\\\"sizing-normal\\\" alt=\\\"\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!jFdK!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff3464668-f880-4091-a4f0-0c26bfe9f4c9_2134x1182.png 424w, https://substackcdn.com/image/fetch/$s_!jFdK!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff3464668-f880-4091-a4f0-0c26bfe9f4c9_2134x1182.png 848w, https://substackcdn.com/image/fetch/$s_!jFdK!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff3464668-f880-4091-a4f0-0c26bfe9f4c9_2134x1182.png 1272w, https://substackcdn.com/image/fetch/$s_!jFdK!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff3464668-f880-4091-a4f0-0c26bfe9f4c9_2134x1182.png 1456w\\\" sizes=\\\"100vw\\\" fetchpriority=\\\"high\\\"></picture><div class=\\\"image-link-expand\\\"><div class=\\\"pencraft pc-display-flex pc-gap-8 pc-reset\\\"><div class=\\\"pencraft pc-reset icon-container restack-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-refresh-cw\\\"><path d=\\\"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8\\\"></path><path d=\\\"M21 3v5h-5\\\"></path><path d=\\\"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16\\\"></path><path d=\\\"M8 16H3v5\\\"></path></svg></div><div class=\\\"pencraft pc-reset icon-container view-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-maximize2\\\"><polyline points=\\\"15 3 21 3 21 9\\\"></polyline><polyline points=\\\"9 21 3 21 3 15\\\"></polyline><line x1=\\\"21\\\" x2=\\\"14\\\" y1=\\\"3\\\" y2=\\\"10\\\"></line><line x1=\\\"3\\\" x2=\\\"10\\\" y1=\\\"21\\\" y2=\\\"14\\\"></line></svg></div></div></div></div></a><figcaption class=\\\"image-caption\\\">(from [1])</figcaption></figure></div><p>The opeurce AI research community has heavily explored the creation of open-source, commercially-usable large language models (LLMs). Although a variety of such models perform well, none stand out quite like LLaMA-2 [1], a suite of recently-proposed open-source language models with sizes ranging from 7 to 70 billion parameters. Compared to their predecessors (i.e., <a href=\\\"https://cameronrwolfe.substack.com/p/llama-llms-for-everyone\\\">LLaMA-1</a> [2]), LLaMA-2 models differentiate themselves by pre-training over more data, using a longer <a href=\\\"https://cameronrwolfe.substack.com/i/117151147/the-context-window\\\">context length</a>, and adopting an architecture that is optimized for faster inference. Additionally, LLaMA-2 goes beyond prior research in open-source LLMs by investing heavily into the models\u2019 alignment process, which is used to create LLaMA-2-Chat models that are optimized for dialogue applications and nearly match the quality of top proprietary LLMs (e.g., ChatGPT and GPT-4) in certain areas. Within this overview, we will explore the details of LLaMA-2 and build an in-depth understanding of these models starting from basic concepts.</p><blockquote><p><em>\u201CThere have been public releases of pre-trained LLMs (such as BLOOM) that match the performance of closed pre-trained competitors like GPT-3 and Chinchilla, but none of these models are suitable substitutes for closed product LLMs, such as ChatGPT, BARD, and Claude.\u201D </em>- from [14]</p></blockquote><p><strong>Language model fundamentals. </strong>Throughout this overview, we will try to build an understanding of relevant concepts from the ground up (sometimes providing links for further reading for the purpose of brevity). However, we will not cover fundamentals with respect to how language models work in general. For these details, I highly recommend reading the resources below:</p><ul><li><p>The transformer architecture [<a href=\\\"http://jalammar.github.io/illustrated-transformer/\\\">link</a>]</p></li><li><p>Decoder-only transformer architecture [<a href=\\\"https://twitter.com/cwolferesearch/status/1640446111348555776?s=20\\\">link</a>]</p></li><li><p>Language modeling (next-token prediction) objective [<a href=\\\"https://cameronrwolfe.substack.com/i/135273362/the-language-modeling-objective\\\">link</a>]</p></li><li><p>Prompting language models [<a href=\\\"https://cameronrwolfe.substack.com/p/practical-prompt-engineering-part\\\">link</a>]</p></li><li><p>Specialized language models [<a href=\\\"https://cameronrwolfe.substack.com/p/specialized-llms-chatgpt-lamda-galactica\\\">link</a>]</p></li><li><p>Decoding (or inference) with a language model [<a href=\\\"https://twitter.com/cwolferesearch/status/1659608476455256078?s=20\\\">link</a>]</p></li></ul><p>Gaining an in-depth understanding of fundamental concepts related to language models is important for understanding this overview. Leveraging this knowledge, we will now build upon these basic concepts to better understand how LLaMA-2 approaches and improves the pre-training and alignment process for LLMs.</p><h2>Model Architecture and Pre-Training</h2><div class=\\\"captioned-image-container\\\"><figure><a class=\\\"image-link image2 is-viewable-img\\\" target=\\\"_blank\\\" href=\\\"https://substackcdn.com/image/fetch/$s_!k3Ps!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fdd8bc0b7-e7b7-4a96-9e00-627ad2ecda20_2232x1362.png\\\" data-component-name=\\\"Image2ToDOM\\\"><div class=\\\"image2-inset\\\"><picture><source type=\\\"image/webp\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!k3Ps!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fdd8bc0b7-e7b7-4a96-9e00-627ad2ecda20_2232x1362.png 424w, https://substackcdn.com/image/fetch/$s_!k3Ps!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fdd8bc0b7-e7b7-4a96-9e00-627ad2ecda20_2232x1362.png 848w, https://substackcdn.com/image/fetch/$s_!k3Ps!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fdd8bc0b7-e7b7-4a96-9e00-627ad2ecda20_2232x1362.png 1272w, https://substackcdn.com/image/fetch/$s_!k3Ps!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fdd8bc0b7-e7b7-4a96-9e00-627ad2ecda20_2232x1362.png 1456w\\\" sizes=\\\"100vw\\\"><img src=\\\"https://substackcdn.com/image/fetch/$s_!k3Ps!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fdd8bc0b7-e7b7-4a96-9e00-627ad2ecda20_2232x1362.png\\\" width=\\\"1456\\\" height=\\\"888\\\" data-attrs=\\\"{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/dd8bc0b7-e7b7-4a96-9e00-627ad2ecda20_2232x1362.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:888,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:386034,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:false,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}\\\" class=\\\"sizing-normal\\\" alt=\\\"\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!k3Ps!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fdd8bc0b7-e7b7-4a96-9e00-627ad2ecda20_2232x1362.png 424w, https://substackcdn.com/image/fetch/$s_!k3Ps!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fdd8bc0b7-e7b7-4a96-9e00-627ad2ecda20_2232x1362.png 848w, https://substackcdn.com/image/fetch/$s_!k3Ps!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fdd8bc0b7-e7b7-4a96-9e00-627ad2ecda20_2232x1362.png 1272w, https://substackcdn.com/image/fetch/$s_!k3Ps!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fdd8bc0b7-e7b7-4a96-9e00-627ad2ecda20_2232x1362.png 1456w\\\" sizes=\\\"100vw\\\"></picture><div class=\\\"image-link-expand\\\"><div class=\\\"pencraft pc-display-flex pc-gap-8 pc-reset\\\"><div class=\\\"pencraft pc-reset icon-container restack-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-refresh-cw\\\"><path d=\\\"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8\\\"></path><path d=\\\"M21 3v5h-5\\\"></path><path d=\\\"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16\\\"></path><path d=\\\"M8 16H3v5\\\"></path></svg></div><div class=\\\"pencraft pc-reset icon-container view-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-maximize2\\\"><polyline points=\\\"15 3 21 3 21 9\\\"></polyline><polyline points=\\\"9 21 3 21 3 15\\\"></polyline><line x1=\\\"21\\\" x2=\\\"14\\\" y1=\\\"3\\\" y2=\\\"10\\\"></line><line x1=\\\"3\\\" x2=\\\"10\\\" y1=\\\"21\\\" y2=\\\"14\\\"></line></svg></div></div></div></div></a><figcaption class=\\\"image-caption\\\">(from [3])</figcaption></figure></div><p>There are many factors that contribute to the utility of LLaMA-2. To begin with, however, the models use a modified (and improved) model architecture and pre-training procedure. Compared to its predecessor, LLaMA-2 has an architecture that is optimized for faster inference and is pre-trained over more data, allowing a broader knowledge base to be formed; see above.</p><h4>Optimized Architecture with Faster Inference</h4><p>LLaMa-2 adopts the model architecture of LLaMA-1 with a few modifications. To understand LLaMA-2\u2019s architecture, we need a working understanding of the transformer architecture in general; see <a href=\\\"https://cameronrwolfe.substack.com/i/85568430/decoder-only-transformers\\\">here</a> for more details on this topic. More specifically, nearly all causal language models adopt the <a href=\\\"https://twitter.com/cwolferesearch/status/1640446111348555776?s=20\\\">decoder-only variant</a> of the transformer architecture. Now, we will study some of the modifications to this architecture that are made by both <a href=\\\"https://cameronrwolfe.substack.com/p/llama-llms-for-everyone\\\">LLaMA</a> [2] and LLaMA-2 [1]. All of these changes apply to both LLaMA and LLaMA-2 unless otherwise specified.</p><div class=\\\"captioned-image-container\\\"><figure><a class=\\\"image-link image2 is-viewable-img\\\" target=\\\"_blank\\\" href=\\\"https://substackcdn.com/image/fetch/$s_!9tyU!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3b6fab4d-7825-47ec-a59e-979d9dfa0384_1256x938.png\\\" data-component-name=\\\"Image2ToDOM\\\"><div class=\\\"image2-inset\\\"><picture><source type=\\\"image/webp\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!9tyU!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3b6fab4d-7825-47ec-a59e-979d9dfa0384_1256x938.png 424w, https://substackcdn.com/image/fetch/$s_!9tyU!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3b6fab4d-7825-47ec-a59e-979d9dfa0384_1256x938.png 848w, https://substackcdn.com/image/fetch/$s_!9tyU!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3b6fab4d-7825-47ec-a59e-979d9dfa0384_1256x938.png 1272w, https://substackcdn.com/image/fetch/$s_!9tyU!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3b6fab4d-7825-47ec-a59e-979d9dfa0384_1256x938.png 1456w\\\" sizes=\\\"100vw\\\"><img src=\\\"https://substackcdn.com/image/fetch/$s_!9tyU!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3b6fab4d-7825-47ec-a59e-979d9dfa0384_1256x938.png\\\" width=\\\"447\\\" height=\\\"333.82643312101914\\\" data-attrs=\\\"{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/3b6fab4d-7825-47ec-a59e-979d9dfa0384_1256x938.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:938,&quot;width&quot;:1256,&quot;resizeWidth&quot;:447,&quot;bytes&quot;:98417,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}\\\" class=\\\"sizing-normal\\\" alt=\\\"\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!9tyU!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3b6fab4d-7825-47ec-a59e-979d9dfa0384_1256x938.png 424w, https://substackcdn.com/image/fetch/$s_!9tyU!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3b6fab4d-7825-47ec-a59e-979d9dfa0384_1256x938.png 848w, https://substackcdn.com/image/fetch/$s_!9tyU!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3b6fab4d-7825-47ec-a59e-979d9dfa0384_1256x938.png 1272w, https://substackcdn.com/image/fetch/$s_!9tyU!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3b6fab4d-7825-47ec-a59e-979d9dfa0384_1256x938.png 1456w\\\" sizes=\\\"100vw\\\" loading=\\\"lazy\\\"></picture><div class=\\\"image-link-expand\\\"><div class=\\\"pencraft pc-display-flex pc-gap-8 pc-reset\\\"><div class=\\\"pencraft pc-reset icon-container restack-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-refresh-cw\\\"><path d=\\\"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8\\\"></path><path d=\\\"M21 3v5h-5\\\"></path><path d=\\\"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16\\\"></path><path d=\\\"M8 16H3v5\\\"></path></svg></div><div class=\\\"pencraft pc-reset icon-container view-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-maximize2\\\"><polyline points=\\\"15 3 21 3 21 9\\\"></polyline><polyline points=\\\"9 21 3 21 3 15\\\"></polyline><line x1=\\\"21\\\" x2=\\\"14\\\" y1=\\\"3\\\" y2=\\\"10\\\"></line><line x1=\\\"3\\\" x2=\\\"10\\\" y1=\\\"21\\\" y2=\\\"14\\\"></line></svg></div></div></div></div></a><figcaption class=\\\"image-caption\\\">LLaMA-2 uses a pre-normalization variant of the normal transformer block</figcaption></figure></div><p><strong>Normalization. </strong>Most transformer architectures adopt <a href=\\\"https://pytorch.org/docs/stable/generated/torch.nn.LayerNorm.html\\\">layer normalization</a>, which is applied after each layer within the transformer block; see above. LLaMA, however, replaces this with a variant called Root Mean Square Layer Normalization (or <a href=\\\"https://github.com/bzhangGo/rmsnorm\\\">RMSNorm</a> for short!), which is a simplified version of layer normalization that has been shown to improve training stability and generalization<a class=\\\"footnote-anchor\\\" data-component-name=\\\"FootnoteAnchorToDOM\\\" id=\\\"footnote-anchor-1\\\" href=\\\"#footnote-1\\\" target=\\\"_self\\\">1</a> [4]. RMSNorm is formulated as shown below.</p><div class=\\\"captioned-image-container\\\"><figure><a class=\\\"image-link image2\\\" target=\\\"_blank\\\" href=\\\"https://substackcdn.com/image/fetch/$s_!S8-H!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbaeeee5e-8cba-426f-9fa4-8666a7e76155_1080x138.png\\\" data-component-name=\\\"Image2ToDOM\\\"><div class=\\\"image2-inset\\\"><picture><source type=\\\"image/webp\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!S8-H!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbaeeee5e-8cba-426f-9fa4-8666a7e76155_1080x138.png 424w, https://substackcdn.com/image/fetch/$s_!S8-H!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbaeeee5e-8cba-426f-9fa4-8666a7e76155_1080x138.png 848w, https://substackcdn.com/image/fetch/$s_!S8-H!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbaeeee5e-8cba-426f-9fa4-8666a7e76155_1080x138.png 1272w, https://substackcdn.com/image/fetch/$s_!S8-H!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbaeeee5e-8cba-426f-9fa4-8666a7e76155_1080x138.png 1456w\\\" sizes=\\\"100vw\\\"><img src=\\\"https://substackcdn.com/image/fetch/$s_!S8-H!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbaeeee5e-8cba-426f-9fa4-8666a7e76155_1080x138.png\\\" width=\\\"463\\\" height=\\\"59.16111111111111\\\" data-attrs=\\\"{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/baeeee5e-8cba-426f-9fa4-8666a7e76155_1080x138.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:138,&quot;width&quot;:1080,&quot;resizeWidth&quot;:463,&quot;bytes&quot;:35449,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}\\\" class=\\\"sizing-normal\\\" alt=\\\"\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!S8-H!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbaeeee5e-8cba-426f-9fa4-8666a7e76155_1080x138.png 424w, https://substackcdn.com/image/fetch/$s_!S8-H!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbaeeee5e-8cba-426f-9fa4-8666a7e76155_1080x138.png 848w, https://substackcdn.com/image/fetch/$s_!S8-H!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbaeeee5e-8cba-426f-9fa4-8666a7e76155_1080x138.png 1272w, https://substackcdn.com/image/fetch/$s_!S8-H!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbaeeee5e-8cba-426f-9fa4-8666a7e76155_1080x138.png 1456w\\\" sizes=\\\"100vw\\\" loading=\\\"lazy\\\"></picture><div></div></div></a></figure></div><p>For LLaMA, a pre-normalization variant of RMSNorm is adopted, meaning that normalization is applied prior to the major layers in a transformer block, rather than after, as shown in the figure above. RMSNorm achieves comparable levels of performance compared to layer norm with a 10-50% improvement in efficiency.</p><p><strong>Activation functions.</strong> LLaMA models adopt the SwiGLU activation function\u2014as opposed to the standard <a href=\\\"https://pytorch.org/docs/stable/generated/torch.nn.ReLU.html\\\">ReLU</a> function adopted by most neural networks\u2014within their feed-forward layers. The SwiGLU activation function can be formulated as follows.</p><div class=\\\"captioned-image-container\\\"><figure><a class=\\\"image-link image2\\\" target=\\\"_blank\\\" href=\\\"https://substackcdn.com/image/fetch/$s_!iFse!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9aec7e3e-45bc-42f1-9e0c-0248bee25263_982x244.png\\\" data-component-name=\\\"Image2ToDOM\\\"><div class=\\\"image2-inset\\\"><picture><source type=\\\"image/webp\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!iFse!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9aec7e3e-45bc-42f1-9e0c-0248bee25263_982x244.png 424w, https://substackcdn.com/image/fetch/$s_!iFse!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9aec7e3e-45bc-42f1-9e0c-0248bee25263_982x244.png 848w, https://substackcdn.com/image/fetch/$s_!iFse!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9aec7e3e-45bc-42f1-9e0c-0248bee25263_982x244.png 1272w, https://substackcdn.com/image/fetch/$s_!iFse!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9aec7e3e-45bc-42f1-9e0c-0248bee25263_982x244.png 1456w\\\" sizes=\\\"100vw\\\"><img src=\\\"https://substackcdn.com/image/fetch/$s_!iFse!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9aec7e3e-45bc-42f1-9e0c-0248bee25263_982x244.png\\\" width=\\\"321\\\" height=\\\"79.75967413441956\\\" data-attrs=\\\"{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/9aec7e3e-45bc-42f1-9e0c-0248bee25263_982x244.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:244,&quot;width&quot;:982,&quot;resizeWidth&quot;:321,&quot;bytes&quot;:60320,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}\\\" class=\\\"sizing-normal\\\" alt=\\\"\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!iFse!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9aec7e3e-45bc-42f1-9e0c-0248bee25263_982x244.png 424w, https://substackcdn.com/image/fetch/$s_!iFse!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9aec7e3e-45bc-42f1-9e0c-0248bee25263_982x244.png 848w, https://substackcdn.com/image/fetch/$s_!iFse!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9aec7e3e-45bc-42f1-9e0c-0248bee25263_982x244.png 1272w, https://substackcdn.com/image/fetch/$s_!iFse!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9aec7e3e-45bc-42f1-9e0c-0248bee25263_982x244.png 1456w\\\" sizes=\\\"100vw\\\" loading=\\\"lazy\\\"></picture><div></div></div></a></figure></div><p>SwiGLU is an element-wise product of two <a href=\\\"https://mathworld.wolfram.com/LinearTransformation.html\\\">linear transformations</a> of the input <code>x</code>, one of which has had a Swish activation applied to it. This activation function requires three matrix multiplications (i.e., it is more computationally expensive than a normal activation function such as ReLU), but it has been found to yield improvements in performance relative to other activation functions, <em>even when the amount of compute being used is held constant</em>. A more in-depth analysis of potential activation functions for LLMs can be found in [5].</p><p><strong>RoPE.</strong> Instead of using <a href=\\\"https://cameronrwolfe.substack.com/p/language-understanding-with-bert#%C2%A7berts-architecture\\\">absolute</a> or <a href=\\\"https://jaketae.github.io/study/relative-positional-encoding/\\\">relative</a> positional embeddings, LLaMA models adopt a RoPE [6] scheme, which finds a balance between the absolute and relative position of each token in a sequence. This position embedding approach encodes absolute position with a <a href=\\\"https://en.wikipedia.org/wiki/Rotation_matrix\\\">rotation matrix</a> and adds relative position information directly into the <a href=\\\"https://twitter.com/cwolferesearch/status/1641932082283700226?s=20\\\">self-attention operation</a>. The benefit of RoPE embeddings on tasks with longer sequence lengths has led this approach to be adopted by a variety of LLMs (e.g., <a href=\\\"https://cameronrwolfe.substack.com/p/palm-efficiently-training-massive\\\">PaLM</a> [7] and <a href=\\\"https://cameronrwolfe.substack.com/p/falcon-the-pinnacle-of-open-source\\\">Falcon</a> [8]); read more below.</p><p class=\\\"button-wrapper\\\" data-attrs=\\\"{&quot;url&quot;:&quot;https://blog.eleuther.ai/rotary-embeddings/&quot;,&quot;text&quot;:&quot;Learn about RoPE&quot;,&quot;action&quot;:null,&quot;class&quot;:null}\\\" data-component-name=\\\"ButtonCreateButton\\\"><a class=\\\"button primary\\\" href=\\\"https://blog.eleuther.ai/rotary-embeddings/\\\"><span>Learn about RoPE</span></a></p><div class=\\\"captioned-image-container\\\"><figure><a class=\\\"image-link image2 is-viewable-img\\\" target=\\\"_blank\\\" href=\\\"https://substackcdn.com/image/fetch/$s_!KCGS!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa9b56d4a-69cc-446d-83e1-5359b87ebf8e_2212x816.png\\\" data-component-name=\\\"Image2ToDOM\\\"><div class=\\\"image2-inset\\\"><picture><source type=\\\"image/webp\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!KCGS!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa9b56d4a-69cc-446d-83e1-5359b87ebf8e_2212x816.png 424w, https://substackcdn.com/image/fetch/$s_!KCGS!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa9b56d4a-69cc-446d-83e1-5359b87ebf8e_2212x816.png 848w, https://substackcdn.com/image/fetch/$s_!KCGS!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa9b56d4a-69cc-446d-83e1-5359b87ebf8e_2212x816.png 1272w, https://substackcdn.com/image/fetch/$s_!KCGS!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa9b56d4a-69cc-446d-83e1-5359b87ebf8e_2212x816.png 1456w\\\" sizes=\\\"100vw\\\"><img src=\\\"https://substackcdn.com/image/fetch/$s_!KCGS!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa9b56d4a-69cc-446d-83e1-5359b87ebf8e_2212x816.png\\\" width=\\\"1456\\\" height=\\\"537\\\" data-attrs=\\\"{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/a9b56d4a-69cc-446d-83e1-5359b87ebf8e_2212x816.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:537,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:237783,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}\\\" class=\\\"sizing-normal\\\" alt=\\\"\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!KCGS!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa9b56d4a-69cc-446d-83e1-5359b87ebf8e_2212x816.png 424w, https://substackcdn.com/image/fetch/$s_!KCGS!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa9b56d4a-69cc-446d-83e1-5359b87ebf8e_2212x816.png 848w, https://substackcdn.com/image/fetch/$s_!KCGS!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa9b56d4a-69cc-446d-83e1-5359b87ebf8e_2212x816.png 1272w, https://substackcdn.com/image/fetch/$s_!KCGS!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa9b56d4a-69cc-446d-83e1-5359b87ebf8e_2212x816.png 1456w\\\" sizes=\\\"100vw\\\" loading=\\\"lazy\\\"></picture><div class=\\\"image-link-expand\\\"><div class=\\\"pencraft pc-display-flex pc-gap-8 pc-reset\\\"><div class=\\\"pencraft pc-reset icon-container restack-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-refresh-cw\\\"><path d=\\\"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8\\\"></path><path d=\\\"M21 3v5h-5\\\"></path><path d=\\\"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16\\\"></path><path d=\\\"M8 16H3v5\\\"></path></svg></div><div class=\\\"pencraft pc-reset icon-container view-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-maximize2\\\"><polyline points=\\\"15 3 21 3 21 9\\\"></polyline><polyline points=\\\"9 21 3 21 3 15\\\"></polyline><line x1=\\\"21\\\" x2=\\\"14\\\" y1=\\\"3\\\" y2=\\\"10\\\"></line><line x1=\\\"3\\\" x2=\\\"10\\\" y1=\\\"21\\\" y2=\\\"14\\\"></line></svg></div></div></div></div></a><figcaption class=\\\"image-caption\\\">(from [1])</figcaption></figure></div><p><strong>What is different?</strong> So far, all of the modifications to the normal decoder-only transformer that we have discussed are adopted by both LLaMA and LLaMA-2. However, LLaMA-2 does have a few notable architectural changes compared to its predecessor. First, LLaMA-2 is trained with a longer <a href=\\\"https://cameronrwolfe.substack.com/i/117151147/the-context-window\\\">context length</a> of 4K tokens (i.e., LLaMA was trained with a 2K context length). Additionally, LLaMA-2 adopts grouped query attention (GQA) [9] within each of its layers; see below. This modification is made to speed up the inference process of LLaMA-2 models. </p><div class=\\\"captioned-image-container\\\"><figure><a class=\\\"image-link image2 is-viewable-img\\\" target=\\\"_blank\\\" href=\\\"https://substackcdn.com/image/fetch/$s_!QELC!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8a7dc1e2-e66c-4a30-a0a7-518ae7e3a566_1536x596.png\\\" data-component-name=\\\"Image2ToDOM\\\"><div class=\\\"image2-inset\\\"><picture><source type=\\\"image/webp\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!QELC!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8a7dc1e2-e66c-4a30-a0a7-518ae7e3a566_1536x596.png 424w, https://substackcdn.com/image/fetch/$s_!QELC!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8a7dc1e2-e66c-4a30-a0a7-518ae7e3a566_1536x596.png 848w, https://substackcdn.com/image/fetch/$s_!QELC!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8a7dc1e2-e66c-4a30-a0a7-518ae7e3a566_1536x596.png 1272w, https://substackcdn.com/image/fetch/$s_!QELC!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8a7dc1e2-e66c-4a30-a0a7-518ae7e3a566_1536x596.png 1456w\\\" sizes=\\\"100vw\\\"><img src=\\\"https://substackcdn.com/image/fetch/$s_!QELC!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8a7dc1e2-e66c-4a30-a0a7-518ae7e3a566_1536x596.png\\\" width=\\\"1456\\\" height=\\\"565\\\" data-attrs=\\\"{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/8a7dc1e2-e66c-4a30-a0a7-518ae7e3a566_1536x596.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:565,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:null,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:null,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}\\\" class=\\\"sizing-normal\\\" alt=\\\"\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!QELC!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8a7dc1e2-e66c-4a30-a0a7-518ae7e3a566_1536x596.png 424w, https://substackcdn.com/image/fetch/$s_!QELC!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8a7dc1e2-e66c-4a30-a0a7-518ae7e3a566_1536x596.png 848w, https://substackcdn.com/image/fetch/$s_!QELC!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8a7dc1e2-e66c-4a30-a0a7-518ae7e3a566_1536x596.png 1272w, https://substackcdn.com/image/fetch/$s_!QELC!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8a7dc1e2-e66c-4a30-a0a7-518ae7e3a566_1536x596.png 1456w\\\" sizes=\\\"100vw\\\" loading=\\\"lazy\\\"></picture><div class=\\\"image-link-expand\\\"><div class=\\\"pencraft pc-display-flex pc-gap-8 pc-reset\\\"><div class=\\\"pencraft pc-reset icon-container restack-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-refresh-cw\\\"><path d=\\\"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8\\\"></path><path d=\\\"M21 3v5h-5\\\"></path><path d=\\\"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16\\\"></path><path d=\\\"M8 16H3v5\\\"></path></svg></div><div class=\\\"pencraft pc-reset icon-container view-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-maximize2\\\"><polyline points=\\\"15 3 21 3 21 9\\\"></polyline><polyline points=\\\"9 21 3 21 3 15\\\"></polyline><line x1=\\\"21\\\" x2=\\\"14\\\" y1=\\\"3\\\" y2=\\\"10\\\"></line><line x1=\\\"3\\\" x2=\\\"10\\\" y1=\\\"21\\\" y2=\\\"14\\\"></line></svg></div></div></div></div></a><figcaption class=\\\"image-caption\\\">(from [9])</figcaption></figure></div><p>GQA is a modified version of the standard multi-head <a href=\\\"https://twitter.com/cwolferesearch/status/1644773244786941952?s=20\\\">causal self-attention</a>. In GQA, we divide the <code>N</code> total self-attention heads into groups, where key and value heads are shared within each group; see above. Such an approach is an interpolation between vanilla multi-headed self-attention and <a href=\\\"https://cameronrwolfe.substack.com/i/104244919/architectural-modifications\\\">multi-query attention</a>, which uses a shared key and value projection across all <code>N</code> heads. Interestingly, <em>GQA maintains the performance of vanilla multi-headed causal self-attention and achieves comparable efficiency compared to multi-query attention</em>. </p><h4>More Data = Better Model</h4><p>All LLMs<a class=\\\"footnote-anchor\\\" data-component-name=\\\"FootnoteAnchorToDOM\\\" id=\\\"footnote-anchor-2\\\" href=\\\"#footnote-2\\\" target=\\\"_self\\\">2</a> follow a (relatively) standard and simple pre-training process, based upon an unlabeled textual corpus and the <a href=\\\"https://cameronrwolfe.substack.com/i/85568430/language-modeling\\\">next token prediction</a> objective. Given that the pre-training methodology for LLMs is standardized, model performance is largely correlated with the quality and amount of data used for pre-training. For pre-trained base models, using <a href=\\\"https://twitter.com/cwolferesearch/status/1688662318522007552?s=20\\\">more and better data</a> for pre-training the LLM will generally improve the resulting model\u2019s performance! </p><blockquote><p><em>\u201CThe capabilities of LLMs are remarkable considering the seemingly straightforward nature of the training methodology.\u201D</em> - from [1]</p></blockquote><p><strong>The LLaMA approach.</strong> Both LLaMA and LLaMA-2 use solely public sources of data for pre-training. Such a choice is made deliberately to ensure that the pre-training process can be openly replicated by anyone with sufficient compute resources. Compared to LLaMA, however, LLaMA-2 adopts a new mixture of pre-training data (i.e., sources that are known to be high-quality and factual are sampled more heavily) and increases the size of the pre-training dataset by 40%. Such a change allows the model to learn from more data during pre-training and, as a result, improves the knowledge base possessed by LLAMA-2.  </p><div class=\\\"captioned-image-container\\\"><figure><a class=\\\"image-link image2 is-viewable-img\\\" target=\\\"_blank\\\" href=\\\"https://substackcdn.com/image/fetch/$s_!J1zP!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd0e47f39-c9ce-4fbe-89d3-96f9baa2cd5f_1270x1362.png\\\" data-component-name=\\\"Image2ToDOM\\\"><div class=\\\"image2-inset\\\"><picture><source type=\\\"image/webp\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!J1zP!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd0e47f39-c9ce-4fbe-89d3-96f9baa2cd5f_1270x1362.png 424w, https://substackcdn.com/image/fetch/$s_!J1zP!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd0e47f39-c9ce-4fbe-89d3-96f9baa2cd5f_1270x1362.png 848w, https://substackcdn.com/image/fetch/$s_!J1zP!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd0e47f39-c9ce-4fbe-89d3-96f9baa2cd5f_1270x1362.png 1272w, https://substackcdn.com/image/fetch/$s_!J1zP!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd0e47f39-c9ce-4fbe-89d3-96f9baa2cd5f_1270x1362.png 1456w\\\" sizes=\\\"100vw\\\"><img src=\\\"https://substackcdn.com/image/fetch/$s_!J1zP!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd0e47f39-c9ce-4fbe-89d3-96f9baa2cd5f_1270x1362.png\\\" width=\\\"553\\\" height=\\\"593.059842519685\\\" data-attrs=\\\"{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/d0e47f39-c9ce-4fbe-89d3-96f9baa2cd5f_1270x1362.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:1362,&quot;width&quot;:1270,&quot;resizeWidth&quot;:553,&quot;bytes&quot;:334047,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}\\\" class=\\\"sizing-normal\\\" alt=\\\"\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!J1zP!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd0e47f39-c9ce-4fbe-89d3-96f9baa2cd5f_1270x1362.png 424w, https://substackcdn.com/image/fetch/$s_!J1zP!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd0e47f39-c9ce-4fbe-89d3-96f9baa2cd5f_1270x1362.png 848w, https://substackcdn.com/image/fetch/$s_!J1zP!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd0e47f39-c9ce-4fbe-89d3-96f9baa2cd5f_1270x1362.png 1272w, https://substackcdn.com/image/fetch/$s_!J1zP!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd0e47f39-c9ce-4fbe-89d3-96f9baa2cd5f_1270x1362.png 1456w\\\" sizes=\\\"100vw\\\" loading=\\\"lazy\\\"></picture><div class=\\\"image-link-expand\\\"><div class=\\\"pencraft pc-display-flex pc-gap-8 pc-reset\\\"><div class=\\\"pencraft pc-reset icon-container restack-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-refresh-cw\\\"><path d=\\\"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8\\\"></path><path d=\\\"M21 3v5h-5\\\"></path><path d=\\\"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16\\\"></path><path d=\\\"M8 16H3v5\\\"></path></svg></div><div class=\\\"pencraft pc-reset icon-container view-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-maximize2\\\"><polyline points=\\\"15 3 21 3 21 9\\\"></polyline><polyline points=\\\"9 21 3 21 3 15\\\"></polyline><line x1=\\\"21\\\" x2=\\\"14\\\" y1=\\\"3\\\" y2=\\\"10\\\"></line><line x1=\\\"3\\\" x2=\\\"10\\\" y1=\\\"21\\\" y2=\\\"14\\\"></line></svg></div></div></div></div></a><figcaption class=\\\"image-caption\\\">(from [1])</figcaption></figure></div><p><strong>Pre-training on the right data.</strong> As we will see, LLaMA-2 places an emphasis on key properties like helpfulness and safety that should be encouraged within the resulting model. Interestingly, LLaMA-2\u2019s focus upon safety metrics and data quality begins as early as the pre-training process. Data from sources that are known to contain high levels of personal information are excluded from the pre-training set, while data coming from factual or respected sources is emphasized more heavily during pre-training. Additionally, authors measure various factors, such as representation of different demographic groups and levels of toxicity, to minimize the amount of bias within LLaMA-2; see above. Put simply, great care is placed into the contents and composition of LLAMA-2\u2019s pre-training dataset. </p><h2>Fine-Tuning Process and LLaMA-2-Chat</h2><div class=\\\"captioned-image-container\\\"><figure><a class=\\\"image-link image2 is-viewable-img\\\" target=\\\"_blank\\\" href=\\\"https://substackcdn.com/image/fetch/$s_!rRss!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8e5666f4-b294-40ad-8fa6-72f5c68e2f53_2210x1328.png\\\" data-component-name=\\\"Image2ToDOM\\\"><div class=\\\"image2-inset\\\"><picture><source type=\\\"image/webp\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!rRss!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8e5666f4-b294-40ad-8fa6-72f5c68e2f53_2210x1328.png 424w, https://substackcdn.com/image/fetch/$s_!rRss!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8e5666f4-b294-40ad-8fa6-72f5c68e2f53_2210x1328.png 848w, https://substackcdn.com/image/fetch/$s_!rRss!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8e5666f4-b294-40ad-8fa6-72f5c68e2f53_2210x1328.png 1272w, https://substackcdn.com/image/fetch/$s_!rRss!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8e5666f4-b294-40ad-8fa6-72f5c68e2f53_2210x1328.png 1456w\\\" sizes=\\\"100vw\\\"><img src=\\\"https://substackcdn.com/image/fetch/$s_!rRss!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8e5666f4-b294-40ad-8fa6-72f5c68e2f53_2210x1328.png\\\" width=\\\"1456\\\" height=\\\"875\\\" data-attrs=\\\"{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/8e5666f4-b294-40ad-8fa6-72f5c68e2f53_2210x1328.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:875,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:465511,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}\\\" class=\\\"sizing-normal\\\" alt=\\\"\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!rRss!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8e5666f4-b294-40ad-8fa6-72f5c68e2f53_2210x1328.png 424w, https://substackcdn.com/image/fetch/$s_!rRss!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8e5666f4-b294-40ad-8fa6-72f5c68e2f53_2210x1328.png 848w, https://substackcdn.com/image/fetch/$s_!rRss!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8e5666f4-b294-40ad-8fa6-72f5c68e2f53_2210x1328.png 1272w, https://substackcdn.com/image/fetch/$s_!rRss!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8e5666f4-b294-40ad-8fa6-72f5c68e2f53_2210x1328.png 1456w\\\" sizes=\\\"100vw\\\" loading=\\\"lazy\\\"></picture><div class=\\\"image-link-expand\\\"><div class=\\\"pencraft pc-display-flex pc-gap-8 pc-reset\\\"><div class=\\\"pencraft pc-reset icon-container restack-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-refresh-cw\\\"><path d=\\\"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8\\\"></path><path d=\\\"M21 3v5h-5\\\"></path><path d=\\\"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16\\\"></path><path d=\\\"M8 16H3v5\\\"></path></svg></div><div class=\\\"pencraft pc-reset icon-container view-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-maximize2\\\"><polyline points=\\\"15 3 21 3 21 9\\\"></polyline><polyline points=\\\"9 21 3 21 3 15\\\"></polyline><line x1=\\\"21\\\" x2=\\\"14\\\" y1=\\\"3\\\" y2=\\\"10\\\"></line><line x1=\\\"3\\\" x2=\\\"10\\\" y1=\\\"21\\\" y2=\\\"14\\\"></line></svg></div></div></div></div></a><figcaption class=\\\"image-caption\\\">(from [1])</figcaption></figure></div><p>Prior to LLaMA-2, most open-source models were aligned exclusively by performing supervised fine-tuning (SFT) over publicly-available datasets. However, proprietary models (e.g., ChatGPT or GPT-4) tend to follow a more thorough approach that fine-tunes the LLM over extensive amounts of dialogue and human feedback. Attempting to close this gap, LLaMA-2 is fine-tuned using a large dataset in a similar manner to proprietary models, producing the LLaMA-2-Chat model that is optimized for dialogue-based applications; see above. For most closed-source models, the alignment process is highly proprietary, but LLaMA-2 attempts to improve transparency and make high-quality alignment more understandable for open-source research efforts.</p><blockquote><p><em>\u201CClosed product LLMs are heavily fine-tuned to align with human preferences, which greatly enhances their usability and safety. This step can require significant costs in compute and human annotation, and is often not transparent or easily reproducible, limiting progress within the community to advance AI alignment research.\u201D</em> - from [1]</p></blockquote><p><strong>What is alignment? </strong>Alignment refers to the idea of teaching an LLM to produce an output that <em>aligns</em> with human desires. While the pre-training process focuses upon accurately performing next token prediction, alignment fine-tunes\u2014typically using <a href=\\\"https://cameronrwolfe.substack.com/i/93578656/refining-llm-behavior\\\">supervised fine-tuning (SFT) and/or reinforcement learning from human feedback (RLHF)</a>\u2014the model to accomplish a variety of different goals; see below. Notably, LLMs gain <a href=\\\"https://cameronrwolfe.substack.com/i/134561977/lima-less-is-more-for-alignment\\\">most of their knowledge base</a> during pre-training, while alignment serves to teach them the correct output style or format.</p><div class=\\\"captioned-image-container\\\"><figure><a class=\\\"image-link image2\\\" target=\\\"_blank\\\" href=\\\"https://substackcdn.com/image/fetch/$s_!SXav!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9295576d-46db-45db-b156-ccaae2ebaa99_2428x588.png\\\" data-component-name=\\\"Image2ToDOM\\\"><div class=\\\"image2-inset\\\"><picture><source type=\\\"image/webp\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!SXav!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9295576d-46db-45db-b156-ccaae2ebaa99_2428x588.png 424w, https://substackcdn.com/image/fetch/$s_!SXav!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9295576d-46db-45db-b156-ccaae2ebaa99_2428x588.png 848w, https://substackcdn.com/image/fetch/$s_!SXav!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9295576d-46db-45db-b156-ccaae2ebaa99_2428x588.png 1272w, https://substackcdn.com/image/fetch/$s_!SXav!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9295576d-46db-45db-b156-ccaae2ebaa99_2428x588.png 1456w\\\" sizes=\\\"100vw\\\"><img src=\\\"https://substackcdn.com/image/fetch/$s_!SXav!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9295576d-46db-45db-b156-ccaae2ebaa99_2428x588.png\\\" width=\\\"1456\\\" height=\\\"353\\\" data-attrs=\\\"{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/9295576d-46db-45db-b156-ccaae2ebaa99_2428x588.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:353,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:342358,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}\\\" class=\\\"sizing-normal\\\" alt=\\\"\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!SXav!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9295576d-46db-45db-b156-ccaae2ebaa99_2428x588.png 424w, https://substackcdn.com/image/fetch/$s_!SXav!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9295576d-46db-45db-b156-ccaae2ebaa99_2428x588.png 848w, https://substackcdn.com/image/fetch/$s_!SXav!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9295576d-46db-45db-b156-ccaae2ebaa99_2428x588.png 1272w, https://substackcdn.com/image/fetch/$s_!SXav!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9295576d-46db-45db-b156-ccaae2ebaa99_2428x588.png 1456w\\\" sizes=\\\"100vw\\\" loading=\\\"lazy\\\"></picture><div></div></div></a><figcaption class=\\\"image-caption\\\">(from [10, 11])</figcaption></figure></div><p>For example, alignment can be performed with a goal of reducing hallucinations, avoiding unsafe questions<a class=\\\"footnote-anchor\\\" data-component-name=\\\"FootnoteAnchorToDOM\\\" id=\\\"footnote-anchor-3\\\" href=\\\"#footnote-3\\\" target=\\\"_self\\\">3</a>, following detailed instructions, and more. Multiple goals can be aligned for at once.  In the case of LLaMA-2, authors focus upon improving the following criteria during alignment:</p><ul><li><p><em>Helpfulness</em>: the model fulfills users\u2019 requests and provides requested information.</p></li><li><p><em>Safety</em>: the model avoids responses that are \u201Cunsafe\u201D</p></li></ul><p>Performing alignment in pursuit of these goals produces the LLaMA-2-Chat model that is specialized for dialogue-based use cases. Given that LLaMA-2-Chat is fine-tuned/aligned using both SFT and RLHF, we will now consider and explore each of these phases of fine-tuning individually. </p><h4>Supervised Fine-Tuning (SFT)</h4><div class=\\\"captioned-image-container\\\"><figure><a class=\\\"image-link image2 is-viewable-img\\\" target=\\\"_blank\\\" href=\\\"https://substackcdn.com/image/fetch/$s_!qMvq!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff1368769-40db-440b-b13f-5299b62dd53a_632x1070.png\\\" data-component-name=\\\"Image2ToDOM\\\"><div class=\\\"image2-inset\\\"><picture><source type=\\\"image/webp\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!qMvq!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff1368769-40db-440b-b13f-5299b62dd53a_632x1070.png 424w, https://substackcdn.com/image/fetch/$s_!qMvq!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff1368769-40db-440b-b13f-5299b62dd53a_632x1070.png 848w, https://substackcdn.com/image/fetch/$s_!qMvq!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff1368769-40db-440b-b13f-5299b62dd53a_632x1070.png 1272w, https://substackcdn.com/image/fetch/$s_!qMvq!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff1368769-40db-440b-b13f-5299b62dd53a_632x1070.png 1456w\\\" sizes=\\\"100vw\\\"><img src=\\\"https://substackcdn.com/image/fetch/$s_!qMvq!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff1368769-40db-440b-b13f-5299b62dd53a_632x1070.png\\\" width=\\\"226\\\" height=\\\"382.626582278481\\\" data-attrs=\\\"{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/f1368769-40db-440b-b13f-5299b62dd53a_632x1070.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:1070,&quot;width&quot;:632,&quot;resizeWidth&quot;:226,&quot;bytes&quot;:124874,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}\\\" class=\\\"sizing-normal\\\" alt=\\\"\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!qMvq!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff1368769-40db-440b-b13f-5299b62dd53a_632x1070.png 424w, https://substackcdn.com/image/fetch/$s_!qMvq!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff1368769-40db-440b-b13f-5299b62dd53a_632x1070.png 848w, https://substackcdn.com/image/fetch/$s_!qMvq!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff1368769-40db-440b-b13f-5299b62dd53a_632x1070.png 1272w, https://substackcdn.com/image/fetch/$s_!qMvq!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff1368769-40db-440b-b13f-5299b62dd53a_632x1070.png 1456w\\\" sizes=\\\"100vw\\\" loading=\\\"lazy\\\"></picture><div class=\\\"image-link-expand\\\"><div class=\\\"pencraft pc-display-flex pc-gap-8 pc-reset\\\"><div class=\\\"pencraft pc-reset icon-container restack-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-refresh-cw\\\"><path d=\\\"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8\\\"></path><path d=\\\"M21 3v5h-5\\\"></path><path d=\\\"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16\\\"></path><path d=\\\"M8 16H3v5\\\"></path></svg></div><div class=\\\"pencraft pc-reset icon-container view-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-maximize2\\\"><polyline points=\\\"15 3 21 3 21 9\\\"></polyline><polyline points=\\\"9 21 3 21 3 15\\\"></polyline><line x1=\\\"21\\\" x2=\\\"14\\\" y1=\\\"3\\\" y2=\\\"10\\\"></line><line x1=\\\"3\\\" x2=\\\"10\\\" y1=\\\"21\\\" y2=\\\"14\\\"></line></svg></div></div></div></div></a><figcaption class=\\\"image-caption\\\">(from [10])</figcaption></figure></div><p>The first step in the fine-tuning process for LLaMA-2 is SFT. This technique is simple to understand, as it relies upon a (supervised) next-token prediction objective that is nearly identical to pre-training; see above. Put simply, we just collect a dataset of dialogue examples (i.e., prompt and response pairs; see below)<a class=\\\"footnote-anchor\\\" data-component-name=\\\"FootnoteAnchorToDOM\\\" id=\\\"footnote-anchor-4\\\" href=\\\"#footnote-4\\\" target=\\\"_self\\\">4</a> and train the model using a <a href=\\\"https://cameronrwolfe.substack.com/i/135273362/the-language-modeling-objective\\\">next-token prediction objective</a> applied to the responses within each of these examples. By fine-tuning the model in this way, the LLM learns to replicate behavior emulated within the responses of the fine-tuning dataset. Thus, any desirable properties\u2014or alignment objectives\u2014present within this data, in turn, become present within the model itself.</p><div class=\\\"captioned-image-container\\\"><figure><a class=\\\"image-link image2 is-viewable-img\\\" target=\\\"_blank\\\" href=\\\"https://substackcdn.com/image/fetch/$s_!RMwG!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8c6d0e01-1cb0-4acf-937a-52b05d96591a_1272x672.png\\\" data-component-name=\\\"Image2ToDOM\\\"><div class=\\\"image2-inset\\\"><picture><source type=\\\"image/webp\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!RMwG!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8c6d0e01-1cb0-4acf-937a-52b05d96591a_1272x672.png 424w, https://substackcdn.com/image/fetch/$s_!RMwG!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8c6d0e01-1cb0-4acf-937a-52b05d96591a_1272x672.png 848w, https://substackcdn.com/image/fetch/$s_!RMwG!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8c6d0e01-1cb0-4acf-937a-52b05d96591a_1272x672.png 1272w, https://substackcdn.com/image/fetch/$s_!RMwG!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8c6d0e01-1cb0-4acf-937a-52b05d96591a_1272x672.png 1456w\\\" sizes=\\\"100vw\\\"><img src=\\\"https://substackcdn.com/image/fetch/$s_!RMwG!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8c6d0e01-1cb0-4acf-937a-52b05d96591a_1272x672.png\\\" width=\\\"1272\\\" height=\\\"672\\\" data-attrs=\\\"{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/8c6d0e01-1cb0-4acf-937a-52b05d96591a_1272x672.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:672,&quot;width&quot;:1272,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:209713,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}\\\" class=\\\"sizing-normal\\\" alt=\\\"\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!RMwG!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8c6d0e01-1cb0-4acf-937a-52b05d96591a_1272x672.png 424w, https://substackcdn.com/image/fetch/$s_!RMwG!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8c6d0e01-1cb0-4acf-937a-52b05d96591a_1272x672.png 848w, https://substackcdn.com/image/fetch/$s_!RMwG!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8c6d0e01-1cb0-4acf-937a-52b05d96591a_1272x672.png 1272w, https://substackcdn.com/image/fetch/$s_!RMwG!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8c6d0e01-1cb0-4acf-937a-52b05d96591a_1272x672.png 1456w\\\" sizes=\\\"100vw\\\" loading=\\\"lazy\\\"></picture><div class=\\\"image-link-expand\\\"><div class=\\\"pencraft pc-display-flex pc-gap-8 pc-reset\\\"><div class=\\\"pencraft pc-reset icon-container restack-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-refresh-cw\\\"><path d=\\\"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8\\\"></path><path d=\\\"M21 3v5h-5\\\"></path><path d=\\\"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16\\\"></path><path d=\\\"M8 16H3v5\\\"></path></svg></div><div class=\\\"pencraft pc-reset icon-container view-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-maximize2\\\"><polyline points=\\\"15 3 21 3 21 9\\\"></polyline><polyline points=\\\"9 21 3 21 3 15\\\"></polyline><line x1=\\\"21\\\" x2=\\\"14\\\" y1=\\\"3\\\" y2=\\\"10\\\"></line><line x1=\\\"3\\\" x2=\\\"10\\\" y1=\\\"21\\\" y2=\\\"14\\\"></line></svg></div></div></div></div></a><figcaption class=\\\"image-caption\\\">(from [1])</figcaption></figure></div><p>Notably, LLaMA-2-Chat performs two separate phases of SFT. The first phrase trains over a larger amount of public data, while the second phase trains over a smaller curated dataset with much higher quality. In total, roughly 100K dialogue examples are observed by LLaMA-2-Chat while performing SFT. </p><p><strong>The data.</strong> Many datasets for dialogue-based fine-tuning are available via sites like HuggingFace. LLaMA-2 begins its alignment process by fine-tuning over a <a href=\\\"https://huggingface.co/datasets/lucasmccabe-lmi/FLAN_CoT_alpaca_style\\\">publicly available dataset for SFT</a>. However, such public data lacks in quality and diversity, which\u2014as revealed by LIMA [12]\u2014is problematic. Authors in [1] collect extra data via a combination of 3rd party vendors and filtering efforts on public data. The resulting dataset, although of moderate size (i.e., 27,540 examples in total), is manually scrutinized and validated to ensure quality criteria are met. </p><blockquote><p><em>\u201CWe found that the outputs sampled from the resulting SFT model were often competitive with SFT data handwritten by human annotators, suggesting that we could reprioritize and devote more annotation effort to preference-based annotation for RLHF.\u201D</em> - from [1]</p></blockquote><p>The limited set of clean instructions used for the second phase of SFT in [1] are quite effective. Interestingly, authors mention that collecting more data for SFT had diminishing returns because <em>i)</em> the fine-tuned model is capable of generating its own data for SFT and <em>ii)</em> investing more annotation into RLHF yields a clear benefit. Overall, we see in [1] that an effective strategy for SFT is to curate a small dataset with higher quality standards, which aligns with findings from [12].&nbsp;</p><h4>Reinforcement Learning from Human Feedback (RLHF)</h4><div class=\\\"captioned-image-container\\\"><figure><a class=\\\"image-link image2 is-viewable-img\\\" target=\\\"_blank\\\" href=\\\"https://substackcdn.com/image/fetch/$s_!Fou6!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fefbc95a9-a0cc-4ef6-908a-7154a2e6517d_1356x1218.png\\\" data-component-name=\\\"Image2ToDOM\\\"><div class=\\\"image2-inset\\\"><picture><source type=\\\"image/webp\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!Fou6!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fefbc95a9-a0cc-4ef6-908a-7154a2e6517d_1356x1218.png 424w, https://substackcdn.com/image/fetch/$s_!Fou6!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fefbc95a9-a0cc-4ef6-908a-7154a2e6517d_1356x1218.png 848w, https://substackcdn.com/image/fetch/$s_!Fou6!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fefbc95a9-a0cc-4ef6-908a-7154a2e6517d_1356x1218.png 1272w, https://substackcdn.com/image/fetch/$s_!Fou6!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fefbc95a9-a0cc-4ef6-908a-7154a2e6517d_1356x1218.png 1456w\\\" sizes=\\\"100vw\\\"><img src=\\\"https://substackcdn.com/image/fetch/$s_!Fou6!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fefbc95a9-a0cc-4ef6-908a-7154a2e6517d_1356x1218.png\\\" width=\\\"423\\\" height=\\\"379.9513274336283\\\" data-attrs=\\\"{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/efbc95a9-a0cc-4ef6-908a-7154a2e6517d_1356x1218.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:1218,&quot;width&quot;:1356,&quot;resizeWidth&quot;:423,&quot;bytes&quot;:280362,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}\\\" class=\\\"sizing-normal\\\" alt=\\\"\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!Fou6!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fefbc95a9-a0cc-4ef6-908a-7154a2e6517d_1356x1218.png 424w, https://substackcdn.com/image/fetch/$s_!Fou6!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fefbc95a9-a0cc-4ef6-908a-7154a2e6517d_1356x1218.png 848w, https://substackcdn.com/image/fetch/$s_!Fou6!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fefbc95a9-a0cc-4ef6-908a-7154a2e6517d_1356x1218.png 1272w, https://substackcdn.com/image/fetch/$s_!Fou6!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fefbc95a9-a0cc-4ef6-908a-7154a2e6517d_1356x1218.png 1456w\\\" sizes=\\\"100vw\\\" loading=\\\"lazy\\\"></picture><div class=\\\"image-link-expand\\\"><div class=\\\"pencraft pc-display-flex pc-gap-8 pc-reset\\\"><div class=\\\"pencraft pc-reset icon-container restack-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-refresh-cw\\\"><path d=\\\"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8\\\"></path><path d=\\\"M21 3v5h-5\\\"></path><path d=\\\"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16\\\"></path><path d=\\\"M8 16H3v5\\\"></path></svg></div><div class=\\\"pencraft pc-reset icon-container view-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-maximize2\\\"><polyline points=\\\"15 3 21 3 21 9\\\"></polyline><polyline points=\\\"9 21 3 21 3 15\\\"></polyline><line x1=\\\"21\\\" x2=\\\"14\\\" y1=\\\"3\\\" y2=\\\"10\\\"></line><line x1=\\\"3\\\" x2=\\\"10\\\" y1=\\\"21\\\" y2=\\\"14\\\"></line></svg></div></div></div></div></a><figcaption class=\\\"image-caption\\\">(from [10])</figcaption></figure></div><p>Although SFT is quite effective, it can be difficult to curate and manage a dataset that accurately captures the goals of alignment. <em>How do we know that the data present within our SFT dataset is consistently helpful and safe?</em> On the other hand, RLHF (shown above) takes the more direct approach of fine-tuning the LLM directly from human feedback on the model\u2019s output. First, human annotators are asked to write prompts for the LLMs, which can be selected based on the alignment criteria (e.g., helpfulness and safety). From here, the LLM is used to generate multiple (i.e., at least two) responses for each prompt, and the human annotators rank these responses based on their quality. Here, \u201Cquality\u201D is typically judged according to how well the response matches the alignment criteria. Then, RLHF can be used to optimize the LLM based on these human preference scores.</p><p><strong>The data.</strong> LLAMA-2 follows a binary protocol for collecting human preference data. For each prompt written by an annotator, two model responses are generated, and the annotator chooses the desired response based on helpfulness and safety criteria. Notably, each instance of human preference collection focuses upon a single alignment criteria<a class=\\\"footnote-anchor\\\" data-component-name=\\\"FootnoteAnchorToDOM\\\" id=\\\"footnote-anchor-5\\\" href=\\\"#footnote-5\\\" target=\\\"_self\\\">5</a>. For example, an annotator could write an adversarial prompt that tries to get the LLM to generate something unsafe, then rate the responses specifically based upon whether safety criteria are satisfied. Similarly, one could prompt the LLM with a detailed instruction and evaluate whether either of the model\u2019s responses are more helpful. </p><div class=\\\"captioned-image-container\\\"><figure><a class=\\\"image-link image2 is-viewable-img\\\" target=\\\"_blank\\\" href=\\\"https://substackcdn.com/image/fetch/$s_!GsBa!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc0cbcce0-923b-4a73-bd93-8ef0a7f00434_1266x646.png\\\" data-component-name=\\\"Image2ToDOM\\\"><div class=\\\"image2-inset\\\"><picture><source type=\\\"image/webp\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!GsBa!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc0cbcce0-923b-4a73-bd93-8ef0a7f00434_1266x646.png 424w, https://substackcdn.com/image/fetch/$s_!GsBa!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc0cbcce0-923b-4a73-bd93-8ef0a7f00434_1266x646.png 848w, https://substackcdn.com/image/fetch/$s_!GsBa!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc0cbcce0-923b-4a73-bd93-8ef0a7f00434_1266x646.png 1272w, https://substackcdn.com/image/fetch/$s_!GsBa!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc0cbcce0-923b-4a73-bd93-8ef0a7f00434_1266x646.png 1456w\\\" sizes=\\\"100vw\\\"><img src=\\\"https://substackcdn.com/image/fetch/$s_!GsBa!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc0cbcce0-923b-4a73-bd93-8ef0a7f00434_1266x646.png\\\" width=\\\"1266\\\" height=\\\"646\\\" data-attrs=\\\"{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/c0cbcce0-923b-4a73-bd93-8ef0a7f00434_1266x646.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:646,&quot;width&quot;:1266,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:198692,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}\\\" class=\\\"sizing-normal\\\" alt=\\\"\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!GsBa!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc0cbcce0-923b-4a73-bd93-8ef0a7f00434_1266x646.png 424w, https://substackcdn.com/image/fetch/$s_!GsBa!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc0cbcce0-923b-4a73-bd93-8ef0a7f00434_1266x646.png 848w, https://substackcdn.com/image/fetch/$s_!GsBa!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc0cbcce0-923b-4a73-bd93-8ef0a7f00434_1266x646.png 1272w, https://substackcdn.com/image/fetch/$s_!GsBa!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc0cbcce0-923b-4a73-bd93-8ef0a7f00434_1266x646.png 1456w\\\" sizes=\\\"100vw\\\" loading=\\\"lazy\\\"></picture><div class=\\\"image-link-expand\\\"><div class=\\\"pencraft pc-display-flex pc-gap-8 pc-reset\\\"><div class=\\\"pencraft pc-reset icon-container restack-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-refresh-cw\\\"><path d=\\\"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8\\\"></path><path d=\\\"M21 3v5h-5\\\"></path><path d=\\\"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16\\\"></path><path d=\\\"M8 16H3v5\\\"></path></svg></div><div class=\\\"pencraft pc-reset icon-container view-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-maximize2\\\"><polyline points=\\\"15 3 21 3 21 9\\\"></polyline><polyline points=\\\"9 21 3 21 3 15\\\"></polyline><line x1=\\\"21\\\" x2=\\\"14\\\" y1=\\\"3\\\" y2=\\\"10\\\"></line><line x1=\\\"3\\\" x2=\\\"10\\\" y1=\\\"21\\\" y2=\\\"14\\\"></line></svg></div></div></div></div></a><figcaption class=\\\"image-caption\\\">(from [1])</figcaption></figure></div><p>Going a bit further, annotators are also asked to label the degree to which one response is better than the other (i.e., <em>significantly better</em>, <em>better</em>, <em>slightly better</em>, or <em>negligibly better</em>), as well as explicitly label whether either of the LLM\u2019s responses are considered unsafe. We see in [1] that new batches of human preference data are collected each week, allowing multiple phases of RLHF to be performed iteratively. Statistics of the full human preference dataset that is collected compared to public human preference datasets are provided in the table above.</p><blockquote><p><em>\u201CHuman feedback is \u2026 used to train a reward model, which learns patterns in the preferences of the human annotators and can then automate preference decisions.\u201D</em> - from [1]</p></blockquote><p>Data for RLHF is collected in several batches. A new batch of data is collected each week, and authors of [1] iteratively fine-tune the LLaMA-2-Chat model (using RLHF) as each of these batches become available. As such, multiple successive \u201Crounds\u201D of RLHF are performed throughout the alignment process.</p><p><strong>Safety-based data collection. </strong>To collect fine-tuning data for improved safety during RLHF, authors in [1] design instructions using two techniques: </p><ol><li><p><em>Risk Categories</em>: a topic about which the LLM could potentially product unsafe content.</p></li><li><p><em>Attack Vectors</em>: question styles that cover a broad variety of prompts that could elicit negative behavior.</p></li></ol><p>Three different risk categories are considered, including illicit and criminal activities, hateful and harmful activities, and unqualified advice. Additionally, several different attack vectors are defined, such as psychological manipulation (authority manipulation), logic manipulation (false premises), syntactic manipulation (misspelling), semantic manipulation (metaphor), and perspective manipulation (role playing). Using combinations of these different techniques, human annotators craft prompts that are more likely to elicit unsafe behavior, allowing such behavior to be discouraged during the fine-tuning process.</p><p><strong>Training the reward model. </strong>After collecting human feedback, a reward model is trained on this data. The reward model takes a prompt\u2014<em>with the full chat history</em>\u2014and response as input and predicts a preference score. The reward model usually shares the same architecture and weights as the LLM, but its classification head (for next token prediction) is replaced with a regression head (for preference estimation) and the model is fine-tuned on preference data; see below. </p><div class=\\\"captioned-image-container\\\"><figure><a class=\\\"image-link image2 is-viewable-img\\\" target=\\\"_blank\\\" href=\\\"https://substackcdn.com/image/fetch/$s_!dJ0v!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fe0961ffa-b040-419a-ab10-1a16a2a84f87_2212x1244.png\\\" data-component-name=\\\"Image2ToDOM\\\"><div class=\\\"image2-inset\\\"><picture><source type=\\\"image/webp\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!dJ0v!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fe0961ffa-b040-419a-ab10-1a16a2a84f87_2212x1244.png 424w, https://substackcdn.com/image/fetch/$s_!dJ0v!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fe0961ffa-b040-419a-ab10-1a16a2a84f87_2212x1244.png 848w, https://substackcdn.com/image/fetch/$s_!dJ0v!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fe0961ffa-b040-419a-ab10-1a16a2a84f87_2212x1244.png 1272w, https://substackcdn.com/image/fetch/$s_!dJ0v!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fe0961ffa-b040-419a-ab10-1a16a2a84f87_2212x1244.png 1456w\\\" sizes=\\\"100vw\\\"><img src=\\\"https://substackcdn.com/image/fetch/$s_!dJ0v!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fe0961ffa-b040-419a-ab10-1a16a2a84f87_2212x1244.png\\\" width=\\\"1456\\\" height=\\\"819\\\" data-attrs=\\\"{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/e0961ffa-b040-419a-ab10-1a16a2a84f87_2212x1244.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:819,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:352243,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}\\\" class=\\\"sizing-normal\\\" alt=\\\"\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!dJ0v!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fe0961ffa-b040-419a-ab10-1a16a2a84f87_2212x1244.png 424w, https://substackcdn.com/image/fetch/$s_!dJ0v!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fe0961ffa-b040-419a-ab10-1a16a2a84f87_2212x1244.png 848w, https://substackcdn.com/image/fetch/$s_!dJ0v!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fe0961ffa-b040-419a-ab10-1a16a2a84f87_2212x1244.png 1272w, https://substackcdn.com/image/fetch/$s_!dJ0v!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fe0961ffa-b040-419a-ab10-1a16a2a84f87_2212x1244.png 1456w\\\" sizes=\\\"100vw\\\" loading=\\\"lazy\\\"></picture><div class=\\\"image-link-expand\\\"><div class=\\\"pencraft pc-display-flex pc-gap-8 pc-reset\\\"><div class=\\\"pencraft pc-reset icon-container restack-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-refresh-cw\\\"><path d=\\\"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8\\\"></path><path d=\\\"M21 3v5h-5\\\"></path><path d=\\\"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16\\\"></path><path d=\\\"M8 16H3v5\\\"></path></svg></div><div class=\\\"pencraft pc-reset icon-container view-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-maximize2\\\"><polyline points=\\\"15 3 21 3 21 9\\\"></polyline><polyline points=\\\"9 21 3 21 3 15\\\"></polyline><line x1=\\\"21\\\" x2=\\\"14\\\" y1=\\\"3\\\" y2=\\\"10\\\"></line><line x1=\\\"3\\\" x2=\\\"10\\\" y1=\\\"21\\\" y2=\\\"14\\\"></line></svg></div></div></div></div></a><figcaption class=\\\"image-caption\\\">Normal LLM structure for next-token prediction compared to the structure of an LLM-based reward model</figcaption></figure></div><p>The reward model automates obtaining an accurate preference score for prompt-response pairs, which allows the LLM to be fine-tuned using <a href=\\\"https://www.geeksforgeeks.org/what-is-reinforcement-learning/\\\">reinforcement learning (RL)</a> to maximize (automatically generated) human preference scores across a large dataset. To train the reward model, we take binary preference data and form a training objective that forces the preferred example to have a higher score than its counterpart<a class=\\\"footnote-anchor\\\" data-component-name=\\\"FootnoteAnchorToDOM\\\" id=\\\"footnote-anchor-6\\\" href=\\\"#footnote-6\\\" target=\\\"_self\\\">6</a>! An example of such an objective is shown below.</p><div class=\\\"captioned-image-container\\\"><figure><a class=\\\"image-link image2\\\" target=\\\"_blank\\\" href=\\\"https://substackcdn.com/image/fetch/$s_!85r1!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3f29a20d-c865-4a01-9fec-61590e4e7d79_1394x498.png\\\" data-component-name=\\\"Image2ToDOM\\\"><div class=\\\"image2-inset\\\"><picture><source type=\\\"image/webp\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!85r1!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3f29a20d-c865-4a01-9fec-61590e4e7d79_1394x498.png 424w, https://substackcdn.com/image/fetch/$s_!85r1!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3f29a20d-c865-4a01-9fec-61590e4e7d79_1394x498.png 848w, https://substackcdn.com/image/fetch/$s_!85r1!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3f29a20d-c865-4a01-9fec-61590e4e7d79_1394x498.png 1272w, https://substackcdn.com/image/fetch/$s_!85r1!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3f29a20d-c865-4a01-9fec-61590e4e7d79_1394x498.png 1456w\\\" sizes=\\\"100vw\\\"><img src=\\\"https://substackcdn.com/image/fetch/$s_!85r1!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3f29a20d-c865-4a01-9fec-61590e4e7d79_1394x498.png\\\" width=\\\"517\\\" height=\\\"184.69583931133428\\\" data-attrs=\\\"{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/3f29a20d-c865-4a01-9fec-61590e4e7d79_1394x498.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:498,&quot;width&quot;:1394,&quot;resizeWidth&quot;:517,&quot;bytes&quot;:86917,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}\\\" class=\\\"sizing-normal\\\" alt=\\\"\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!85r1!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3f29a20d-c865-4a01-9fec-61590e4e7d79_1394x498.png 424w, https://substackcdn.com/image/fetch/$s_!85r1!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3f29a20d-c865-4a01-9fec-61590e4e7d79_1394x498.png 848w, https://substackcdn.com/image/fetch/$s_!85r1!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3f29a20d-c865-4a01-9fec-61590e4e7d79_1394x498.png 1272w, https://substackcdn.com/image/fetch/$s_!85r1!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3f29a20d-c865-4a01-9fec-61590e4e7d79_1394x498.png 1456w\\\" sizes=\\\"100vw\\\" loading=\\\"lazy\\\"></picture><div></div></div></a><figcaption class=\\\"image-caption\\\">(from [1])</figcaption></figure></div><p>However, we should recall that the preference data collected in [1] is not just binary. We have more granular information that identifies responses that are significantly or moderately better than others. To capture this more detailed information, we can simply add a margin\u2014<em>or a fixed value assigned to each of the significantly better, better, slightly better, or negligibly better categories</em>\u2014to the loss shown above. Such a margin pushes the reward model to assign larger gaps in score between responses with big differences in preference; see below.</p><div class=\\\"captioned-image-container\\\"><figure><a class=\\\"image-link image2\\\" target=\\\"_blank\\\" href=\\\"https://substackcdn.com/image/fetch/$s_!H2D3!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb7ac7d1c-cfd3-4e65-9db3-1163349c2717_1376x282.png\\\" data-component-name=\\\"Image2ToDOM\\\"><div class=\\\"image2-inset\\\"><picture><source type=\\\"image/webp\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!H2D3!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb7ac7d1c-cfd3-4e65-9db3-1163349c2717_1376x282.png 424w, https://substackcdn.com/image/fetch/$s_!H2D3!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb7ac7d1c-cfd3-4e65-9db3-1163349c2717_1376x282.png 848w, https://substackcdn.com/image/fetch/$s_!H2D3!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb7ac7d1c-cfd3-4e65-9db3-1163349c2717_1376x282.png 1272w, https://substackcdn.com/image/fetch/$s_!H2D3!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb7ac7d1c-cfd3-4e65-9db3-1163349c2717_1376x282.png 1456w\\\" sizes=\\\"100vw\\\"><img src=\\\"https://substackcdn.com/image/fetch/$s_!H2D3!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb7ac7d1c-cfd3-4e65-9db3-1163349c2717_1376x282.png\\\" width=\\\"487\\\" height=\\\"99.80668604651163\\\" data-attrs=\\\"{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/b7ac7d1c-cfd3-4e65-9db3-1163349c2717_1376x282.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:282,&quot;width&quot;:1376,&quot;resizeWidth&quot;:487,&quot;bytes&quot;:49948,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}\\\" class=\\\"sizing-normal\\\" alt=\\\"\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!H2D3!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb7ac7d1c-cfd3-4e65-9db3-1163349c2717_1376x282.png 424w, https://substackcdn.com/image/fetch/$s_!H2D3!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb7ac7d1c-cfd3-4e65-9db3-1163349c2717_1376x282.png 848w, https://substackcdn.com/image/fetch/$s_!H2D3!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb7ac7d1c-cfd3-4e65-9db3-1163349c2717_1376x282.png 1272w, https://substackcdn.com/image/fetch/$s_!H2D3!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fb7ac7d1c-cfd3-4e65-9db3-1163349c2717_1376x282.png 1456w\\\" sizes=\\\"100vw\\\" loading=\\\"lazy\\\"></picture><div></div></div></a><figcaption class=\\\"image-caption\\\">(from [1])</figcaption></figure></div><p>Interestingly, we see in [1] that authors combine their custom-curated human preference data with other public sources of data when training reward models. To explain this decision, authors claim that injecting such extra sources of data does not seem to have a negative impact on reward model performance. Plus, this data aids the reward models\u2019 generalization and can protect against issues like reward hacking, in which RLHF takes advantage of weaknesses in the reward function to arbitrarily inflate preference scores without improving the model. </p><blockquote><p><em>\u201CWe do not observe negative transfer from the open-source preference datasets. Thus, we have decided to keep them in our data mixture, as they could enable better generalization for the reward model and prevent reward hacking, i.e. Llama 2-Chat taking advantage of some weaknesses of our reward, and so artificially inflating the score despite performing less well.\u201D</em> - from [1]</p></blockquote><p><strong>Alignment is oftentimes a tradeoff!</strong> Interestingly, we see in [1] that separate reward models are trained for each of the alignment criteria. More specifically, we have a helpfulness reward model and a separately safety reward model. This might seem unnecessary at first, but we should realize that properties such as helpfulness and safety\u2014<em>or any alignment criteria in general</em>\u2014are oftentimes a tradeoff. Making an LLM more safe might make it less helpful; e.g., the model could refuse to answer a question that is unsafe, which is (arguably) not helpful. Given this tradeoff, authors in [2] observe that predicting helpfulness and safety preference scores with separate reward models is the best way to accurately model the nuances in human preference according to different alignment criteria.</p><blockquote><p><em>\u201CIn order for a single model to perform well on both dimensions, it needs to not only learn to select the better response given a prompt but also to distinguish adversarial prompts from safe ones. As a result, optimizing two separate models eases the reward modeling task.\u201D</em> - from [1]</p></blockquote><p><strong>Optimization via RL.</strong>  Even after multiple rounds of SFT are performed, five successive versions of RLHF models are created in [1]\u2014<em>one for each batch of human preference data</em>. Although the <a href=\\\"https://openai.com/research/openai-baselines-ppo\\\">PPO algorithm</a> has typically been a standard for performing RLHF, we see in [1] that two separate algorithms are considered:</p><ul><li><p><em>PPO</em>: standard algorithm used for RLHF.</p></li><li><p><em>Rejection Sampling</em>: samples <code>K</code> responses from the LLM for each prompt, scores each response using the reward model, selects the best response, and fine-tunes on this example. </p></li></ul><p>While PPO only takes one sample from the model per iteration, rejection sampling takes numerous samples.  Within rejection sampling, the highest-reward sample that is generated is considered the new \u201Cgold standard\u201D. As shown in the figure below, generating multiple samples in this manner can drastically increase the maximum reward of samples observed during fine-tuning.</p><div class=\\\"captioned-image-container\\\"><figure><a class=\\\"image-link image2 is-viewable-img\\\" target=\\\"_blank\\\" href=\\\"https://substackcdn.com/image/fetch/$s_!QtIR!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2b3e108b-443b-481c-8b76-3c0a12d4a165_1594x604.png\\\" data-component-name=\\\"Image2ToDOM\\\"><div class=\\\"image2-inset\\\"><picture><source type=\\\"image/webp\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!QtIR!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2b3e108b-443b-481c-8b76-3c0a12d4a165_1594x604.png 424w, https://substackcdn.com/image/fetch/$s_!QtIR!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2b3e108b-443b-481c-8b76-3c0a12d4a165_1594x604.png 848w, https://substackcdn.com/image/fetch/$s_!QtIR!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2b3e108b-443b-481c-8b76-3c0a12d4a165_1594x604.png 1272w, https://substackcdn.com/image/fetch/$s_!QtIR!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2b3e108b-443b-481c-8b76-3c0a12d4a165_1594x604.png 1456w\\\" sizes=\\\"100vw\\\"><img src=\\\"https://substackcdn.com/image/fetch/$s_!QtIR!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2b3e108b-443b-481c-8b76-3c0a12d4a165_1594x604.png\\\" width=\\\"1456\\\" height=\\\"552\\\" data-attrs=\\\"{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/2b3e108b-443b-481c-8b76-3c0a12d4a165_1594x604.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:552,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:110350,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}\\\" class=\\\"sizing-normal\\\" alt=\\\"\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!QtIR!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2b3e108b-443b-481c-8b76-3c0a12d4a165_1594x604.png 424w, https://substackcdn.com/image/fetch/$s_!QtIR!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2b3e108b-443b-481c-8b76-3c0a12d4a165_1594x604.png 848w, https://substackcdn.com/image/fetch/$s_!QtIR!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2b3e108b-443b-481c-8b76-3c0a12d4a165_1594x604.png 1272w, https://substackcdn.com/image/fetch/$s_!QtIR!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2b3e108b-443b-481c-8b76-3c0a12d4a165_1594x604.png 1456w\\\" sizes=\\\"100vw\\\" loading=\\\"lazy\\\"></picture><div class=\\\"image-link-expand\\\"><div class=\\\"pencraft pc-display-flex pc-gap-8 pc-reset\\\"><div class=\\\"pencraft pc-reset icon-container restack-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-refresh-cw\\\"><path d=\\\"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8\\\"></path><path d=\\\"M21 3v5h-5\\\"></path><path d=\\\"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16\\\"></path><path d=\\\"M8 16H3v5\\\"></path></svg></div><div class=\\\"pencraft pc-reset icon-container view-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-maximize2\\\"><polyline points=\\\"15 3 21 3 21 9\\\"></polyline><polyline points=\\\"9 21 3 21 3 15\\\"></polyline><line x1=\\\"21\\\" x2=\\\"14\\\" y1=\\\"3\\\" y2=\\\"10\\\"></line><line x1=\\\"3\\\" x2=\\\"10\\\" y1=\\\"21\\\" y2=\\\"14\\\"></line></svg></div></div></div></div></a><figcaption class=\\\"image-caption\\\">(from [1])</figcaption></figure></div><p>In [1], rejection sampling is performed with the largest model (i.e., LLaMA-70B-Chat) and used to train all other (smaller) models<a class=\\\"footnote-anchor\\\" data-component-name=\\\"FootnoteAnchorToDOM\\\" id=\\\"footnote-anchor-7\\\" href=\\\"#footnote-7\\\" target=\\\"_self\\\">7</a>. While PPO performs iterative updates after each sample, rejection sampling fine-tuning uses the same model (i.e., at the beginning of the RLHF round) to generate an entire dataset of high-reward samples that are used for fine-tuning in a similar manner to SFT.  </p><blockquote><p><em>\u201CWe illustrate the benefit of Rejection Sampling in Figure 7. The delta between the maximum and median curves can be interpreted as the potential gain of fine-tuning on the best output.\u201D</em> - from [1]</p></blockquote><p>To ensure the best possible performance, authors include best samples from all RLHF iterations\u2014<em>not just the current iteration</em>\u2014when performing rejection sampling fine-tuning. Without including samples from prior iterations, we see that regressions in performance may occur when using rejection sampling fine-tuning. In [1], a rejection sampling approach is adopted for the first four rounds of RLHF, then the final round combines both rejection sampling fine-tuning and PPO sequentially (i.e., PPO is applied after rejection sampling fine-tuning). </p><div class=\\\"captioned-image-container\\\"><figure><a class=\\\"image-link image2 is-viewable-img\\\" target=\\\"_blank\\\" href=\\\"https://substackcdn.com/image/fetch/$s_!IjRU!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F4b0ef016-bb81-4a02-9a41-4f685609aea1_1584x568.png\\\" data-component-name=\\\"Image2ToDOM\\\"><div class=\\\"image2-inset\\\"><picture><source type=\\\"image/webp\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!IjRU!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F4b0ef016-bb81-4a02-9a41-4f685609aea1_1584x568.png 424w, https://substackcdn.com/image/fetch/$s_!IjRU!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F4b0ef016-bb81-4a02-9a41-4f685609aea1_1584x568.png 848w, https://substackcdn.com/image/fetch/$s_!IjRU!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F4b0ef016-bb81-4a02-9a41-4f685609aea1_1584x568.png 1272w, https://substackcdn.com/image/fetch/$s_!IjRU!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F4b0ef016-bb81-4a02-9a41-4f685609aea1_1584x568.png 1456w\\\" sizes=\\\"100vw\\\"><img src=\\\"https://substackcdn.com/image/fetch/$s_!IjRU!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F4b0ef016-bb81-4a02-9a41-4f685609aea1_1584x568.png\\\" width=\\\"1456\\\" height=\\\"522\\\" data-attrs=\\\"{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/4b0ef016-bb81-4a02-9a41-4f685609aea1_1584x568.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:522,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:214524,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}\\\" class=\\\"sizing-normal\\\" alt=\\\"\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!IjRU!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F4b0ef016-bb81-4a02-9a41-4f685609aea1_1584x568.png 424w, https://substackcdn.com/image/fetch/$s_!IjRU!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F4b0ef016-bb81-4a02-9a41-4f685609aea1_1584x568.png 848w, https://substackcdn.com/image/fetch/$s_!IjRU!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F4b0ef016-bb81-4a02-9a41-4f685609aea1_1584x568.png 1272w, https://substackcdn.com/image/fetch/$s_!IjRU!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F4b0ef016-bb81-4a02-9a41-4f685609aea1_1584x568.png 1456w\\\" sizes=\\\"100vw\\\" loading=\\\"lazy\\\"></picture><div class=\\\"image-link-expand\\\"><div class=\\\"pencraft pc-display-flex pc-gap-8 pc-reset\\\"><div class=\\\"pencraft pc-reset icon-container restack-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-refresh-cw\\\"><path d=\\\"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8\\\"></path><path d=\\\"M21 3v5h-5\\\"></path><path d=\\\"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16\\\"></path><path d=\\\"M8 16H3v5\\\"></path></svg></div><div class=\\\"pencraft pc-reset icon-container view-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-maximize2\\\"><polyline points=\\\"15 3 21 3 21 9\\\"></polyline><polyline points=\\\"9 21 3 21 3 15\\\"></polyline><line x1=\\\"21\\\" x2=\\\"14\\\" y1=\\\"3\\\" y2=\\\"10\\\"></line><line x1=\\\"3\\\" x2=\\\"10\\\" y1=\\\"21\\\" y2=\\\"14\\\"></line></svg></div></div></div></div></a><figcaption class=\\\"image-caption\\\">(from [1])</figcaption></figure></div><p><strong>Tweaking the temperature. </strong>Interestingly, we also observe in [1] that the optimal <a href=\\\"https://twitter.com/cwolferesearch/status/1671628210180698112?s=20\\\">temperature</a> to use when generating samples for RLHF changes with iterative updates to the model; see above. As such, the temperature must be readjusted after each round of RLHF to achieve the best results. Furthermore, authors in [1] mention that the optimal temperature seems to be dependent upon context. For example, different shifts in the optimal temperature are observed for certain types of prompts, such as creative prompts or those that are considered more factual. </p><h4>Improving Multi-Turn Dialogue with Ghost Attention</h4><p>In many cases, dialogue agents, such as LLaMA-2-Chat, conduct conversations with users over multiple turns. Sometimes, a system message or instruction is provided to the model at the beginning of this back-and-forth conversation that should be obeyed throughout. However, we see in [1] that the LLM may quickly forget about this instruction, leading it to only apply to initial turns; see below. </p><div class=\\\"captioned-image-container\\\"><figure><a class=\\\"image-link image2 is-viewable-img\\\" target=\\\"_blank\\\" href=\\\"https://substackcdn.com/image/fetch/$s_!B0FK!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F85cc8dd2-4fbc-4aba-8767-ecf72474ff5e_1928x1106.png\\\" data-component-name=\\\"Image2ToDOM\\\"><div class=\\\"image2-inset\\\"><picture><source type=\\\"image/webp\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!B0FK!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F85cc8dd2-4fbc-4aba-8767-ecf72474ff5e_1928x1106.png 424w, https://substackcdn.com/image/fetch/$s_!B0FK!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F85cc8dd2-4fbc-4aba-8767-ecf72474ff5e_1928x1106.png 848w, https://substackcdn.com/image/fetch/$s_!B0FK!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F85cc8dd2-4fbc-4aba-8767-ecf72474ff5e_1928x1106.png 1272w, https://substackcdn.com/image/fetch/$s_!B0FK!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F85cc8dd2-4fbc-4aba-8767-ecf72474ff5e_1928x1106.png 1456w\\\" sizes=\\\"100vw\\\"><img src=\\\"https://substackcdn.com/image/fetch/$s_!B0FK!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F85cc8dd2-4fbc-4aba-8767-ecf72474ff5e_1928x1106.png\\\" width=\\\"599\\\" height=\\\"343.5199175824176\\\" data-attrs=\\\"{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/85cc8dd2-4fbc-4aba-8767-ecf72474ff5e_1928x1106.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:835,&quot;width&quot;:1456,&quot;resizeWidth&quot;:599,&quot;bytes&quot;:439450,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}\\\" class=\\\"sizing-normal\\\" alt=\\\"\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!B0FK!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F85cc8dd2-4fbc-4aba-8767-ecf72474ff5e_1928x1106.png 424w, https://substackcdn.com/image/fetch/$s_!B0FK!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F85cc8dd2-4fbc-4aba-8767-ecf72474ff5e_1928x1106.png 848w, https://substackcdn.com/image/fetch/$s_!B0FK!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F85cc8dd2-4fbc-4aba-8767-ecf72474ff5e_1928x1106.png 1272w, https://substackcdn.com/image/fetch/$s_!B0FK!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F85cc8dd2-4fbc-4aba-8767-ecf72474ff5e_1928x1106.png 1456w\\\" sizes=\\\"100vw\\\" loading=\\\"lazy\\\"></picture><div class=\\\"image-link-expand\\\"><div class=\\\"pencraft pc-display-flex pc-gap-8 pc-reset\\\"><div class=\\\"pencraft pc-reset icon-container restack-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-refresh-cw\\\"><path d=\\\"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8\\\"></path><path d=\\\"M21 3v5h-5\\\"></path><path d=\\\"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16\\\"></path><path d=\\\"M8 16H3v5\\\"></path></svg></div><div class=\\\"pencraft pc-reset icon-container view-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-maximize2\\\"><polyline points=\\\"15 3 21 3 21 9\\\"></polyline><polyline points=\\\"9 21 3 21 3 15\\\"></polyline><line x1=\\\"21\\\" x2=\\\"14\\\" y1=\\\"3\\\" y2=\\\"10\\\"></line><line x1=\\\"3\\\" x2=\\\"10\\\" y1=\\\"21\\\" y2=\\\"14\\\"></line></svg></div></div></div></div></a><figcaption class=\\\"image-caption\\\">(from [1])</figcaption></figure></div><p>To solve this issue, authors in [1] explore a fine-tuning approach with synthetic data, called Ghost Attention (GAtt). Given a dialogue session, GAtt<em> i)</em> samples an instruction that should be followed in a conversation, <em>ii)</em> concatenates this instruction to every user message within the conversation, and <em>iii)</em> samples responses to each message using the model from the latest round of RLHF. After removing the concatenated instruction from all but the first user message, such an approach can generate synthetic multi-turn dialogue data that consistently abides by an instruction. Then, we can just fine-tune over this data using SFT, which\u2014<em>as shown above</em>\u2014improves instruction following over long dialogues!</p><h2>Evaluations and Key Findings</h2><p>LLaMA-2 and LLaMA-2-Chat are evaluated extensively in comparison to both other open-source LLMs and proprietary models. The base and fine-tuned models set a new state-of-the-art among open-source LLMs. As we will see, these models also have a variety of different emergent capabilities<a class=\\\"footnote-anchor\\\" data-component-name=\\\"FootnoteAnchorToDOM\\\" id=\\\"footnote-anchor-8\\\" href=\\\"#footnote-8\\\" target=\\\"_self\\\">8</a> and interesting properties that are analyzed extensively within [1] to provide useful insights.</p><h4>LLaMA-2 (Base Model) Performance</h4><div class=\\\"captioned-image-container\\\"><figure><a class=\\\"image-link image2 is-viewable-img\\\" target=\\\"_blank\\\" href=\\\"https://substackcdn.com/image/fetch/$s_!qmpo!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F02a42b8e-34ba-48f4-b9c5-1f36ba909f64_1260x490.png\\\" data-component-name=\\\"Image2ToDOM\\\"><div class=\\\"image2-inset\\\"><picture><source type=\\\"image/webp\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!qmpo!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F02a42b8e-34ba-48f4-b9c5-1f36ba909f64_1260x490.png 424w, https://substackcdn.com/image/fetch/$s_!qmpo!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F02a42b8e-34ba-48f4-b9c5-1f36ba909f64_1260x490.png 848w, https://substackcdn.com/image/fetch/$s_!qmpo!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F02a42b8e-34ba-48f4-b9c5-1f36ba909f64_1260x490.png 1272w, https://substackcdn.com/image/fetch/$s_!qmpo!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F02a42b8e-34ba-48f4-b9c5-1f36ba909f64_1260x490.png 1456w\\\" sizes=\\\"100vw\\\"><img src=\\\"https://substackcdn.com/image/fetch/$s_!qmpo!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F02a42b8e-34ba-48f4-b9c5-1f36ba909f64_1260x490.png\\\" width=\\\"1260\\\" height=\\\"490\\\" data-attrs=\\\"{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/02a42b8e-34ba-48f4-b9c5-1f36ba909f64_1260x490.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:490,&quot;width&quot;:1260,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:null,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:null,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}\\\" class=\\\"sizing-normal\\\" alt=\\\"\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!qmpo!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F02a42b8e-34ba-48f4-b9c5-1f36ba909f64_1260x490.png 424w, https://substackcdn.com/image/fetch/$s_!qmpo!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F02a42b8e-34ba-48f4-b9c5-1f36ba909f64_1260x490.png 848w, https://substackcdn.com/image/fetch/$s_!qmpo!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F02a42b8e-34ba-48f4-b9c5-1f36ba909f64_1260x490.png 1272w, https://substackcdn.com/image/fetch/$s_!qmpo!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F02a42b8e-34ba-48f4-b9c5-1f36ba909f64_1260x490.png 1456w\\\" sizes=\\\"100vw\\\" loading=\\\"lazy\\\"></picture><div class=\\\"image-link-expand\\\"><div class=\\\"pencraft pc-display-flex pc-gap-8 pc-reset\\\"><div class=\\\"pencraft pc-reset icon-container restack-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-refresh-cw\\\"><path d=\\\"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8\\\"></path><path d=\\\"M21 3v5h-5\\\"></path><path d=\\\"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16\\\"></path><path d=\\\"M8 16H3v5\\\"></path></svg></div><div class=\\\"pencraft pc-reset icon-container view-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-maximize2\\\"><polyline points=\\\"15 3 21 3 21 9\\\"></polyline><polyline points=\\\"9 21 3 21 3 15\\\"></polyline><line x1=\\\"21\\\" x2=\\\"14\\\" y1=\\\"3\\\" y2=\\\"10\\\"></line><line x1=\\\"3\\\" x2=\\\"10\\\" y1=\\\"21\\\" y2=\\\"14\\\"></line></svg></div></div></div></div></a><figcaption class=\\\"image-caption\\\">(from [1])</figcaption></figure></div><p>Compared to popular open-source base LLMs (e.g., <a href=\\\"https://cameronrwolfe.substack.com/p/democratizing-ai-mosaicmls-impact\\\">MPT</a>, <a href=\\\"https://cameronrwolfe.substack.com/p/falcon-the-pinnacle-of-open-source\\\">Falcon</a>, and <a href=\\\"https://cameronrwolfe.substack.com/p/llama-llms-for-everyone\\\">LLaMA-1</a>), LLaMA-2 models set a new state-of-the-art on all tasks considered; see above. Notably, however, LLaMA-2 was somewhat <a href=\\\"https://twitter.com/amasad/status/1681383736032493580?s=20\\\">criticized</a> for its (relatively) poor performance on coding-based tasks (e.g., <a href=\\\"https://arxiv.org/abs/2107.03374\\\">HumanEval</a>). Some have speculated that this may be due to a lack of sufficient code within LLaMA-2\u2019s pre-training corpus, though the exact explanation is not completely clear as of now. </p><div class=\\\"captioned-image-container\\\"><figure><a class=\\\"image-link image2 is-viewable-img\\\" target=\\\"_blank\\\" href=\\\"https://substackcdn.com/image/fetch/$s_!Wvzh!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7984d418-3031-480a-8438-a7e992c82023_1262x356.png\\\" data-component-name=\\\"Image2ToDOM\\\"><div class=\\\"image2-inset\\\"><picture><source type=\\\"image/webp\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!Wvzh!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7984d418-3031-480a-8438-a7e992c82023_1262x356.png 424w, https://substackcdn.com/image/fetch/$s_!Wvzh!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7984d418-3031-480a-8438-a7e992c82023_1262x356.png 848w, https://substackcdn.com/image/fetch/$s_!Wvzh!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7984d418-3031-480a-8438-a7e992c82023_1262x356.png 1272w, https://substackcdn.com/image/fetch/$s_!Wvzh!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7984d418-3031-480a-8438-a7e992c82023_1262x356.png 1456w\\\" sizes=\\\"100vw\\\"><img src=\\\"https://substackcdn.com/image/fetch/$s_!Wvzh!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7984d418-3031-480a-8438-a7e992c82023_1262x356.png\\\" width=\\\"1262\\\" height=\\\"356\\\" data-attrs=\\\"{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/7984d418-3031-480a-8438-a7e992c82023_1262x356.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:356,&quot;width&quot;:1262,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:null,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:null,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}\\\" class=\\\"sizing-normal\\\" alt=\\\"\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!Wvzh!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7984d418-3031-480a-8438-a7e992c82023_1262x356.png 424w, https://substackcdn.com/image/fetch/$s_!Wvzh!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7984d418-3031-480a-8438-a7e992c82023_1262x356.png 848w, https://substackcdn.com/image/fetch/$s_!Wvzh!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7984d418-3031-480a-8438-a7e992c82023_1262x356.png 1272w, https://substackcdn.com/image/fetch/$s_!Wvzh!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7984d418-3031-480a-8438-a7e992c82023_1262x356.png 1456w\\\" sizes=\\\"100vw\\\" loading=\\\"lazy\\\"></picture><div class=\\\"image-link-expand\\\"><div class=\\\"pencraft pc-display-flex pc-gap-8 pc-reset\\\"><div class=\\\"pencraft pc-reset icon-container restack-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-refresh-cw\\\"><path d=\\\"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8\\\"></path><path d=\\\"M21 3v5h-5\\\"></path><path d=\\\"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16\\\"></path><path d=\\\"M8 16H3v5\\\"></path></svg></div><div class=\\\"pencraft pc-reset icon-container view-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-maximize2\\\"><polyline points=\\\"15 3 21 3 21 9\\\"></polyline><polyline points=\\\"9 21 3 21 3 15\\\"></polyline><line x1=\\\"21\\\" x2=\\\"14\\\" y1=\\\"3\\\" y2=\\\"10\\\"></line><line x1=\\\"3\\\" x2=\\\"10\\\" y1=\\\"21\\\" y2=\\\"14\\\"></line></svg></div></div></div></div></a><figcaption class=\\\"image-caption\\\">(from [1])</figcaption></figure></div><p>When compared to proprietary models, LLaMA-2 base models perform worse; see above. However, we should keep in mind that this comparison is made between a base LLM and aligned models like GPT-3.5 and GPT-4. When compared to proprietary base LLMs (e.g., <a href=\\\"https://cameronrwolfe.substack.com/p/palm-efficiently-training-massive\\\">PaLM</a> [4]), LLaMA-2 performs favorably!</p><div class=\\\"captioned-image-container\\\"><figure><a class=\\\"image-link image2 is-viewable-img\\\" target=\\\"_blank\\\" href=\\\"https://substackcdn.com/image/fetch/$s_!KocF!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F13124aad-2af1-43ed-8ac1-291c1cd49072_1590x732.png\\\" data-component-name=\\\"Image2ToDOM\\\"><div class=\\\"image2-inset\\\"><picture><source type=\\\"image/webp\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!KocF!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F13124aad-2af1-43ed-8ac1-291c1cd49072_1590x732.png 424w, https://substackcdn.com/image/fetch/$s_!KocF!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F13124aad-2af1-43ed-8ac1-291c1cd49072_1590x732.png 848w, https://substackcdn.com/image/fetch/$s_!KocF!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F13124aad-2af1-43ed-8ac1-291c1cd49072_1590x732.png 1272w, https://substackcdn.com/image/fetch/$s_!KocF!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F13124aad-2af1-43ed-8ac1-291c1cd49072_1590x732.png 1456w\\\" sizes=\\\"100vw\\\"><img src=\\\"https://substackcdn.com/image/fetch/$s_!KocF!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F13124aad-2af1-43ed-8ac1-291c1cd49072_1590x732.png\\\" width=\\\"1456\\\" height=\\\"670\\\" data-attrs=\\\"{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/13124aad-2af1-43ed-8ac1-291c1cd49072_1590x732.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:670,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:158497,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}\\\" class=\\\"sizing-normal\\\" alt=\\\"\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!KocF!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F13124aad-2af1-43ed-8ac1-291c1cd49072_1590x732.png 424w, https://substackcdn.com/image/fetch/$s_!KocF!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F13124aad-2af1-43ed-8ac1-291c1cd49072_1590x732.png 848w, https://substackcdn.com/image/fetch/$s_!KocF!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F13124aad-2af1-43ed-8ac1-291c1cd49072_1590x732.png 1272w, https://substackcdn.com/image/fetch/$s_!KocF!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F13124aad-2af1-43ed-8ac1-291c1cd49072_1590x732.png 1456w\\\" sizes=\\\"100vw\\\" loading=\\\"lazy\\\"></picture><div class=\\\"image-link-expand\\\"><div class=\\\"pencraft pc-display-flex pc-gap-8 pc-reset\\\"><div class=\\\"pencraft pc-reset icon-container restack-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-refresh-cw\\\"><path d=\\\"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8\\\"></path><path d=\\\"M21 3v5h-5\\\"></path><path d=\\\"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16\\\"></path><path d=\\\"M8 16H3v5\\\"></path></svg></div><div class=\\\"pencraft pc-reset icon-container view-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-maximize2\\\"><polyline points=\\\"15 3 21 3 21 9\\\"></polyline><polyline points=\\\"9 21 3 21 3 15\\\"></polyline><line x1=\\\"21\\\" x2=\\\"14\\\" y1=\\\"3\\\" y2=\\\"10\\\"></line><line x1=\\\"3\\\" x2=\\\"10\\\" y1=\\\"21\\\" y2=\\\"14\\\"></line></svg></div></div></div></div></a><figcaption class=\\\"image-caption\\\">(from [1])</figcaption></figure></div><p><strong>Safety results.</strong> As we have mentioned previously, the authors of LLaMA-2 place an emphasis upon safety when crafting the model\u2019s pre-training dataset, leading them to measure and even exclude data according to a variety of different factors. Despite these efforts to minimize bias in the pre-training dataset, results on automatic safety benchmarks are mixed as shown above. While LLaMA-2-7B is less toxic and more truthful and informative compared to prior models, larger models (e.g., LLaMA-2-34B and LLaMA-2-70B) seem to have an increase in toxicity, which the authors claim may come from their use of a larger pre-training and lack of aggressive filtering of toxic information from this dataset.</p><h4>Fine-Tuning Analysis for LLaMA-2-Chat</h4><blockquote><p><em>\u201CEvaluating LLMs is a challenging open-research problem. Human evaluation, while a gold standard, can be complicated by various HCI considerations, and is not always scalable.\u201D</em> - from [1]</p></blockquote><p>LLaMA-2-Chat is evaluated according to its levels of helpfulness and safety using a variety of different techniques. First, evaluation of model quality is automated by using reward model output as a proxy for performance. The results of these evaluations\u2014and alternative evaluations that use GPT-4 as a judge\u2014are shown below, where we see that LLaMA-2-Chat slowly becomes more helpful and safe throughout each round of the fine-tuning process with both SFT and RLHF.  </p><div class=\\\"captioned-image-container\\\"><figure><a class=\\\"image-link image2 is-viewable-img\\\" target=\\\"_blank\\\" href=\\\"https://substackcdn.com/image/fetch/$s_!9A3z!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F97eb6108-8b95-47a1-965e-85e8390d70b4_1892x672.png\\\" data-component-name=\\\"Image2ToDOM\\\"><div class=\\\"image2-inset\\\"><picture><source type=\\\"image/webp\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!9A3z!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F97eb6108-8b95-47a1-965e-85e8390d70b4_1892x672.png 424w, https://substackcdn.com/image/fetch/$s_!9A3z!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F97eb6108-8b95-47a1-965e-85e8390d70b4_1892x672.png 848w, https://substackcdn.com/image/fetch/$s_!9A3z!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F97eb6108-8b95-47a1-965e-85e8390d70b4_1892x672.png 1272w, https://substackcdn.com/image/fetch/$s_!9A3z!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F97eb6108-8b95-47a1-965e-85e8390d70b4_1892x672.png 1456w\\\" sizes=\\\"100vw\\\"><img src=\\\"https://substackcdn.com/image/fetch/$s_!9A3z!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F97eb6108-8b95-47a1-965e-85e8390d70b4_1892x672.png\\\" width=\\\"1456\\\" height=\\\"517\\\" data-attrs=\\\"{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/97eb6108-8b95-47a1-965e-85e8390d70b4_1892x672.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:517,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:673527,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}\\\" class=\\\"sizing-normal\\\" alt=\\\"\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!9A3z!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F97eb6108-8b95-47a1-965e-85e8390d70b4_1892x672.png 424w, https://substackcdn.com/image/fetch/$s_!9A3z!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F97eb6108-8b95-47a1-965e-85e8390d70b4_1892x672.png 848w, https://substackcdn.com/image/fetch/$s_!9A3z!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F97eb6108-8b95-47a1-965e-85e8390d70b4_1892x672.png 1272w, https://substackcdn.com/image/fetch/$s_!9A3z!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F97eb6108-8b95-47a1-965e-85e8390d70b4_1892x672.png 1456w\\\" sizes=\\\"100vw\\\" loading=\\\"lazy\\\"></picture><div class=\\\"image-link-expand\\\"><div class=\\\"pencraft pc-display-flex pc-gap-8 pc-reset\\\"><div class=\\\"pencraft pc-reset icon-container restack-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-refresh-cw\\\"><path d=\\\"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8\\\"></path><path d=\\\"M21 3v5h-5\\\"></path><path d=\\\"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16\\\"></path><path d=\\\"M8 16H3v5\\\"></path></svg></div><div class=\\\"pencraft pc-reset icon-container view-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-maximize2\\\"><polyline points=\\\"15 3 21 3 21 9\\\"></polyline><polyline points=\\\"9 21 3 21 3 15\\\"></polyline><line x1=\\\"21\\\" x2=\\\"14\\\" y1=\\\"3\\\" y2=\\\"10\\\"></line><line x1=\\\"3\\\" x2=\\\"10\\\" y1=\\\"21\\\" y2=\\\"14\\\"></line></svg></div></div></div></div></a><figcaption class=\\\"image-caption\\\">(from [1])</figcaption></figure></div><p>Although such automated metrics are informative, they can be biased or incorrect. As such, LLaMA-2-Chat is subjected to extensive human evaluations. In the figure below, we see that humans find LLaMA-2-Chat to be more helpful than a variety of powerful open-source and proprietary language models. Similarly, LLaMA-2-Chat exceeds the same models in human safety evaluations. As such, the LLaMA-2-Chat model is generally found to be more helpful and safe than a variety of other powerful LLMs based on extensive human evaluation. </p><div class=\\\"captioned-image-container\\\"><figure><a class=\\\"image-link image2 is-viewable-img\\\" target=\\\"_blank\\\" href=\\\"https://substackcdn.com/image/fetch/$s_!u5d8!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F065228d3-36b5-4837-9901-84fd88d02ec4_2040x792.png\\\" data-component-name=\\\"Image2ToDOM\\\"><div class=\\\"image2-inset\\\"><picture><source type=\\\"image/webp\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!u5d8!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F065228d3-36b5-4837-9901-84fd88d02ec4_2040x792.png 424w, https://substackcdn.com/image/fetch/$s_!u5d8!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F065228d3-36b5-4837-9901-84fd88d02ec4_2040x792.png 848w, https://substackcdn.com/image/fetch/$s_!u5d8!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F065228d3-36b5-4837-9901-84fd88d02ec4_2040x792.png 1272w, https://substackcdn.com/image/fetch/$s_!u5d8!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F065228d3-36b5-4837-9901-84fd88d02ec4_2040x792.png 1456w\\\" sizes=\\\"100vw\\\"><img src=\\\"https://substackcdn.com/image/fetch/$s_!u5d8!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F065228d3-36b5-4837-9901-84fd88d02ec4_2040x792.png\\\" width=\\\"1456\\\" height=\\\"565\\\" data-attrs=\\\"{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/065228d3-36b5-4837-9901-84fd88d02ec4_2040x792.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:565,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:623109,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}\\\" class=\\\"sizing-normal\\\" alt=\\\"\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!u5d8!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F065228d3-36b5-4837-9901-84fd88d02ec4_2040x792.png 424w, https://substackcdn.com/image/fetch/$s_!u5d8!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F065228d3-36b5-4837-9901-84fd88d02ec4_2040x792.png 848w, https://substackcdn.com/image/fetch/$s_!u5d8!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F065228d3-36b5-4837-9901-84fd88d02ec4_2040x792.png 1272w, https://substackcdn.com/image/fetch/$s_!u5d8!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F065228d3-36b5-4837-9901-84fd88d02ec4_2040x792.png 1456w\\\" sizes=\\\"100vw\\\" loading=\\\"lazy\\\"></picture><div class=\\\"image-link-expand\\\"><div class=\\\"pencraft pc-display-flex pc-gap-8 pc-reset\\\"><div class=\\\"pencraft pc-reset icon-container restack-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-refresh-cw\\\"><path d=\\\"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8\\\"></path><path d=\\\"M21 3v5h-5\\\"></path><path d=\\\"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16\\\"></path><path d=\\\"M8 16H3v5\\\"></path></svg></div><div class=\\\"pencraft pc-reset icon-container view-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-maximize2\\\"><polyline points=\\\"15 3 21 3 21 9\\\"></polyline><polyline points=\\\"9 21 3 21 3 15\\\"></polyline><line x1=\\\"21\\\" x2=\\\"14\\\" y1=\\\"3\\\" y2=\\\"10\\\"></line><line x1=\\\"3\\\" x2=\\\"10\\\" y1=\\\"21\\\" y2=\\\"14\\\"></line></svg></div></div></div></div></a><figcaption class=\\\"image-caption\\\">(from [1])</figcaption></figure></div><p>Despite these results, we should recall that human evaluations can be limited and are only conducted over a (relatively) small set of prompts<a class=\\\"footnote-anchor\\\" data-component-name=\\\"FootnoteAnchorToDOM\\\" id=\\\"footnote-anchor-9\\\" href=\\\"#footnote-9\\\" target=\\\"_self\\\">9</a>.  In general, human evaluation can be subjective and noise is present in the evaluation process, which we should keep in mind when studying and interpreting these results.</p><div class=\\\"captioned-image-container\\\"><figure><a class=\\\"image-link image2 is-viewable-img\\\" target=\\\"_blank\\\" href=\\\"https://substackcdn.com/image/fetch/$s_!D8gh!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F1bc94cc6-4876-4a05-beb9-12ec1727926c_1274x806.png\\\" data-component-name=\\\"Image2ToDOM\\\"><div class=\\\"image2-inset\\\"><picture><source type=\\\"image/webp\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!D8gh!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F1bc94cc6-4876-4a05-beb9-12ec1727926c_1274x806.png 424w, https://substackcdn.com/image/fetch/$s_!D8gh!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F1bc94cc6-4876-4a05-beb9-12ec1727926c_1274x806.png 848w, https://substackcdn.com/image/fetch/$s_!D8gh!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F1bc94cc6-4876-4a05-beb9-12ec1727926c_1274x806.png 1272w, https://substackcdn.com/image/fetch/$s_!D8gh!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F1bc94cc6-4876-4a05-beb9-12ec1727926c_1274x806.png 1456w\\\" sizes=\\\"100vw\\\"><img src=\\\"https://substackcdn.com/image/fetch/$s_!D8gh!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F1bc94cc6-4876-4a05-beb9-12ec1727926c_1274x806.png\\\" width=\\\"1274\\\" height=\\\"806\\\" data-attrs=\\\"{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/1bc94cc6-4876-4a05-beb9-12ec1727926c_1274x806.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:806,&quot;width&quot;:1274,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:209798,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}\\\" class=\\\"sizing-normal\\\" alt=\\\"\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!D8gh!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F1bc94cc6-4876-4a05-beb9-12ec1727926c_1274x806.png 424w, https://substackcdn.com/image/fetch/$s_!D8gh!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F1bc94cc6-4876-4a05-beb9-12ec1727926c_1274x806.png 848w, https://substackcdn.com/image/fetch/$s_!D8gh!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F1bc94cc6-4876-4a05-beb9-12ec1727926c_1274x806.png 1272w, https://substackcdn.com/image/fetch/$s_!D8gh!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F1bc94cc6-4876-4a05-beb9-12ec1727926c_1274x806.png 1456w\\\" sizes=\\\"100vw\\\" loading=\\\"lazy\\\"></picture><div class=\\\"image-link-expand\\\"><div class=\\\"pencraft pc-display-flex pc-gap-8 pc-reset\\\"><div class=\\\"pencraft pc-reset icon-container restack-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-refresh-cw\\\"><path d=\\\"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8\\\"></path><path d=\\\"M21 3v5h-5\\\"></path><path d=\\\"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16\\\"></path><path d=\\\"M8 16H3v5\\\"></path></svg></div><div class=\\\"pencraft pc-reset icon-container view-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-maximize2\\\"><polyline points=\\\"15 3 21 3 21 9\\\"></polyline><polyline points=\\\"9 21 3 21 3 15\\\"></polyline><line x1=\\\"21\\\" x2=\\\"14\\\" y1=\\\"3\\\" y2=\\\"10\\\"></line><line x1=\\\"3\\\" x2=\\\"10\\\" y1=\\\"21\\\" y2=\\\"14\\\"></line></svg></div></div></div></div></a><figcaption class=\\\"image-caption\\\">(from [1])</figcaption></figure></div><p><strong>Reward model scaling. </strong>To assess the quality of helpfulness and safety reward models created in [1], authors compare and evaluate these models against a variety of other reward models; see above. As expected, the reward models used to fine-tune LLaMA-2-Chat seem to perform the best. Additionally, we see that larger reward models perform better when trained over the same amount of data and that the performance of reward models has yet to reach a plateau; see below. </p><div class=\\\"captioned-image-container\\\"><figure><a class=\\\"image-link image2 is-viewable-img\\\" target=\\\"_blank\\\" href=\\\"https://substackcdn.com/image/fetch/$s_!-CvU!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F92dac79e-851f-4bd1-ab42-07f0c48b237f_1266x528.png\\\" data-component-name=\\\"Image2ToDOM\\\"><div class=\\\"image2-inset\\\"><picture><source type=\\\"image/webp\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!-CvU!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F92dac79e-851f-4bd1-ab42-07f0c48b237f_1266x528.png 424w, https://substackcdn.com/image/fetch/$s_!-CvU!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F92dac79e-851f-4bd1-ab42-07f0c48b237f_1266x528.png 848w, https://substackcdn.com/image/fetch/$s_!-CvU!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F92dac79e-851f-4bd1-ab42-07f0c48b237f_1266x528.png 1272w, https://substackcdn.com/image/fetch/$s_!-CvU!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F92dac79e-851f-4bd1-ab42-07f0c48b237f_1266x528.png 1456w\\\" sizes=\\\"100vw\\\"><img src=\\\"https://substackcdn.com/image/fetch/$s_!-CvU!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F92dac79e-851f-4bd1-ab42-07f0c48b237f_1266x528.png\\\" width=\\\"1266\\\" height=\\\"528\\\" data-attrs=\\\"{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/92dac79e-851f-4bd1-ab42-07f0c48b237f_1266x528.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:528,&quot;width&quot;:1266,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:171197,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}\\\" class=\\\"sizing-normal\\\" alt=\\\"\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!-CvU!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F92dac79e-851f-4bd1-ab42-07f0c48b237f_1266x528.png 424w, https://substackcdn.com/image/fetch/$s_!-CvU!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F92dac79e-851f-4bd1-ab42-07f0c48b237f_1266x528.png 848w, https://substackcdn.com/image/fetch/$s_!-CvU!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F92dac79e-851f-4bd1-ab42-07f0c48b237f_1266x528.png 1272w, https://substackcdn.com/image/fetch/$s_!-CvU!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F92dac79e-851f-4bd1-ab42-07f0c48b237f_1266x528.png 1456w\\\" sizes=\\\"100vw\\\" loading=\\\"lazy\\\"></picture><div class=\\\"image-link-expand\\\"><div class=\\\"pencraft pc-display-flex pc-gap-8 pc-reset\\\"><div class=\\\"pencraft pc-reset icon-container restack-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-refresh-cw\\\"><path d=\\\"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8\\\"></path><path d=\\\"M21 3v5h-5\\\"></path><path d=\\\"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16\\\"></path><path d=\\\"M8 16H3v5\\\"></path></svg></div><div class=\\\"pencraft pc-reset icon-container view-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-maximize2\\\"><polyline points=\\\"15 3 21 3 21 9\\\"></polyline><polyline points=\\\"9 21 3 21 3 15\\\"></polyline><line x1=\\\"21\\\" x2=\\\"14\\\" y1=\\\"3\\\" y2=\\\"10\\\"></line><line x1=\\\"3\\\" x2=\\\"10\\\" y1=\\\"21\\\" y2=\\\"14\\\"></line></svg></div></div></div></div></a><figcaption class=\\\"image-caption\\\">(from [1])</figcaption></figure></div><p><em>Why does this matter?</em> As authors note in [1], the performance of the reward model, given that it is used to automate preference feedback during RLHF, is directly related to the performance of the fine-tuned chat model. In other words, an improvement in the quality of the reward model tends to produce a relative improvement in the quality of the fine-tuned LLM. The results above seem to indicate that using larger reward models trained over more data is helpful.</p><p><strong>Other findings. </strong>In addition to the helpfulness and safety analysis performed in [1], a variety of interesting observations are made about the behavior of LLaMA-2-Chat. Most LLMs struggle with temporal reasoning (i.e., reasoning about when in time certain events occurred), but LLaMA-2 is fine-tuned to better process temporal information by performing SFT over time-focused prompt-response examples. As such, the model is surprisingly capable of organizing knowledge in a temporal manner; see above. Going further, LLaMA-2-Chat is not specifically trained to <a href=\\\"https://cameronrwolfe.substack.com/p/teaching-language-models-to-use-tools\\\">leverage tools</a>, but the model seems to be able to generalize to tool usage in a <a href=\\\"https://cameronrwolfe.substack.com/i/117151147/zero-shot-learning\\\">zero-shot</a> manner as shown in the figure below. </p><div class=\\\"captioned-image-container\\\"><figure><a class=\\\"image-link image2 is-viewable-img\\\" target=\\\"_blank\\\" href=\\\"https://substackcdn.com/image/fetch/$s_!GE4V!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1625468-04e3-4875-a760-f25c6da9187a_1578x614.png\\\" data-component-name=\\\"Image2ToDOM\\\"><div class=\\\"image2-inset\\\"><picture><source type=\\\"image/webp\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!GE4V!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1625468-04e3-4875-a760-f25c6da9187a_1578x614.png 424w, https://substackcdn.com/image/fetch/$s_!GE4V!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1625468-04e3-4875-a760-f25c6da9187a_1578x614.png 848w, https://substackcdn.com/image/fetch/$s_!GE4V!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1625468-04e3-4875-a760-f25c6da9187a_1578x614.png 1272w, https://substackcdn.com/image/fetch/$s_!GE4V!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1625468-04e3-4875-a760-f25c6da9187a_1578x614.png 1456w\\\" sizes=\\\"100vw\\\"><img src=\\\"https://substackcdn.com/image/fetch/$s_!GE4V!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1625468-04e3-4875-a760-f25c6da9187a_1578x614.png\\\" width=\\\"1456\\\" height=\\\"567\\\" data-attrs=\\\"{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/a1625468-04e3-4875-a760-f25c6da9187a_1578x614.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:567,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:270416,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}\\\" class=\\\"sizing-normal\\\" alt=\\\"\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!GE4V!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1625468-04e3-4875-a760-f25c6da9187a_1578x614.png 424w, https://substackcdn.com/image/fetch/$s_!GE4V!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1625468-04e3-4875-a760-f25c6da9187a_1578x614.png 848w, https://substackcdn.com/image/fetch/$s_!GE4V!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1625468-04e3-4875-a760-f25c6da9187a_1578x614.png 1272w, https://substackcdn.com/image/fetch/$s_!GE4V!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1625468-04e3-4875-a760-f25c6da9187a_1578x614.png 1456w\\\" sizes=\\\"100vw\\\" loading=\\\"lazy\\\"></picture><div class=\\\"image-link-expand\\\"><div class=\\\"pencraft pc-display-flex pc-gap-8 pc-reset\\\"><div class=\\\"pencraft pc-reset icon-container restack-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-refresh-cw\\\"><path d=\\\"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8\\\"></path><path d=\\\"M21 3v5h-5\\\"></path><path d=\\\"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16\\\"></path><path d=\\\"M8 16H3v5\\\"></path></svg></div><div class=\\\"pencraft pc-reset icon-container view-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-maximize2\\\"><polyline points=\\\"15 3 21 3 21 9\\\"></polyline><polyline points=\\\"9 21 3 21 3 15\\\"></polyline><line x1=\\\"21\\\" x2=\\\"14\\\" y1=\\\"3\\\" y2=\\\"10\\\"></line><line x1=\\\"3\\\" x2=\\\"10\\\" y1=\\\"21\\\" y2=\\\"14\\\"></line></svg></div></div></div></div></a><figcaption class=\\\"image-caption\\\">(from [1])</figcaption></figure></div><h2>Closing Thoughts</h2><p>The LLaMA-2 (and LLaMA-2-Chat) suite of LLMs mark the beginning of a new era for open-source LLMs, as their performance is now closer than ever to that of top proprietary models like ChatGPT and GPT-4. When we examine the key insights from [1] that make these models so impressive, we will notice that simple changes can have a big impact on model performance. However, a variety of in-depth technical insights are provided by LLaMA-2 as well. Some of the major takeaways from LLaMA-2 are itemized and elaborated below. </p><p><strong>Garbage in = garbage out. </strong>As we have <a href=\\\"https://cameronrwolfe.substack.com/p/data-is-the-foundation-of-language\\\">discussed previously</a>, the amount and quality of data used to train an LLM\u2014both during pre-training and fine-tuning\u2014is incredibly important. We see in [1] that part of what makes LLaMA-2 so great is an emphasis upon data. During pre-training, the model observes 40% more data than its predecessor and adopts a modified mixture that emphasizes factual sources. Additionally, LLaMA-2 adopts an approach similar to <a href=\\\"https://cameronrwolfe.substack.com/i/134561977/lima-less-is-more-for-alignment\\\">LIMA</a> during fine-tuning by curating a smaller, high-quality corpus of dialogues for SFT.</p><p><strong>Alignment is important.</strong> One of the largest differences between LLaMA-2 and prior work on open-source LLMs is the emphasis upon high-quality alignment. Rather than simply performing SFT with public data, authors in [1] truly try to replicate the complex alignment process that is used for proprietary models by performing multiple rounds of both SFT and RLHF. Although the resulting LLaMA-2-Chat model isn\u2019t the current leader on the <a href=\\\"https://huggingface.co/spaces/HuggingFaceH4/open_llm_leaderboard\\\">Open LLM Leaderboard</a><a class=\\\"footnote-anchor\\\" data-component-name=\\\"FootnoteAnchorToDOM\\\" id=\\\"footnote-anchor-10\\\" href=\\\"#footnote-10\\\" target=\\\"_self\\\">10</a>, such an emphasis upon extensive alignment provides invaluable technical insight that drastically improves the transparency of research in this area. </p><div class=\\\"captioned-image-container\\\"><figure><a class=\\\"image-link image2 is-viewable-img\\\" target=\\\"_blank\\\" href=\\\"https://substackcdn.com/image/fetch/$s_!PvSs!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F5e903beb-ebf5-44b2-9731-55afc4c02584_1584x432.png\\\" data-component-name=\\\"Image2ToDOM\\\"><div class=\\\"image2-inset\\\"><picture><source type=\\\"image/webp\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!PvSs!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F5e903beb-ebf5-44b2-9731-55afc4c02584_1584x432.png 424w, https://substackcdn.com/image/fetch/$s_!PvSs!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F5e903beb-ebf5-44b2-9731-55afc4c02584_1584x432.png 848w, https://substackcdn.com/image/fetch/$s_!PvSs!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F5e903beb-ebf5-44b2-9731-55afc4c02584_1584x432.png 1272w, https://substackcdn.com/image/fetch/$s_!PvSs!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F5e903beb-ebf5-44b2-9731-55afc4c02584_1584x432.png 1456w\\\" sizes=\\\"100vw\\\"><img src=\\\"https://substackcdn.com/image/fetch/$s_!PvSs!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F5e903beb-ebf5-44b2-9731-55afc4c02584_1584x432.png\\\" width=\\\"1456\\\" height=\\\"397\\\" data-attrs=\\\"{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/5e903beb-ebf5-44b2-9731-55afc4c02584_1584x432.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:397,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:87793,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}\\\" class=\\\"sizing-normal\\\" alt=\\\"\\\" srcset=\\\"https://substackcdn.com/image/fetch/$s_!PvSs!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F5e903beb-ebf5-44b2-9731-55afc4c02584_1584x432.png 424w, https://substackcdn.com/image/fetch/$s_!PvSs!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F5e903beb-ebf5-44b2-9731-55afc4c02584_1584x432.png 848w, https://substackcdn.com/image/fetch/$s_!PvSs!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F5e903beb-ebf5-44b2-9731-55afc4c02584_1584x432.png 1272w, https://substackcdn.com/image/fetch/$s_!PvSs!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F5e903beb-ebf5-44b2-9731-55afc4c02584_1584x432.png 1456w\\\" sizes=\\\"100vw\\\" loading=\\\"lazy\\\"></picture><div class=\\\"image-link-expand\\\"><div class=\\\"pencraft pc-display-flex pc-gap-8 pc-reset\\\"><div class=\\\"pencraft pc-reset icon-container restack-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-refresh-cw\\\"><path d=\\\"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8\\\"></path><path d=\\\"M21 3v5h-5\\\"></path><path d=\\\"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16\\\"></path><path d=\\\"M8 16H3v5\\\"></path></svg></div><div class=\\\"pencraft pc-reset icon-container view-image\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"lucide lucide-maximize2\\\"><polyline points=\\\"15 3 21 3 21 9\\\"></polyline><polyline points=\\\"9 21 3 21 3 15\\\"></polyline><line x1=\\\"21\\\" x2=\\\"14\\\" y1=\\\"3\\\" y2=\\\"10\\\"></line><line x1=\\\"3\\\" x2=\\\"10\\\" y1=\\\"21\\\" y2=\\\"14\\\"></line></svg></div></div></div></div></a><figcaption class=\\\"image-caption\\\">(from [1])</figcaption></figure></div><p><strong>RLHF is powerful.</strong> Interestingly, authors in [1] mentioned an aversion to using reinforcement learning-based alignment approaches at the outset of this project. However, we see in [1] that reinforcement learning is incredibly effective! RLHF seems to be a natural approach for alignment, as it fosters a synergy between human and LLM via iterative feedback and fine-tuning. Although SFT is useful, human writing quality has high variance, and the model must learn (at least in part) from the tail end of this variance (i.e., bad examples) when using SFT. In contrast, the annotation process for RLHF only requires humans to select the better response, which is less noisy and allows poor responses to be eliminated over time; see above. Additionally, we can observe during RLHF responses that even go beyond human writing comprehension. Despite not being able to write such responses, humans can easily rate them as preferable.</p><blockquote><p><em>\u201CMany among us expressed a preference for supervised annotation, attracted by its denser signal\u2026 However, reinforcement learning proved highly effective, particularly given its cost and time effectiveness. Our findings underscore that the crucial determinant of RLHF\u2019s success lies in the synergy it fosters between humans and LLMs throughout the annotation process.\u201D</em> - from [1]</p></blockquote><h4>New to the newsletter?</h4><p>Hi! I\u2019m <a href=\\\"https://cameronrwolfe.me/\\\">Cameron R. Wolfe</a>, deep learning Ph.D. and Director of AI at <a href=\\\"https://www.rebuyengine.com/\\\">Rebuy</a>. This is the Deep (Learning) Focus newsletter, where I help readers understand AI research via overviews that explain relevant topics from the ground up. If you like the newsletter, please subscribe, share it, or follow me on <a href=\\\"https://twitter.com/cwolferesearch\\\">twitter</a> or <a href=\\\"https://www.linkedin.com/in/cameron-r-wolfe-ph-d-04744a238/\\\">LinkedIn</a>!</p><p class=\\\"button-wrapper\\\" data-attrs=\\\"{&quot;url&quot;:&quot;https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up?utm_source=substack&utm_medium=email&utm_content=share&action=share&quot;,&quot;text&quot;:&quot;Share&quot;,&quot;action&quot;:null,&quot;class&quot;:null}\\\" data-component-name=\\\"ButtonCreateButton\\\"><a class=\\\"button primary\\\" href=\\\"https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up?utm_source=substack&utm_medium=email&utm_content=share&action=share\\\"><span>Share</span></a></p><h4>Bibliography</h4><p>[1] Touvron, Hugo, et al. \\\"Llama 2: Open Foundation and Fine-Tuned Chat Models.\\\"&nbsp;<em>arXiv preprint arXiv:2307.09288</em>&nbsp;(2023).&nbsp;</p><p>[2] Touvron, Hugo, et al. \\\"Llama: Open and efficient foundation language models.\\\"&nbsp;<em>arXiv preprint arXiv:2302.13971</em>&nbsp;(2023).</p><p>[3] \u201CIntroducing Llama2: The next generation of our open source large language model\u201D, <em>Meta</em>, https://ai.meta.com/llama/.</p><p>[4] Zhang, Biao, and Rico Sennrich. \\\"Root mean square layer normalization.\\\"&nbsp;<em>Advances in Neural Information Processing Systems</em>&nbsp;32 (2019).</p><p>[5] Shazeer, Noam. \\\"Glu variants improve transformer.\\\"&nbsp;<em>arXiv preprint arXiv:2002.05202</em>&nbsp;(2020).</p><p>[6] Su, Jianlin, et al. \\\"Roformer: Enhanced transformer with rotary position embedding.\\\"&nbsp;<em>arXiv preprint arXiv:2104.09864</em>&nbsp;(2021).</p><p>[7] Chowdhery, Aakanksha, et al. \\\"Palm: Scaling language modeling with pathways.\\\"&nbsp;<em>arXiv preprint arXiv:2204.02311</em>&nbsp;(2022).</p><p>[8] \u201CIntroducing Falcon LLM\u201D,&nbsp;<em>Technology Innovation Institute</em>, 7 June 2023, https://falconllm.tii.ae/.</p><p>[9] Ainslie, Joshua, et al. \\\"GQA: Training Generalized Multi-Query Transformer Models from Multi-Head Checkpoints.\\\"&nbsp;<em>arXiv preprint arXiv:2305.13245</em>&nbsp;(2023).</p><p>[10] Ouyang, Long, et al. \\\"Training language models to follow instructions with human feedback.\\\"&nbsp;<em>Advances in Neural Information Processing Systems</em>&nbsp;35 (2022): 27730-27744.</p><p>[11] Glaese, Amelia, et al. \\\"Improving alignment of dialogue agents via targeted human judgements.\\\"&nbsp;<em>arXiv preprint arXiv:2209.14375</em>&nbsp;(2022).</p><p>[12] Zhou, Chunting, et al. \\\"Lima: Less is more for alignment.\\\"&nbsp;<em>arXiv preprint arXiv:2305.11206</em>&nbsp;(2023).</p><div class=\\\"footnote\\\" data-component-name=\\\"FootnoteToDOM\\\"><a id=\\\"footnote-1\\\" href=\\\"#footnote-anchor-1\\\" class=\\\"footnote-number\\\" contenteditable=\\\"false\\\" target=\\\"_self\\\">1</a><div class=\\\"footnote-content\\\"><p>\u201CGeneralization\u201D is a term in deep/machine learning that refers to a model\u2019s ability to <em>generalize</em> beyond training data and also perform well on data it has not seen during training, either in the wild or as part of a hold-out test set. </p></div></div><div class=\\\"footnote\\\" data-component-name=\\\"FootnoteToDOM\\\"><a id=\\\"footnote-2\\\" href=\\\"#footnote-anchor-2\\\" class=\\\"footnote-number\\\" contenteditable=\\\"false\\\" target=\\\"_self\\\">2</a><div class=\\\"footnote-content\\\"><p>Many people have disagreements over the definition of an LLM. Here, I am referring to causal language models (i.e., trained with a language modeling objective) that are based upon a decoder-only transformer architecture. </p></div></div><div class=\\\"footnote\\\" data-component-name=\\\"FootnoteToDOM\\\"><a id=\\\"footnote-3\\\" href=\\\"#footnote-anchor-3\\\" class=\\\"footnote-number\\\" contenteditable=\\\"false\\\" target=\\\"_self\\\">3</a><div class=\\\"footnote-content\\\"><p>Notably, many researchers/practitioners have heavily criticized popular LLMs\u2014especially recently\u2014for their refusal to answer questions that are \u201Cunsafe\u201D. In some cases, alignment efforts can even be perceived by some as reducing the quality of the underlying LLM for this exact reason. </p></div></div><div class=\\\"footnote\\\" data-component-name=\\\"FootnoteToDOM\\\"><a id=\\\"footnote-4\\\" href=\\\"#footnote-anchor-4\\\" class=\\\"footnote-number\\\" contenteditable=\\\"false\\\" target=\\\"_self\\\">4</a><div class=\\\"footnote-content\\\"><p>LLaMA-2 uses dialogue examples for fine-tuning because it is explicitly optimized for dialogue or chat-based conversations during alignment. </p></div></div><div class=\\\"footnote\\\" data-component-name=\\\"FootnoteToDOM\\\"><a id=\\\"footnote-5\\\" href=\\\"#footnote-anchor-5\\\" class=\\\"footnote-number\\\" contenteditable=\\\"false\\\" target=\\\"_self\\\">5</a><div class=\\\"footnote-content\\\"><p>Maximizing the quality of human annotation is largely related to minimizing cognitive load. So, focusing upon a single alignment criteria at a time likely leads to higher quality, detailed annotations that more accurately reflect alignment criteria. </p></div></div><div class=\\\"footnote\\\" data-component-name=\\\"FootnoteToDOM\\\"><a id=\\\"footnote-6\\\" href=\\\"#footnote-anchor-6\\\" class=\\\"footnote-number\\\" contenteditable=\\\"false\\\" target=\\\"_self\\\">6</a><div class=\\\"footnote-content\\\"><p>This style of loss function is called a \u201Cranking\u201D loss. We don\u2019t directly optimize the model to output a certain score for any input. Rather, we just have pairs of inputs where we know that one input should have a higher score within this pair. So, we train the model to push these scores apart, where the preferred input has a higher score. </p></div></div><div class=\\\"footnote\\\" data-component-name=\\\"FootnoteToDOM\\\"><a id=\\\"footnote-7\\\" href=\\\"#footnote-anchor-7\\\" class=\\\"footnote-number\\\" contenteditable=\\\"false\\\" target=\\\"_self\\\">7</a><div class=\\\"footnote-content\\\"><p>Interestingly, this is a form of <a href=\\\"https://cameronrwolfe.substack.com/i/114077195/knowledge-distillation\\\">knowledge distillation</a>, as the best samples from the larger model are used to fine-tune all smaller LLaMa-2-Chat models via a fine-tuning approach that is similar to SFT. </p></div></div><div class=\\\"footnote\\\" data-component-name=\\\"FootnoteToDOM\\\"><a id=\\\"footnote-8\\\" href=\\\"#footnote-anchor-8\\\" class=\\\"footnote-number\\\" contenteditable=\\\"false\\\" target=\\\"_self\\\">8</a><div class=\\\"footnote-content\\\"><p>An emergent capability simply refers to a capability or skill possessed by a model that is not explicitly encouraged during training. For example, the ability of pre-trained LLMs to perform in-context learning can be considered \u201Cemergent\u201D given that we never directly train the model to develop this skill via next-token prediction. </p></div></div><div class=\\\"footnote\\\" data-component-name=\\\"FootnoteToDOM\\\"><a id=\\\"footnote-9\\\" href=\\\"#footnote-anchor-9\\\" class=\\\"footnote-number\\\" contenteditable=\\\"false\\\" target=\\\"_self\\\">9</a><div class=\\\"footnote-content\\\"><p>Most evaluations are performed over a set of ~4,000 prompts, which is quite large by academic research standards. </p></div></div><div class=\\\"footnote\\\" data-component-name=\\\"FootnoteToDOM\\\"><a id=\\\"footnote-10\\\" href=\\\"#footnote-anchor-10\\\" class=\\\"footnote-number\\\" contenteditable=\\\"false\\\" target=\\\"_self\\\">10</a><div class=\\\"footnote-content\\\"><p>We should keep in mind here that whether one LLM is better than another is subjective and highly dependent upon how we define \u201Cbetter\u201D. LLaMA-2-Chat is specifically aligned based on helpfulness and safety, and the model seems to excel in these categories as shown by extensive evaluation in [1]. </p></div></div>\",\"truncated_body_text\":\"The opeurce AI research community has heavily explored the creation of open-source, commercially-usable large language models (LLMs). Although a variety of such models perform well, none stand out quite like LLaMA-2 [1], a suite of recently-proposed open-source language models with sizes ranging from 7 to 70 billion parameters. Compared to the\u2026\",\"wordcount\":5101,\"postTags\":[{\"id\":\"75e43d96-4fc4-4190-900b-0df4c46fb24e\",\"publication_id\":1092659,\"name\":\"Open-Source LLMs\",\"slug\":\"open-source-llms\",\"hidden\":false}],\"postCountryBlocks\":[],\"headlineTest\":null,\"coverImagePalette\":{\"Vibrant\":{\"rgb\":[50,124,139],\"population\":51},\"DarkVibrant\":{\"rgb\":[35.079365079365076,86.99682539682536,97.52063492063493],\"population\":0},\"LightVibrant\":{\"rgb\":[252,204,140],\"population\":115},\"Muted\":{\"rgb\":[96,152,177],\"population\":80},\"DarkMuted\":{\"rgb\":[80,80,80],\"population\":8},\"LightMuted\":{\"rgb\":[214,202,168],\"population\":10}},\"publishedBylines\":[{\"id\":29736521,\"name\":\"Cameron R. Wolfe, Ph.D.\",\"handle\":\"cwolferesearch\",\"previous_name\":\"Cameron R. Wolfe\",\"photo_url\":\"https://bucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com/public/images/69aba7df-b571-4609-aa47-fc2d031c11b8_1242x1595.jpeg\",\"bio\":\"Research @ Netflix \u2022 Rice University PhD \u2022 I make AI understandable\",\"profile_set_up_at\":\"2022-09-17T15:11:34.083Z\",\"reader_installed_at\":\"2023-01-10T11:25:00.723Z\",\"publicationUsers\":[{\"id\":1042380,\"user_id\":29736521,\"publication_id\":1092659,\"role\":\"admin\",\"public\":true,\"is_primary\":true,\"publication\":{\"id\":1092659,\"name\":\"Deep (Learning) Focus\",\"subdomain\":\"cameronrwolfe\",\"custom_domain\":null,\"custom_domain_optional\":false,\"hero_text\":\"I contextualize and explain important topics in AI research.\",\"logo_url\":\"https://bucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com/public/images/ab9b43fb-52d5-40da-995d-5b7cd3f91064_896x896.png\",\"author_id\":29736521,\"primary_user_id\":29736521,\"theme_var_background_pop\":\"#6C0095\",\"created_at\":\"2022-09-17T15:12:33.160Z\",\"email_from_name\":\"Deep (Learning) Focus\",\"copyright\":\"Cameron R. Wolfe\",\"founding_plan_name\":\"Founding Member\",\"community_enabled\":true,\"invite_only\":false,\"payments_state\":\"enabled\",\"language\":null,\"explicit\":false,\"homepage_type\":\"newspaper\",\"is_personal_mode\":false}}],\"twitter_screen_name\":\"cwolferesearch\",\"is_guest\":false,\"bestseller_tier\":null}],\"reaction\":null,\"reaction_count\":44,\"comment_count\":6,\"child_comment_count\":3,\"audio_items\":[{\"post_id\":135824233,\"voice_id\":\"en-US-AlloyTurboMultilingualNeural\",\"audio_url\":\"https://substack-video.s3.amazonaws.com/video_upload/post/135824233/tts/731c6e8f-099b-46ef-8890-1ff8d85ffeb7/en-US-AlloyTurboMultilingualNeural.mp3\",\"type\":\"tts\",\"status\":\"completed\"}],\"is_geoblocked\":false,\"hasCashtag\":false},\"comments\":[{\"id\":58676835,\"body\":\"wow, that's a really deep and comprehensive explanation. Thanks a lot!\",\"body_json\":{\"type\":\"doc\",\"attrs\":{\"schemaVersion\":\"v1\"},\"content\":[{\"type\":\"paragraph\",\"content\":[{\"type\":\"text\",\"text\":\"wow, that's a really deep and comprehensive explanation. Thanks a lot!\"}]}]},\"publication_id\":1092659,\"post_id\":135824233,\"user_id\":134301190,\"ancestor_path\":\"\",\"type\":\"comment\",\"deleted\":false,\"date\":\"2024-06-10T13:50:54.947Z\",\"edited_at\":null,\"status\":\"published\",\"pinned_by_user_id\":null,\"restacks\":0,\"name\":\"Oleksandr Rechynskyi\",\"photo_url\":\"https://substack-post-media.s3.amazonaws.com/public/images/484cd279-07e6-417d-82a9-65fa67c93d7e_144x144.png\",\"handle\":\"oleksandrrechynskyi\",\"reactor_names\":[\"Cameron R. Wolfe, Ph.D.\"],\"reaction\":null,\"reactions\":{\"\u2764\":1},\"reaction_count\":1,\"children\":[],\"bans\":[],\"suppressed\":false,\"user_banned\":false,\"user_banned_for_comment\":false,\"user_slug\":\"oleksandrrechynskyi\",\"metadata\":{\"is_author\":false,\"membership_state\":\"free_signup\",\"eligibleForGift\":true,\"author_on_other_pub\":{\"name\":\"Oleksandr\u2019s Substack\",\"id\":2694475,\"base_url\":\"https://oleksandrrechynskyi.substack.com\"}},\"user_bestseller_tier\":null,\"can_dm\":true,\"score\":6,\"children_count\":1,\"reported_by_user\":false,\"restacked\":false,\"childrenSummary\":\"1 reply by Cameron R. Wolfe, Ph.D.\"},{\"id\":50759769,\"body\":\"What a great article. Saved me tens of hours of going through multiple sources. Thank you Dr. Cameron!\",\"body_json\":{\"type\":\"doc\",\"attrs\":{\"schemaVersion\":\"v1\"},\"content\":[{\"type\":\"paragraph\",\"content\":[{\"type\":\"text\",\"text\":\"What a great article. Saved me tens of hours of going through multiple sources. Thank you Dr. Cameron!\"}]}]},\"publication_id\":1092659,\"post_id\":135824233,\"user_id\":142072296,\"ancestor_path\":\"\",\"type\":\"comment\",\"deleted\":false,\"date\":\"2024-03-02T12:03:30.887Z\",\"edited_at\":null,\"status\":\"published\",\"pinned_by_user_id\":null,\"restacks\":0,\"name\":\"Rahul\",\"photo_url\":\"https://substack-post-media.s3.amazonaws.com/public/images/2fe4a66c-ed97-4468-a7e0-69396ad9233b_144x144.png\",\"handle\":\"rahul572864\",\"reactor_names\":[\"Cameron R. Wolfe, Ph.D.\"],\"reaction\":null,\"reactions\":{\"\u2764\":1},\"reaction_count\":1,\"children\":[],\"bans\":[],\"suppressed\":false,\"user_banned\":false,\"user_banned_for_comment\":false,\"user_slug\":\"rahul572864\",\"metadata\":{\"is_author\":false,\"membership_state\":\"free_signup\",\"eligibleForGift\":true},\"user_bestseller_tier\":null,\"can_dm\":true,\"score\":6,\"children_count\":1,\"reported_by_user\":false,\"restacked\":false,\"childrenSummary\":\"1 reply by Cameron R. Wolfe, Ph.D.\"}],\"canonicalUrl\":\"https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up\",\"inlineComments\":false,\"readerIsSearchCrawler\":false,\"ogUrl\":\"https://cameronrwolfe.substack.com/p/llama-2-from-the-ground-up\",\"bannedFromNotes\":false,\"themeVariables\":{\"color_theme_bg_pop\":\"#538cfa\",\"background_pop\":\"#538cfa\",\"color_theme_bg_web\":null,\"cover_bg_color\":\"#FFFFFF\",\"background_pop_darken\":\"#3a7bf9\",\"print_on_pop\":\"#ffffff\",\"color_theme_bg_pop_darken\":\"#3a7bf9\",\"color_theme_print_on_pop\":\"#ffffff\",\"color_theme_bg_pop_20\":\"rgba(83, 140, 250, 0.2)\",\"color_theme_bg_pop_30\":\"rgba(83, 140, 250, 0.3)\",\"border_subtle\":\"rgba(204, 204, 204, 0.5)\",\"background_subtle\":\"rgba(229, 238, 254, 0.4)\",\"print_pop\":\"#538cfa\",\"color_theme_accent\":\"#538cfa\",\"cover_print_primary\":\"#363737\",\"cover_print_secondary\":\"#757575\",\"cover_print_tertiary\":\"#b6b6b6\",\"cover_border_color\":\"#538cfa\",\"font_family_headings_preset\":\"Lora,sans-serif\",\"font_weight_headings_preset\":600,\"font_family_body_preset\":\"Spectral,sans-serif\",\"font_weight_body_preset\":400,\"font_size_body_offset\":\"1px\",\"font_preset_heading\":\"fancy_serif\",\"font_preset_body\":\"classic_serif\",\"home_hero\":\"feature-media\",\"home_posts\":\"list\",\"home_show_top_posts\":true,\"web_bg_color\":\"#ffffff\",\"background_contrast_1\":\"#f0f0f0\",\"color_theme_bg_contrast_1\":\"#f0f0f0\",\"background_contrast_2\":\"#dddddd\",\"color_theme_bg_contrast_2\":\"#dddddd\",\"background_contrast_3\":\"#b7b7b7\",\"color_theme_bg_contrast_3\":\"#b7b7b7\",\"background_contrast_4\":\"#929292\",\"color_theme_bg_contrast_4\":\"#929292\",\"background_contrast_5\":\"#515151\",\"color_theme_bg_contrast_5\":\"#515151\",\"color_theme_bg_elevated\":\"#ffffff\",\"color_theme_bg_elevated_secondary\":\"#f0f0f0\",\"color_theme_detail\":\"#e6e6e6\",\"background_contrast_pop\":\"rgba(83, 140, 250, 0.4)\",\"color_theme_bg_contrast_pop\":\"rgba(83, 140, 250, 0.4)\",\"input_background\":\"#ffffff\",\"cover_input_background\":\"#ffffff\",\"tooltip_background\":\"#191919\",\"web_bg_color_h\":\"0\",\"web_bg_color_s\":\"0%\",\"web_bg_color_l\":\"100%\",\"print_on_web_bg_color\":\"#363737\",\"print_secondary_on_web_bg_color\":\"#868787\",\"selected_comment_background_color\":\"#fdf9f3\",\"background_pop_rgb\":\"83, 140, 250\",\"background_pop_rgb_pc\":\"83 140 250\",\"color_theme_bg_pop_rgb\":\"83, 140, 250\",\"color_theme_bg_pop_rgb_pc\":\"83 140 250\",\"color_theme_accent_rgb\":\"83, 140, 250\",\"color_theme_accent_rgb_pc\":\"83 140 250\"},\"recentEpisodes\":null,\"trackFrontendVisit\":true,\"activeLiveStream\":null,\"freeTrialCoupon\":null,\"isChatActive\":false,\"isMeetingsActive\":false,\"hasViralGiftsCount\":0,\"features\":{},\"browser\":{\"name\":\"Chrome\",\"version\":\"139.0.0.0\",\"major\":\"139\"},\"showCookieBanner\":false,\"disabledCookies\":[],\"dd_env\":\"prod\",\"dd_ti\":true}")</script>
        <script>window._analyticsConfig = JSON.parse("{\"properties\":{\"subdomain\":\"cameronrwolfe\",\"publication_id\":1092659,\"has_plans\":true,\"pub_community_enabled\":true,\"is_personal_publication\":false,\"is_subscribed\":false,\"is_free_subscribed\":false,\"is_author\":false,\"is_contributor\":false,\"is_admin\":false,\"is_founding\":false},\"adwordsAccountId\":\"AW-316245675\",\"adwordsEventSendTo\":\"Tf76CKqcyL4DEKuN5pYB\"}")</script>

        
        
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/7664.be2a2857.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/7949.5676a4de.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/3069.64209640.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/7445.e16a5130.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/2199.c37d205e.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/7337.5a331a04.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/4147.a2df9fc9.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/126.62e18834.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/400.327ea1b4.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/3900.66ea0839.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/9889.77d3bef9.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/4985.6ad1ba52.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/6804.af859815.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/8240.4b9eb8d1.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/1772.e4e160ee.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/main.dd9007f7.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/7408.2051efce.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/3837.7e7c293c.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/744.a3593765.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/7870.199fccc0.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/4462.5e693f67.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/7415.88410df6.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/5581.d5e894e8.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/7199.cd22fbc9.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/4999.d12fa8bd.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/2749.53c3a209.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/1529.5bda4ab4.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/1844.7f6b07d4.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/8203.9e5fa696.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/1026.66330aca.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/3569.7e3bdadb.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/3908.09b51d92.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/222.a888998f.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/2312.f1ac26bf.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/1870.43f71dc4.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/7833.4af75e5f.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/6151.647e1df0.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/1498.fbb0a999.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/7053.e9e0b78b.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/276.f527c32b.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/8336.2629e1fb.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/2340.8650f279.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/4693.30c93a81.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/1714.ac7671de.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/5434.a9282d14.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/7189.202a3a72.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/2432.b0b92ea7.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/1484.457cb812.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/8206.8f2deba7.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/2109.b4f694c4.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/8226.323da71e.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/4327.23cbb980.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/6247.99682318.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/9726.2d0223d6.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/8914.72a80eaf.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/1262.c3709c8c.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/7491.e1c7b7b0.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/2897.c38a4b8f.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/1871.5928b042.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/9530.a527241f.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/883.7fbcf7c2.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/8299.e9848931.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/7044.d901506e.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/4219.b2b7a1bb.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/4665.6d2d4689.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/9631.3c9d0ffd.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/2384.1225dff7.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/1482.1a779c15.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/4425.a50ae14a.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/221.6a595268.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/5924.96135785.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/4046.08172dd3.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/886.01e5d68d.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/2035.58660d40.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/3338.8069a07e.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/8381.15d661d8.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/2889.4bb63120.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/7232.86428e8b.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/6736.5d24f2be.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/1376.efb40de6.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/6566.5fd21797.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/546.1e81f03f.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/9760.3b93fbba.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/7065.18c0dbcf.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/6890.51fcbdcd.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/7648.57104179.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/5759.13d040a1.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/5397.c8c11817.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/6027.2246d7b3.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/5822.2df6e139.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/3576.2fcf30b9.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/7993.469a5d09.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/7030.adbb186c.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/5648.e0574d0b.js" charset="utf-8"></script>
            
                <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/8173.efed9e1f.js" charset="utf-8"></script>
            
        
        <script nomodule="">
            (function() {
                var message = 'Your browser does not support modern JavaScript modules. Please upgrade your browser for the best experience.';
                var warningDiv = document.createElement('div');
                warningDiv.style.color = 'red';
                warningDiv.style.padding = '10px';
                warningDiv.style.margin = '10px 0';
                warningDiv.style.border = '1px solid red';
                warningDiv.style.backgroundColor = 'lightyellow';
                warningDiv.innerText = message;
                document.body.prepend(warningDiv);
            })();
        </script>

        
            <!-- Datadog Analytics -->
            <script>
              (function(h,o,u,n,d) {
                h=h[d]=h[d]||{q:[],onReady:function(c){h.q.push(c)}}
                d=o.createElement(u);d.async=1;d.src=n
                n=o.getElementsByTagName(u)[0];n.parentNode.insertBefore(d,n)
              })(window,document,'script','https://www.datadoghq-browser-agent.com/us1/v5/datadog-rum.js','DD_RUM')
              window.DD_RUM.onReady(function() {
                window.DD_RUM.init({
                  clientToken: 'puba71073f072643721169b68f352438710',
                  applicationId: '2e321b35-c76b-4073-8d04-cc9a10461793',
                  site: 'datadoghq.com',
                  service: 'substack-web',
                  env: window._preloads.dd_env,
                  version: '106c8f80c334439eb4ae6f63909b8cddcec7af14',
                  sessionSampleRate: 1,
                  sessionReplaySampleRate: 100,
                  trackUserInteractions: window._preloads.dd_ti,
                  trackResources: true,
                  trackLongTasks: true,
                  defaultPrivacyLevel: 'mask-user-input',
                  allowedTracingUrls: [/https?:\/\/(.+\/.)?substack(cdn)?\.com/]
                });
              })
            </script>
            <!-- End Datadog Analytics -->

            <!-- Cloudflare Web Analytics -->
            <script defer="" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/beacon.min.js" data-cf-beacon="{&quot;token&quot;: &quot;216309cffb464db4b0e02daf0b8e8060&quot;}"></script>
            <!-- End Cloudflare Web Analytics -->
        

        <!-- Fallback tracking pixels -->
        

        

        <noscript>
    <style>
        #nojs-banner {
            position: fixed;
            bottom: 0;
            left: 0;
            padding: 16px 16px 16px 32px;
            width: 100%;
            box-sizing: border-box;
            background: red;
            color: white;
            font-family: -apple-system, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
            font-size: 13px;
            line-height: 13px;
        }
        #nojs-banner a {
            color: inherit;
            text-decoration: underline;
        }
    </style>

    <div id="nojs-banner">
        This site requires JavaScript to run correctly. Please <a href="https://enable-javascript.com/" target="_blank">turn on JavaScript</a> or unblock scripts
    </div>
</noscript>


        

        

        
        
    <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9710a5deca43c1d2',t:'MTc1NTUxMjEwNC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><iframe height="1" width="1" style="position: absolute; top: 0px; left: 0px; border: none; visibility: hidden;" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/saved_resource.html"></iframe><iframe height="0" width="0" style="display: none; visibility: hidden;" src="./LLaMA-2 from the Ground Up - by Cameron R. Wolfe, Ph.D._files/saved_resource(1).html"></iframe>

<div id="headlessui-portal-root"><div data-headlessui-portal=""><button type="button" data-headlessui-focus-guard="true" aria-hidden="true" style="position: fixed; top: 1px; left: 1px; width: 1px; height: 0px; padding: 0px; margin: -1px; overflow: hidden; clip: rect(0px, 0px, 0px, 0px); white-space: nowrap; border-width: 0px;"></button><div><div data-testid="modal" id="headlessui-dialog-P0-29" role="dialog" aria-modal="true" data-headlessui-state="open" class="modal-O8Dx6X" style="z-index: 1000;"><div class="pencraft pc-reset backdropContainer-cOZ3hh"><div class="backdropEnter-ZpaQIK backdropEnterTo-QxRXXs"><div aria-hidden="true" class="pencraft pc-reset backdrop-IqiELY"></div></div><div id="headlessui-dialog-panel-P0-0" data-headlessui-state="open" class="pencraft pc-display-flex pc-reset pc-borderRadius-lg panel-ulWfet position-full-roTcOT panelEnter-yiVhfS panelEnterTo-wmKOeP"><div class="chrome-_LLvs8 inactive-_Lk_xA"><div class="pencraft pc-display-flex pc-justifyContent-center pc-alignItems-center pc-reset modalImageButtonContainer-gaFoGh modalImageSidebar-WtdDRF" style="right: 0px; padding: 16px;"><button tabindex="0" type="button" aria-label="Chevron Right" class="pencraft pc-reset pencraft media-XfKJl4 size_md-gCDS3o priority_secondary-S63h9o iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_md-gCDS3o priority_secondary-S63h9o rounded-SYxRdz"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right"><path d="m9 18 6-6-6-6"></path></svg></button></div><div class="pencraft pc-display-flex pc-justifyContent-center pc-alignItems-center pc-reset modalImageButtonContainer-gaFoGh modalImageSidebar-WtdDRF" style="left: 0px; padding: 16px;"><button tabindex="0" type="button" aria-label="Chevron Left" class="pencraft pc-reset pencraft media-XfKJl4 size_md-gCDS3o priority_secondary-S63h9o iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_md-gCDS3o priority_secondary-S63h9o rounded-SYxRdz"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-left"><path d="m15 18-6-6 6-6"></path></svg></button></div><div class="pencraft pc-display-flex pc-justifyContent-center pc-alignItems-center pc-reset modalImageButtonContainer-gaFoGh" style="position: absolute; right: 16px; top: 16px;"><button tabindex="0" type="button" aria-label="X" class="pencraft pc-reset pencraft media-XfKJl4 size_md-gCDS3o priority_secondary-S63h9o iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_md-gCDS3o priority_secondary-S63h9o rounded-SYxRdz"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg></button></div><div class="pencraft pc-display-flex pc-justifyContent-center pc-alignItems-center pc-reset modalImageButtonContainer-gaFoGh" style="position: absolute; left: 16px; top: 16px;"><button tabindex="0" type="button" aria-label="Download" class="pencraft pc-reset pencraft media-XfKJl4 size_md-gCDS3o priority_secondary-S63h9o iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M buttonStyle-r7yGCK size_md-gCDS3o priority_secondary-S63h9o rounded-SYxRdz"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-download"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" x2="12" y1="15" y2="3"></line></svg></button></div></div><div class="imgContainer-_cFpip"><img src="https://substackcdn.com/image/fetch/$s_!9tyU!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3b6fab4d-7825-47ec-a59e-979d9dfa0384_1256x938.png" class="img-nwpk1x"></div></div></div></div></div><button type="button" data-headlessui-focus-guard="true" aria-hidden="true" style="position: fixed; top: 1px; left: 1px; width: 1px; height: 0px; padding: 0px; margin: -1px; overflow: hidden; clip: rect(0px, 0px, 0px, 0px); white-space: nowrap; border-width: 0px;"></button></div></div></body></html>