"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["7415"],{19548:function(t,e,r){if(r.d(e,{CH:()=>k,Jv:()=>y,KG:()=>_,Y_:()=>g,Yq:()=>x,fQ:()=>B,gc:()=>b}),/^(2[79]87|3154|5288|6909)$/.test(r.j))var n=r(7409);if(/^(2[79]87|3154|5288|6909)$/.test(r.j))var o=r(99282);var i=r(16584),s=r(6400),a=r(30396);if(/^(2[79]87|3154|5288|6909)$/.test(r.j))var l=r(10844);if(/^(2[79]87|3154|5288|6909)$/.test(r.j))var c=r(88812);var u=r(60807),d=r(48980),h=r(7882),f=r(98914),p=r(36500),m=r(70379);let v={mutes:[],blocks:[],blocked:[]},Z=(0,s.createContext)({result:v,refetch:async()=>null,isBlockingUser:()=>!1,isMutedByUser:()=>!1,isBlockedByUser:()=>!1});function g(t){let{user:e,children:r}=t,n=(0,h.ib)({pathname:"/api/v1/blocks/ids",deps:[e],auto:!!e}),o=(0,a.Ye)(()=>{let{result:t,refetch:e}=n;if(t){let{blocked:r,mutes:n,blocks:o}=t,i=new Set(r),s=new Set(n),a=new Set(o);return{result:t,refetch:e,isBlockingUser:t=>i.has(t),isMutedByUser:t=>s.has(t),isBlockedByUser:t=>a.has(t)}}return{result:v,refetch:e,isBlockingUser:()=>!1,isMutedByUser:()=>!1,isBlockedByUser:()=>!1}},[n.result]);return(0,i.tZ)(Z.Provider,{value:o,children:r})}function y(){return(0,a.qp)(Z)}function _(t){let{isBlockingUser:e,isBlockedByUser:r}=(0,a.qp)(Z);return t?r(t)?"blocking":e(t)?"blocked":null:null}function b(t){let{isBlockingUser:e,isBlockedByUser:r,isMutedByUser:n}=(0,a.qp)(Z);return t?n(t)?"muting":r(t)?"blocking":e(t)?"blocked":null:null}function k(t,e){let{surface:r,noteId:s,onClick:a}=e,h=(0,u.aF)(),v=!!(h&&t&&h.id!==t.id),Z=y(),g=b(null==t?void 0:t.id),_=(0,m.pm)(),k=async()=>{if(t){try{await (0,d.rd)("/api/v1/blocks/".concat(t.id),{method:"POST",json:{type:"mute",surface:r,noteId:s}})}catch(t){_.popToast(e=>(0,i.tZ)(m.FN,(0,o._)((0,n._)({},e),{text:(0,f.zx)(t)})));return}Z.refetch(),_.popToast(e=>(0,i.tZ)(m.FN,(0,o._)((0,n._)({},e),{text:"".concat(t.name||"User"," muted"),Icon:l.Z}))),null==a||a("mute")}},w=async()=>{if(t){try{await (0,d.rd)("/api/v1/blocks/".concat(t.id),{method:"DELETE",query:{surface:r,noteId:s}})}catch(t){_.popToast(e=>(0,i.tZ)(m.FN,(0,o._)((0,n._)({},e),{text:(0,f.zx)(t)})));return}Z.refetch(),_.popToast(e=>(0,i.tZ)(m.FN,(0,o._)((0,n._)({},e),{text:"".concat(t.name||"User"," unmuted"),Icon:l.Z}))),null==a||a("unmute")}},B=async()=>{if(t){try{await (0,d.rd)("/api/v1/blocks/".concat(t.id),{method:"POST",json:{type:"block",surface:r,noteId:s}})}catch(t){_.popToast(e=>(0,i.tZ)(m.FN,(0,o._)((0,n._)({},e),{text:(0,f.zx)(t)})));return}Z.refetch(),_.popToast(e=>(0,i.tZ)(m.FN,(0,o._)((0,n._)({},e),{text:"".concat(t.name||"User"," blocked"),Icon:c.Z}))),null==a||a("block")}},x=async()=>{if(t){try{await (0,d.rd)("/api/v1/blocks/".concat(t.id),{method:"DELETE",query:{surface:r,noteId:s}})}catch(t){_.popToast(e=>(0,i.tZ)(m.FN,(0,o._)((0,n._)({},e),{text:(0,f.zx)(t)})));return}Z.refetch(),_.popToast(e=>(0,i.tZ)(m.FN,(0,o._)((0,n._)({},e),{text:"".concat(t.name||"User"," unblocked"),Icon:c.Z}))),null==a||a("unblock")}},C=[];return v&&("blocking"!==g&&C.push((0,i.tZ)(p.sN,{leading:(0,i.tZ)(l.Z,{}),priority:"destructive",onClick:"muting"===g?w:k,children:"muting"===g?"Unmute":"Mute"})),C.push((0,i.tZ)(p.sN,{leading:(0,i.tZ)(c.Z,{}),priority:"destructive",onClick:"blocking"===g?x:B,children:"blocking"===g?"Unblock":"Block"}))),C}Z.displayName="UserBlockContext";let w=(0,s.createContext)(!1);function B(t){let{muteFree:e=!0,children:r}=t;return(0,i.tZ)(w.Provider,{value:e,children:r})}function x(){return(0,a.qp)(w)}w.displayName="MuteFreeZone"},39198:function(t,e,r){r.d(e,{t:()=>a});var n=r(16584),o=r(61254),i=r(19081),s=r(58175);function a(t){let{children:e}=t;return(0,n.BX)(n.HY,{children:[(0,n.tZ)(i.tu,{paddingY:4,paddingX:8,children:(0,n.tZ)(s.xv.B4,{color:"secondary",children:e})}),(0,n.tZ)(o.iz,{pullX:8})]})}},45783:function(t,e,r){if(r.d(e,{De:()=>m,R3:()=>y,eK:()=>p,nD:()=>Z,rQ:()=>v}),!/^(1588|1691|2536|4457)$/.test(r.j))var n=r(7409);if(!/^(1588|1691|2536|4457)$/.test(r.j))var o=r(99282);if(/^(2987|3270)$/.test(r.j))var i=r(98848);var s=r(16584),a=r(94184),l=r.n(a);if(/^(2987|3154|5288|6909)$/.test(r.j))var c=r(56743);if(/^(2987|3154|5288|6909)$/.test(r.j))var u=r(2564);var d=r(98661),h=r(80026),f=r(68857);let p=function(t){let{inset:e=0,pageSizeAdjust:r=0,initialState:i,scrollFullPage:s=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},[a,l]=(0,d.useState)(i||{showLeft:!1,showRight:!1});return(0,d.useEffect)(()=>{let{current:r}=t;if(r){let t=()=>{l(t=>{let i=t;!i.showLeft&&r.scrollLeft>e?i=(0,o._)((0,n._)({},t),{showLeft:!0}):i.showLeft&&r.scrollLeft<=e&&(i=(0,o._)((0,n._)({},t),{showLeft:!1}));let s=r.scrollWidth-r.offsetWidth-4-e;return!i.showRight&&r.scrollLeft<s?i=(0,o._)((0,n._)({},t),{showRight:!0}):i.showRight&&r.scrollLeft>=s&&(i=(0,o._)((0,n._)({},t),{showRight:!1})),i})};return r.addEventListener("scroll",t),setTimeout(()=>{t()},50),()=>{r.removeEventListener("scroll",t)}}},[]),{state:a,handleArrowClick:e=>()=>{let{current:n}=t;n&&n.scrollBy({left:e*(s?n.offsetWidth:n.offsetWidth/2-r),behavior:"smooth"})}}};function m(t){var{className:e,scrollRef:r}=t,a=(0,i._)(t,["className","scrollRef"]);return(0,s.tZ)(h.hs,(0,o._)((0,n._)({},a),{className:l()(f.Z.scrollBox,e),ref:r,overflowX:"auto",scrollBar:"hidden",minWidth:0,onTouchStart:t=>{let{pageX:e}=t;void 0!==e&&(!(e>10)||!(e<window.innerWidth-10))&&t.preventDefault()}}))}function v(t){let{direction:e,isVisible:r=!0,onClick:n}=t;return(0,s.tZ)(h.hs,{alignItems:"center",justifyContent:"center",position:"absolute",className:l()(f.Z.arrowButtonContainer,f.Z.arrowButtonOffsetContainer,r&&f.Z.visible,f.Z[e]),children:(0,s.tZ)(g,{direction:e,isVisible:r,onClick:n})})}function Z(t){let{direction:e,isVisible:r=!0,onClick:n}=t;return(0,s.tZ)(y,{direction:e,isVisible:r,children:(0,s.tZ)(g,{direction:e,isVisible:r,onClick:n,className:f.Z.arrowButtonOverlaid})})}function g(t){let{direction:e,isVisible:r=!0,onClick:n,className:o}=t;return(0,s.tZ)(h.hU,{size:"sm",priority:"quaternary",disabled:!r,className:o,onClick:n,"aria-hidden":!r,"aria-label":r?"left"===e?"Previous":"Next":void 0,children:"left"===e?(0,s.tZ)(c.Z,{}):(0,s.tZ)(u.Z,{})})}function y(t){let{direction:e,isVisible:r=!0,children:n,bg:o="primary"}=t;return(0,s.BX)(h.hs,{alignItems:"center",className:l()(f.Z.arrowButtonContainer,f.Z.arrowButtonOverlaidContainer,r&&f.Z.visible,f.Z[e]),children:[(0,s.tZ)("div",{className:l()(f.Z.overlay,f.Z[o])}),n]})}},76566:function(t,e,r){r.d(e,{S:()=>d,m:()=>f});var n=r(27412),o=r(16584),i=r(20042),s=r(98661),a=r(20888),l=r(9682),c=r(19081),u=r(58175);class d extends s.Component{static getDerivedStateFromError(t){return{error:t}}componentDidMount(){Promise.all([r.e("7152"),r.e("6993")]).then(r.bind(r,91985)).then(t=>{this.Sentry=t.Sentry})}componentDidCatch(t){console.error(t),this.Sentry&&this.Sentry.captureException(t)}render(){let{error:t}=this.state;return(0,o.tZ)(h,{onReset:()=>this.setState({error:null}),error:t,children:t?(0,o.tZ)(f,{}):this.props.children})}constructor(t){super(t),(0,n._)(this,"Sentry",null),this.state={error:null}}}function h(t){let{onReset:e,error:r,children:n}=t,a=(0,s.useRef)((0,i.getCurrentUrl)());return(0,l.js)(t=>{r&&a.current!==t&&e(),a.current=t},[]),r?(0,o.tZ)(f,{}):n}function f(){return(0,o.BX)(c.tu,{flex:"grow",justifyContent:"center",alignItems:"center",gap:32,padding:20,children:[(0,o.tZ)(a.e,{src:"/img/reader/toad.png",maxWidth:200}),(0,o.BX)(c.tu,{gap:8,children:[(0,o.tZ)(u.xv.H3,{weight:"semibold",align:"center",children:"Oh noâ€”this page croaked."}),(0,o.tZ)(u.xv.B3,{color:"secondary",align:"center",children:"Try again, or hop to another page."})]})]})}},65958:function(t,e,r){r.d(e,{s:()=>v,z:()=>Z});var n=r(7409),o=r(99282),i=r(16584),s=r(60807),a=r(48980),l=r(80878),c=r(7882),u=r(70379),d=r(97842),h=r(81043),f=r(95551),p=r(62515),m=r(36186);function v(t){let{source:e}=t,r=Z({source:e}),c=(0,f.d)(),d=(0,u.pm)(),v=(0,s.aF)(),{onboardingModalRef:g,requireLogin:y}=(0,h.SJ)(),_=async t=>{var e;if(!v)return y?y():g.current?g.current.open():c(Error("Onboarding modal not found"),"Could not start conversation."),!1;let s=await r.handleStart(t);return s instanceof Error?(s instanceof a.kp&&(null===(e=s.body)||void 0===e?void 0:e.type)==="profile_not_set_up"?d.popToast(t=>(0,i.tZ)(u.FN,(0,o._)((0,n._)({},t),{text:"Please set up your profile before sending a message.",cta:"Set up profile",href:(0,m.Nh)({utm_source:"substack",utm_campaign:"chat_dm_button",redirect:window.location}),localNavigation:!1}))):c(s,"Could not start conversation."),!1):((0,l._)((0,p.Rm)(s.thread.id)),!0)};return(0,o._)((0,n._)({},r),{handleStart:_})}function Z(t){let{source:e}=t,r=(0,d.I0)(),i=(0,c.ib)({pathname:"/api/v1/messages/dm/start",method:"POST"}),s=async t=>{let n=await i.refetch({json:{user_ids:t,source:e}});return n instanceof Error||r({type:"conversation-load_more",payload:{edge:"before",cursor:null,page:n}}),n};return(0,o._)((0,n._)({},i),{handleStart:s})}}}]);