"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["2432"],{86657:function(e,t,a){a.d(t,{Z:()=>S});var i=a(27412),s=a(7409),r=a(99282),n=a(16584),o=a(6400),l=a(94184),d=a.n(l),c=a(14293),h=a.n(c),p=a(36081),u=a(36813),y=a(36181),m=a(18389),g=a(97742),v=a(95441),b=a(30372),_=a(68833),T=a(55480),f=a(59176),k=a(98914),P=a(15771),E=a(24791),M=a(60308),C=a(84864),Z=a(47929);let N="AudioPlayer.playbackRate",w={utm_source:Z.b3.twitter,utm_medium:Z.lP.social,utm_campaign:Z.VX.twitterEmbed};class D extends o.Component{shouldComponentUpdate(e){return this.props.currentPlaybackRate!==e.currentPlaybackRate||this.props.setPlaybackRate!==e.setPlaybackRate}render(){let{currentPlaybackRate:e,setPlaybackRate:t}=this.props;return(0,n.BX)("select",{className:"audio-player-playback-rate",dir:"rtl",onInput:e=>t(Number(e.target.value)),children:[(0,n.tZ)("option",{value:"1",selected:1===e,children:"1x"}),(0,n.tZ)("option",{value:"1.25",selected:1.25===e,children:"1.25x"}),(0,n.tZ)("option",{value:"1.5",selected:1.5===e,children:"1.5x"}),(0,n.tZ)("option",{value:"1.75",selected:1.75===e,children:"1.75x"}),(0,n.tZ)("option",{value:"2",selected:2===e,children:"2x"})]})}}class S extends o.Component{componentDidMount(){var e;null===k.sz||void 0===k.sz||k.sz.on("play",this._onGlobalPlay),document.body&&(document.body.addEventListener("mousemove",this._onMouseMove,!1),document.body.addEventListener("mouseup",this._onDragEnd,!1),document.body.addEventListener("touchmove",this._onTouchMove,{passive:!1}),document.body.addEventListener("touchend",this._onDragEnd,!1),document.body.addEventListener("touchcancel",this._onDragEnd,!1)),this.player&&(this.player.volume=1,this.player.playbackRate=this.state.playbackRate,this.player.addEventListener("canplay",this._onCanPlay),this.player.addEventListener("play",this._onPlay),this.player.addEventListener("pause",this._onPause),this.player.addEventListener("ended",this.onEnded),this.player.addEventListener("timeupdate",this._onTimeUpdate),this.player.addEventListener("ratechange",this._onRateChange),this.player.addEventListener("waiting",this._onWaiting),this.player.addEventListener("playing",this._onPlaying),this.player.addEventListener("seeked",this.onSeeked)),this.progressBar.current&&this.progressBar.current.addEventListener("touchstart",this._onTouchStart,{passive:!0}),this.onTimeUpdate();let t=null===(e=this.player)||void 0===e?void 0:e.duration;!this.props.onGetDuration||h()(t)||isNaN(Number(t))||this.props.onGetDuration(t),(0,k.pt)((0,M.zF4)("/img/audio-player-pause.png",96))}componentWillUnmount(){null===k.sz||void 0===k.sz||k.sz.off("play",this._onGlobalPlay),document.body&&(document.body.removeEventListener("mousemove",this._onMouseMove,!1),document.body.removeEventListener("mouseup",this._onDragEnd,!1),document.body.removeEventListener("touchmove",this._onTouchMove,!1),document.body.removeEventListener("touchend",this._onDragEnd,!1),document.body.removeEventListener("touchcancel",this._onDragEnd,!1)),this.player&&(this.player.removeEventListener("canplay",this._onCanPlay),this.player.removeEventListener("play",this._onPlay),this.player.removeEventListener("pause",this._onPause),this.player.removeEventListener("ended",this.onEnded),this.player.removeEventListener("timeupdate",this._onTimeUpdate),this.player.removeEventListener("ratechange",this._onRateChange),this.player.removeEventListener("waiting",this._onWaiting),this.player.removeEventListener("playing",this._onPlaying)),this.progressBar.current&&this.progressBar.current.removeEventListener("touchstart",this._onTouchStart)}componentDidUpdate(e,t){if(this.state.playing||"number"!=typeof this.state.waiting||"number"==typeof t.waiting||this.track(_.FP.AUDIO_BUFFERING_STARTED),!this.state.playing||t.playing||this.state.waiting||"number"!=typeof t.waiting||this.track(_.FP.AUDIO_BUFFERING_COMPLETED,{buffering_duration:Date.now()-t.waiting}),this.state.playing&&Math.floor(this.state.currentTime)!==Math.floor(t.currentTime)&&Math.floor(this.state.currentTime)%5==0){var a;if(this.trackMedia(_.FP.MEDIA_PLAYBACK_CONTINUED),(null===(a=this.props.metricsPost)||void 0===a?void 0:a.id)&&this.state.duration&&!this.props.feature){let e=Math.min(Math.max(0,this.state.currentTime/this.state.duration),1);(0,b.UO)(this.props.metricsPost.id,"audio",e)}}if(!this.state.playing&&t.playing&&this.player&&this.player.ended&&(this.props.onFinishAudio&&this.props.onFinishAudio(),this.trackMedia(_.FP.MEDIA_PLAYBACK_COMPLETED)),this.props.updateOnEveryFrame&&this.state.playing&&!t.playing){let e=()=>{this.onTimeUpdate(),this.loopId=requestAnimationFrame(e)};this.loopId=requestAnimationFrame(e)}this.props.updateOnEveryFrame&&!this.state.playing&&t.playing&&(h()(this.loopId)||cancelAnimationFrame(this.loopId)),this.progressBar.current&&(this.progressBar.current.removeEventListener("touchstart",this._onTouchStart),this.progressBar.current.addEventListener("touchstart",this._onTouchStart,{passive:!0}))}onCanPlay(){this.props.onGetDuration&&this.player&&this.props.onGetDuration(this.player.duration),this.onTimeUpdate()}onPlay(){null===k.sz||void 0===k.sz||k.sz.emit("play",this),this.setState({playing:!0}),this.trackMedia(_.FP.MEDIA_PLAYBACK_STARTED)}onPause(){var e;this.setState({playing:!1,waiting:!1}),(null===(e=this.player)||void 0===e?void 0:e.ended)||this.trackMedia(_.FP.MEDIA_PLAYBACK_PAUSED)}onTimeUpdate(){if(this.player&&isFinite(this.player.duration)){if(this.player.currentTime>this.player.duration){this.player.currentTime=this.player.duration;return}this.state.duration!==this.player.duration||this.state.currentTime!==this.player.currentTime?(this.setState({duration:this.player.duration||this.props.duration,currentTime:this.player.currentTime,waiting:!1}),this.props.onTimeUpdate&&this.props.onTimeUpdate({duration:Math.max(this.state.duration||0,this.player.duration||this.props.duration||0),currentTime:this.player.currentTime})):this.setState({waiting:!1})}}onRateChange(){this.player&&this.state.playbackRate!==this.player.playbackRate&&this.setState({playbackRate:this.player.playbackRate})}onWaiting(){this.setState({waiting:Date.now()})}onPlaying(){this.setState({playing:!0,waiting:!1})}onMouseDown(e){this.onDragStart(e.clientX)}onMouseMove(e){this.onDragMove(e.clientX)}onTouchStart(e){e.touches&&e.touches[0]&&this.onDragStart(e.touches[0].pageX)}onTouchMove(e){"number"==typeof this.state.dragTime&&e.preventDefault(),e.touches&&e.touches[0]&&this.onDragMove(e.touches[0].pageX)}onDragStart(e){"number"!=typeof this.state.dragTime&&this.setDragTime(e)}onDragMove(e){"number"==typeof this.state.dragTime&&this.setDragTime(e)}onDragEnd(){this.clearDragTime()}onGlobalPlay(e){if(this!==e&&this.player&&!this.player.paused){let t=e.player;t instanceof HTMLVideoElement&&t.muted||(this.track(_.FP.CLICKED_PAUSE_BUTTON,{implicit:!0,feature:this.props.feature}),this.player.pause())}}async togglePlayback(){let{iString:e}=this.context;if(this.player){if(this.player.paused){this.track(_.FP.CLICKED_PLAY_BUTTON,{feature:this.props.feature});try{await this.player.play()}catch(t){if("NotSupportedError"===t.name)alert(e("Failed to play this media: it may not be supported by this browser."));else throw t}}else this.track(_.FP.CLICKED_PAUSE_BUTTON,{feature:this.props.feature}),await this.player.pause()}}skipBack(){if(this.player){let e=Math.max(0,this.state.currentTime-15);this.player.currentTime=e}}skipForward(){if(this.player){var e;let t=Math.min(null!==(e=this.state.duration)&&void 0!==e?e:0,this.state.currentTime+30);this.player.currentTime=t}}setDragTime(e){if(!this.props.src||!this.state.duration||!this.player||!this.progressBar.current||!document.body||!document.body.getBoundingClientRect)return;let t=document.body.getBoundingClientRect(),a=this.progressBar.current.getBoundingClientRect(),i=a.left-t.left,s=a.right,r=(Math.max(i,Math.min(s,e))-i)/(s-i)*this.state.duration;this.isDragTimeCloseToCurrentTime(r)&&(r=this.state.currentTime),this.setState({dragTime:r})}clearDragTime(){if("number"!=typeof this.state.dragTime)return;let e=this.state.dragTime;this.isDragTimeCloseToCurrentTime(e)?this.setState({dragTime:null}):(this.setState({currentTime:e,dragTime:null,lastDragClearedAt:performance.now()}),this.player&&(this.player.currentTime=e))}isDragTimeCloseToCurrentTime(e){let t;return!this.props.preventSnappingToCurrentTime&&"number"==typeof this.state.currentTime&&(t=!h()(this.state.duration)&&this.state.duration<10?0:!h()(this.state.duration)&&this.state.duration<30?3:5,Math.abs(this.state.currentTime-e)<t)}track(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=this.props.metricsPost;a&&(0,_.j)(e,Object.assign({post_id:a.id,publication_id:a.publication_id,is_podcast_free_preview:(0,E.dq)(a),current_time:this.state.currentTime?Math.floor(this.state.currentTime):0,duration:this.state.duration?Math.floor(this.state.duration):0,playback_rate:this.state.playbackRate},t))}trackMedia(e){var t,a,i,n,o;let{pub:l,mediaUpload:d,src:c,trackingProps:{feedItemTrackingParameters:h,surface:p,contentType:u,entityKey:y,entityType:m,primaryEntityKey:g,primaryEntityType:v}={}}=this.props;(0,_.j)(e,(0,r._)((0,s._)({},h),{media_type:"audio",video_upload_id:null!==(a=null==d?void 0:d.id)&&void 0!==a?a:"unknown",src_video_upload_id:null==d?void 0:d.src_media_upload_id,surface:p,content_type:u,primary_entity_key:String(null!==(i=null!=g?g:y)&&void 0!==i?i:"unknown"),primary_entity_type:null!=v?v:m,entity_key:String(y),entity_type:m,publication_id:null==l?void 0:l.id,display:"inline",muted:null===(t=this.player)||void 0===t?void 0:t.muted,captions_enabled:null,autoplay:!1,is_preview:!1,current_time:Math.floor(null!==(n=this.state.currentTime)&&void 0!==n?n:0),duration:Math.floor(null!==(o=this.state.duration)&&void 0!==o?o:0),src:c}))}render(e){let{addToPodcastLink:t,autoPlay:a,isFancy:i,isPaywalled:s,post:r,pub:o,render:l,showCTAs:d,skipPreloading:c,src:h}=e,{iString:p}=this.context;if(l){let{dragTime:e,duration:t,currentTime:i,playbackRate:r}=this.state,o="number"==typeof e?e:i;return(0,n.BX)(n.HY,{children:[l({isPaywalled:s,progress:t?("number"==typeof e?e:i)/t:0,currentTime:t?(0,C.secondsToHHMMSS)(o):"--:--",dragTime:"number"==typeof e?(0,C.secondsToHHMMSS)(e):null,duration:t,remainingTime:t?"-".concat((0,C.secondsToHHMMSS)(t-Math.min(o,t))):"--:--",isPlaying:this.state.playing,playbackRate:r,progressBarOnMouseDown:e=>{this.onMouseDown(e)},progressBarRef:this.progressBar,setPlaybackRate:e=>{this.setPlaybackRate(e)},skipBack:()=>{this.skipBack()},skipForward:()=>{this.skipForward()},togglePlayback:()=>{this.togglePlayback()}}),h&&!s&&(0,n.tZ)("audio",{ref:this.assignPlayer,src:h,autoPlay:a,preload:c?"none":"auto",children:p("Audio playback is not supported on your browser. Please upgrade.")})]})}return i?this.renderFancy({src:h,autoPlay:a,pub:o,post:r,showCTAs:d}):this.renderOriginal({src:h,autoPlay:a,pub:o,addToPodcastLink:t})}renderFancy(e){var t,a;let{src:i,autoPlay:o,pub:l,post:d,showCTAs:c}=e,{iString:h}=this.context,p=(0,T.Tn)(l,d);return(0,n.tZ)(n.HY,{children:(0,n.tZ)("div",{className:"audio-player-wrapper-fancy",children:(0,n.BX)("div",{className:"audio-player",children:[(0,n.tZ)("div",{className:"audio-player-substack-logo audio-player-clickable",onClick:this.openEpisodePage,children:(0,n.tZ)(g.Z,{color:"#F8F8F8"})}),(0,n.tZ)("div",{className:"audio-player-hero-image-container audio-player-clickable",onClick:this.openEpisodePage,children:p&&(0,n.tZ)("img",{className:"audio-player-hero-image audio-player-clickable",src:(0,M.zF4)(p,500,{height:500,crop:"fill"}),onClick:this.openEpisodePage})}),(0,n.tZ)("div",{className:"audio-player-title audio-player-clickable",onClick:this.openEpisodePage,children:null!==(t=null==d?void 0:d.title)&&void 0!==t?t:""}),(0,n.tZ)("div",{className:"audio-player-subtitle audio-player-clickable",onClick:this.openEpisodePage,children:null!==(a=null==d?void 0:d.subtitle)&&void 0!==a?a:""}),i&&(0,n.tZ)("audio",{"data-testid":"audio-element",ref:this.assignPlayer,src:i,autoPlay:o,children:h("Audio playback is not supported on your browser. Please upgrade.")}),this.renderProgressFancy(this.props,this.state),this.renderButtonsFancy(this.props,this.state),c&&(0,n.BX)("div",{className:"btn-group",children:[(0,n.tZ)(P.zx,{priority:"secondary",newTab:!0,onClick:this.openEpisodePage,children:h("View post")}),(0,n.tZ)(P.zx,{priority:"primary",href:l?this.maybeAppendIframeVisitId((0,M.W1P)(l,(0,r._)((0,s._)({},w),{simple:!0,next:(0,M.uRy)(l,d)}))):void 0,newTab:!0,children:(0,C.getSubscribeText)(l)})]})]})})})}renderOriginal(e){let{src:t,autoPlay:a,pub:i,addToPodcastLink:s}=e,{iString:r}=this.context;return(0,n.BX)("div",{className:"audio-player-wrapper",children:[(0,n.BX)("div",{className:"audio-player",children:[t&&(0,n.tZ)("audio",{ref:this.assignPlayer,src:t,autoPlay:a,children:r("Audio playback is not supported on your browser. Please upgrade.")}),this.renderButtons(this.props,this.state),this.renderProgress(this.props,this.state)]}),s&&i&&!i.hide_podcast_feed_link&&(0,n.tZ)("div",{className:"audio-player-add-to-podcast-link",children:(0,n.tZ)("a",{href:s,target:"_blank",rel:"noopener",children:r("Listen in podcast app")})})]})}renderButtonsFancy(e,t){let{playing:a,waiting:i}=t;return(0,n.BX)("div",{className:"audio-player-buttons",children:[(0,n.tZ)("button",{className:"audio-player-backward","aria-pressed":"false",onClick:()=>this.skipBack(),children:(0,n.tZ)(p.Z,{className:"skip-icon"})}),(0,n.tZ)("button",{className:d()("audio-player-play",{pause:"playing",waiting:i}),"aria-pressed":"false",onClick:()=>this.togglePlayback(),children:a?(0,n.tZ)(y.Z,{className:"playback-icon pause",fill:"#1C110B"}):(0,n.tZ)(m.Z,{className:"playback-icon play",fill:"#1C110B"})}),(0,n.tZ)("button",{className:"audio-player-forward","aria-pressed":"false",onClick:()=>this.skipForward(),children:(0,n.tZ)(u.Z,{className:"skip-icon"})})]})}renderButtons(e,t){let{src:a,href:i,isStatic:s}=e,{playing:r,waiting:o,playbackRate:l}=t;return(0,n.BX)("div",{className:"audio-player-buttons",children:[(0,n.tZ)("table",{className:"custom",children:(0,n.BX)("tr",{children:[(0,n.tZ)("td",{className:"audio-player-buttons-spacing",children:"\xa0"}),(0,n.tZ)("td",{className:"audio-player-backward",children:(0,n.tZ)("a",{role:"button",className:"button",tabIndex:0,"aria-pressed":"false",href:i||"javascript:void(0)",onClick:()=>this.skipBack(),children:(0,n.tZ)(p.Z,{className:"skip-icon",fill:"#3c3c3c",height:30,isStatic:s})})}),(0,n.tZ)("td",{className:"audio-player-play ".concat(r?"pause":""," ").concat(o?"waiting":""),children:(0,n.tZ)("a",{className:"button",role:"button",tabIndex:0,"aria-pressed":"false",href:i||"javascript:void(0)",onClick:()=>this.togglePlayback(),children:(0,n.tZ)("img",{src:(0,M.zF4)(r?"/img/audio-player-pause.png":"/img/audio-player-play.png",96)})})}),(0,n.tZ)("td",{className:"audio-player-forward",children:(0,n.tZ)("a",{role:"button",className:"button",tabIndex:0,"aria-pressed":"false",href:i||"javascript:void(0)",onClick:()=>this.skipForward(),children:(0,n.tZ)(u.Z,{className:"skip-icon",fill:"#3c3c3c",height:30,isStatic:s})})}),(0,n.tZ)("td",{className:"audio-player-buttons-spacing",children:"\xa0"})]})}),a&&(0,n.tZ)(D,{currentPlaybackRate:l,setPlaybackRate:this.setPlaybackRate})]})}renderProgress(e,t){let{duration:a,currentTime:i,dragTime:s}=t;return(0,n.tZ)("div",{className:"audio-player-progress",children:(0,n.tZ)("table",{className:"custom",children:(0,n.BX)("tr",{children:[(0,n.tZ)("td",{className:"audio-player-progress-past",children:a?(0,C.secondsToHHMMSS)(i):"--:--"}),(0,n.BX)("td",{ref:this.progressBar,className:"audio-player-progress-bar",onMouseDown:e=>this.onMouseDown(e),children:[(0,n.tZ)("div",{className:"audio-player-progress-bar-track"}),(0,n.tZ)("div",{className:"audio-player-progress-bar-filled",style:"width:".concat(a?100*("number"==typeof s?s:i)/a:0,"%")}),(0,n.tZ)("div",{className:"audio-player-progress-bar-current",style:"left:".concat(a?100*i/a:0,"%")}),(0,n.tZ)("div",{className:"audio-player-progress-bar-button",style:"left:".concat(a?100*("number"==typeof s?s:i)/a:0,"%")}),"number"==typeof s&&(0,n.tZ)("div",{className:"audio-player-progress-bar-popup",style:"left:".concat(a?100*s/a:0,"%"),children:(0,C.secondsToHHMMSS)(s)})]}),(0,n.tZ)("td",{className:"audio-player-progress-left",children:a?"-".concat((0,C.secondsToHHMMSS)(a-Math.min(i,a))):"--:--"})]})})})}renderProgressFancy(e,t){let{duration:a,currentTime:i,dragTime:s,lastDragClearedAt:r}=t,o="number"==typeof s,l=!!r&&performance.now()-r<50;return(0,n.BX)(n.HY,{children:[(0,n.tZ)("div",{className:"audio-player-progress",children:(0,n.BX)("div",{ref:this.progressBar,className:"audio-player-progress-bar",onMouseDown:e=>this.onMouseDown(e),children:[(0,n.tZ)("div",{className:"audio-player-progress-bar-track"}),(0,n.tZ)("div",{className:"audio-player-progress-bar-filled",style:{width:"".concat(a?100*(o?s:i)/a:0,"%")}}),(0,n.tZ)("div",{className:d()("audio-player-progress-bar-current",{"audio-player-progress-bar-current-placeholder":o,"audio-player-progress-bar-current-disable-animations":l}),style:"left:".concat(a?100*i/a:0,"%")}),o&&(0,n.tZ)("div",{className:"audio-player-progress-bar-current audio-player-progress-bar-current-dragging",style:"left:".concat(a?100*s/a:0,"%")}),o&&(0,n.tZ)("div",{className:"audio-player-progress-bar-popup",style:"left:".concat(a?100*s/a:0,"%"),children:(0,C.secondsToHHMMSS)(s)})]})}),(0,n.BX)("div",{className:"audio-player-time-wrapper",children:[(0,n.tZ)("div",{className:"audio-player-progress-past",children:a?(0,C.secondsToHHMMSS)(i):"--:--"}),(0,n.tZ)("div",{className:"audio-player-progress-left",children:a?"-".concat((0,C.secondsToHHMMSS)(a-Math.min(i,a))):"--:--"})]})]})}constructor(e,t){super(e,t),(0,i._)(this,"player",void 0),(0,i._)(this,"progressBar",(0,o.createRef)()),(0,i._)(this,"loopId",void 0),(0,i._)(this,"isShowingCaptionsElsewhere",!1),(0,i._)(this,"_onGlobalPlay",void 0),(0,i._)(this,"_onMouseMove",void 0),(0,i._)(this,"_onTouchStart",void 0),(0,i._)(this,"_onTouchMove",void 0),(0,i._)(this,"_onDragEnd",void 0),(0,i._)(this,"_onCanPlay",void 0),(0,i._)(this,"_onPlay",void 0),(0,i._)(this,"_onPause",void 0),(0,i._)(this,"_onTimeUpdate",void 0),(0,i._)(this,"_onRateChange",void 0),(0,i._)(this,"_onWaiting",void 0),(0,i._)(this,"_onPlaying",void 0),(0,i._)(this,"assignPlayer",e=>{this.player=e}),(0,i._)(this,"onEnded",()=>{this.setState({playing:!1,waiting:!1}),this.trackMedia(_.FP.MEDIA_PLAYBACK_PAUSED)}),(0,i._)(this,"onSeeked",()=>{this.trackMedia(_.FP.MEDIA_SEEKED)}),(0,i._)(this,"setPlaybackRate",e=>{this.state.playbackRate!==e&&(this.player&&(this.player.playbackRate=e),this.setState({playbackRate:e}),(0,f.ex)(N,e))}),(0,i._)(this,"maybeAppendIframeVisitId",e=>{let t=(0,_.A)(),a=t?t.id:null;return a&&(e=(0,M.rhs)(e,{src_iid:a})),e}),(0,i._)(this,"openEpisodePage",()=>{if(!this.props.post)return;let e=this.props.post.canonical_url;e=this.maybeAppendIframeVisitId(e),e=(0,M.rhs)(e,w),(0,k.uX)(e,{newTab:!0})}),this._onGlobalPlay=this.onGlobalPlay.bind(this),this._onMouseMove=this.onMouseMove.bind(this),this._onTouchStart=this.onTouchStart.bind(this),this._onTouchMove=this.onTouchMove.bind(this),this._onDragEnd=this.onDragEnd.bind(this),this._onCanPlay=this.onCanPlay.bind(this),this._onPlay=this.onPlay.bind(this),this._onPause=this.onPause.bind(this),this._onTimeUpdate=this.onTimeUpdate.bind(this),this._onRateChange=this.onRateChange.bind(this),this._onWaiting=this.onWaiting.bind(this),this._onPlaying=this.onPlaying.bind(this),this.state={playbackRate:e.playbackRate||(0,f.mM)(N,1),currentTime:0,waiting:!0,duration:e.duration||void 0,lastDragClearedAt:null}}}(0,i._)(S,"contextType",v.wj)},30218:function(e,t,a){a.d(t,{Z:()=>h});var i=a(16584),s=a(30396),r=a(20253),n=a(15771),o=a(19081),l=a(58175),d=a(51776),c=a(26111);let h=e=>{let{allowAllDay:t,redirect:a,onCancel:h,requiresMfa:p}=e,[u,y]=(0,s.eJ)(!1),[m,g]=(0,s.eJ)(""),[v,b]=(0,s.eJ)(!p),_=(0,s.sO)(null),T=a||(0,c.x)("redirect")||"/",f=(0,c.x)("for_pub")||"";return(0,s.d4)(()=>{_.current&&_.current.focus()},[]),(0,s.d4)(()=>{6===m.length&&b(!0)},[m]),(0,i.tZ)(r.ZP,{className:"customer-support-mode-form",analyticsName:"Customer Support Mode Form",action:"/api/v1/customer_support_mode",onSuccess:e=>{var t;let a=null==e?void 0:null===(t=e.body)||void 0===t?void 0:t.redirect;a?document.location.href=a:document.location.href=T||"/"},autoLock:!0,children:(0,i.BX)(o.tu,{children:[(0,i.BX)(o.tu,{gap:8,children:[(0,i.tZ)(l.xv.Meta,{className:"danger",weight:"semibold",color:"error",children:"Danger"}),(0,i.tZ)(l.xv.H2,{children:"Support Mode"}),(0,i.tZ)(l.xv.B3,{children:"Be absolutely respectful to the writers on whose behalf you are working."}),p&&(0,i.BX)(i.HY,{children:[(0,i.tZ)(l.xv.B3,{paddingTop:12,weight:"bold",children:"Enter your MFA code"}),(0,i.tZ)(d.oi,{ref:_,name:"code",inputMode:"numeric",maxLength:6,placeholder:"Code",value:m,width:300,autoComplete:"off",onChange:e=>g(e.target.value)})]}),t&&(0,i.tZ)("label",{children:(0,i.BX)(o.gq,{gap:8,children:[(0,i.tZ)("input",{type:"checkbox",defaultChecked:!1,onInput:e=>y(e.target.checked)})," ",(0,i.tZ)(l.xv.B3,{children:"Allow access for the day"})]})}),u&&(0,i.tZ)("input",{type:"hidden",name:"all_pubs",value:"true"}),(0,i.tZ)("input",{type:"hidden",name:"minutes",value:u?600:30}),(0,i.tZ)("input",{type:"hidden",name:"for_pub",value:f}),(0,i.tZ)("input",{type:"hidden",name:"redirect",value:T}),(0,i.BX)(o.gq,{gap:8,paddingTop:8,children:[(0,i.tZ)(n.zx,{priority:"destructive",type:"submit",id:"enter-support-mode",disabled:!v,children:"Enter support mode"}),h&&(0,i.tZ)(n.zx,{priority:"secondary",onClick:h,children:"Cancel"})]})]}),(0,i.tZ)("div",{id:"error-container"})]})})}},16864:function(e,t,a){a.d(t,{Z:()=>l});var i=a(7409),s=a(99282),r=a(98848),n=a(16584),o=a(64515);let l=e=>{var{size:t=24,className:a}=e,l=(0,r._)(e,["size","className"]);return(0,n.tZ)(o.l,(0,s._)((0,i._)({},l),{name:"ChevronRightCircleIcon",svgParams:{viewBox:"0 0 24 24"},stroke:"none",width:t,height:t,className:a,children:(0,n.tZ)("path",{d:"M24 12C24 18.553 18.5648 24 12 24C5.44707 24 0 18.553 0 12C0 5.4353 5.4353 0 11.9883 0C18.553 0 24 5.4353 24 12ZM9.22355 6.02354C8.84708 6.37648 8.83531 6.97649 9.21178 7.32943L14.2 12.0117L9.21178 16.7059C8.84708 17.0471 8.84708 17.6353 9.21178 18.0118C9.5412 18.3177 10.1765 18.2942 10.5177 17.9647L15.5647 13.2118C16.2471 12.5765 16.2588 11.4589 15.5647 10.8118L10.5177 6.07061C10.1412 5.71766 9.57649 5.68237 9.22355 6.02354Z"})}))}},45563:function(e,t,a){a.d(t,{X:()=>c});var i=a(7409),s=a(99282),r=a(23398),n=a(21666),o=a(76324);let l={medium:{desktop:{charactersTruncateTo:500,charactersTruncateIfOver:560,linesTruncateTo:6,linesTruncateIfOver:8},mobile:{charactersTruncateTo:320,charactersTruncateIfOver:420,linesTruncateTo:6,linesTruncateIfOver:8}},small:{desktop:{charactersTruncateTo:340,charactersTruncateIfOver:400,linesTruncateTo:4,linesTruncateIfOver:6},mobile:{charactersTruncateTo:210,charactersTruncateIfOver:210,linesTruncateTo:4,linesTruncateIfOver:4}}},d={desktop:{TRUNCATED_LINES:32,TRUNCATED_CHARACTERS:2400},mobile:{TRUNCATED_LINES:20,TRUNCATED_CHARACTERS:1e3}};function c(e,t){var a,c,h,p;let{truncationProfile:u="medium",isMobile:y}=t,{charactersTruncateTo:m,charactersTruncateIfOver:g,linesTruncateTo:v,linesTruncateIfOver:b}=l[c=e,"small"!==(h=u)&&(null===(p=c.attachments)||void 0===p?void 0:p.length)?"small":h][y?"mobile":"desktop"],_=function e(t){let a=null;if(t){if(a=(0,s._)((0,i._)({},t),{content:void 0,text:void 0}),null==t?void 0:t.content)for(let i of(a.content=[],t.content)){let t=e(i);t&&a.content.push(t)}else{var n,o;let e=null===(n=t.marks)||void 0===n?void 0:n.find(e=>"link"===e.type);(null==e?void 0:null===(o=e.attrs)||void 0===o?void 0:o.href)?a.text=(0,r.u)(e.attrs.href):a.text=t.text}}return a}(null!==(a=null==e?void 0:e.body_json)&&void 0!==a?a:(null==e?void 0:e.body)?{type:"doc",attrs:{schemaVersion:"v1"},content:e.body.split("\n\n").map(e=>({type:"paragraph",content:[{type:"text",text:e}]}))}:null),T=(0,n.k)(_)>g,f=(0,n.e)(_)>b;if(!_||!(T||f))return{bodyJson:_,truncatedBodyJson:_,isTruncated:!1,shouldExpandInline:!1};let k=_,P=!1,E=0;if(T){let e=(0,o.$)(k,{limit:m});k=e.doc,P=e.isTruncated,E=(0,n.k)(_)-(0,n.k)(k)}let M=!1,C=0;if(f&&k){let e=(0,o.p)(k,v);k=e.doc,M=e.isTruncated,C=(0,n.e)(_)-(0,n.e)(k)}return{bodyJson:_,truncatedBodyJson:k,isTruncated:P||M,shouldExpandInline:C<d[y?"mobile":"desktop"].TRUNCATED_LINES&&E<d[y?"mobile":"desktop"].TRUNCATED_CHARACTERS}}}}]);