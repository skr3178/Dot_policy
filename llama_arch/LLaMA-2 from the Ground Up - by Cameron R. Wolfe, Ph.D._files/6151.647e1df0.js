"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["6151"],{2180:function(e,t,n){n.d(t,{Z:()=>i});let i={container:"container-u4XWUV",label:"label-gARrM9",input:"input-rLnHxk",selectedInput:"selectedInput-RGkQnW"}},60648:function(e,t,n){n.d(t,{Z:()=>i});let i={input:"input-qHk4bN",form:"form-CkZ7Kt"}},43389:function(e,t,n){n.d(t,{Z:()=>d});var i=n(7409),r=n(99282),l=n(16584),o=n(66298),a=n(64515);let d=e=>(0,l.tZ)(a.l,(0,r._)((0,i._)({},e),{name:"LucideArrowUpRight",svgParams:{height:24,width:24},children:(0,l.tZ)(o.Z,{height:24,stroke:e.stroke,fill:e.fill,strokeWidth:e.strokeWidth})}))},25265:function(e,t,n){n.d(t,{Z:()=>d});var i=n(7409),r=n(99282),l=n(16584),o=n(7617),a=n(64515);let d=e=>(0,l.tZ)(a.l,(0,r._)((0,i._)({},e),{name:"LucideComments",svgParams:{height:24,width:24,fill:"#000000",strokeWidth:0},children:(0,l.tZ)(o.Z,{height:24,stroke:e.stroke,fill:e.fill,strokeWidth:e.strokeWidth})}))},666:function(e,t,n){n.d(t,{Z:()=>d});var i=n(7409),r=n(99282),l=n(16584),o=n(8618),a=n(64515);let d=e=>(0,l.tZ)(a.l,(0,r._)((0,i._)({},e),{name:"LucideHeart",svgParams:{height:24,width:24,fill:"#000000",strokeWidth:0},children:(0,l.tZ)(o.Z,{height:24,stroke:e.stroke,fill:e.fill,strokeWidth:e.strokeWidth})}))},95398:function(e,t,n){n.d(t,{Z:()=>a});var i=n(7409),r=n(99282),l=n(16584),o=n(64515);let a=e=>(0,l.tZ)(o.l,(0,r._)((0,i._)({},e),{name:"LucideShare",svgParams:{height:24,width:24,fill:"#000000",strokeWidth:0},children:(0,l.tZ)("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,l.tZ)("path",{d:"M12.4376 15.6C4.77778 15.6 2 20.3999 2 20.3999C2 12.5999 5.88889 8.4 12.4376 8.4V3L22 11.9812L12.4376 21V15.6Z",strokeWidth:e.strokeWidth,fill:e.fill,className:"lucide",strokeLinecap:"round",strokeLinejoin:"round"})})}))},50137:function(e,t,n){n.d(t,{Z:()=>a});var i=n(7409),r=n(99282),l=n(16584),o=n(64515);let a=e=>(0,l.tZ)(o.l,(0,r._)((0,i._)({},e),{name:"NoteForwardIcon",svgParams:{height:24,width:24,stroke:e.stroke,strokeWidth:e.strokeWidth},children:(0,l.tZ)("path",{d:"M21 3V8M21 8H16M21 8L18 5.29962C16.7056 4.14183 15.1038 3.38328 13.3879 3.11547C11.6719 2.84766 9.9152 3.08203 8.32951 3.79031C6.74382 4.49858 5.39691 5.65051 4.45125 7.10715C3.5056 8.5638 3.00158 10.2629 3 11.9996M3 21V16M3 16H8M3 16L6 18.7C7.29445 19.8578 8.89623 20.6163 10.6121 20.8841C12.3281 21.152 14.0848 20.9176 15.6705 20.2093C17.2562 19.501 18.6031 18.3491 19.5487 16.8925C20.4944 15.4358 20.9984 13.7367 21 12",strokeLinecap:"round","stroke-linejoin":"round"})}))},6498:function(e,t,n){n.d(t,{R:()=>c});var i=n(16584),r=n(347),l=n(7523),o=n(95441),a=n(83225),d=n(80026);let c=e=>{let{comments:t,post:n,commentId:a,notAllowedToFetchComments:c,handleSort:u,publication:h,sort:m,sortMenuUseMobileBottomSheet:p}=e,{iString:Z}=(0,o.M1)();return(0,i.BX)(r.h,{children:[(0,i.BX)(d.gq,{alignItems:"baseline",flex:"grow",gap:8,position:"relative",children:[(0,i.tZ)(l.Z,{preset:"st4",children:Z("Comments")}),(0,i.tZ)("div",{className:"mediumRule-B78a2B"}),(null==t?void 0:t.length)&&(null==t?void 0:t.length)>0?(0,i.tZ)(l.Z,{color:"accent",preset:"st4",children:n.comment_count}):null]}),(0,i.BX)(d.xu,{className:"sortOptionsContainer-bIIUcJ",children:[!c&&(0,i.tZ)(l.Z,{align:"left",as:"a",color:"tertiary",href:"/p/community-guidelines",preset:"detail-small",style:{textDecoration:"underline"},children:Z("Community Guidelines")}),t&&(null==t?void 0:t.length)>1&&!c&&!a&&(0,i.tZ)(s,{comments:t,handleSort:u,publication:h,sort:m,useMobileBottomSheet:p})]})]})},s=e=>{let{publication:t,handleSort:n,sort:r,comments:l,useMobileBottomSheet:o}=e;return t&&n&&r?(0,i.tZ)(a.$,{currentSort:r,handleSort:n,isLoading:!l,pub:t,useMobileBottomSheet:o}):null}},57626:function(e,t,n){n.d(t,{C:()=>m});var i=n(16584),r=n(18787),l=n(74626),o=n(6498),a=n(7523),d=n(95441),c=n(71068),s=n(19081),u=n(60308),h=n(47929);let m=e=>{let{post:t,publication:n,user:m,freeSignupEmail:p=null,showHeader:Z=!1}=e,{iString:f}=(0,d.M1)(),v=m&&m.email||p||null,b=(0,u.Zs0)(n,{simple:!0,next:document.location.href,utm_source:h.b3.paywall,utm_medium:h.lP.web,utm_content:t?t.id:null,just_signed_up:!1}),g=async()=>{window.location.href=b};return(0,i.BX)(s.tu,{className:"container-u0f9W_",children:[Z&&(0,i.tZ)(o.R,{notAllowedToFetchComments:!0,post:t,publication:n}),(0,i.tZ)(c.xu,{className:"commentsPaywall-ASd8iy",children:(0,i.BX)(s.tu,{alignItems:"center",gap:24,paddingX:24,paddingY:40,children:[(0,i.tZ)(a.Z,{color:"white",preset:"h4-sans-condensed",children:f("Join the conversation")}),(0,i.tZ)(a.Z,{color:"white",preset:"d3-serif",children:f("Share your thoughts and connect with other readers by becoming a paid subscriber!")}),(0,i.tZ)(l._,{variant:"inverse",onClick:g,children:f("Upgrade today")}),(0,i.BX)(a.Z,{as:"a",color:"white",href:(0,u.W1P)(n,{isSignInAttempt:!0}),native:!0,preset:"caption",children:[(0,r.qV)({post:t,publication:n})," ",(0,i.tZ)("u",{children:f(v?"Switch accounts":"Sign in")})]})]})})]})}},12980:function(e,t,n){n.d(t,{H:()=>E,U:()=>X});var i=n(27412),r=n(58865),l=n(16584),o=n(6400),a=n(80569),d=n.n(a),c=n(60826),s=n(56219),u=n(94442),h=n(11712),m=n(89276),p=n(74626),Z=n(95441),f=n(19081);let v=e=>{let{post:t,ctaUrl:n,ctaText:i,hidden:r}=e,{iString:o}=(0,Z.M1)(),a=i;return r||"podcast"!==t.type?r||"newsletter"!==t.type||(a=o("Back to article")):a=o("Back to episode"),(0,l.tZ)(f.tu,{alignItems:"start",paddingY:8,children:(0,l.tZ)(p._,{href:n,leadingIcon:"chevron-left",native:!0,size:"md",variant:"tertiary",children:a})})};var b=n(58319),g=n(75905),_=n(90099),y=n(68833),C=n(98914),w=n(6070),k=n(31377),B=n(60308),x=n(84864),M=n(47929);function S(){let e=(0,r._)(["This thread is only visible to "," subscribers of ",""]);return S=function(){return e},e}class N extends o.Component{onTopReached(){this.state.topReached||(this.setState({topReached:!0}),(0,y.j)(y.FP.POST_SEEN,{post_id:this.props.post.id,post_audience:this.props.post.audience,post_type:this.props.post.type}))}onBottomReached(){this.state.bottomReached||(this.setState({bottomReached:!0}),(0,y.j)(y.FP.POST_BOTTOM_SEEN,{post_id:this.props.post.id,post_audience:this.props.post.audience,post_type:this.props.post.type}))}async enableEmailNotifications(){try{await d().post("/api/v1/post/".concat(this.props.post.id,"/subscribe")),window.location.reload()}catch(e){console.error("Failed to subscribe to email notifications:",e),alert((0,C.zx)(e))}}render(e){let t,n,{className:i,pub:r,post:a,user:d,freeSignup:p,freeSignupEmail:Z,isStatic:f,hidden:g,truncated:y,invisible:C,post_reaction_token:N,onChange:E,showCta:X=y,showUnsubscribeNotice:L,dataForEmailRender:P={},showReactions:I=!0,gap:R=16,iString:T,iTemplate:H,iPlural:z,language:F,showShare:V}=e;"boolean"!=typeof g&&(g=a.hidden),g?(t=T("Subscribe to view"),n=(0,B.n1t)("/subscribe",{simple:!0,next:document.location.href,utm_source:M.b3.thread,utm_medium:M.lP.web,utm_content:a.id})):(n=(0,B.uRy)(r,a,{noBase:!0}),t="thread"!==a.type||y?(0,x.getPostCtaText)(a,F):a.comment_count?z("View 1 comment","View %1 comments",a.comment_count):T("Reply"));let A=f&&!this.context.isAmp,W=(0,w.HD)({pub:r}),U=W?m.j:o.Fragment;return(0,l.tZ)(_.YF,{className:"thread-head typography ".concat(i||""),children:(0,l.tZ)("tr",{children:(0,l.tZ)("td",{children:(0,l.BX)(_.i$,{width:"100%",children:[!C&&!g&&(0,l.tZ)(b.Z,{onVisible:()=>this.onTopReached()}),(0,l.BX)(_.i$,{gap:R,width:"100%",children:[X&&W&&(0,l.tZ)(v,{post:a,ctaUrl:n,ctaText:t,hidden:g}),(0,l.tZ)(s.mV,{pub:r,post:a,user:d,isStatic:f,reaction_token:N,allowEdit:!0,allowTruncate:y,showReactions:!!X||I,showShare:V,showComments:!!a.comment_count,inThreadHead:!0,onChange:E,showLabel:!0}),(0,l.tZ)(U,{inThreadHead:!0,children:(0,l.tZ)(h.Z,{user:d,freeSignup:p,freeSignupEmail:Z,pub:r,post:a,html:g||y||!a.body_html?null:a.body_html,isStatic:f,dataForEmailRender:P,children:g?(0,l.tZ)("p",{children:(0,l.tZ)("i",{children:H(S(),(0,k.isFoundingAudience)(a.audience)?"founding":"paid",r.name)})}):y?(0,l.tZ)("p",{children:a.description}):null})}),X?!W&&(0,l.BX)("a",{className:"thread-head-cta",href:n,native:!0,children:[t," â†’"]}):g&&(0,l.BX)("p",{className:"thread-head-cta",children:[(0,l.tZ)("a",{href:(0,B.W1P)(r,{simple:!0,next:document.location.href,utm_source:M.b3.thread,utm_medium:M.lP.web,utm_content:a.id}),className:"button primary subscribe-btn",native:!f,children:(0,x.getSubscribeText)(r)}),(0,l.tZ)("a",{href:(0,B.uXE)({for_pub:r.subdomain}),className:"button",native:!0,children:T("Sign in")})]})]}),A&&(0,l.BX)(_.i$,{gap:R,style:{width:"100%"},children:[(0,l.tZ)(_.i$,{style:{width:"100%",textAlign:"center"},children:(0,l.tZ)("a",{role:"button",className:"button primary",style:{margin:"0 auto"},href:c.W.HALF_MAGIC_COMMENTS_URL,children:T("See the discussion")})}),(0,l.tZ)(u.yT,{isFooter:!0,customization:{showShare:!0,showComments:!0,showReactions:{showReactions:I},showRestack:!1,showLabels:!0,showCommentRestack:!r.hide_post_restacks}})]}),L&&a.unsubscribed&&(0,l.BX)("div",{className:"notifications-alert",children:[T("Email notifications are disabled for this thread.")," ",(0,l.tZ)("a",{href:"javascript:void(0)",onClick:()=>this.enableEmailNotifications(),children:T("Re-enable")})]}),!C&&!g&&(0,l.tZ)(b.Z,{onVisible:()=>this.onBottomReached()})]})})})})}}(0,i._)(N,"contextType",g.E);let E=(0,Z.fz)(N);class X extends o.Component{render(){return(0,l.BX)("div",{className:"thread-head-silhouette",children:[(0,l.tZ)("div",{className:"thread-head-silhouette-head"}),(0,l.BX)("div",{className:"thread-head-silhouette-content",children:[(0,l.tZ)("div",{className:"thread-head-silhouette-title"}),(0,l.tZ)("div",{className:"thread-head-silhouette-meta"}),(0,l.BX)("div",{className:"thread-head-silhouette-body",children:[(0,l.tZ)("div",{className:"thread-head-silhouette-body-line"}),(0,l.tZ)("div",{className:"thread-head-silhouette-body-line"}),(0,l.tZ)("div",{className:"thread-head-silhouette-body-line"})]})]})]})}}},41149:function(e,t,n){n.d(t,{N:()=>m});var i=n(16584),r=n(3312),l=n.n(r),o=n(32351),a=n(32129),d=n(95355),c=n(93052),s=n(33884),u=n(63651),h=n(84864);function m(e){var t,n,r,l;let c,m,Z,{comment:f,post:v,publication:b}=e,g="Substack | Notes";b&&f.name?g="".concat(f.name," on ").concat(b.name):f.name&&f.handle?g="".concat(f.name," (@").concat(f.handle,")"):f.name?g=f.name:b&&(g="".concat(b.name));let _=v&&b?(0,a.getPageTitleAndMeta)(v,b,{isCommentPage:!0}).title:"".concat(g,': "').concat((0,h.truncateText)(f.body,280),'"'),y=(null!==(t=f.attachments)&&void 0!==t?t:[]).filter(e=>"image"===e.type),C=1===y.length?y[0]:null,w=C&&"imageUrl"in C?C.imageUrl:void 0;w?c=w:(0,d.pO)(f)&&(m=680,Z=680,c=(0,u.zF4)((0,s.IY)(f.id,{isSmall:!0,attachmentsOnly:!0}),Z,{height:m}));let k=null!==(n=f.body)&&void 0!==n?n:"";return(0,i.BX)(i.HY,{children:[(0,i.tZ)(o.Metadata,{title:_,socialTitle:g,description:k,image:c,imageHeight:m,imageWidth:Z,isLargeImage:!!c||void 0,siteName:b?b.name:"Substack",publishedTime:f.date.toString(),meta:[{name:"twitter:label1",content:"Likes"},{name:"twitter:data1",content:String(null!==(r=f.reaction_count)&&void 0!==r?r:0)},{name:"twitter:label2",content:"Replies"},{name:"twitter:data2",content:String(null!==(l=f.children_count)&&void 0!==l?l:0)}]}),(0,i.tZ)(p,{comment:f,includeBody:!0})]})}function p(e){let{comment:t,includeBody:n}=e;return t?(0,i.tZ)("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:l()((0,c.J)(t,{includeViews:!1,includeBody:n}),{json:!0,isScriptContext:!0})}}):null}},95434:function(e,t,n){n.d(t,{Gg:()=>L});var i=n(58865),r=n(16584),l=n(30396),o=n(24830),a=n(17048),d=n(80569),c=n.n(d),s=n(95441),u=n(80449),h=n(94874),m=n(71068),p=n(15771),Z=n(19081),f=n(1844),v=n(6490),b=n(65523),g=n(98248),_=n(17688),y=n(43570),C=n(58175),w=n(65252),k=n(98012);function B(){let e=(0,i._)(["Ban or suspend ",""]);return B=function(){return e},e}function x(){let e=(0,i._)(["Prevent this person from commenting on your publication in the future."]);return x=function(){return e},e}function M(){let e=(0,i._)(["Ban ",""]);return M=function(){return e},e}function S(){let e=(0,i._)(["Previously banned "," time(s), last on ",""]);return S=function(){return e},e}function N(){let e=(0,i._)([""," is permanently banned."]);return N=function(){return e},e}function E(){let e=(0,i._)([""," is banned until ","."]);return E=function(){return e},e}function X(){let e=(0,i._)(["Leave a reply"]);return X=function(){return e},e}let L=e=>{var t,n,i,o;let{comment:a,onReply:d,onBan:c,onClose:s}=e,{sub:u,loading:h,bans:m,bansHistory:p,error:Z,submitBan:f}=H(a,c),b=(0,w.mr)(),g=null===(t=b[1])||void 0===t?void 0:t[0],[_,y]=(0,l.eJ)(g),[C,B]=(0,l.eJ)(w.ol.VISIBLE),x=!!a||h,M=null!==(o=null===(i=b.find(e=>{let[t]=e;return t===_}))||void 0===i?void 0:null===(n=i[1])||void 0===n?void 0:n.toLowerCase())&&void 0!==o?o:"",S=m.filter(e=>(0,k.Z)(e.expiry).isAfter((0,k.Z)()));return(0,r.BX)(v.u_,{isOpen:x,onClose:s,children:[0===S.length&&(0,r.tZ)(P,{comment:a,sub:u,bans:m,bansHistory:p,loading:h,error:Z,selectedExpiry:_,setSelectedExpiry:y,selectedCommentVisibility:C,setSelectedCommentVisibility:B,expiryText:M,onClose:s,submitBan:f}),S.length>0&&(0,r.tZ)(T,{comment:a,bans:m,onClose:s,onReply:()=>{d&&a&&(d(a.id),s())}})]})},P=e=>{var t,n;let{comment:i,sub:l,bans:o,bansHistory:a,loading:d,error:c,selectedExpiry:u,setSelectedExpiry:m,selectedCommentVisibility:b,setSelectedCommentVisibility:k,expiryText:S,onClose:N,submitBan:E}=e,{iString:X,iTemplate:L}=(0,s.M1)(),P=(0,w.mr)(),T=(0,w.FG)();return(0,r.BX)(r.HY,{children:[(0,r.tZ)(v.xB,{showClose:!0,onClose:N,title:L(B(),null!==(t=null==i?void 0:i.name)&&void 0!==t?t:"user"),showDivider:!0,alignItems:"center",icon:(0,r.tZ)(h.qE,{photoUrl:null!==(n=null==i?void 0:i.photo_url)&&void 0!==n?n:void 0,size:56}),description:(0,r.BX)(Z.sg,{alignItems:"center",gap:8,children:[(null==l?void 0:l.is_subscribed)&&(0,r.tZ)(y.Vp,{priority:"secondary",children:X("Paid subscriber")}),(0,r.tZ)(C.xv,{children:L(x())})]})}),(0,r.tZ)(v.fe,{children:(0,r.BX)(Z.sg,{gap:20,children:[(0,r.tZ)(R,{bans:o,bansHistory:a}),c&&(0,r.tZ)(f.y,{children:X("An error occurred. Please try again.")}),d&&(0,r.tZ)(g.$j,{padding:32,alignItems:"center",justifyContent:"center"}),!d&&(0,r.BX)(r.HY,{children:[(0,r.BX)(I,{children:[(0,r.tZ)(C.xv.B3,{weight:"semibold",children:X("Ban duration")}),(0,r.BX)(_.i,{name:"expiry",value:u,onChange:e=>{m(e.target.value)},children:[(0,r.tZ)(_.d,{children:X("Select a duration")}),P.map(e=>{let[t,n]=e;return(0,r.tZ)("option",{value:t,children:null==n?void 0:n.replace(/^For /,"")})})]})]}),(0,r.BX)(I,{children:[(0,r.tZ)(C.xv.B3,{weight:"semibold",children:X("Delete comments")}),(0,r.BX)(_.i,{name:"comment_visibility",value:b,onChange:e=>{k(e.target.value)},children:[(0,r.tZ)(_.d,{children:X("Select whether to delete comments")}),T.map(e=>{let[t,n]=e;return(0,r.tZ)("option",{value:t,children:n})})]})]})]})]})}),(0,r.tZ)(v.mz,{direction:"column",showDivider:!0,primaryButton:(0,r.tZ)(p.zx,{priority:"destructive",onClick:()=>E(u,b),children:L(M(),S)})})]})},I=(0,m.zo)({display:"flex",justifyContent:"space-between",alignItems:"center"}),R=e=>{let{bans:t,bansHistory:n}=e,{iTemplate:i}=(0,s.M1)();if(!t[0])return null;let l=n.length?n.length:t.filter(e=>e.user_id).length;return(0,r.tZ)(u.b,{title:i(S(),l,(0,k.Z)(t[0].start).standardDatetimeWithYear()),theme:"default",priority:"secondary",Icon:o.Z,showClose:!1})},T=e=>{var t,n;let{comment:i,bans:l,onClose:o,onReply:d}=e,{iString:c,iTemplate:u}=(0,s.M1)(),h=l.find(e=>e.user_id),m=h&&(0,k.Z)(h.expiry).isAfter((0,k.Z)().add(100,"years"))?u(N(),null!==(t=null==i?void 0:i.name)&&void 0!==t?t:"This user"):u(E(),null!==(n=null==i?void 0:i.name)&&void 0!==n?n:"This user",(0,k.Z)(null==h?void 0:h.expiry).standardDatetimeWithYear());return h?(0,r.BX)(r.HY,{children:[(0,r.tZ)(v.xB,{title:m,alignItems:"center",icon:(0,r.tZ)(b.AM,{icon:(0,r.tZ)(a.Z,{})}),showClose:!0,onClose:o,description:c("We recommend leaving a reply to tell them why they are banned, and to let other readers know what kinds of comments are not acceptable.")}),(0,r.tZ)(v.ex,{}),(0,r.tZ)(v.mz,{direction:"column",primaryButton:(0,r.tZ)(p.zx,{priority:"primary-mono",onClick:d,children:u(X())})})]}):null},H=(e,t)=>{let[n,i]=(0,l.eJ)(null),[r,o]=(0,l.eJ)(!1),[a,d]=(0,l.eJ)([]),[s,u]=(0,l.eJ)([]),[h,m]=(0,l.eJ)(null),p=e=>{e.forEach(t=>{-1==e.findIndex(e=>e.id===t.id)&&e.push(t)}),d(e)},Z=async(n,i)=>{o(!0);try{if(!e)throw Error("comment undefined, cannot submitBan");let r=await c().post("/api/v1/comment_ban/".concat(e.id)).send({user_id:e.user_id,expiry:n,commentVisibility:i});i!==w.ol.VISIBLE&&document.location.reload();let l=r.body;p(l.bans),o(!1),t&&t(e,a)}catch(e){console.error("Failed to submit ban",e),m(!0)}o(!1)};return(0,l.d4)(()=>{(async()=>{if(e){o(!0),d([]),u([]),m(null),i(null);try{var t;let[n,r]=await Promise.all([c().get("/api/v1/user/".concat(e.user_id,"/bans")),c().get("/api/v1/moderation/publications/".concat(e.publication_id,"/users/").concat(e.user_id,"/bans")).query({type:"comment",limit:20})]),l=n.body;d(l.bans),i(l.sub),u(null!==(t=r.body.data)&&void 0!==t?t:[])}catch(e){console.error("Failed to get bans:",e),m(!0)}o(!1)}})()},[e]),{sub:n,loading:r,bans:a,bansHistory:s,error:h,submitBan:Z,setLoading:o,setError:m}}},82011:function(e,t,n){n.d(t,{a:()=>s});var i=n(16584),r=n(88812),l=n(46638),o=n(94874),a=n(17540),d=n(63474),c=n(63651);function s(e){let{comment:t,onClick:n,utm_content:s,noHover:m}=e,p=(0,l.gz)(t),Z=(0,c.NNq)(p,{utm_source:"comment",utm_content:s}),f=null!=n?n:()=>{};if(t.user_banned)return(0,i.tZ)(d.A0,{href:Z,onClick:f,children:(0,i.tZ)(o.ky,{size:32,icon:(0,i.tZ)(r.Z,{color:"var(--color-fg-tertiary)"})})});let v=h(p,m,Z,f),b=u(t);return b?(0,i.tZ)(a.zY,{tier:b,children:v}):v}let u=e=>{let{metadata:t}=e;return(null==t?void 0:t.is_author)?"author":(null==t?void 0:t.founding)?"founding":(null==t?void 0:t.membership_state)==="subscribed"?"paid":null},h=(e,t,n,r)=>t?(0,i.tZ)(o.On,{user:e,size:32,linkProps:{href:n,onClick:r}}):(0,i.tZ)(o.xV,{user:e,size:32,linkProps:{href:n,onClick:r}})},83225:function(e,t,n){n.d(t,{$:()=>u});var i=n(16584),r=n(37619),l=n(25380),o=n(95441),a=n(49762),d=n(15771),c=n(84747),s=n(50364);let u=e=>{let{currentSort:t,isLoading:n,pub:l,handleSort:a,useMobileBottomSheet:u}=e,{iString:m}=(0,o.M1)();return(0,i.tZ)(c.M,{trigger:(0,i.tZ)(d.zx,{size:"sm",priority:"secondary",disabled:n,leading:(0,i.tZ)(r.Z,{size:18}),children:(0,s.Sh)(t,l.language)}),ariaLabel:m("Sort comments"),useMobileBottomSheet:u,children:(0,i.tZ)(h,{currentSort:t,pub:l,handleSort:a})})},h=e=>{let{currentSort:t,pub:n,handleSort:r}=e,o=!!(0,a.ZP)("like_comments_enabled");return(0,i.tZ)(i.HY,{children:(0,s.Hz)({likesEnabled:o,language:n.language}).map(e=>{let{key:n,text:o}=e;return(0,i.tZ)(c.u,{onClick:()=>r(n),trailing:n===t?(0,i.tZ)(l.Z,{}):void 0,children:o},n)})})}},68072:function(e,t,n){n.d(t,{S:()=>o});var i=n(16584),r=n(71068),l=n(19081);function o(e){let{onCollapse:t}=e;return(0,i.tZ)(l.sg,{className:"collapser-Xs0O6C",onClick:t,children:(0,i.tZ)(r.xu,{className:"threadLine-BvF1wF",animate:!0})})}},63648:function(e,t,n){n.d(t,{Z:()=>g});var i=n(16584),r=n(94184),l=n.n(r),o=n(7617),a=n(31131),d=n(50137),c=n(30329),s=n(95441),u=n(53678),h=n(49762),m=n(19081),p=n(36500),Z=n(58175),f=n(39493);let v={link:"link-_X6et2",withShareButton:"withShareButton-hQzuEn"};function b(e){let{pub:t,post:n,comment:r,onChange:o}=e,{iString:a}=(0,s.M1)(),{canRestack:c,isRestacked:u,restacks:h,menuItems:m,nuxModal:Z}=(0,f.K)({pub:t,post:n,comment:r,onRestack:e=>{o({restacked:e,restacks:h+(e?1:-1)})}});return c?(0,i.BX)("span",{children:[Z,(0,i.tZ)(p.v2,{trigger:(0,i.BX)("a",{className:l()("restack-button",u&&"restacked"),href:"javascript:void(0)",children:[(0,i.tZ)(d.Z,{}),a("Restack"),h>0&&" (".concat(h,")")]}),children:m})]}):null}let g=e=>{var t,n;let{comment:r,pub:d,user:p,post:f,reaction_token:g,commentsEnabledForPost:_,noRestack:y,onChange:C,startReply:w,shareComment:k,updateCommentReacted:B,hideShare:x}=e,{iString:M}=(0,s.M1)(),S=(0,h.ZP)("like_comments_enabled");return(0,i.tZ)(m.hs,{gap:16,alignItems:"center",justifyContent:"start",paddingTop:8,className:l()("comment-actions",{[null!==(n=v.withShareButton)&&void 0!==n?n:"undefined"]:!!k}),children:!r.deleted&&[S&&(0,i.tZ)(c.dJ,{user:p,pub:d,post:f,comment:r,height:16,countInParenthesesStyle:!0,token:g,onChange:e=>{let{comment:t}=e;return C(t)},onReactedChange:e=>{B&&B(r.id,e)},noSelfUpdate:!!B}),_&&(0,i.tZ)(u.hh,{onClick:()=>w(),className:v.link,children:(0,i.BX)(m.hs,{gap:6,alignItems:"center",children:[(0,i.tZ)(o.Z,{stroke:"var(--color-fg-secondary-themed)",size:16}),(0,i.BX)(Z.xv.Meta,{color:"pub-secondary-text",children:[M("Reply"),(null===(t=r.children)||void 0===t?void 0:t.length)>0&&" (".concat(r.children.length,")")]})]})}),!x&&!!k&&(0,i.tZ)(u.hh,{onClick:()=>k(r.id),className:v.link,children:(0,i.BX)(m.hs,{gap:6,alignItems:"center",children:[(0,i.tZ)(a.Z,{stroke:"var(--color-fg-secondary-themed)",size:16}),(0,i.tZ)(Z.xv.Meta,{color:"pub-secondary-text",children:M("Share")})]})}),!y&&(0,i.tZ)(b,{pub:d,post:f,comment:r,onChange:C})]})}},65892:function(e,t,n){n.d(t,{Z:()=>p});var i=n(16584),r=n(30396),l=n(95441),o=n(46638),a=n(50364),d=n(98012),c=n(60308),s=n(84864),u=n(47929);let h=e=>{var t;let{comment:n,showHiddenComment:r,setShowHiddenComment:o}=e,{iString:c}=(0,l.M1)(),s=null===(t=n.bans)||void 0===t?void 0:t.find(e=>e.publication_id===n.publication_id),u=s&&(0,d.Z)(s.expiry).diff((0,d.Z)(),"years")>=1,h=(0,a.Ng)(n)&&(n.user_banned_for_comment||n.reported_by_user),m=c(u?"User was indefinitely suspended for this comment. ":"User was temporarily suspended for this comment. "),p=n.user_banned_for_comment?m:c("You reported this comment. ");return h&&(0,i.tZ)("div",{className:"comment_notice",children:(0,i.BX)("i",{children:[p,(0,i.tZ)("a",{href:"javascript:void(0)",onClick:()=>o(!r),children:r?"Hide":"Show"})]})})},m=e=>{let{comment:t}=e,{title:n,truncated_body_text:r,date:l,bylines:o,like_count:a,comment_count:d,url:h}=t.reply;return(0,i.BX)("a",{className:"reply-comment",href:(0,c.n1t)(h,{utm_source:u.b3.substack,utm_campaign:u.VX.postReplyComment,utm_medium:u.lP.web}),native:!0,children:[(0,i.tZ)("div",{className:"reply-comment-title",children:n}),r&&(0,i.tZ)("div",{className:"reply-comment-body",children:(0,s.formatEllipsis)(r)}),(0,i.tZ)("button",{className:"reply-comment-read-more",children:"Read more"}),(0,i.tZ)("div",{className:"reply-comment-meta",children:(0,s.getPostEmbedMeta)({date:l,bylines:o,like_count:a,comment_count:d})})]})},p=e=>{let{comment:t,bodyRef:n,expandToggleClicked:l}=e,[a,d]=(0,r.eJ)(!1),c=(t.user_banned_for_comment||t.reported_by_user)&&!a;return(0,i.BX)("div",{className:"comment-body",ref:n,children:[(0,i.tZ)(h,{comment:t,showHiddenComment:a,setShowHiddenComment:d}),t.hidden?(0,i.tZ)("i",{children:"Comment hidden"}):t.deleted?(0,i.tZ)("i",{children:"Comment deleted"}):c?(0,i.tZ)("i",{}):t.suppressed&&!a?(0,i.tZ)("i",{children:"Comment removed"}):"reply"===t.type?(0,i.tZ)(m,{comment:t}):(0,o.Fs)(t.body),(0,i.tZ)("div",{role:"button",className:"show-all-toggle",onClick:()=>l(),children:(0,i.tZ)("div",{className:"show-all-toggle-label",children:"Expand full comment"})})]})}},26419:function(e,t,n){n.d(t,{J:()=>ez});var i=n(58865),r=n(16584),l=n(30396),o=n(14293),a=n.n(o),d=n(95441),c=n(60807),s=n(25991),u=n(53678),h=n(16451),m=n(7409),p=n(99282),Z=n(85200),f=n(7760),v=n(85598),b=n(99869),g=n(59543),_=n(78526),y=n(16293),C=n(76924),w=n(66440),k=n(17876),B=n(7073),x=n(17048),M=n(74655),S=n(98848),N=n(64515);let E=e=>{var{size:t=24,fill:n="var(--color-fg-primary)"}=e,i=(0,S._)(e,["size","fill"]);return(0,r.tZ)(N.l,(0,p._)((0,m._)({},i),{name:"LinearIcon",svgParams:{viewBox:"0 0 24 24"},width:t,height:t,fill:n,children:(0,r.tZ)("path",{stroke:"none",fillRule:"evenodd",clipRule:"evenodd",d:"M19.0619 4.92341C15.1689 1.03032 8.8663 1.01517 4.95447 4.87797L19.1074 19.0309C22.9702 15.119 22.955 8.81651 19.0619 4.92341ZM2.95746 7.67367L16.3108 21.027C17.0035 20.6951 17.6661 20.2789 18.2829 19.7783L4.2062 5.70169C3.70565 6.31846 3.2894 6.98092 2.95746 7.67367ZM12.5482 21.9918L1.99316 11.4369C2.04331 10.5412 2.21326 9.65092 2.50301 8.79221L15.1928 21.4819C14.334 21.7717 13.4439 21.9416 12.5482 21.9918ZM4.90872 19.077C3.22167 17.3899 2.26284 15.2503 2.03226 13.049L10.9367 21.9534C8.73529 21.7228 6.59577 20.7639 4.90872 19.077Z"})}))},X=(0,n(6400).createContext)(null);function L(e){let{children:t,value:n}=e;return(0,r.tZ)(X.Provider,{value:n,children:t})}var P=n(80569),I=n.n(P),R=n(8923),T=n(98914),H=n(46638),z=n(98012),F=n(23854);function V(){let e=(0,i._)(["Are you sure you want to unpin this comment?"]);return V=function(){return e},e}function A(){let e=(0,i._)(["Are you sure you want to pin this comment?"]);return A=function(){return e},e}function W(){let e=(0,l.qp)(X);if(!e)throw Error("useCommentMenu must be used within a CommentMenuProvider");return e}let U=e=>{var t;let{iString:n}=(0,d.M1)(),i=null===(t=e.bans)||void 0===t?void 0:t.find(t=>t.publication_id===e.publication_id),r=i&&(0,z.Z)(i.expiry).diff((0,z.Z)(),"years")>=1,l=["moderator_removed","deleted"].includes(e.status),o=e.user_banned_for_comment;return{banText:r?n("Banned"):l?"":n("Suspended"),shouldShowBanText:o}};function j(e){let{iString:t}=(0,d.M1)(),{isOAuthProvider:n}=(0,R.wg)();return()=>!!n||window.confirm("".concat(t("Are you sure you want to ".concat(e," this comment? This action cannot be reversed."))))}var D=n(15771),J=n(19081),O=n(36500),Y=n(84747),q=n(40949),G=n(75419),$=n(50364),K=n(40121),Q=n(60308),ee=n(84864);function et(e){let{comment:t,pub:n,post:i,user:l,onChange:o,startEdit:a,startReport:d,openBan:c,isCollapsed:s,toggleCollapse:u,useMobileBottomSheet:h}=e;return!function(e){let{menuEnabled:t}=ev(e);return t}({comment:t,user:l})?null:(0,r.tZ)(Y.M,{trigger:(0,r.tZ)(J.X2,{className:"triggerContainer-eX588u",children:(0,r.tZ)(en,{})}),useMobileBottomSheet:h,children:(0,r.tZ)(er,{comment:t,pub:n,post:i,user:l,onChange:o,startEdit:a,startReport:d,openBan:c,isCollapsed:s,toggleCollapse:u})})}function en(){return(0,r.tZ)(D.hU,{priority:"quaternary",size:"sm",className:"trigger-j08Uop",children:(0,r.tZ)(Z.Z,{size:16})})}function ei(e){let{sections:t}=e,n=t.map(e=>(0,p._)((0,m._)({},e),{items:e.items.filter(e=>{var t;return null!==e&&(null===(t=e.props)||void 0===t?void 0:t.enabled)!==!1})})).filter(e=>e.items.length>0);return(0,r.tZ)(r.HY,{children:n.map((e,t)=>(0,r.tZ)(O.xw,{isFirst:0===t,children:e.items},e.key))})}function er(e){var t;let{comment:n,pub:i,post:o,user:a,onChange:d,startEdit:c,startReport:s,openBan:u,isCollapsed:h,toggleCollapse:m}=e,p=(0,l.sO)(),Z=ev({comment:n,user:a}),f=[{key:"editing",items:[(0,r.tZ)(ea,{enabled:Z.editCommentEnabled,onClick:c})]},{key:"sharing",items:[(0,r.tZ)(eo,{enabled:!0}),(0,r.tZ)(eZ,{enabled:Z.restackCommentEnabled})]},{key:"actions",items:[(0,r.tZ)(ed,{enabled:Z.pinCommentEnabled}),(0,r.tZ)(el,{enabled:!0,isCollapsed:h,toggleCollapse:m}),(0,r.tZ)(ec,{enabled:Z.giftSubscriptionEnabled}),(0,r.tZ)(ef,{enabled:null!==(t=null==a?void 0:a.is_global_admin)&&void 0!==t&&t}),(0,r.tZ)(es,{enabled:Z.subscriberDetailsEnabled})]},{key:"admin",items:[(0,r.tZ)(eu,{enabled:Z.deleteCommentEnabled}),(0,r.tZ)(eh,{enabled:Z.removeCommentEnabled}),(0,r.tZ)(em,{enabled:Z.reportCommentEnabled,onClick:s}),(0,r.tZ)(ep,{enabled:Z.banUserEnabled,onClick:u})]}];return(0,r.tZ)(L,{value:{comment:n,pub:i,post:o,onChange:d,onMenuClose:()=>{var e;return null===(e=p.current)||void 0===e?void 0:e.close()},toggleCollapse:m},children:(0,r.tZ)(ei,{sections:f})})}function el(e){let{enabled:t,isCollapsed:n,toggleCollapse:i}=e,{iString:l}=(0,d.M1)();return t?(0,r.tZ)(Y.u,{leading:n?(0,r.tZ)(f.Z,{}):(0,r.tZ)(v.Z,{}),onClick:i,children:l(n?"Expand":"Collapse")}):null}function eo(e){let{enabled:t}=e,{iString:n}=(0,d.M1)(),{comment:i,post:l,pub:o}=W(),a=(0,q.y)();return t?(0,r.tZ)(Y.u,{leading:(0,r.tZ)(b.Z,{}),onClick:()=>{a((0,H.aE)(l,i,o))},children:n("Copy link")}):null}function ea(e){let{enabled:t,onClick:n}=e,{iString:i}=(0,d.M1)();return t?(0,r.tZ)(Y.u,{leading:(0,r.tZ)(g.Z,{}),onClick:n,children:i("Edit")}):null}function ed(e){let{enabled:t}=e,{iString:n}=(0,d.M1)(),{comment:i,onChange:o}=W(),{pinned:a,togglingPin:c,togglePinned:s}=function(e){let{comment:t,onChange:n}=e,{iTemplate:i}=(0,d.M1)(),[r,o]=(0,l.eJ)(!1),a=!!t.pinned_by_user_id,c=async()=>{if(!r&&window.confirm(a?i(V()):i(A()))&&!r){o(!0);try{await I().patch("/api/v1/comment/".concat(t.id,"/pin")).send({pinned:!a}),n({pinned:!a}),document.location.reload()}catch(e){alert((0,T.zx)(e)),o(!1)}}};return{pinned:a,togglingPin:r,togglePinned:c}}({comment:i,onChange:o});return t?(0,r.tZ)(Y.u,{leading:(0,r.tZ)(_.Z,{}),onClick:s,children:n(c?a?"Unpinning...":"Pinning...":a?"Unpin":"Pin")}):null}function ec(e){let{enabled:t}=e,{iString:n}=(0,d.M1)(),{comment:i,pub:l}=W();if(!t)return null;let o="".concat(l.base_url,"/subscribe?gift=true&recipient=").concat(i.user_id,"-").concat((0,K.Hm)(i.name,{hashIfEmpty:!0}),"&comment_id=").concat(i.id,"}");return(0,r.tZ)(Y.u,{leading:(0,r.tZ)(y.Z,{}),href:o,children:n("Gift a subscription")})}function es(e){let{enabled:t}=e,{iString:n}=(0,d.M1)(),{comment:i,pub:l}=W();return t?(0,r.tZ)(Y.u,{leading:(0,r.tZ)(C.Z,{}),onClick:()=>{if(i.email)return window.open((0,Q.pN7)(l,i.email),"_blank")},children:n("Subscriber details")}):null}function eu(e){let{enabled:t}=e,{iString:n}=(0,d.M1)(),{comment:i,onChange:o,onMenuClose:a}=W(),{isDeleting:c,deleteComment:s}=function(e){let{comment:t,onChange:n,onMenuClose:i}=e,[r,o]=(0,l.eJ)(!1),a=j("delete"),d=(0,R.Sn)(),c=async()=>{if(!r&&a()){o(!0);try{await d.delete("/api/v1/comment/".concat(t.id)).send(),n({status:F.ql.deleted,deleted:!0,user_id:null,name:null,body:null}),i()}catch(e){alert((0,T.zx)(e))}o(!1)}};return{isDeleting:r,deleteComment:c}}({comment:i,onChange:o,onMenuClose:a});return t?(0,r.tZ)(Y.u,{leading:(0,r.tZ)(w.Z,{}),onClick:s,priority:"destructive",children:n(c?"Deleting...":"Delete")}):null}function eh(e){let{enabled:t}=e,{iString:n}=(0,d.M1)(),{comment:i,onChange:o,onMenuClose:a}=W(),{isRemoving:c,removeComment:s}=function(e){let{comment:t,onChange:n,onMenuClose:i}=e,[r,o]=(0,l.eJ)(!1),a=j("remove"),d=async()=>{if(!r&&a()){o(!0);try{await I().patch("/api/v1/comment/".concat(t.id,"/status")).send({status:F.ql.moderator_removed}),n({suppressed:!0,status:F.ql.moderator_removed,body:null}),i()}catch(e){alert((0,T.zx)(e))}o(!1)}};return{isRemoving:r,removeComment:d}}({comment:i,onChange:o,onMenuClose:a});return t?(0,r.tZ)(Y.u,{leading:(0,r.tZ)(k.Z,{}),onClick:s,priority:"destructive",children:n(c?"Removing...":"Remove")}):null}function em(e){let{enabled:t,onClick:n}=e,{iString:i}=(0,d.M1)();return t?(0,r.tZ)(Y.u,{leading:(0,r.tZ)(B.Z,{}),onClick:n,priority:"destructive",children:i("Report")}):null}function ep(e){let{enabled:t,onClick:n}=e,{iString:i}=(0,d.M1)();return t?(0,r.tZ)(Y.u,{leading:(0,r.tZ)(x.Z,{}),onClick:n,priority:"destructive",children:i("Ban or suspend user")}):null}function eZ(e){let{enabled:t}=e,n=(0,G.i3)(),{comment:i,pub:l,post:o}=W(),{iString:a}=(0,d.M1)();return t?(0,r.tZ)(Y.u,{leading:(0,r.tZ)(M.Z,{}),onClick:()=>{n.open({restackUrl:(0,H.aE)(o,i,l)})},children:a("Restack")}):null}function ef(e){let{enabled:t}=e,{iString:n}=(0,d.M1)(),{comment:i,post:l,pub:o}=W(),{addCommentToLinear:a}=function(e){let{comment:t,post:n,pub:i}=e,r=()=>{let e=(0,H.aE)(n,t,i),r=encodeURIComponent("".concat(t.body,"\n\nComment author: [").concat(t.name,"](https://admin.substack.com/users/").concat(t.user_id,")\n\nLink: ").concat(e));return"https://linear.app/substackinc/team/TPT/new?description=".concat(r,"&status=Triage")};return{addCommentToLinear:()=>{window.open(r(),"_blank")}}}({comment:i,post:l,pub:o});return t?(0,r.tZ)(Y.u,{leading:(0,r.tZ)(E,{}),onClick:a,children:n("Add to Linear")}):null}function ev(e){let{comment:t,user:n}=e,i=!!(n&&n.id===t.user_id),r=!!(null==n?void 0:n.is_contributor)&&(0,$.Ng)(t),l=(0,ee.canEditComment)(n,t),o=!!(null==n?void 0:n.is_contributor)&&(0,$.Ng)(t)&&""===t.ancestor_path,a=!i&&!!t.metadata.eligibleForGift&&!t.metadata.is_author,d=!i&&!t.reported_by_user&&!t.hidden&&!t.suppressed,c=r&&!i,s=r&&!t.user_banned&&!i,u=!!r&&!!t.email&&!i,h=(0,$.Ng)(t)&&!(null==n?void 0:n.is_oauth),m=l||o||a||d||c||s||u||h;return{editCommentEnabled:l,pinCommentEnabled:o,giftSubscriptionEnabled:a,reportCommentEnabled:d,deleteCommentEnabled:i,removeCommentEnabled:c,banUserEnabled:s,subscriberDetailsEnabled:u,restackCommentEnabled:h,menuEnabled:m}}var eb=n(67749);let eg=e=>{var{size:t=24,fill:n="var(--color-fg-primary)"}=e,i=(0,S._)(e,["size","fill"]);return(0,r.tZ)(N.l,(0,p._)((0,m._)({},i),{name:"CommentBadgeHeartIcon",svgParams:{viewBox:"0 0 20 20"},width:t,height:t,fill:n,children:(0,r.tZ)("path",{stroke:"none",d:"M9.99915 16.7256C9.90515 16.7256 9.79102 16.692 9.65674 16.6249C9.52246 16.5622 9.3949 16.4906 9.27405 16.41C8.02974 15.6044 6.94657 14.7584 6.02454 13.8722C5.10697 12.9815 4.3953 12.0662 3.88953 11.1262C3.38375 10.1818 3.13086 9.23067 3.13086 8.27283C3.13086 7.63725 3.23157 7.05762 3.43298 6.53394C3.63888 6.01025 3.92086 5.55819 4.27893 5.17773C4.64148 4.79728 5.05774 4.50635 5.52771 4.30493C6.00216 4.09904 6.51241 3.99609 7.05847 3.99609C7.73433 3.99609 8.31844 4.16618 8.81079 4.50635C9.30762 4.84652 9.70374 5.28963 9.99915 5.83569C10.299 5.28516 10.6951 4.84204 11.1875 4.50635C11.6843 4.16618 12.2707 3.99609 12.9465 3.99609C13.4836 3.99609 13.9894 4.09904 14.4639 4.30493C14.9428 4.50635 15.3613 4.79728 15.7194 5.17773C16.0774 5.55819 16.3572 6.01025 16.5586 6.53394C16.7645 7.05762 16.8674 7.63725 16.8674 8.27283C16.8674 9.23067 16.6145 10.1818 16.1088 11.1262C15.603 12.0662 14.8891 12.9815 13.967 13.8722C13.0495 14.7584 11.9708 15.6044 10.731 16.41C10.6056 16.4906 10.4758 16.5622 10.3416 16.6249C10.2118 16.692 10.0976 16.7256 9.99915 16.7256Z"})}))},e_=e=>{var{size:t=24,fill:n="var(--color-fg-primary)"}=e,i=(0,S._)(e,["size","fill"]);return(0,r.tZ)(N.l,(0,p._)((0,m._)({},i),{name:"CommentBadgePinIcon",svgParams:{viewBox:"0 0 20 20"},width:t,height:t,fill:n,children:(0,r.tZ)("path",{stroke:"none",d:"M4.62891 12.2131C4.62891 11.7253 4.75199 11.2486 4.99817 10.7831C5.24434 10.3131 5.5957 9.88566 6.05225 9.50073C6.51326 9.11133 7.05933 8.79801 7.69043 8.56079L7.91199 5.4187C7.57182 5.22624 7.26074 5.03153 6.97876 4.83459C6.69678 4.63765 6.45284 4.44967 6.24695 4.27063C6.04106 4.08712 5.87992 3.92151 5.76355 3.7738C5.57556 3.5321 5.48157 3.29041 5.48157 3.04871C5.48157 2.81596 5.56213 2.62349 5.72327 2.47131C5.88888 2.31466 6.10372 2.23633 6.3678 2.23633H13.6322C13.8963 2.23633 14.1089 2.31466 14.27 2.47131C14.4356 2.62349 14.5184 2.81596 14.5184 3.04871C14.5184 3.29041 14.4244 3.5321 14.2365 3.7738C14.1201 3.92151 13.9567 4.08712 13.7463 4.27063C13.5404 4.44967 13.2965 4.63765 13.0145 4.83459C12.737 5.02706 12.4282 5.22176 12.088 5.4187L12.3029 8.56079C12.9384 8.79801 13.4845 9.11133 13.941 9.50073C14.3976 9.88566 14.7489 10.3131 14.9951 10.7831C15.2413 11.2486 15.3644 11.7253 15.3644 12.2131C15.3644 12.5309 15.2659 12.7883 15.069 12.9852C14.872 13.1777 14.608 13.2739 14.2767 13.2739H10.7117V16.4697C10.7117 16.689 10.6848 16.9128 10.6311 17.1411C10.5774 17.3694 10.5103 17.5753 10.4297 17.7588C10.3491 17.9468 10.2686 18.0967 10.188 18.2086C10.1119 18.325 10.0492 18.3832 10 18.3832C9.95076 18.3832 9.88586 18.325 9.8053 18.2086C9.72473 18.0967 9.64417 17.9468 9.5636 17.7588C9.48303 17.5753 9.41589 17.3694 9.36218 17.1411C9.30847 16.9128 9.28162 16.689 9.28162 16.4697V13.2739H5.72327C5.39205 13.2739 5.12573 13.1777 4.92432 12.9852C4.72738 12.7883 4.62891 12.5309 4.62891 12.2131Z"})}))};var ey=n(63474),eC=n(43570),ew=n(87077);function ek(){let e=(0,i._)(["Pinned by ",""]);return ek=function(){return e},e}function eB(){let e=(0,i._)(["Liked by ",""]);return eB=function(){return e},e}let ex=e=>{let{comment:t}=e;return t.pinned_by_user_id?(0,r.tZ)(eM,{name:t.pinned_by_name}):t.metadata.is_author?(0,r.tZ)(eS,{}):t.reactor_names.length>0?(0,r.tZ)(eN,{names:t.reactor_names}):null},eM=e=>{let{name:t}=e,{iString:n,iTemplate:i}=(0,d.M1)();return t?(0,r.tZ)(ew.u,{text:i(ek(),t),layerOptions:{placement:"top-center",triggerOffset:8},children:(0,r.tZ)(eC.Vp,{priority:"secondary",cursor:"pointer",fillIcon:!0,leading:(0,r.tZ)(e_,(0,m._)({},eC.NH)),children:n("Pinned")})}):(0,r.tZ)(eC.Vp,{priority:"secondary-outline",fillIcon:!0,leading:(0,r.tZ)(e_,(0,m._)({},eC.NH)),children:n("Pinned")})},eS=()=>{let{iString:e}=(0,d.M1)();return(0,r.tZ)(eC.Vp,{priority:"secondary-outline",theme:"accent",children:e("Author")})},eN=e=>{let{names:t}=e,{iTemplate:n}=(0,d.M1)();return(0,r.tZ)(eC.Vp,{theme:"accent",priority:"secondary-outline",fillIcon:!0,leading:(0,r.tZ)(eg,(0,m._)({},eC.NH)),children:n(eB(),t.join(", "))})},eE=e=>{let{comment:t,userBanned:n}=e,{banText:i,shouldShowBanText:l}=U(t);return!l||n?null:(0,r.tZ)(eC.Vp,{priority:"secondary",children:i})},eX=e=>{let{comment:t,userPendingApproval:n}=e,{iString:i}=(0,d.M1)();return n?(0,r.tZ)(ey.A0,{href:"/publish/moderation/new-commenters?user=".concat(t.user_id),target:"_blank",rel:"noopener",children:(0,r.tZ)(eC.Vp,{priority:"secondary",cursor:"pointer",trailing:(0,r.tZ)(eb.Z,(0,m._)({},eC.NH)),children:i("Awaiting approval")})}):null},eL=e=>{let{children:t}=e;return(0,r.tZ)(J.X2,{gap:4,children:t})};var eP=n(71068),eI=n(58175),eR=n(33017),eT=n(47929);function eH(){let e=(0,i._)(["Edited"]);return eH=function(){return e},e}function ez(e){let{post:t,pub:n,comment:i,isCollapsed:l,onProfileClick:o,userBanned:a,toggleCollapse:d,userPendingApproval:u,disableHoverCard:h,onChange:m,startEdit:p,startReport:Z,openBan:f,hideContextMenu:v,useMobileBottomSheet:b}=e,g=(0,c.aF)();return(0,r.BX)(J.gq,{children:[(0,r.BX)(eJ,{children:[(0,r.tZ)(s.KF,{children:(0,r.BX)(s.Gf,{children:[(0,r.tZ)(eF,{comment:i,onClick:o,disableHoverCard:h}),(0,r.tZ)(eV,{comment:i}),(0,r.tZ)(eW,{comment:i,post:t,pub:n}),(0,r.tZ)(eU,{comment:i})]})}),!l&&(0,r.tZ)(eD,{comment:i,userBanned:a,userPendingApproval:u}),(0,r.tZ)(ej,{comment:i,isCollapsed:l,toggleCollapse:d})]}),(0,r.tZ)(eO,{onClick:d}),!v&&(0,r.tZ)(et,{comment:i,pub:n,post:t,user:g,onChange:m,startEdit:p,startReport:Z,openBan:f,isCollapsed:l,toggleCollapse:d,useMobileBottomSheet:b})]})}function eF(e){let{comment:t,onClick:n,disableHoverCard:i}=e,{iString:l}=(0,d.M1)();if(t.name&&!a()(t.user_id))return(0,r.tZ)(eI.xv.B4,{display:"flex",gap:6,children:(0,r.tZ)(s.Lg,{user:(0,H.gz)(t),onClick:n?()=>n(t):void 0,disableHoverCard:i})});let o=l(t.hidden?"Comment hidden":t.deleted?"Comment deleted":(0,$.Ng)(t)?"Anonymous":"Comment removed");return(0,r.tZ)(eI.xv.B4,{color:"secondary",children:o})}function eV(e){var t,n,i,l,o;let{comment:a}=e,d=(null===(t=a.metadata)||void 0===t?void 0:t.author_on_other_pub)&&!a.metadata.is_author,c=(null===(i=a.metadata)||void 0===i?void 0:null===(n=i.author_on_other_pub)||void 0===n?void 0:n.id)&&!a.hidden;return d?c?(0,r.tZ)(eR.Sm,{publication_id:null!==(o=null===(l=a.metadata.author_on_other_pub)||void 0===l?void 0:l.id)&&void 0!==o?o:0,children:(0,r.tZ)(eA,{comment:a})}):(0,r.tZ)(eA,{comment:a}):null}function eA(e){var t;let{comment:n,disableHoverCard:i}=e,l=(0,c.aF)();return n.metadata.author_on_other_pub&&l?(0,r.tZ)(eI.xv.B4,{as:"span",color:"secondary",weight:"regular",children:(0,r.tZ)(u.G6,{publication:n.metadata.author_on_other_pub,utm_source:eT.b3.substackFeedItem,utm_content:eT.fZ.commentMetadata,disableHoverCard:i,user:l,children:(0,r.BX)("span",{children:[(0,ee.truncateText)(null===(t=n.metadata.author_on_other_pub)||void 0===t?void 0:t.name,32)," "]})})}):null}function eW(e){let{comment:t,post:n,pub:i}=e;return(0,r.tZ)(eI.hh,{href:(0,H.aE)(n,t,i),onClick:e=>null===this||void 0===this?void 0:this.onDateClick(e),rel:"nofollow",native:!0,color:"secondary",title:s.c9.format((0,z.Z)(t.date).toDate()),children:(0,r.tZ)(h.Ku,{timestamp:t.date})})}function eU(e){let{comment:t}=e,{iTemplate:n}=(0,d.M1)();return t.edited_at?(0,r.tZ)(eI.xv.B4,{as:"span",fontStyle:"italic",decoration:"hover-underline",cursor:"pointer",color:"tertiary",title:s.c9.format((0,z.Z)(t.edited_at).toDate()),children:n(eH())}):null}function ej(e){let{comment:t,toggleCollapse:n,isCollapsed:i}=e,{iString:o}=(0,d.M1)(),[a,c]=(0,l.eJ)(!1);if(!i||!n)return null;let s=e=>{var t,n;return(null!==(t=e.children)&&void 0!==t?t:[]).length+(null!==(n=e.children)&&void 0!==n?n:[]).reduce((e,t)=>e+s(t),0)},u=s(t),h=o(a?"Loading":u>0?"Show replies":"Show comment");return(0,r.tZ)(J.X2,{children:(0,r.tZ)(D.zx,{size:"sm",flex:"auto",priority:"secondary-outline",maxHeight:28,onClick:()=>{c(!0),setTimeout(()=>{n(),c(!1)},0)},children:h})})}function eD(e){let{comment:t,userBanned:n,userPendingApproval:i}=e,l=ex({comment:t}),o=eE({comment:t,userBanned:n}),a=eX({comment:t,userPendingApproval:i});return l||o||a?(0,r.BX)(eL,{children:[l,o,a]}):null}let eJ=(0,eP.zo)({display:"flex",direction:"column",gap:4}),eO=(0,eP.zo)({display:"flex",direction:"column",flex:"grow"})},75496:function(e,t,n){n.d(t,{v:()=>function e(t,n){let l=[],o=!1,a=new Map(t.map(e=>[e.id,e]));for(let t of n){let n=a.get(t.id);if(n){var d,c;(n.children&&t.children?e(n.children,t.children):t.children)!==n.children||r.some(e=>n[e]!==t[e])||!(0,i.wU)(null!==(d=n.reactions)&&void 0!==d?d:{},null!==(c=t.reactions)&&void 0!==c?c:{})?(l.push(t),o=!0):l.push(n)}else l.push(t),o=!0}return o?l:t}});var i=n(75561);let r=["edited_at","deleted","status"]},21266:function(e,t,n){n.d(t,{H:()=>l});var i=n(7409),r=n(99282);function l(e,t){var n,l;return function e(t,n,l){let o=n[0];if(!o){let e=t.findIndex(e=>e.id===l.id);return e>=0?t.with(e,l):[...t,l]}let a=t.findIndex(e=>e.id===o);if(a>=0){let o=t[a];if(o.id===l.id)return t.with(a,l);if(o.children)return t.with(a,(0,r._)((0,i._)({},o),{children:e(o.children,n.slice(1),l)}))}return t}(e,null!==(l=null===(n=t.ancestor_path)||void 0===n?void 0:n.split(".").map(Number))&&void 0!==l?l:[],t)}},65252:function(e,t,n){n.d(t,{FG:()=>a,mr:()=>l,ol:()=>o});var i,r=n(95441);let l=()=>{let{iString:e}=(0,r.M1)();return[["1d",e("For 1 day")],["30d",e("For 30 days")],["90d",e("For 90 days")],["1y",e("For 1 year")],["1000y",e("Forever")]]};var o=((i={}).VISIBLE="visible",i.DELETE_THIS_COMMENT="delete_this_comment",i.DELETE_ALL_COMMENTS="delete_all_comments",i);let a=()=>{let{iString:e}=(0,r.M1)();return[["visible",e("Do not delete comments")],["delete_this_comment",e("Delete this comment")],["delete_all_comments",e("Also delete all comments")]]}},37155:function(e,t,n){n.d(t,{g:()=>i});function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise(t=>{setTimeout(t,e)})}},4953:function(e,t,n){n.d(t,{w6:()=>i});function*i(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;for(let i=e;i<t;i+=n)yield i}}}]);