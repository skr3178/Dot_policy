"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["8203"],{87815:function(e,t,o){o.d(t,{Z:()=>r});let r={group:"group-JuxKi2",segment:"segment-XiSgAE",outlined:"outlined-kJWSK2"}},58474:function(e,t,o){o.d(t,{Qe:()=>A,iL:()=>C,k2:()=>x,zw:()=>Z});var r=o(7409),a=o(16584),l=o(30396),n=o(57061),i=o(36781),s=o(33804),c=o(63049),d=o(53687),u=o(44404),p=o(95441),_=o(68833),h=o(98914),g=o(15771),m=o(19081),v=o(6490),b=o(63474),w=o(96302),y=o(58175),T=o(35500),k=o(60308),E=o(15181);let f=(e,t)=>{var o;let{postCoverImageUrl:r,pubCoverImageUrl:a,pub:l,themeVariables:n}=t,i=[],s=[],c=!1,d=n||l.theme,u=null!==(o=(null==d?void 0:d.web_bg_color)||(null==d?void 0:d.cover_bg_color))&&void 0!==o?o:"";switch(e){case"post_asset":r&&i.push("image"),((null==d?void 0:d.background_pop_color)||(null==d?void 0:d.background_pop))&&i.push("accent"),i.push("primary"),"#ffffff"!==u.toLowerCase()&&i.push("black&white"),c=!0;break;case"pub_shareable_image":a&&i.push("image"),i.push("primary"),s.push({type:"logo",label:"Logo"}),l.has_posts&&s.push({type:"posts",label:"Top posts"}),l.hero_text&&s.push({type:"description",label:"Description"});break;case"paid_subscription":case"pledged_subscription":((null==d?void 0:d.background_pop_color)||(null==d?void 0:d.background_pop))&&i.push("accent"),i.push("primary")}return{assetThemes:i,assetTypes:s,includePreviewTextToggle:c}};function C(e){var t;let o,b,w,y,C,I,{pub:O,item:B,isOpen:P,setOpen:M,themeVariables:N,width:R}=e,{iString:L}=(0,p.M1)(),{type:W,target_user:X,target_user_id:j,target_pledge_note:G,target_subscription_note:q,post:F}=B,U=O.logo_url||O.cover_photo_url||O.author_photo_url||(null===(t=O.author)||void 0===t?void 0:t.photo_url),z=null==F?void 0:F.cover_image,J="post_asset"===W,{assetThemes:K,assetTypes:H,includePreviewTextToggle:Q}=f(W,{postCoverImageUrl:z,pubCoverImageUrl:U,pub:O,themeVariables:N}),V=N||O.theme,[$,Y]=(0,l.eJ)(J?"instagram":"stories"),[ee,et]=(0,l.eJ)(K.find(e=>"image"===e)&&U?"image":K.find(e=>"accent"===e)&&((null==V?void 0:V.background_pop_color)||(null==V?void 0:V.background_pop))?"accent":"primary"),[eo,er]=(0,l.eJ)("logo");(0,l.d4)(()=>{P&&(0,_.j)(_.FP.SHARE_CENTER_CUSTOMIZE_ASSETS_MODAL_OPENED)},[P]);let[ea,el]=(0,l.eJ)(!0),en=()=>{switch(ee){case"image":return(0,r._)({aspectRatio:$,bgImage:!0},H.length&&{type:eo},Q&&ea&&{hidePreviewText:!0});case"accent":return(0,r._)({aspectRatio:$,bgColor:(null==V?void 0:V.background_pop_color)||(null==V?void 0:V.background_pop),textColor:null==V?void 0:V.print_on_pop},H.length&&{type:eo},Q&&ea&&{hidePreviewText:!0});case"primary":return(0,r._)({aspectRatio:$,bgColor:(null==V?void 0:V.web_bg_color)||(null==V?void 0:V.cover_bg_color),textColor:(null==V?void 0:V.print_on_web_bg_color)||(null==V?void 0:V.cover_print_primary)},H.length&&{type:eo},Q&&ea&&{hidePreviewText:!0});default:return(0,r._)({aspectRatio:$,bgColor:"#ffffff",textColor:"#404040"},H.length&&{type:eo},Q&&ea&&{hidePreviewText:!0})}},ei=(0,h.K1)(),es=()=>{M(!1)};switch(W){case"arr_10k_milestone":w=T.dD.ARR10K,b=(0,a.tZ)(n.d,{pub:O,milestone:w,style:{aspectRatio:$}}),y=(0,k.iNT)(O,w,{aspectRatio:$},"".concat(w," - ").concat("stories"===$?"vertical":$));break;case"arr_1k_milestone":w=T.dD.ARR1K,b=(0,a.tZ)(n.d,{pub:O,milestone:w,style:{aspectRatio:$}}),y=(0,k.iNT)(O,w,{aspectRatio:$},"".concat(w," - ").concat("stories"===$?"vertical":$));break;case"list_100_milestone":w=T.bq.List100,b=(0,a.tZ)(n.d,{pub:O,milestone:w,style:{aspectRatio:$}}),y=(0,k.iNT)(O,w,{aspectRatio:$},"".concat(w," - ").concat("stories"===$?"vertical":$));break;case"list_1k_milestone":w=T.bq.List1K,b=(0,a.tZ)(n.d,{pub:O,milestone:w,style:{aspectRatio:$}}),y=(0,k.iNT)(O,w,{aspectRatio:$},"".concat(w," - ").concat("stories"===$?"vertical":$));break;case"paid_subscription":b=(0,a.tZ)(u.uP,{pub:O,note:q,user:X||{id:j||0},style:en()}),y=(0,k.gGz)(O,X||{id:j||0},en(),{fileToDownload:"Message - ".concat("stories"===$?"vertical":$)}),I=()=>{(0,_.j)(_.FP.SUBSCRIPTION_NOTE_MEDIA_ASSETS_IMAGE_DOWNLOADED,{note_from_user_id:(null==X?void 0:X.id)||j,aspectRatio:$,source:"download-button"})};break;case"pledged_subscription":b=(0,a.tZ)(u.hi,{pub:O,note:G,user:X||{id:j||0},style:en()}),y=(0,k.uQO)(O,X||{id:j||0},en(),{fileToDownload:"Message - ".concat("stories"===$?"vertical":$)}),I=()=>{(0,_.j)(_.FP.PLEDGE_NOTE_MEDIA_ASSETS_IMAGE_DOWNLOADED,{note_from_user_id:(null==X?void 0:X.id)||j,aspectRatio:$,source:"download-button"})};break;case"pub_shareable_image":o=L("Create shareable image"),b=(0,a.tZ)(c.H,{pub:O,style:en()}),C="".concat(O.name," - ").concat("stories"===$?"vertical":$),y=(0,k.p5u)(O,null,en(),{fileToDownload:C}),I=()=>{(0,_.j)(_.FP.PUBLICATION_MEDIA_ASSETS_IMAGE_DOWNLOADED,{aspectRatio:$,source:"download-button"})};break;case"post_asset":{let e=en(),{text:t,translatedText:r}="image"===ee?{text:"Image".concat(ea?" - no preview":""),translatedText:L(ea?"Image - no preview":"Image")}:"accent"===ee?{text:"Accent Color".concat(ea?" - no preview":""),translatedText:L(ea?"Accent Color - no preview":"Accent Color")}:"primary"===ee?{text:"Background Color".concat(ea?" - no preview":""),translatedText:L(ea?"Background Color - no preview":"Background Color")}:{text:"Black and White".concat(ea?" - no preview":""),translatedText:L(ea?"Black and White - no preview":"Black and White")};o=L("Create shareable image"),b=F&&(0,a.tZ)(i.Z,{pub:O,post:F,style:e,translatedText:r,size:420,hoverOverlay:!1}),C="".concat(r," - ").concat("stories"===$?"vertical":$),y=F&&(0,k.ChS)(O,F,e,C),I=()=>{(0,_.j)(_.FP.WRITER_MEDIA_ASSETS_IMAGE_DOWNLOADED,{post_id:null==F?void 0:F.id,type:t,aspectRatio:e.aspectRatio,share_center:!0,inline:!1,source:"download-button"})}}}["arr_10k_milestone","arr_1k_milestone","list_100_milestone","list_1k_milestone"].includes(W)?(o=L("Share milestone"),C="".concat(w," - ").concat("stories"===$?"vertical":$),I=()=>{(0,_.j)(_.FP.MILESTONE_MEDIA_ASSETS_IMAGE_DOWNLOADED,{milestone:w,aspectRatio:$,source:"download-button"})}):["paid_subscription","pledged_subscription"].includes(W)&&(o=L("Share message"),C="Message - ".concat("stories"===$?"vertical":$));let ec=async()=>{null==I||I();let e=document.createElement("a");e.href=y,e.download=C,e.target="_blank",e.rel="noopener noreferrer",e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e)},ed=K.length>1,eu=H.length>1,ep=d.sl.length>1;return(0,a.tZ)(v.u_,{isOpen:P,onClose:es,width:R||640,overflow:"hidden",renderOverReactLaagPortal:!0,fullscreenMobile:!0,children:(0,a.BX)(s.w,{children:[(0,a.tZ)(v.xB,{onClose:es,title:o,showClose:!0,showDivider:!0}),(0,a.tZ)(v.fe,{children:(0,a.BX)(m.tu,{gap:20,children:[(0,a.tZ)(m.hs,{className:E.Z.imageContainer,alignItems:"center",justifyContent:"center",children:b}),(0,a.BX)(x,{children:[ed&&(0,a.tZ)(A,{assetThemes:K,assetTheme:ee,setAssetTheme:et,theme:V,pubCoverImageUrl:U}),eu&&(0,a.tZ)(S,{assetTypes:H,assetType:eo,setAssetType:er}),ep&&(0,a.tZ)(Z,{aspectRatio:$,setAspectRatio:Y,includeInstagram:J}),Q&&(0,a.tZ)(D,{hidePreviewText:ea,setHidePreviewText:el})]})]})}),!ei&&(0,a.tZ)(v.mz,{showDivider:!0,direction:"column",primaryButton:(0,a.tZ)(g.zx,{priority:"primary",onClick:ec,children:L("Download image")})})]})})}function A(e){let{assetThemes:t,assetTheme:o,setAssetTheme:r,theme:l,pubCoverImageUrl:n}=e;return(0,a.BX)(m.tu,{gap:8,children:[(0,a.tZ)(y.xv.B4,{weight:"medium",translated:!0,children:"Background"}),(0,a.tZ)(m.gq,{gap:8,children:t.map(e=>(0,a.tZ)(d.rn,{value:e,isSelected:e===o,onClick:()=>r(e),themeVariables:l,coverImageUrl:n}))})]})}function S(e){let{assetTypes:t,assetType:o,setAssetType:r}=e;return(0,a.BX)(m.tu,{gap:8,children:[(0,a.tZ)(y.xv.B4,{weight:"medium",translated:!0,children:"Type"}),(0,a.tZ)(m.gq,{gap:8,children:t.map(e=>{let{type:t,label:l}=e;return(0,a.tZ)(d.$I,{label:l,isSelected:t===o,onClick:()=>r(t)})})})]})}function Z(e){let{aspectRatio:t,setAspectRatio:o,includeInstagram:r}=e,l=r?d.sl:d.sl.filter(e=>"instagram"!==e);return(0,a.BX)(m.tu,{gap:8,children:[(0,a.tZ)(y.xv.B4,{weight:"medium",translated:!0,children:"Aspect Ratio"}),(0,a.tZ)(m.gq,{gap:8,children:l.map(e=>(0,a.tZ)(d.ar,{value:e,isSelected:e===t,onClick:()=>o(e)}))})]})}function D(e){let{hidePreviewText:t,setHidePreviewText:o}=e;return(0,a.BX)(m.tu,{gap:8,children:[(0,a.tZ)(y.xv.B4,{weight:"medium",translated:!0,children:"Preview Text"}),(0,a.tZ)(m.hs,{flex:"grow",alignItems:"center",children:(0,a.tZ)(w.rs,{checked:!t,onChange:e=>{o(!e),(0,_.j)(_.FP.SHARE_CENTER_CUSTOMIZE_ASSETS_PREVIEW_TEXT_TOGGLED,{includePreviewText:e})}})})]})}let x=(0,b.zo)({display:"flex",gap:20,overflowX:"auto",flex:"auto",justifyContent:"space-between"})},86190:function(e,t,o){o.d(t,{U:()=>a});var r=o(48980);let a=e=>async t=>{let o="before";t({type:"conversation-request_initial",payload:{conversationId:e}});try{let a=await (0,r.rd)("/api/v1/messages/dm/".concat(e));t({type:"conversation-load_more",payload:{edge:o,cursor:null,page:a}})}catch(r){t({type:"conversation-request_error",payload:{conversationId:e,edge:o,cursor:null,error:r}})}}}}]);